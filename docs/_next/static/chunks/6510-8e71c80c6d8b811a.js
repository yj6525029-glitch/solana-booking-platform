(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6510],{95589:function(e){"use strict";var t=Object.prototype.hasOwnProperty,r="~";function i(){}function s(e,t,r){this.fn=e,this.context=t,this.once=r||!1}function n(e,t,i,n,o){if("function"!=typeof i)throw TypeError("The listener must be a function");var a=new s(i,n||e,o),c=r?r+t:t;return e._events[c]?e._events[c].fn?e._events[c]=[e._events[c],a]:e._events[c].push(a):(e._events[c]=a,e._eventsCount++),e}function o(e,t){0==--e._eventsCount?e._events=new i:delete e._events[t]}function a(){this._events=new i,this._eventsCount=0}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(r=!1)),a.prototype.eventNames=function(){var e,i,s=[];if(0===this._eventsCount)return s;for(i in e=this._events)t.call(e,i)&&s.push(r?i.slice(1):i);return Object.getOwnPropertySymbols?s.concat(Object.getOwnPropertySymbols(e)):s},a.prototype.listeners=function(e){var t=r?r+e:e,i=this._events[t];if(!i)return[];if(i.fn)return[i.fn];for(var s=0,n=i.length,o=Array(n);s<n;s++)o[s]=i[s].fn;return o},a.prototype.listenerCount=function(e){var t=r?r+e:e,i=this._events[t];return i?i.fn?1:i.length:0},a.prototype.emit=function(e,t,i,s,n,o){var a=r?r+e:e;if(!this._events[a])return!1;var c,l,h=this._events[a],u=arguments.length;if(h.fn){switch(h.once&&this.removeListener(e,h.fn,void 0,!0),u){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,t),!0;case 3:return h.fn.call(h.context,t,i),!0;case 4:return h.fn.call(h.context,t,i,s),!0;case 5:return h.fn.call(h.context,t,i,s,n),!0;case 6:return h.fn.call(h.context,t,i,s,n,o),!0}for(l=1,c=Array(u-1);l<u;l++)c[l-1]=arguments[l];h.fn.apply(h.context,c)}else{var d,p=h.length;for(l=0;l<p;l++)switch(h[l].once&&this.removeListener(e,h[l].fn,void 0,!0),u){case 1:h[l].fn.call(h[l].context);break;case 2:h[l].fn.call(h[l].context,t);break;case 3:h[l].fn.call(h[l].context,t,i);break;case 4:h[l].fn.call(h[l].context,t,i,s);break;default:if(!c)for(d=1,c=Array(u-1);d<u;d++)c[d-1]=arguments[d];h[l].fn.apply(h[l].context,c)}}return!0},a.prototype.on=function(e,t,r){return n(this,e,t,r,!1)},a.prototype.once=function(e,t,r){return n(this,e,t,r,!0)},a.prototype.removeListener=function(e,t,i,s){var n=r?r+e:e;if(!this._events[n])return this;if(!t)return o(this,n),this;var a=this._events[n];if(a.fn)a.fn!==t||s&&!a.once||i&&a.context!==i||o(this,n);else{for(var c=0,l=[],h=a.length;c<h;c++)(a[c].fn!==t||s&&!a[c].once||i&&a[c].context!==i)&&l.push(a[c]);l.length?this._events[n]=1===l.length?l[0]:l:o(this,n)}return this},a.prototype.removeAllListeners=function(e){var t;return e?(t=r?r+e:e,this._events[t]&&o(this,t)):(this._events=new i,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=r,a.EventEmitter=a,e.exports=a},12238:function(e,t,r){"use strict";function i(){return(null===r.g||void 0===r.g?void 0:r.g.crypto)||(null===r.g||void 0===r.g?void 0:r.g.msCrypto)||{}}function s(){let e=i();return e.subtle||e.webkitSubtle}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowserCryptoAvailable=t.getSubtleCrypto=t.getBrowerCrypto=void 0,t.getBrowerCrypto=i,t.getSubtleCrypto=s,t.isBrowserCryptoAvailable=function(){return!!i()&&!!s()}},33531:function(e,t,r){"use strict";var i=r(25566);function s(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function n(){return void 0!==i&&void 0!==i.versions&&void 0!==i.versions.node}Object.defineProperty(t,"__esModule",{value:!0}),t.isBrowser=t.isNode=t.isReactNative=void 0,t.isReactNative=s,t.isNode=n,t.isBrowser=function(){return!s()&&!n()}},13303:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(45161);i.__exportStar(r(12238),t),i.__exportStar(r(33531),t)},45161:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return n},__asyncDelegator:function(){return v},__asyncGenerator:function(){return w},__asyncValues:function(){return E},__await:function(){return b},__awaiter:function(){return h},__classPrivateFieldGet:function(){return S},__classPrivateFieldSet:function(){return N},__createBinding:function(){return d},__decorate:function(){return a},__exportStar:function(){return p},__extends:function(){return s},__generator:function(){return u},__importDefault:function(){return C},__importStar:function(){return _},__makeTemplateObject:function(){return I},__metadata:function(){return l},__param:function(){return c},__read:function(){return g},__rest:function(){return o},__spread:function(){return m},__spreadArrays:function(){return y},__values:function(){return f}});var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function s(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)0>t.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function a(e,t,r,i){var s,n=arguments.length,o=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,i){t(r,i,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,i){return new(r||(r=Promise))(function(s,n){function o(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function u(e,t){var r,i,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(s=2&n[0]?i.return:n[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function d(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}function p(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,s,n=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),s=0,t=0;t<r;t++)for(var n=arguments[t],o=0,a=n.length;o<a;o++,s++)i[s]=n[o];return i}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,s=r.apply(e,t||[]),n=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){s[e]&&(i[e]=function(t){return new Promise(function(r,i){n.push([e,t,r,i])>1||a(e,t)})})}function a(e,t){try{var r;(r=s[e](t)).value instanceof b?Promise.resolve(r.value.v).then(c,l):h(n[0][2],r)}catch(e){h(n[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function h(e,t){e(t),n.shift(),n.length&&a(n[0][0],n[0][1])}}function v(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,s){t[i]=e[i]?function(t){return(r=!r)?{value:b(e[i](t)),done:"return"===i}:s?s(t):t}:s}}function E(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,s){!function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)}(i,s,(t=e[r](t)).done,t.value)})}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function C(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}function N(e,t,r){if(!t.has(e))throw TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},5071:function(e,t,r){"use strict";r.d(t,{Z:function(){return b},k:function(){return b}});var i=r(55445),s=r(80751),n=r.n(s),o=r(80577),a=r(5276),c=Object.defineProperty,l=Object.defineProperties,h=Object.getOwnPropertyDescriptors,u=Object.getOwnPropertySymbols,d=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,f=(e,t,r)=>t in e?c(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g=(e,t)=>{for(var r in t||(t={}))d.call(t,r)&&f(e,r,t[r]);if(u)for(var r of u(t))p.call(t,r)&&f(e,r,t[r]);return e},m=(e,t)=>l(e,h(t));let y={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class b{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new i.EventEmitter,this.isAvailable=!1,this.registering=!1,!(0,a.isHttpUrl)(e))throw Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{let t=(0,o.u)(e),r=await (await n()(this.url,m(g({},y),{body:t}))).json();this.onPayload({data:r})}catch(t){this.onError(e.id,t)}}async register(e=this.url){if(!(0,a.isHttpUrl)(e))throw Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return t(Error("HTTP connection is missing or invalid"));e()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){let t=(0,o.u)({id:1,jsonrpc:"2.0",method:"test",params:[]});await n()(e,m(g({},y),{body:t}))}this.onOpen()}catch(t){let e=this.parseError(t);throw this.events.emit("register_error",e),this.onClose(),e}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?(0,o.D)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let r=this.parseError(t),i=r.message||r.toString(),s=(0,a.formatJsonRpcError)(e,i);this.events.emit("payload",s)}parseError(e,t=this.url){return(0,a.parseConnectionError)(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}}},38979:function(e,t,r){"use strict";r.d(t,{r:function(){return n}});var i=r(55445),s=r(5276);class n extends s.IJsonRpcProvider{constructor(e){super(e),this.events=new i.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict((0,s.formatJsonRpcRequest)(e.method,e.params||[],e.id||(0,s.getBigIntRpcId)().toString()),t)}async requestStrict(e,t){return new Promise(async(r,i)=>{if(!this.connection.connected)try{await this.open()}catch(e){i(e)}this.events.on(`${e.id}`,e=>{(0,s.isJsonRpcError)(e)?i(e.error):r(e.result)});try{await this.connection.send(e,t)}catch(e){i(e)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),(0,s.isJsonRpcResponse)(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&3e3===e.code&&this.events.emit("error",Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof e&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}},44265:function(e,t,r){"use strict";r.d(t,{CA:function(){return s},JV:function(){return a},O4:function(){return i},dQ:function(){return n},xK:function(){return o}});let i="INTERNAL_ERROR",s="SERVER_ERROR",n=[-32700,-32600,-32601,-32602,-32603],o={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},[i]:{code:-32603,message:"Internal error"},[s]:{code:-32e3,message:"Server error"}},a=s},23497:function(e,t,r){"use strict";var i=r(13303);r.o(i,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return i.IJsonRpcProvider}}),r.o(i,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return i.formatJsonRpcError}}),r.o(i,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return i.formatJsonRpcRequest}}),r.o(i,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return i.formatJsonRpcResult}}),r.o(i,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return i.getBigIntRpcId}}),r.o(i,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return i.isHttpUrl}}),r.o(i,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return i.isJsonRpcError}}),r.o(i,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return i.isJsonRpcRequest}}),r.o(i,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return i.isJsonRpcResponse}}),r.o(i,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return i.isJsonRpcResult}}),r.o(i,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return i.isLocalhostUrl}}),r.o(i,"isReactNative")&&r.d(t,{isReactNative:function(){return i.isReactNative}}),r.o(i,"isWsUrl")&&r.d(t,{isWsUrl:function(){return i.isWsUrl}}),r.o(i,"payloadId")&&r.d(t,{payloadId:function(){return i.payloadId}})},28418:function(e,t,r){"use strict";r.d(t,{CX:function(){return a},L2:function(){return o},by:function(){return n},i5:function(){return s}});var i=r(44265);function s(e){return i.dQ.includes(e)}function n(e){return Object.keys(i.xK).includes(e)?i.xK[e]:i.xK[i.JV]}function o(e){return Object.values(i.xK).find(t=>t.code===e)||i.xK[i.JV]}function a(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?Error(`Unavailable ${r} RPC url at ${t}`):e}},74947:function(e,t,r){"use strict";r.d(t,{CS:function(){return o},RI:function(){return l},o0:function(){return n},sT:function(){return a},tm:function(){return c}});var i=r(28418),s=r(44265);function n(e=3){return Date.now()*Math.pow(10,e)+Math.floor(Math.random()*Math.pow(10,e))}function o(e=6){return BigInt(n(e))}function a(e,t,r){return{id:r||n(),jsonrpc:"2.0",method:e,params:t}}function c(e,t){return{id:e,jsonrpc:"2.0",result:t}}function l(e,t,r){var n;return{id:e,jsonrpc:"2.0",error:void 0===(n=t)?(0,i.by)(s.O4):("string"==typeof n&&(n=Object.assign(Object.assign({},(0,i.by)(s.CA)),{message:n})),void 0!==r&&(n.data=r),(0,i.i5)(n.code)&&(n=(0,i.L2)(n.code)),n)}}},5276:function(e,t,r){"use strict";r.d(t,{IJsonRpcProvider:function(){return o.x0},formatJsonRpcError:function(){return n.RI},formatJsonRpcRequest:function(){return n.sT},formatJsonRpcResult:function(){return n.tm},getBigIntRpcId:function(){return n.CS},isHttpUrl:function(){return a.jK},isJsonRpcError:function(){return c.jg},isJsonRpcRequest:function(){return c.DW},isJsonRpcResponse:function(){return c.u},isJsonRpcResult:function(){return c.k4},isLocalhostUrl:function(){return a.JF},isWsUrl:function(){return a.UZ},parseConnectionError:function(){return i.CX},payloadId:function(){return n.o0}}),r(44265);var i=r(28418),s=r(23497);r.o(s,"IJsonRpcProvider")&&r.d(t,{IJsonRpcProvider:function(){return s.IJsonRpcProvider}}),r.o(s,"formatJsonRpcError")&&r.d(t,{formatJsonRpcError:function(){return s.formatJsonRpcError}}),r.o(s,"formatJsonRpcRequest")&&r.d(t,{formatJsonRpcRequest:function(){return s.formatJsonRpcRequest}}),r.o(s,"formatJsonRpcResult")&&r.d(t,{formatJsonRpcResult:function(){return s.formatJsonRpcResult}}),r.o(s,"getBigIntRpcId")&&r.d(t,{getBigIntRpcId:function(){return s.getBigIntRpcId}}),r.o(s,"isHttpUrl")&&r.d(t,{isHttpUrl:function(){return s.isHttpUrl}}),r.o(s,"isJsonRpcError")&&r.d(t,{isJsonRpcError:function(){return s.isJsonRpcError}}),r.o(s,"isJsonRpcRequest")&&r.d(t,{isJsonRpcRequest:function(){return s.isJsonRpcRequest}}),r.o(s,"isJsonRpcResponse")&&r.d(t,{isJsonRpcResponse:function(){return s.isJsonRpcResponse}}),r.o(s,"isJsonRpcResult")&&r.d(t,{isJsonRpcResult:function(){return s.isJsonRpcResult}}),r.o(s,"isLocalhostUrl")&&r.d(t,{isLocalhostUrl:function(){return s.isLocalhostUrl}}),r.o(s,"isReactNative")&&r.d(t,{isReactNative:function(){return s.isReactNative}}),r.o(s,"isWsUrl")&&r.d(t,{isWsUrl:function(){return s.isWsUrl}}),r.o(s,"payloadId")&&r.d(t,{payloadId:function(){return s.payloadId}});var n=r(74947),o=r(75826),a=r(20276),c=r(65505)},75826:function(e,t,r){"use strict";r.d(t,{x0:function(){return n}});class i{}class s extends i{constructor(){super()}}class n extends s{constructor(e){super()}}},20276:function(e,t,r){"use strict";function i(e,t){let r=function(e){let t=e.match(RegExp(/^\w+:/,"gi"));if(t&&t.length)return t[0]}(e);return void 0!==r&&new RegExp(t).test(r)}function s(e){return i(e,"^https?:")}function n(e){return i(e,"^wss?:")}function o(e){return RegExp("wss?://localhost(:d{2,5})?").test(e)}r.d(t,{JF:function(){return o},UZ:function(){return n},jK:function(){return s}})},65505:function(e,t,r){"use strict";function i(e){return"object"==typeof e&&"id"in e&&"jsonrpc"in e&&"2.0"===e.jsonrpc}function s(e){return i(e)&&"method"in e}function n(e){return i(e)&&(o(e)||a(e))}function o(e){return"result"in e}function a(e){return"error"in e}r.d(t,{DW:function(){return s},jg:function(){return a},k4:function(){return o},u:function(){return n}})},16854:function(e){"use strict";e.exports=function(){throw Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},15133:function(e,t,r){"use strict";r.d(t,{Ep:function(){return C},Fd:function(){return _},Rt:function(){return S},gw:function(){return s.a},jI:function(){return I}});var i=r(97435),s=r.n(i),n=r(80577);let o={level:"info"},a="custom_context";class c{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}}class l{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){let t=new c(e);if(t.size>this.maxSizeInBytes)throw Error(`[LinkedList] Value too big to insert into list: ${e} with size ${t.size}`);for(;this.size+t.size>this.maxSizeInBytes;)this.shift();this.head?this.tail&&(this.tail.next=t):this.head=t,this.tail=t,this.lengthInNodes++,this.sizeInBytes+=t.size}shift(){if(!this.head)return;let e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){let e=[],t=this.head;for(;null!==t;)e.push(t.value),t=t.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};let t=e.value;return e=e.next,{done:!1,value:t}}}}}class h{constructor(e,t=1024e3){this.level=e??"error",this.levelValue=i.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=t,this.logs=new l(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,t){t===i.levels.values.error?console.error(e):t===i.levels.values.warn?console.warn(e):t===i.levels.values.debug?console.debug(e):t===i.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append((0,n.u)({timestamp:new Date().toISOString(),log:e}));let t="string"==typeof e?JSON.parse(e).level:e.level;t>=this.levelValue&&this.forwardToConsole(e,t)}getLogs(){return this.logs}clearLogs(){this.logs=new l(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){let t=this.getLogArray();return t.push((0,n.u)({extraMetadata:e})),new Blob(t,{type:"application/json"})}}class u{constructor(e,t=1024e3){this.baseChunkLogger=new h(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){let t=URL.createObjectURL(this.logsToBlob(e)),r=document.createElement("a");r.href=t,r.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(t)}}class d{constructor(e,t=1024e3){this.baseChunkLogger=new h(e,t)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}}var p=Object.defineProperty,f=Object.defineProperties,g=Object.getOwnPropertyDescriptors,m=Object.getOwnPropertySymbols,y=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,w=(e,t,r)=>t in e?p(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v=(e,t)=>{for(var r in t||(t={}))y.call(t,r)&&w(e,r,t[r]);if(m)for(var r of m(t))b.call(t,r)&&w(e,r,t[r]);return e},E=(e,t)=>f(e,g(t));function I(e){return E(v({},e),{level:e?.level||o.level})}function _(e,t=a){return typeof e.bindings>"u"?function(e,t=a){return e[t]||""}(e,t):e.bindings().context||""}function C(e,t,r=a){let i=function(e,t,r=a){let i=_(e,r);return i.trim()?`${i}/${t}`:t}(e,t,r);return function(e,t,r=a){return e[r]=t,e}(e.child({context:i}),i,r)}function S(e){return"u">typeof e.loggerOverride&&"string"!=typeof e.loggerOverride?{logger:e.loggerOverride,chunkLoggerController:null}:"u">typeof window?function(e){var t,r;let i=new u(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:s()(E(v({},e.opts),{level:"trace",browser:E(v({},null==(r=e.opts)?void 0:r.browser),{write:e=>i.write(e)})})),chunkLoggerController:i}}(e):function(e){var t;let r=new d(null==(t=e.opts)?void 0:t.level,e.maxSizeInBytes);return{logger:s()(E(v({},e.opts),{level:"trace"}),r),chunkLoggerController:r}}(e)}},80577:function(e,t,r){"use strict";r.d(t,{D:function(){return n},u:function(){return o}});let i=e=>JSON.stringify(e,(e,t)=>"bigint"==typeof t?t.toString()+"n":t),s=e=>JSON.parse(e.replace(/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,'$1"$2n"$3'),(e,t)=>"string"==typeof t&&t.match(/^\d+n$/)?BigInt(t.substring(0,t.length-1)):t);function n(e){if("string"!=typeof e)throw Error(`Cannot safe json parse value of type ${typeof e}`);try{return s(e)}catch(t){return e}}function o(e){return"string"==typeof e?e:i(e)||""}},70213:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(62494);i.__exportStar(r(12658),t),i.__exportStar(r(75127),t)},12658:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_THOUSAND=t.ONE_HUNDRED=void 0,t.ONE_HUNDRED=100,t.ONE_THOUSAND=1e3},75127:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=5*t.ONE_MINUTE,t.TEN_MINUTES=10*t.ONE_MINUTE,t.THIRTY_MINUTES=30*t.ONE_MINUTE,t.SIXTY_MINUTES=60*t.ONE_MINUTE,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=3*t.ONE_HOUR,t.SIX_HOURS=6*t.ONE_HOUR,t.TWELVE_HOURS=12*t.ONE_HOUR,t.TWENTY_FOUR_HOURS=24*t.ONE_HOUR,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=3*t.ONE_DAY,t.FIVE_DAYS=5*t.ONE_DAY,t.SEVEN_DAYS=7*t.ONE_DAY,t.THIRTY_DAYS=30*t.ONE_DAY,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=2*t.ONE_WEEK,t.THREE_WEEKS=3*t.ONE_WEEK,t.FOUR_WEEKS=4*t.ONE_WEEK,t.ONE_YEAR=365*t.ONE_DAY},40537:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(62494);i.__exportStar(r(78627),t),i.__exportStar(r(59854),t),i.__exportStar(r(3205),t),i.__exportStar(r(70213),t)},3205:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),r(62494).__exportStar(r(71146),t)},71146:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IWatch=void 0;class r{}t.IWatch=r},68353:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fromMiliseconds=t.toMiliseconds=void 0;let i=r(70213);t.toMiliseconds=function(e){return e*i.ONE_THOUSAND},t.fromMiliseconds=function(e){return Math.floor(e/i.ONE_THOUSAND)}},86029:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delay=void 0,t.delay=function(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}},78627:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});let i=r(62494);i.__exportStar(r(86029),t),i.__exportStar(r(68353),t)},59854:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Watch=void 0;class r{constructor(){this.timestamps=new Map}start(e){if(this.timestamps.has(e))throw Error(`Watch already started for label: ${e}`);this.timestamps.set(e,{started:Date.now()})}stop(e){let t=this.get(e);if(void 0!==t.elapsed)throw Error(`Watch already stopped for label: ${e}`);let r=Date.now()-t.started;this.timestamps.set(e,{started:t.started,elapsed:r})}get(e){let t=this.timestamps.get(e);if(void 0===t)throw Error(`No timestamp found for label: ${e}`);return t}elapsed(e){let t=this.get(e);return t.elapsed||Date.now()-t.started}}t.Watch=r,t.default=r},62494:function(e,t,r){"use strict";r.r(t),r.d(t,{__assign:function(){return n},__asyncDelegator:function(){return v},__asyncGenerator:function(){return w},__asyncValues:function(){return E},__await:function(){return b},__awaiter:function(){return h},__classPrivateFieldGet:function(){return S},__classPrivateFieldSet:function(){return N},__createBinding:function(){return d},__decorate:function(){return a},__exportStar:function(){return p},__extends:function(){return s},__generator:function(){return u},__importDefault:function(){return C},__importStar:function(){return _},__makeTemplateObject:function(){return I},__metadata:function(){return l},__param:function(){return c},__read:function(){return g},__rest:function(){return o},__spread:function(){return m},__spreadArrays:function(){return y},__values:function(){return f}});var i=function(e,t){return(i=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function s(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var n=function(){return(n=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var s in t=arguments[r])Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&0>t.indexOf(i)&&(r[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var s=0,i=Object.getOwnPropertySymbols(e);s<i.length;s++)0>t.indexOf(i[s])&&Object.prototype.propertyIsEnumerable.call(e,i[s])&&(r[i[s]]=e[i[s]]);return r}function a(e,t,r,i){var s,n=arguments.length,o=n<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,i);else for(var a=e.length-1;a>=0;a--)(s=e[a])&&(o=(n<3?s(o):n>3?s(t,r,o):s(t,r))||o);return n>3&&o&&Object.defineProperty(t,r,o),o}function c(e,t){return function(r,i){t(r,i,e)}}function l(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function h(e,t,r,i){return new(r||(r=Promise))(function(s,n){function o(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function u(e,t){var r,i,s,n,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return n={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(n[Symbol.iterator]=function(){return this}),n;function a(n){return function(a){return function(n){if(r)throw TypeError("Generator is already executing.");for(;o;)try{if(r=1,i&&(s=2&n[0]?i.return:n[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,n[1])).done)return s;switch(i=0,s&&(n=[2&n[0],s.value]),n[0]){case 0:case 1:s=n;break;case 4:return o.label++,{value:n[1],done:!1};case 5:o.label++,i=n[1],n=[0];continue;case 7:n=o.ops.pop(),o.trys.pop();continue;default:if(!(s=(s=o.trys).length>0&&s[s.length-1])&&(6===n[0]||2===n[0])){o=0;continue}if(3===n[0]&&(!s||n[1]>s[0]&&n[1]<s[3])){o.label=n[1];break}if(6===n[0]&&o.label<s[1]){o.label=s[1],s=n;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(n);break}s[2]&&o.ops.pop(),o.trys.pop();continue}n=t.call(e,o)}catch(e){n=[6,e],i=0}finally{r=s=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}}function d(e,t,r,i){void 0===i&&(i=r),e[i]=t[r]}function p(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function f(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],i=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,s,n=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(i=n.next()).done;)o.push(i.value)}catch(e){s={error:e}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return o}function m(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(g(arguments[t]));return e}function y(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var i=Array(e),s=0,t=0;t<r;t++)for(var n=arguments[t],o=0,a=n.length;o<a;o++,s++)i[s]=n[o];return i}function b(e){return this instanceof b?(this.v=e,this):new b(e)}function w(e,t,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,s=r.apply(e,t||[]),n=[];return i={},o("next"),o("throw"),o("return"),i[Symbol.asyncIterator]=function(){return this},i;function o(e){s[e]&&(i[e]=function(t){return new Promise(function(r,i){n.push([e,t,r,i])>1||a(e,t)})})}function a(e,t){try{var r;(r=s[e](t)).value instanceof b?Promise.resolve(r.value.v).then(c,l):h(n[0][2],r)}catch(e){h(n[0][3],e)}}function c(e){a("next",e)}function l(e){a("throw",e)}function h(e,t){e(t),n.shift(),n.length&&a(n[0][0],n[0][1])}}function v(e){var t,r;return t={},i("next"),i("throw",function(e){throw e}),i("return"),t[Symbol.iterator]=function(){return this},t;function i(i,s){t[i]=e[i]?function(t){return(r=!r)?{value:b(e[i](t)),done:"return"===i}:s?s(t):t}:s}}function E(e){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=f(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=e[r]&&function(t){return new Promise(function(i,s){!function(e,t,r,i){Promise.resolve(i).then(function(t){e({value:t,done:r})},t)}(i,s,(t=e[r](t)).done,t.value)})}}}function I(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function _(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function C(e){return e&&e.__esModule?e:{default:e}}function S(e,t){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}function N(e,t,r){if(!t.has(e))throw TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},76454:function(e,t){"use strict";function r(e){let t;return"undefined"!=typeof window&&void 0!==window[e]&&(t=window[e]),t}function i(e){let t=r(e);if(!t)throw Error(`${e} is not defined in Window`);return t}Object.defineProperty(t,"__esModule",{value:!0}),t.getLocalStorage=t.getLocalStorageOrThrow=t.getCrypto=t.getCryptoOrThrow=t.getLocation=t.getLocationOrThrow=t.getNavigator=t.getNavigatorOrThrow=t.getDocument=t.getDocumentOrThrow=t.getFromWindowOrThrow=t.getFromWindow=void 0,t.getFromWindow=r,t.getFromWindowOrThrow=i,t.getDocumentOrThrow=function(){return i("document")},t.getDocument=function(){return r("document")},t.getNavigatorOrThrow=function(){return i("navigator")},t.getNavigator=function(){return r("navigator")},t.getLocationOrThrow=function(){return i("location")},t.getLocation=function(){return r("location")},t.getCryptoOrThrow=function(){return i("crypto")},t.getCrypto=function(){return r("crypto")},t.getLocalStorageOrThrow=function(){return i("localStorage")},t.getLocalStorage=function(){return r("localStorage")}},3897:function(e,t,r){"use strict";t.D=void 0;let i=r(76454);t.D=function(){let e,t,r;try{e=i.getDocumentOrThrow(),t=i.getLocationOrThrow()}catch(e){return null}function s(...t){let r=e.getElementsByTagName("meta");for(let e=0;e<r.length;e++){let i=r[e],s=["itemprop","property","name"].map(e=>i.getAttribute(e)).filter(e=>!!e&&t.includes(e));if(s.length&&s){let e=i.getAttribute("content");if(e)return e}}return""}let n=((r=s("name","og:site_name","og:title","twitter:title"))||(r=e.title),r),o=s("description","og:description","twitter:description","keywords");return{description:o,url:t.origin,icons:function(){let r=e.getElementsByTagName("link"),i=[];for(let e=0;e<r.length;e++){let s=r[e],n=s.getAttribute("rel");if(n&&n.toLowerCase().indexOf("icon")>-1){let e=s.getAttribute("href");if(e){if(-1===e.toLowerCase().indexOf("https:")&&-1===e.toLowerCase().indexOf("http:")&&0!==e.indexOf("//")){let r=t.protocol+"//"+t.host;if(0===e.indexOf("/"))r+=e;else{let i=t.pathname.split("/");i.pop(),r+=i.join("/")+"/"+e}i.push(r)}else if(0===e.indexOf("//")){let r=t.protocol+e;i.push(r)}else i.push(e)}}}return i}(),name:n}}},18282:function(e){"use strict";e.exports=function(e){if(e.length>=255)throw TypeError("Alphabet too long");for(var t=new Uint8Array(256),r=0;r<t.length;r++)t[r]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),n=s.charCodeAt(0);if(255!==t[n])throw TypeError(s+" is ambiguous");t[n]=i}var o=e.length,a=e.charAt(0),c=Math.log(o)/Math.log(256),l=Math.log(256)/Math.log(o);function h(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;for(var r=0,i=0,s=0;e[r]===a;)i++,r++;for(var n=(e.length-r)*c+1>>>0,l=new Uint8Array(n);e[r];){var h=e.charCodeAt(r);if(h>255)return;var u=t[h];if(255===u)return;for(var d=0,p=n-1;(0!==u||d<s)&&-1!==p;p--,d++)u+=o*l[p]>>>0,l[p]=u%256>>>0,u=u/256>>>0;if(0!==u)throw Error("Non-zero carry");s=d,r++}for(var f=n-s;f!==n&&0===l[f];)f++;for(var g=new Uint8Array(i+(n-f)),m=i;f!==n;)g[m++]=l[f++];return g}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var c=(n-s)*l+1>>>0,h=new Uint8Array(c);s!==n;){for(var u=t[s],d=0,p=c-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*h[p]>>>0,h[p]=u%o>>>0,u=u/o>>>0;if(0!==u)throw Error("Non-zero carry");i=d,s++}for(var f=c-i;f!==c&&0===h[f];)f++;for(var g=a.repeat(r);f<c;++f)g+=e.charAt(h[f]);return g},decodeUnsafe:h,decode:function(e){var t=h(e);if(t)return t;throw Error("Non-base"+o+" character")}}}},47223:function(e,t,r){var i;function s(e){this.rand=e}if(e.exports=function(e){return i||(i=new s(null)),i.generate(e)},e.exports.Rand=s,s.prototype.generate=function(e){return this._rand(e)},s.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var t=new Uint8Array(e),r=0;r<t.length;r++)t[r]=this.rand.getByte();return t},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?s.prototype._rand=function(e){var t=new Uint8Array(e);return self.crypto.getRandomValues(t),t}:self.msCrypto&&self.msCrypto.getRandomValues?s.prototype._rand=function(e){var t=new Uint8Array(e);return self.msCrypto.getRandomValues(t),t}:"object"==typeof window&&(s.prototype._rand=function(){throw Error("Not implemented yet")});else try{var n=r(89214);if("function"!=typeof n.randomBytes)throw Error("Not supported");s.prototype._rand=function(e){return n.randomBytes(e)}}catch(e){}},59147:function(e,t,r){let i=r(18282);e.exports=i("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz")},80751:function(e,t,r){var i="undefined"!=typeof globalThis&&globalThis||"undefined"!=typeof self&&self||void 0!==r.g&&r.g,s=function(){function e(){this.fetch=!1,this.DOMException=i.DOMException}return e.prototype=i,new e}();(function(e){var t=void 0!==s&&s||"undefined"!=typeof self&&self||void 0!==r.g&&r.g||{},i={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(i.arrayBuffer)var n=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],o=ArrayBuffer.isView||function(e){return e&&n.indexOf(Object.prototype.toString.call(e))>-1};function a(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(e)||""===e)throw TypeError('Invalid character in header field name: "'+e+'"');return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function l(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return i.iterable&&(t[Symbol.iterator]=function(){return t}),t}function h(e){this.map={},e instanceof h?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){if(2!=e.length)throw TypeError("Headers constructor: expected name/value pair to be length 2, found"+e.length);this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function u(e){if(!e._noBody){if(e.bodyUsed)return Promise.reject(TypeError("Already read"));e.bodyUsed=!0}}function d(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function p(e){var t=new FileReader,r=d(t);return t.readAsArrayBuffer(e),r}function f(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function g(){return this.bodyUsed=!1,this._initBody=function(e){if(this.bodyUsed=this.bodyUsed,this._bodyInit=e,e){if("string"==typeof e)this._bodyText=e;else if(i.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(i.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(i.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else{var t;i.arrayBuffer&&i.blob&&(t=e)&&DataView.prototype.isPrototypeOf(t)?(this._bodyArrayBuffer=f(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):i.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(e)||o(e))?this._bodyArrayBuffer=f(e):this._bodyText=e=Object.prototype.toString.call(e)}}else this._noBody=!0,this._bodyText="";!this.headers.get("content-type")&&("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):i.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i.blob&&(this.blob=function(){var e=u(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(!this._bodyFormData)return Promise.resolve(new Blob([this._bodyText]));throw Error("could not read FormData body as blob")}),this.arrayBuffer=function(){if(this._bodyArrayBuffer)return u(this)||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer));if(i.blob)return this.blob().then(p);throw Error("could not read as ArrayBuffer")},this.text=function(){var e,t,r,i,s,n=u(this);if(n)return n;if(this._bodyBlob)return e=this._bodyBlob,r=d(t=new FileReader),s=(i=/charset=([A-Za-z0-9_-]+)/.exec(e.type))?i[1]:"utf-8",t.readAsText(e,s),r;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),r=Array(t.length),i=0;i<t.length;i++)r[i]=String.fromCharCode(t[i]);return r.join("")}(this._bodyArrayBuffer));if(!this._bodyFormData)return Promise.resolve(this._bodyText);throw Error("could not read FormData body as text")},i.formData&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}h.prototype.append=function(e,t){e=a(e),t=c(t);var r=this.map[e];this.map[e]=r?r+", "+t:t},h.prototype.delete=function(e){delete this.map[a(e)]},h.prototype.get=function(e){return e=a(e),this.has(e)?this.map[e]:null},h.prototype.has=function(e){return this.map.hasOwnProperty(a(e))},h.prototype.set=function(e,t){this.map[a(e)]=c(t)},h.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},h.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),l(e)},h.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),l(e)},h.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),l(e)},i.iterable&&(h.prototype[Symbol.iterator]=h.prototype.entries);var m=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function y(e,r){if(!(this instanceof y))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');var i,s,n=(r=r||{}).body;if(e instanceof y){if(e.bodyUsed)throw TypeError("Already read");this.url=e.url,this.credentials=e.credentials,r.headers||(this.headers=new h(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,n||null==e._bodyInit||(n=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=r.credentials||this.credentials||"same-origin",(r.headers||!this.headers)&&(this.headers=new h(r.headers)),this.method=(s=(i=r.method||this.method||"GET").toUpperCase(),m.indexOf(s)>-1?s:i),this.mode=r.mode||this.mode||null,this.signal=r.signal||this.signal||function(){if("AbortController"in t)return new AbortController().signal}(),this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(n),("GET"===this.method||"HEAD"===this.method)&&("no-store"===r.cache||"no-cache"===r.cache)){var o=/([?&])_=[^&]*/;o.test(this.url)?this.url=this.url.replace(o,"$1_="+new Date().getTime()):this.url+=(/\?/.test(this.url)?"&":"?")+"_="+new Date().getTime()}}function b(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),i=r.shift().replace(/\+/g," "),s=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(s))}}),t}function w(e,t){if(!(this instanceof w))throw TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.status<200||this.status>599)throw RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=void 0===t.statusText?"":""+t.statusText,this.headers=new h(t.headers),this.url=t.url||"",this._initBody(e)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},g.call(y.prototype),g.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new h(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:200,statusText:""});return e.ok=!1,e.status=0,e.type="error",e};var v=[301,302,303,307,308];w.redirect=function(e,t){if(-1===v.indexOf(t))throw RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},e.DOMException=t.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var r=Error(e);this.stack=r.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function E(r,s){return new Promise(function(n,o){var l=new y(r,s);if(l.signal&&l.signal.aborted)return o(new e.DOMException("Aborted","AbortError"));var u=new XMLHttpRequest;function d(){u.abort()}if(u.onload=function(){var e,t,r={statusText:u.statusText,headers:(e=u.getAllResponseHeaders()||"",t=new h,e.replace(/\r?\n[\t ]+/g," ").split("\r").map(function(e){return 0===e.indexOf("\n")?e.substr(1,e.length):e}).forEach(function(e){var r=e.split(":"),i=r.shift().trim();if(i){var s=r.join(":").trim();try{t.append(i,s)}catch(e){console.warn("Response "+e.message)}}}),t)};0===l.url.indexOf("file://")&&(u.status<200||u.status>599)?r.status=200:r.status=u.status,r.url="responseURL"in u?u.responseURL:r.headers.get("X-Request-URL");var i="response"in u?u.response:u.responseText;setTimeout(function(){n(new w(i,r))},0)},u.onerror=function(){setTimeout(function(){o(TypeError("Network request failed"))},0)},u.ontimeout=function(){setTimeout(function(){o(TypeError("Network request timed out"))},0)},u.onabort=function(){setTimeout(function(){o(new e.DOMException("Aborted","AbortError"))},0)},u.open(l.method,function(e){try{return""===e&&t.location.href?t.location.href:e}catch(t){return e}}(l.url),!0),"include"===l.credentials?u.withCredentials=!0:"omit"===l.credentials&&(u.withCredentials=!1),"responseType"in u&&(i.blob?u.responseType="blob":i.arrayBuffer&&(u.responseType="arraybuffer")),s&&"object"==typeof s.headers&&!(s.headers instanceof h||t.Headers&&s.headers instanceof t.Headers)){var p=[];Object.getOwnPropertyNames(s.headers).forEach(function(e){p.push(a(e)),u.setRequestHeader(e,c(s.headers[e]))}),l.headers.forEach(function(e,t){-1===p.indexOf(t)&&u.setRequestHeader(t,e)})}else l.headers.forEach(function(e,t){u.setRequestHeader(t,e)});l.signal&&(l.signal.addEventListener("abort",d),u.onreadystatechange=function(){4===u.readyState&&l.signal.removeEventListener("abort",d)}),u.send(void 0===l._bodyInit?null:l._bodyInit)})}E.polyfill=!0,t.fetch||(t.fetch=E,t.Headers=h,t.Request=y,t.Response=w),e.Headers=h,e.Request=y,e.Response=w,e.fetch=E,Object.defineProperty(e,"__esModule",{value:!0})})({}),s.fetch.ponyfill=!0,delete s.fetch.polyfill;var n=i.fetch?i:s;(t=n.fetch).default=n.fetch,t.fetch=n.fetch,t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response,e.exports=t},71096:function(e){var t;t=function(){"use strict";var e="millisecond",t="second",r="minute",i="hour",s="week",n="month",o="quarter",a="year",c="date",l="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,u=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,d=function(e,t,r){var i=String(e);return!i||i.length>=t?e:""+Array(t+1-i.length).join(r)+e},p="en",f={};f[p]={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||"th")+"]"}};var g="$isDayjsObject",m=function(e){return e instanceof v||!(!e||!e[g])},y=function e(t,r,i){var s;if(!t)return p;if("string"==typeof t){var n=t.toLowerCase();f[n]&&(s=n),r&&(f[n]=r,s=n);var o=t.split("-");if(!s&&o.length>1)return e(o[0])}else{var a=t.name;f[a]=t,s=a}return!i&&s&&(p=s),s||!i&&p},b=function(e,t){if(m(e))return e.clone();var r="object"==typeof t?t:{};return r.date=e,r.args=arguments,new v(r)},w={s:d,z:function(e){var t=-e.utcOffset(),r=Math.abs(t);return(t<=0?"+":"-")+d(Math.floor(r/60),2,"0")+":"+d(r%60,2,"0")},m:function e(t,r){if(t.date()<r.date())return-e(r,t);var i=12*(r.year()-t.year())+(r.month()-t.month()),s=t.clone().add(i,n),o=r-s<0,a=t.clone().add(i+(o?-1:1),n);return+(-(i+(r-s)/(o?s-a:a-s))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(l){return({M:n,y:a,w:s,d:"day",D:c,h:i,m:r,s:t,ms:e,Q:o})[l]||String(l||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}};w.l=y,w.i=m,w.w=function(e,t){return b(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var v=function(){function d(e){this.$L=y(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[g]=!0}var p=d.prototype;return p.parse=function(e){this.$d=function(e){var t=e.date,r=e.utc;if(null===t)return new Date(NaN);if(w.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var i=t.match(h);if(i){var s=i[2]-1||0,n=(i[7]||"0").substring(0,3);return r?new Date(Date.UTC(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,n)):new Date(i[1],s,i[3]||1,i[4]||0,i[5]||0,i[6]||0,n)}}return new Date(t)}(e),this.init()},p.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},p.$utils=function(){return w},p.isValid=function(){return this.$d.toString()!==l},p.isSame=function(e,t){var r=b(e);return this.startOf(t)<=r&&r<=this.endOf(t)},p.isAfter=function(e,t){return b(e)<this.startOf(t)},p.isBefore=function(e,t){return this.endOf(t)<b(e)},p.$g=function(e,t,r){return w.u(e)?this[t]:this.set(r,e)},p.unix=function(){return Math.floor(this.valueOf()/1e3)},p.valueOf=function(){return this.$d.getTime()},p.startOf=function(e,o){var l=this,h=!!w.u(o)||o,u=w.p(e),d=function(e,t){var r=w.w(l.$u?Date.UTC(l.$y,t,e):new Date(l.$y,t,e),l);return h?r:r.endOf("day")},p=function(e,t){return w.w(l.toDate()[e].apply(l.toDate("s"),(h?[0,0,0,0]:[23,59,59,999]).slice(t)),l)},f=this.$W,g=this.$M,m=this.$D,y="set"+(this.$u?"UTC":"");switch(u){case a:return h?d(1,0):d(31,11);case n:return h?d(1,g):d(0,g+1);case s:var b=this.$locale().weekStart||0,v=(f<b?f+7:f)-b;return d(h?m-v:m+(6-v),g);case"day":case c:return p(y+"Hours",0);case i:return p(y+"Minutes",1);case r:return p(y+"Seconds",2);case t:return p(y+"Milliseconds",3);default:return this.clone()}},p.endOf=function(e){return this.startOf(e,!1)},p.$set=function(s,o){var l,h=w.p(s),u="set"+(this.$u?"UTC":""),d=((l={}).day=u+"Date",l[c]=u+"Date",l[n]=u+"Month",l[a]=u+"FullYear",l[i]=u+"Hours",l[r]=u+"Minutes",l[t]=u+"Seconds",l[e]=u+"Milliseconds",l)[h],p="day"===h?this.$D+(o-this.$W):o;if(h===n||h===a){var f=this.clone().set(c,1);f.$d[d](p),f.init(),this.$d=f.set(c,Math.min(this.$D,f.daysInMonth())).$d}else d&&this.$d[d](p);return this.init(),this},p.set=function(e,t){return this.clone().$set(e,t)},p.get=function(e){return this[w.p(e)]()},p.add=function(e,o){var c,l=this;e=Number(e);var h=w.p(o),u=function(t){var r=b(l);return w.w(r.date(r.date()+Math.round(t*e)),l)};if(h===n)return this.set(n,this.$M+e);if(h===a)return this.set(a,this.$y+e);if("day"===h)return u(1);if(h===s)return u(7);var d=((c={})[r]=6e4,c[i]=36e5,c[t]=1e3,c)[h]||1,p=this.$d.getTime()+e*d;return w.w(p,this)},p.subtract=function(e,t){return this.add(-1*e,t)},p.format=function(e){var t=this,r=this.$locale();if(!this.isValid())return r.invalidDate||l;var i=e||"YYYY-MM-DDTHH:mm:ssZ",s=w.z(this),n=this.$H,o=this.$m,a=this.$M,c=r.weekdays,h=r.months,d=r.meridiem,p=function(e,r,s,n){return e&&(e[r]||e(t,i))||s[r].slice(0,n)},f=function(e){return w.s(n%12||12,e,"0")},g=d||function(e,t,r){var i=e<12?"AM":"PM";return r?i.toLowerCase():i};return i.replace(u,function(e,i){return i||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return w.s(t.$y,4,"0");case"M":return a+1;case"MM":return w.s(a+1,2,"0");case"MMM":return p(r.monthsShort,a,h,3);case"MMMM":return p(h,a);case"D":return t.$D;case"DD":return w.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return p(r.weekdaysMin,t.$W,c,2);case"ddd":return p(r.weekdaysShort,t.$W,c,3);case"dddd":return c[t.$W];case"H":return String(n);case"HH":return w.s(n,2,"0");case"h":return f(1);case"hh":return f(2);case"a":return g(n,o,!0);case"A":return g(n,o,!1);case"m":return String(o);case"mm":return w.s(o,2,"0");case"s":return String(t.$s);case"ss":return w.s(t.$s,2,"0");case"SSS":return w.s(t.$ms,3,"0");case"Z":return s}return null}(e)||s.replace(":","")})},p.utcOffset=function(){return-(15*Math.round(this.$d.getTimezoneOffset()/15))},p.diff=function(e,c,l){var h,u=this,d=w.p(c),p=b(e),f=(p.utcOffset()-this.utcOffset())*6e4,g=this-p,m=function(){return w.m(u,p)};switch(d){case a:h=m()/12;break;case n:h=m();break;case o:h=m()/3;break;case s:h=(g-f)/6048e5;break;case"day":h=(g-f)/864e5;break;case i:h=g/36e5;break;case r:h=g/6e4;break;case t:h=g/1e3;break;default:h=g}return l?h:w.a(h)},p.daysInMonth=function(){return this.endOf(n).$D},p.$locale=function(){return f[this.$L]},p.locale=function(e,t){if(!e)return this.$L;var r=this.clone(),i=y(e,t,!0);return i&&(r.$L=i),r},p.clone=function(){return w.w(this.$d,this)},p.toDate=function(){return new Date(this.valueOf())},p.toJSON=function(){return this.isValid()?this.toISOString():null},p.toISOString=function(){return this.$d.toISOString()},p.toString=function(){return this.$d.toUTCString()},d}(),E=v.prototype;return b.prototype=E,[["$ms",e],["$s",t],["$m",r],["$H",i],["$W","day"],["$M",n],["$y",a],["$D",c]].forEach(function(e){E[e[1]]=function(t){return this.$g(t,e[0],e[1])}}),b.extend=function(e,t){return e.$i||(e(t,v,b),e.$i=!0),b},b.locale=y,b.isDayjs=m,b.unix=function(e){return b(1e3*e)},b.en=f[p],b.Ls=f,b.p={},b},e.exports=t()},70939:function(e){var t;t=function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],r=e%100;return"["+e+(t[(r-20)%10]||t[r]||"th")+"]"}}},e.exports=t()},45721:function(e){var t;t=function(){return function(e,t,r){e=e||{};var i=t.prototype,s={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function n(e,t,r,s){return i.fromToBase(e,t,r,s)}r.en.relativeTime=s,i.fromToBase=function(t,i,n,o,a){for(var c,l,h,u=n.$locale().relativeTime||s,d=e.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],p=d.length,f=0;f<p;f+=1){var g=d[f];g.d&&(c=o?r(t).diff(n,g.d,!0):n.diff(t,g.d,!0));var m=(e.rounding||Math.round)(Math.abs(c));if(h=c>0,m<=g.r||!g.r){m<=1&&f>0&&(g=d[f-1]);var y=u[g.l];a&&(m=a(""+m)),l="string"==typeof y?y.replace("%d",m):y(m,i,g.l,h);break}}if(i)return l;var b=h?u.future:u.past;return"function"==typeof b?b(l):b.replace("%s",l)},i.to=function(e,t){return n(e,t,this,!0)},i.from=function(e,t){return n(e,t,this)};var o=function(e){return e.$u?r.utc():r()};i.toNow=function(e){return this.to(o(this),e)},i.fromNow=function(e){return this.from(o(this),e)}}},e.exports=t()},96961:function(e){var t;t=function(){return function(e,t,r){r.updateLocale=function(e,t){var i=r.Ls[e];if(i)return(t?Object.keys(t):[]).forEach(function(e){i[e]=t[e]}),i}}},e.exports=t()},46946:function(e){"use strict";var t={single_source_shortest_paths:function(e,r,i){var s,n,o,a,c,l,h,u={},d={};d[r]=0;var p=t.PriorityQueue.make();for(p.push(r,0);!p.empty();)for(o in n=(s=p.pop()).value,a=s.cost,c=e[n]||{})c.hasOwnProperty(o)&&(l=a+c[o],h=d[o],(void 0===d[o]||h>l)&&(d[o]=l,p.push(o,l),u[o]=n));if(void 0!==i&&void 0===d[i])throw Error(["Could not find a path from ",r," to ",i,"."].join(""));return u},extract_shortest_path_from_predecessor_list:function(e,t){for(var r=[],i=t;i;)r.push(i),e[i],i=e[i];return r.reverse(),r},find_path:function(e,r,i){var s=t.single_source_shortest_paths(e,r,i);return t.extract_shortest_path_from_predecessor_list(s,i)},PriorityQueue:{make:function(e){var r,i=t.PriorityQueue,s={};for(r in e=e||{},i)i.hasOwnProperty(r)&&(s[r]=i[r]);return s.queue=[],s.sorter=e.sorter||i.default_sorter,s},default_sorter:function(e,t){return e.cost-t.cost},push:function(e,t){this.queue.push({value:e,cost:t}),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return 0===this.queue.length}}};e.exports=t},61984:function(e,t,r){"use strict";t.version=r(58274).i8,t.utils=r(36321),t.rand=r(47223),t.curve=r(64358),t.curves=r(83475),t.ec=r(90063),t.eddsa=r(37115)},21398:function(e,t,r){"use strict";var i=r(21803),s=r(36321),n=s.getNAF,o=s.getJSF,a=s.assert;function c(e,t){this.type=e,this.p=new i(t.p,16),this.red=t.prime?i.red(t.prime):i.mont(this.p),this.zero=new i(0).toRed(this.red),this.one=new i(1).toRed(this.red),this.two=new i(2).toRed(this.red),this.n=t.n&&new i(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=[,,,,],this._wnafT2=[,,,,],this._wnafT3=[,,,,],this._wnafT4=[,,,,],this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function l(e,t){this.curve=e,this.type=t,this.precomputed=null}e.exports=c,c.prototype.point=function(){throw Error("Not implemented")},c.prototype.validate=function(){throw Error("Not implemented")},c.prototype._fixedNafMul=function(e,t){a(e.precomputed);var r,i,s=e._getDoubles(),o=n(t,1,this._bitLength),c=(1<<s.step+1)-(s.step%2==0?2:1);c/=3;var l=[];for(r=0;r<o.length;r+=s.step){i=0;for(var h=r+s.step-1;h>=r;h--)i=(i<<1)+o[h];l.push(i)}for(var u=this.jpoint(null,null,null),d=this.jpoint(null,null,null),p=c;p>0;p--){for(r=0;r<l.length;r++)(i=l[r])===p?d=d.mixedAdd(s.points[r]):i===-p&&(d=d.mixedAdd(s.points[r].neg()));u=u.add(d)}return u.toP()},c.prototype._wnafMul=function(e,t){var r=4,i=e._getNAFPoints(r);r=i.wnd;for(var s=i.points,o=n(t,r,this._bitLength),c=this.jpoint(null,null,null),l=o.length-1;l>=0;l--){for(var h=0;l>=0&&0===o[l];l--)h++;if(l>=0&&h++,c=c.dblp(h),l<0)break;var u=o[l];a(0!==u),c="affine"===e.type?u>0?c.mixedAdd(s[u-1>>1]):c.mixedAdd(s[-u-1>>1].neg()):u>0?c.add(s[u-1>>1]):c.add(s[-u-1>>1].neg())}return"affine"===e.type?c.toP():c},c.prototype._wnafMulAdd=function(e,t,r,i,s){var a,c,l,h=this._wnafT1,u=this._wnafT2,d=this._wnafT3,p=0;for(a=0;a<i;a++){var f=(l=t[a])._getNAFPoints(e);h[a]=f.wnd,u[a]=f.points}for(a=i-1;a>=1;a-=2){var g=a-1,m=a;if(1!==h[g]||1!==h[m]){d[g]=n(r[g],h[g],this._bitLength),d[m]=n(r[m],h[m],this._bitLength),p=Math.max(d[g].length,p),p=Math.max(d[m].length,p);continue}var y=[t[g],null,null,t[m]];0===t[g].y.cmp(t[m].y)?(y[1]=t[g].add(t[m]),y[2]=t[g].toJ().mixedAdd(t[m].neg())):0===t[g].y.cmp(t[m].y.redNeg())?(y[1]=t[g].toJ().mixedAdd(t[m]),y[2]=t[g].add(t[m].neg())):(y[1]=t[g].toJ().mixedAdd(t[m]),y[2]=t[g].toJ().mixedAdd(t[m].neg()));var b=[-3,-1,-5,-7,0,7,5,1,3],w=o(r[g],r[m]);for(c=0,p=Math.max(w[0].length,p),d[g]=Array(p),d[m]=Array(p);c<p;c++){var v=0|w[0][c],E=0|w[1][c];d[g][c]=b[(v+1)*3+(E+1)],d[m][c]=0,u[g]=y}}var I=this.jpoint(null,null,null),_=this._wnafT4;for(a=p;a>=0;a--){for(var C=0;a>=0;){var S=!0;for(c=0;c<i;c++)_[c]=0|d[c][a],0!==_[c]&&(S=!1);if(!S)break;C++,a--}if(a>=0&&C++,I=I.dblp(C),a<0)break;for(c=0;c<i;c++){var N=_[c];0!==N&&(N>0?l=u[c][N-1>>1]:N<0&&(l=u[c][-N-1>>1].neg()),I="affine"===l.type?I.mixedAdd(l):I.add(l))}}for(a=0;a<i;a++)u[a]=null;return s?I:I.toP()},c.BasePoint=l,l.prototype.eq=function(){throw Error("Not implemented")},l.prototype.validate=function(){return this.curve.validate(this)},c.prototype.decodePoint=function(e,t){e=s.toArray(e,t);var r=this.p.byteLength();if((4===e[0]||6===e[0]||7===e[0])&&e.length-1==2*r)return 6===e[0]?a(e[e.length-1]%2==0):7===e[0]&&a(e[e.length-1]%2==1),this.point(e.slice(1,1+r),e.slice(1+r,1+2*r));if((2===e[0]||3===e[0])&&e.length-1===r)return this.pointFromX(e.slice(1,1+r),3===e[0]);throw Error("Unknown point format")},l.prototype.encodeCompressed=function(e){return this.encode(e,!0)},l.prototype._encode=function(e){var t=this.curve.p.byteLength(),r=this.getX().toArray("be",t);return e?[this.getY().isEven()?2:3].concat(r):[4].concat(r,this.getY().toArray("be",t))},l.prototype.encode=function(e,t){return s.encode(this._encode(t),e)},l.prototype.precompute=function(e){if(this.precomputed)return this;var t={doubles:null,naf:null,beta:null};return t.naf=this._getNAFPoints(8),t.doubles=this._getDoubles(4,e),t.beta=this._getBeta(),this.precomputed=t,this},l.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var t=this.precomputed.doubles;return!!t&&t.points.length>=Math.ceil((e.bitLength()+1)/t.step)},l.prototype._getDoubles=function(e,t){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var r=[this],i=this,s=0;s<t;s+=e){for(var n=0;n<e;n++)i=i.dbl();r.push(i)}return{step:e,points:r}},l.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var t=[this],r=(1<<e)-1,i=1===r?null:this.dbl(),s=1;s<r;s++)t[s]=t[s-1].add(i);return{wnd:e,points:t}},l.prototype._getBeta=function(){return null},l.prototype.dblp=function(e){for(var t=this,r=0;r<e;r++)t=t.dbl();return t}},98343:function(e,t,r){"use strict";var i=r(36321),s=r(21803),n=r(56853),o=r(21398),a=i.assert;function c(e){this.twisted=(0|e.a)!=1,this.mOneA=this.twisted&&(0|e.a)==-1,this.extended=this.mOneA,o.call(this,"edwards",e),this.a=new s(e.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new s(e.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new s(e.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),a(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=(0|e.c)==1}function l(e,t,r,i,n){o.BasePoint.call(this,e,"projective"),null===t&&null===r&&null===i?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new s(t,16),this.y=new s(r,16),this.z=i?new s(i,16):this.curve.one,this.t=n&&new s(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,!this.curve.extended||this.t||(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}n(c,o),e.exports=c,c.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)},c.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)},c.prototype.jpoint=function(e,t,r,i){return this.point(e,t,r,i)},c.prototype.pointFromX=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),i=this.c2.redSub(this.a.redMul(r)),n=this.one.redSub(this.c2.redMul(this.d).redMul(r)),o=i.redMul(n.redInvm()),a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw Error("invalid point");var c=a.fromRed().isOdd();return(t&&!c||!t&&c)&&(a=a.redNeg()),this.point(e,a)},c.prototype.pointFromY=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr(),i=r.redSub(this.c2),n=r.redMul(this.d).redMul(this.c2).redSub(this.a),o=i.redMul(n.redInvm());if(0===o.cmp(this.zero)){if(!t)return this.point(this.zero,e);throw Error("invalid point")}var a=o.redSqrt();if(0!==a.redSqr().redSub(o).cmp(this.zero))throw Error("invalid point");return a.fromRed().isOdd()!==t&&(a=a.redNeg()),this.point(a,e)},c.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var t=e.x.redSqr(),r=e.y.redSqr(),i=t.redMul(this.a).redAdd(r),s=this.c2.redMul(this.one.redAdd(this.d.redMul(t).redMul(r)));return 0===i.cmp(s)},n(l,o.BasePoint),c.prototype.pointFromJSON=function(e){return l.fromJSON(this,e)},c.prototype.point=function(e,t,r,i){return new l(this,e,t,r,i)},l.fromJSON=function(e,t){return new l(e,t[0],t[1],t[2])},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&(0===this.y.cmp(this.z)||this.zOne&&0===this.y.cmp(this.curve.c))},l.prototype._extDbl=function(){var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr();r=r.redIAdd(r);var i=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(t),n=i.redAdd(t),o=n.redSub(r),a=i.redSub(t),c=s.redMul(o),l=n.redMul(a),h=s.redMul(a),u=o.redMul(n);return this.curve.point(c,l,u,h)},l.prototype._projDbl=function(){var e,t,r,i,s,n,o=this.x.redAdd(this.y).redSqr(),a=this.x.redSqr(),c=this.y.redSqr();if(this.curve.twisted){var l=(i=this.curve._mulA(a)).redAdd(c);this.zOne?(e=o.redSub(a).redSub(c).redMul(l.redSub(this.curve.two)),t=l.redMul(i.redSub(c)),r=l.redSqr().redSub(l).redSub(l)):(s=this.z.redSqr(),n=l.redSub(s).redISub(s),e=o.redSub(a).redISub(c).redMul(n),t=l.redMul(i.redSub(c)),r=l.redMul(n))}else i=a.redAdd(c),s=this.curve._mulC(this.z).redSqr(),n=i.redSub(s).redSub(s),e=this.curve._mulC(o.redISub(i)).redMul(n),t=this.curve._mulC(i).redMul(a.redISub(c)),r=i.redMul(n);return this.curve.point(e,t,r)},l.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},l.prototype._extAdd=function(e){var t=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),r=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),n=r.redSub(t),o=s.redSub(i),a=s.redAdd(i),c=r.redAdd(t),l=n.redMul(o),h=a.redMul(c),u=n.redMul(c),d=o.redMul(a);return this.curve.point(l,h,d,u)},l.prototype._projAdd=function(e){var t,r,i=this.z.redMul(e.z),s=i.redSqr(),n=this.x.redMul(e.x),o=this.y.redMul(e.y),a=this.curve.d.redMul(n).redMul(o),c=s.redSub(a),l=s.redAdd(a),h=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(o),u=i.redMul(c).redMul(h);return this.curve.twisted?(t=i.redMul(l).redMul(o.redSub(this.curve._mulA(n))),r=c.redMul(l)):(t=i.redMul(l).redMul(o.redSub(n)),r=this.curve._mulC(c).redMul(l)),this.curve.point(u,t,r)},l.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)},l.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!1)},l.prototype.jmulAdd=function(e,t,r){return this.curve._wnafMulAdd(1,[this,t],[e,r],2,!0)},l.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this},l.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},l.prototype.getX=function(){return this.normalize(),this.x.fromRed()},l.prototype.getY=function(){return this.normalize(),this.y.fromRed()},l.prototype.eq=function(e){return this===e||0===this.getX().cmp(e.getX())&&0===this.getY().cmp(e.getY())},l.prototype.eqXToP=function(e){var t=e.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(t))return!0;for(var r=e.clone(),i=this.curve.redN.redMul(this.z);;){if(r.iadd(this.curve.n),r.cmp(this.curve.p)>=0)return!1;if(t.redIAdd(i),0===this.x.cmp(t))return!0}},l.prototype.toP=l.prototype.normalize,l.prototype.mixedAdd=l.prototype.add},64358:function(e,t,r){"use strict";t.base=r(21398),t.short=r(13770),t.mont=r(75656),t.edwards=r(98343)},75656:function(e,t,r){"use strict";var i=r(21803),s=r(56853),n=r(21398),o=r(36321);function a(e){n.call(this,"mont",e),this.a=new i(e.a,16).toRed(this.red),this.b=new i(e.b,16).toRed(this.red),this.i4=new i(4).toRed(this.red).redInvm(),this.two=new i(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function c(e,t,r){n.BasePoint.call(this,e,"projective"),null===t&&null===r?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new i(t,16),this.z=new i(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}s(a,n),e.exports=a,a.prototype.validate=function(e){var t=e.normalize().x,r=t.redSqr(),i=r.redMul(t).redAdd(r.redMul(this.a)).redAdd(t);return 0===i.redSqrt().redSqr().cmp(i)},s(c,n.BasePoint),a.prototype.decodePoint=function(e,t){return this.point(o.toArray(e,t),1)},a.prototype.point=function(e,t){return new c(this,e,t)},a.prototype.pointFromJSON=function(e){return c.fromJSON(this,e)},c.prototype.precompute=function(){},c.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},c.fromJSON=function(e,t){return new c(e,t[0],t[1]||e.one)},c.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},c.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},c.prototype.dbl=function(){var e=this.x.redAdd(this.z).redSqr(),t=this.x.redSub(this.z).redSqr(),r=e.redSub(t),i=e.redMul(t),s=r.redMul(t.redAdd(this.curve.a24.redMul(r)));return this.curve.point(i,s)},c.prototype.add=function(){throw Error("Not supported on Montgomery curve")},c.prototype.diffAdd=function(e,t){var r=this.x.redAdd(this.z),i=this.x.redSub(this.z),s=e.x.redAdd(e.z),n=e.x.redSub(e.z).redMul(r),o=s.redMul(i),a=t.z.redMul(n.redAdd(o).redSqr()),c=t.x.redMul(n.redISub(o).redSqr());return this.curve.point(a,c)},c.prototype.mul=function(e){for(var t=e.clone(),r=this,i=this.curve.point(null,null),s=[];0!==t.cmpn(0);t.iushrn(1))s.push(t.andln(1));for(var n=s.length-1;n>=0;n--)0===s[n]?(r=r.diffAdd(i,this),i=i.dbl()):(i=r.diffAdd(i,this),r=r.dbl());return i},c.prototype.mulAdd=function(){throw Error("Not supported on Montgomery curve")},c.prototype.jumlAdd=function(){throw Error("Not supported on Montgomery curve")},c.prototype.eq=function(e){return 0===this.getX().cmp(e.getX())},c.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},c.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},13770:function(e,t,r){"use strict";var i=r(36321),s=r(21803),n=r(56853),o=r(21398),a=i.assert;function c(e){o.call(this,"short",e),this.a=new s(e.a,16).toRed(this.red),this.b=new s(e.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(e),this._endoWnafT1=[,,,,],this._endoWnafT2=[,,,,]}function l(e,t,r,i){o.BasePoint.call(this,e,"affine"),null===t&&null===r?(this.x=null,this.y=null,this.inf=!0):(this.x=new s(t,16),this.y=new s(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function h(e,t,r,i){o.BasePoint.call(this,e,"jacobian"),null===t&&null===r&&null===i?(this.x=this.curve.one,this.y=this.curve.one,this.z=new s(0)):(this.x=new s(t,16),this.y=new s(r,16),this.z=new s(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}n(c,o),e.exports=c,c.prototype._getEndomorphism=function(e){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){if(e.beta)t=new s(e.beta,16).toRed(this.red);else{var t,r,i,n=this._getEndoRoots(this.p);t=(t=0>n[0].cmp(n[1])?n[0]:n[1]).toRed(this.red)}if(e.lambda)r=new s(e.lambda,16);else{var o=this._getEndoRoots(this.n);0===this.g.mul(o[0]).x.cmp(this.g.x.redMul(t))?r=o[0]:(r=o[1],a(0===this.g.mul(r).x.cmp(this.g.x.redMul(t))))}return i=e.basis?e.basis.map(function(e){return{a:new s(e.a,16),b:new s(e.b,16)}}):this._getEndoBasis(r),{beta:t,lambda:r,basis:i}}},c.prototype._getEndoRoots=function(e){var t=e===this.p?this.red:s.mont(e),r=new s(2).toRed(t).redInvm(),i=r.redNeg(),n=new s(3).toRed(t).redNeg().redSqrt().redMul(r);return[i.redAdd(n).fromRed(),i.redSub(n).fromRed()]},c.prototype._getEndoBasis=function(e){for(var t,r,i,n,o,a,c,l,h,u=this.n.ushrn(Math.floor(this.n.bitLength()/2)),d=e,p=this.n.clone(),f=new s(1),g=new s(0),m=new s(0),y=new s(1),b=0;0!==d.cmpn(0);){var w=p.div(d);l=p.sub(w.mul(d)),h=m.sub(w.mul(f));var v=y.sub(w.mul(g));if(!i&&0>l.cmp(u))t=c.neg(),r=f,i=l.neg(),n=h;else if(i&&2==++b)break;c=l,p=d,d=l,m=f,f=h,y=g,g=v}o=l.neg(),a=h;var E=i.sqr().add(n.sqr());return o.sqr().add(a.sqr()).cmp(E)>=0&&(o=t,a=r),i.negative&&(i=i.neg(),n=n.neg()),o.negative&&(o=o.neg(),a=a.neg()),[{a:i,b:n},{a:o,b:a}]},c.prototype._endoSplit=function(e){var t=this.endo.basis,r=t[0],i=t[1],s=i.b.mul(e).divRound(this.n),n=r.b.neg().mul(e).divRound(this.n),o=s.mul(r.a),a=n.mul(i.a),c=s.mul(r.b),l=n.mul(i.b);return{k1:e.sub(o).sub(a),k2:c.add(l).neg()}},c.prototype.pointFromX=function(e,t){(e=new s(e,16)).red||(e=e.toRed(this.red));var r=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=r.redSqrt();if(0!==i.redSqr().redSub(r).cmp(this.zero))throw Error("invalid point");var n=i.fromRed().isOdd();return(t&&!n||!t&&n)&&(i=i.redNeg()),this.point(e,i)},c.prototype.validate=function(e){if(e.inf)return!0;var t=e.x,r=e.y,i=this.a.redMul(t),s=t.redSqr().redMul(t).redIAdd(i).redIAdd(this.b);return 0===r.redSqr().redISub(s).cmpn(0)},c.prototype._endoWnafMulAdd=function(e,t,r){for(var i=this._endoWnafT1,s=this._endoWnafT2,n=0;n<e.length;n++){var o=this._endoSplit(t[n]),a=e[n],c=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),c=c.neg(!0)),i[2*n]=a,i[2*n+1]=c,s[2*n]=o.k1,s[2*n+1]=o.k2}for(var l=this._wnafMulAdd(1,i,s,2*n,r),h=0;h<2*n;h++)i[h]=null,s[h]=null;return l},n(l,o.BasePoint),c.prototype.point=function(e,t,r){return new l(this,e,t,r)},c.prototype.pointFromJSON=function(e,t){return l.fromJSON(this,e,t)},l.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var t=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var r=this.curve,i=function(e){return r.point(e.x.redMul(r.endo.beta),e.y)};e.beta=t,t.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return t}},l.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},l.fromJSON=function(e,t,r){"string"==typeof t&&(t=JSON.parse(t));var i=e.point(t[0],t[1],r);if(!t[2])return i;function s(t){return e.point(t[0],t[1],r)}var n=t[2];return i.precomputed={beta:null,doubles:n.doubles&&{step:n.doubles.step,points:[i].concat(n.doubles.points.map(s))},naf:n.naf&&{wnd:n.naf.wnd,points:[i].concat(n.naf.points.map(s))}},i},l.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},l.prototype.isInfinity=function(){return this.inf},l.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e)||0===this.x.cmp(e.x))return this.curve.point(null,null);var t=this.y.redSub(e.y);0!==t.cmpn(0)&&(t=t.redMul(this.x.redSub(e.x).redInvm()));var r=t.redSqr().redISub(this.x).redISub(e.x),i=t.redMul(this.x.redSub(r)).redISub(this.y);return this.curve.point(r,i)},l.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(0===e.cmpn(0))return this.curve.point(null,null);var t=this.curve.a,r=this.x.redSqr(),i=e.redInvm(),s=r.redAdd(r).redIAdd(r).redIAdd(t).redMul(i),n=s.redSqr().redISub(this.x.redAdd(this.x)),o=s.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,o)},l.prototype.getX=function(){return this.x.fromRed()},l.prototype.getY=function(){return this.y.fromRed()},l.prototype.mul=function(e){return(e=new s(e,16),this.isInfinity())?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)},l.prototype.mulAdd=function(e,t,r){var i=[this,t],s=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,s):this.curve._wnafMulAdd(1,i,s,2)},l.prototype.jmulAdd=function(e,t,r){var i=[this,t],s=[e,r];return this.curve.endo?this.curve._endoWnafMulAdd(i,s,!0):this.curve._wnafMulAdd(1,i,s,2,!0)},l.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||0===this.x.cmp(e.x)&&0===this.y.cmp(e.y))},l.prototype.neg=function(e){if(this.inf)return this;var t=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var r=this.precomputed,i=function(e){return e.neg()};t.precomputed={naf:r.naf&&{wnd:r.naf.wnd,points:r.naf.points.map(i)},doubles:r.doubles&&{step:r.doubles.step,points:r.doubles.points.map(i)}}}return t},l.prototype.toJ=function(){return this.inf?this.curve.jpoint(null,null,null):this.curve.jpoint(this.x,this.y,this.curve.one)},n(h,o.BasePoint),c.prototype.jpoint=function(e,t,r){return new h(this,e,t,r)},h.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),t=e.redSqr(),r=this.x.redMul(t),i=this.y.redMul(t).redMul(e);return this.curve.point(r,i)},h.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},h.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var t=e.z.redSqr(),r=this.z.redSqr(),i=this.x.redMul(t),s=e.x.redMul(r),n=this.y.redMul(t.redMul(e.z)),o=e.y.redMul(r.redMul(this.z)),a=i.redSub(s),c=n.redSub(o);if(0===a.cmpn(0))return 0!==c.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var l=a.redSqr(),h=l.redMul(a),u=i.redMul(l),d=c.redSqr().redIAdd(h).redISub(u).redISub(u),p=c.redMul(u.redISub(d)).redISub(n.redMul(h)),f=this.z.redMul(e.z).redMul(a);return this.curve.jpoint(d,p,f)},h.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var t=this.z.redSqr(),r=this.x,i=e.x.redMul(t),s=this.y,n=e.y.redMul(t).redMul(this.z),o=r.redSub(i),a=s.redSub(n);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=o.redSqr(),l=c.redMul(o),h=r.redMul(c),u=a.redSqr().redIAdd(l).redISub(h).redISub(h),d=a.redMul(h.redISub(u)).redISub(s.redMul(l)),p=this.z.redMul(o);return this.curve.jpoint(u,d,p)},h.prototype.dblp=function(e){if(0===e||this.isInfinity())return this;if(!e)return this.dbl();if(this.curve.zeroA||this.curve.threeA){var t,r=this;for(t=0;t<e;t++)r=r.dbl();return r}var i=this.curve.a,s=this.curve.tinv,n=this.x,o=this.y,a=this.z,c=a.redSqr().redSqr(),l=o.redAdd(o);for(t=0;t<e;t++){var h=n.redSqr(),u=l.redSqr(),d=u.redSqr(),p=h.redAdd(h).redIAdd(h).redIAdd(i.redMul(c)),f=n.redMul(u),g=p.redSqr().redISub(f.redAdd(f)),m=f.redISub(g),y=p.redMul(m);y=y.redIAdd(y).redISub(d);var b=l.redMul(a);t+1<e&&(c=c.redMul(d)),n=g,a=b,l=y}return this.curve.jpoint(n,l.redMul(s),a)},h.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},h.prototype._zeroDbl=function(){if(this.zOne){var e,t,r,i=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(n);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i),c=a.redSqr().redISub(o).redISub(o),l=n.redIAdd(n);l=(l=l.redIAdd(l)).redIAdd(l),e=c,t=a.redMul(o.redISub(c)).redISub(l),r=this.y.redAdd(this.y)}else{var h=this.x.redSqr(),u=this.y.redSqr(),d=u.redSqr(),p=this.x.redAdd(u).redSqr().redISub(h).redISub(d);p=p.redIAdd(p);var f=h.redAdd(h).redIAdd(h),g=f.redSqr(),m=d.redIAdd(d);m=(m=m.redIAdd(m)).redIAdd(m),e=g.redISub(p).redISub(p),t=f.redMul(p.redISub(e)).redISub(m),r=(r=this.y.redMul(this.z)).redIAdd(r)}return this.curve.jpoint(e,t,r)},h.prototype._threeDbl=function(){if(this.zOne){var e,t,r,i=this.x.redSqr(),s=this.y.redSqr(),n=s.redSqr(),o=this.x.redAdd(s).redSqr().redISub(i).redISub(n);o=o.redIAdd(o);var a=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),c=a.redSqr().redISub(o).redISub(o);e=c;var l=n.redIAdd(n);l=(l=l.redIAdd(l)).redIAdd(l),t=a.redMul(o.redISub(c)).redISub(l),r=this.y.redAdd(this.y)}else{var h=this.z.redSqr(),u=this.y.redSqr(),d=this.x.redMul(u),p=this.x.redSub(h).redMul(this.x.redAdd(h));p=p.redAdd(p).redIAdd(p);var f=d.redIAdd(d),g=(f=f.redIAdd(f)).redAdd(f);e=p.redSqr().redISub(g),r=this.y.redAdd(this.z).redSqr().redISub(u).redISub(h);var m=u.redSqr();m=(m=(m=m.redIAdd(m)).redIAdd(m)).redIAdd(m),t=p.redMul(f.redISub(e)).redISub(m)}return this.curve.jpoint(e,t,r)},h.prototype._dbl=function(){var e=this.curve.a,t=this.x,r=this.y,i=this.z,s=i.redSqr().redSqr(),n=t.redSqr(),o=r.redSqr(),a=n.redAdd(n).redIAdd(n).redIAdd(e.redMul(s)),c=t.redAdd(t),l=(c=c.redIAdd(c)).redMul(o),h=a.redSqr().redISub(l.redAdd(l)),u=l.redISub(h),d=o.redSqr();d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var p=a.redMul(u).redISub(d),f=r.redAdd(r).redMul(i);return this.curve.jpoint(h,p,f)},h.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),t=this.y.redSqr(),r=this.z.redSqr(),i=t.redSqr(),s=e.redAdd(e).redIAdd(e),n=s.redSqr(),o=this.x.redAdd(t).redSqr().redISub(e).redISub(i),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(n)).redSqr(),c=i.redIAdd(i);c=(c=(c=c.redIAdd(c)).redIAdd(c)).redIAdd(c);var l=s.redIAdd(o).redSqr().redISub(n).redISub(a).redISub(c),h=t.redMul(l);h=(h=h.redIAdd(h)).redIAdd(h);var u=this.x.redMul(a).redISub(h);u=(u=u.redIAdd(u)).redIAdd(u);var d=this.y.redMul(l.redMul(c.redISub(l)).redISub(o.redMul(a)));d=(d=(d=d.redIAdd(d)).redIAdd(d)).redIAdd(d);var p=this.z.redAdd(o).redSqr().redISub(r).redISub(a);return this.curve.jpoint(u,d,p)},h.prototype.mul=function(e,t){return e=new s(e,t),this.curve._wnafMul(this,e)},h.prototype.eq=function(e){if("affine"===e.type)return this.eq(e.toJ());if(this===e)return!0;var t=this.z.redSqr(),r=e.z.redSqr();if(0!==this.x.redMul(r).redISub(e.x.redMul(t)).cmpn(0))return!1;var i=t.redMul(this.z),s=r.redMul(e.z);return 0===this.y.redMul(s).redISub(e.y.redMul(i)).cmpn(0)},h.prototype.eqXToP=function(e){var t=this.z.redSqr(),r=e.toRed(this.curve.red).redMul(t);if(0===this.x.cmp(r))return!0;for(var i=e.clone(),s=this.curve.redN.redMul(t);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(s),0===this.x.cmp(r))return!0}},h.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},h.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},83475:function(e,t,r){"use strict";var i,s=r(28714),n=r(64358),o=r(36321).assert;function a(e){"short"===e.type?this.curve=new n.short(e):"edwards"===e.type?this.curve=new n.edwards(e):this.curve=new n.mont(e),this.g=this.curve.g,this.n=this.curve.n,this.hash=e.hash,o(this.g.validate(),"Invalid curve"),o(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function c(e,r){Object.defineProperty(t,e,{configurable:!0,enumerable:!0,get:function(){var i=new a(r);return Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:i}),i}})}t.PresetCurve=a,c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:s.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:s.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:s.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:s.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:s.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:s.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});try{i=r(36113)}catch(e){i=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:s.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",i]})},90063:function(e,t,r){"use strict";var i=r(21803),s=r(28072),n=r(36321),o=r(83475),a=r(47223),c=n.assert,l=r(61258),h=r(90362);function u(e){if(!(this instanceof u))return new u(e);"string"==typeof e&&(c(Object.prototype.hasOwnProperty.call(o,e),"Unknown curve "+e),e=o[e]),e instanceof o.PresetCurve&&(e={curve:e}),this.curve=e.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=e.curve.g,this.g.precompute(e.curve.n.bitLength()+1),this.hash=e.hash||e.curve.hash}e.exports=u,u.prototype.keyPair=function(e){return new l(this,e)},u.prototype.keyFromPrivate=function(e,t){return l.fromPrivate(this,e,t)},u.prototype.keyFromPublic=function(e,t){return l.fromPublic(this,e,t)},u.prototype.genKeyPair=function(e){e||(e={});for(var t=new s({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||a(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),r=this.n.byteLength(),n=this.n.sub(new i(2));;){var o=new i(t.generate(r));if(!(o.cmp(n)>0))return o.iaddn(1),this.keyFromPrivate(o)}},u.prototype._truncateToN=function(e,t,r){if(i.isBN(e)||"number"==typeof e)s=(e=new i(e,16)).byteLength();else if("object"==typeof e)s=e.length,e=new i(e,16);else{var s,n=e.toString();s=n.length+1>>>1,e=new i(n,16)}"number"!=typeof r&&(r=8*s);var o=r-this.n.bitLength();return(o>0&&(e=e.ushrn(o)),!t&&e.cmp(this.n)>=0)?e.sub(this.n):e},u.prototype.sign=function(e,t,r,n){if("object"==typeof r&&(n=r,r=null),n||(n={}),"string"!=typeof e&&"number"!=typeof e&&!i.isBN(e)){c("object"==typeof e&&e&&"number"==typeof e.length,"Expected message to be an array-like, a hex string, or a BN instance"),c(e.length>>>0===e.length);for(var o=0;o<e.length;o++)c((255&e[o])===e[o])}t=this.keyFromPrivate(t,r),c(!(e=this._truncateToN(e,!1,n.msgBitLength)).isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),l=t.getPrivate().toArray("be",a),u=e.toArray("be",a);c(new i(u).eq(e),"Can not sign message");for(var d=new s({hash:this.hash,entropy:l,nonce:u,pers:n.pers,persEnc:n.persEnc||"utf8"}),p=this.n.sub(new i(1)),f=0;;f++){var g=n.k?n.k(f):new i(d.generate(this.n.byteLength()));if(!(0>=(g=this._truncateToN(g,!0)).cmpn(1)||g.cmp(p)>=0)){var m=this.g.mul(g);if(!m.isInfinity()){var y=m.getX(),b=y.umod(this.n);if(0!==b.cmpn(0)){var w=g.invm(this.n).mul(b.mul(t.getPrivate()).iadd(e));if(0!==(w=w.umod(this.n)).cmpn(0)){var v=(m.getY().isOdd()?1:0)|(0!==y.cmp(b)?2:0);return n.canonical&&w.cmp(this.nh)>0&&(w=this.n.sub(w),v^=1),new h({r:b,s:w,recoveryParam:v})}}}}}},u.prototype.verify=function(e,t,r,i,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),r=this.keyFromPublic(r,i);var n,o=(t=new h(t,"hex")).r,a=t.s;if(0>o.cmpn(1)||o.cmp(this.n)>=0||0>a.cmpn(1)||a.cmp(this.n)>=0)return!1;var c=a.invm(this.n),l=c.mul(e).umod(this.n),u=c.mul(o).umod(this.n);return this.curve._maxwellTrick?!(n=this.g.jmulAdd(l,r.getPublic(),u)).isInfinity()&&n.eqXToP(o):!(n=this.g.mulAdd(l,r.getPublic(),u)).isInfinity()&&0===n.getX().umod(this.n).cmp(o)},u.prototype.recoverPubKey=function(e,t,r,s){c((3&r)===r,"The recovery param is more than two bits"),t=new h(t,s);var n=this.n,o=new i(e),a=t.r,l=t.s,u=1&r,d=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&d)throw Error("Unable to find sencond key candinate");a=d?this.curve.pointFromX(a.add(this.curve.n),u):this.curve.pointFromX(a,u);var p=t.r.invm(n),f=n.sub(o).mul(p).umod(n),g=l.mul(p).umod(n);return this.g.mulAdd(f,a,g)},u.prototype.getKeyRecoveryParam=function(e,t,r,i){if(null!==(t=new h(t,i)).recoveryParam)return t.recoveryParam;for(var s,n=0;n<4;n++){try{s=this.recoverPubKey(e,t,n)}catch(e){continue}if(s.eq(r))return n}throw Error("Unable to find valid recovery factor")}},61258:function(e,t,r){"use strict";var i=r(21803),s=r(36321).assert;function n(e,t){this.ec=e,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}e.exports=n,n.fromPublic=function(e,t,r){return t instanceof n?t:new n(e,{pub:t,pubEnc:r})},n.fromPrivate=function(e,t,r){return t instanceof n?t:new n(e,{priv:t,privEnc:r})},n.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},n.prototype.getPublic=function(e,t){return("string"==typeof e&&(t=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),t)?this.pub.encode(t,e):this.pub},n.prototype.getPrivate=function(e){return"hex"===e?this.priv.toString(16,2):this.priv},n.prototype._importPrivate=function(e,t){this.priv=new i(e,t||16),this.priv=this.priv.umod(this.ec.curve.n)},n.prototype._importPublic=function(e,t){if(e.x||e.y){"mont"===this.ec.curve.type?s(e.x,"Need x coordinate"):("short"===this.ec.curve.type||"edwards"===this.ec.curve.type)&&s(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,t)},n.prototype.derive=function(e){return e.validate()||s(e.validate(),"public point not validated"),e.mul(this.priv).getX()},n.prototype.sign=function(e,t,r){return this.ec.sign(e,this,t,r)},n.prototype.verify=function(e,t,r){return this.ec.verify(e,t,this,void 0,r)},n.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},90362:function(e,t,r){"use strict";var i=r(21803),s=r(36321),n=s.assert;function o(e,t){if(e instanceof o)return e;this._importDER(e,t)||(n(e.r&&e.s,"Signature without r or s"),this.r=new i(e.r,16),this.s=new i(e.s,16),void 0===e.recoveryParam?this.recoveryParam=null:this.recoveryParam=e.recoveryParam)}function a(){this.place=0}function c(e,t){var r=e[t.place++];if(!(128&r))return r;var i=15&r;if(0===i||i>4||0===e[t.place])return!1;for(var s=0,n=0,o=t.place;n<i;n++,o++)s<<=8,s|=e[o],s>>>=0;return!(s<=127)&&(t.place=o,s)}function l(e){for(var t=0,r=e.length-1;!e[t]&&!(128&e[t+1])&&t<r;)t++;return 0===t?e:e.slice(t)}function h(e,t){if(t<128){e.push(t);return}var r=1+(Math.log(t)/Math.LN2>>>3);for(e.push(128|r);--r;)e.push(t>>>(r<<3)&255);e.push(t)}e.exports=o,o.prototype._importDER=function(e,t){e=s.toArray(e,t);var r=new a;if(48!==e[r.place++])return!1;var n=c(e,r);if(!1===n||n+r.place!==e.length||2!==e[r.place++])return!1;var o=c(e,r);if(!1===o||(128&e[r.place])!=0)return!1;var l=e.slice(r.place,o+r.place);if(r.place+=o,2!==e[r.place++])return!1;var h=c(e,r);if(!1===h||e.length!==h+r.place||(128&e[r.place])!=0)return!1;var u=e.slice(r.place,h+r.place);if(0===l[0]){if(!(128&l[1]))return!1;l=l.slice(1)}if(0===u[0]){if(!(128&u[1]))return!1;u=u.slice(1)}return this.r=new i(l),this.s=new i(u),this.recoveryParam=null,!0},o.prototype.toDER=function(e){var t=this.r.toArray(),r=this.s.toArray();for(128&t[0]&&(t=[0].concat(t)),128&r[0]&&(r=[0].concat(r)),t=l(t),r=l(r);!r[0]&&!(128&r[1]);)r=r.slice(1);var i=[2];h(i,t.length),(i=i.concat(t)).push(2),h(i,r.length);var n=i.concat(r),o=[48];return h(o,n.length),o=o.concat(n),s.encode(o,e)}},37115:function(e,t,r){"use strict";var i=r(28714),s=r(83475),n=r(36321),o=n.assert,a=n.parseBytes,c=r(76244),l=r(55967);function h(e){if(o("ed25519"===e,"only tested with ed25519 so far"),!(this instanceof h))return new h(e);e=s[e].curve,this.curve=e,this.g=e.g,this.g.precompute(e.n.bitLength()+1),this.pointClass=e.point().constructor,this.encodingLength=Math.ceil(e.n.bitLength()/8),this.hash=i.sha512}e.exports=h,h.prototype.sign=function(e,t){e=a(e);var r=this.keyFromSecret(t),i=this.hashInt(r.messagePrefix(),e),s=this.g.mul(i),n=this.encodePoint(s),o=this.hashInt(n,r.pubBytes(),e).mul(r.priv()),c=i.add(o).umod(this.curve.n);return this.makeSignature({R:s,S:c,Rencoded:n})},h.prototype.verify=function(e,t,r){if(e=a(e),(t=this.makeSignature(t)).S().gte(t.eddsa.curve.n)||t.S().isNeg())return!1;var i=this.keyFromPublic(r),s=this.hashInt(t.Rencoded(),i.pubBytes(),e),n=this.g.mul(t.S());return t.R().add(i.pub().mul(s)).eq(n)},h.prototype.hashInt=function(){for(var e=this.hash(),t=0;t<arguments.length;t++)e.update(arguments[t]);return n.intFromLE(e.digest()).umod(this.curve.n)},h.prototype.keyFromPublic=function(e){return c.fromPublic(this,e)},h.prototype.keyFromSecret=function(e){return c.fromSecret(this,e)},h.prototype.makeSignature=function(e){return e instanceof l?e:new l(this,e)},h.prototype.encodePoint=function(e){var t=e.getY().toArray("le",this.encodingLength);return t[this.encodingLength-1]|=e.getX().isOdd()?128:0,t},h.prototype.decodePoint=function(e){var t=(e=n.parseBytes(e)).length-1,r=e.slice(0,t).concat(-129&e[t]),i=(128&e[t])!=0,s=n.intFromLE(r);return this.curve.pointFromY(s,i)},h.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)},h.prototype.decodeInt=function(e){return n.intFromLE(e)},h.prototype.isPoint=function(e){return e instanceof this.pointClass}},76244:function(e,t,r){"use strict";var i=r(36321),s=i.assert,n=i.parseBytes,o=i.cachedProperty;function a(e,t){this.eddsa=e,this._secret=n(t.secret),e.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=n(t.pub)}a.fromPublic=function(e,t){return t instanceof a?t:new a(e,{pub:t})},a.fromSecret=function(e,t){return t instanceof a?t:new a(e,{secret:t})},a.prototype.secret=function(){return this._secret},o(a,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),o(a,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),o(a,"privBytes",function(){var e=this.eddsa,t=this.hash(),r=e.encodingLength-1,i=t.slice(0,e.encodingLength);return i[0]&=248,i[r]&=127,i[r]|=64,i}),o(a,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),o(a,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),o(a,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),a.prototype.sign=function(e){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)},a.prototype.verify=function(e,t){return this.eddsa.verify(e,t,this)},a.prototype.getSecret=function(e){return s(this._secret,"KeyPair is public only"),i.encode(this.secret(),e)},a.prototype.getPublic=function(e){return i.encode(this.pubBytes(),e)},e.exports=a},55967:function(e,t,r){"use strict";var i=r(21803),s=r(36321),n=s.assert,o=s.cachedProperty,a=s.parseBytes;function c(e,t){this.eddsa=e,"object"!=typeof t&&(t=a(t)),Array.isArray(t)&&(n(t.length===2*e.encodingLength,"Signature has invalid size"),t={R:t.slice(0,e.encodingLength),S:t.slice(e.encodingLength)}),n(t.R&&t.S,"Signature without R or S"),e.isPoint(t.R)&&(this._R=t.R),t.S instanceof i&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}o(c,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),o(c,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),o(c,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),o(c,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),c.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},c.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},e.exports=c},36113:function(e){e.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},36321:function(e,t,r){"use strict";var i=r(21803),s=r(73045),n=r(83742);t.assert=s,t.toArray=n.toArray,t.zero2=n.zero2,t.toHex=n.toHex,t.encode=n.encode,t.getNAF=function(e,t,r){var i=Array(Math.max(e.bitLength(),r)+1);for(o=0;o<i.length;o+=1)i[o]=0;var s=1<<t+1,n=e.clone();for(o=0;o<i.length;o++){var o,a,c=n.andln(s-1);n.isOdd()?(a=c>(s>>1)-1?(s>>1)-c:c,n.isubn(a)):a=0,i[o]=a,n.iushrn(1)}return i},t.getJSF=function(e,t){var r=[[],[]];e=e.clone(),t=t.clone();for(var i=0,s=0;e.cmpn(-i)>0||t.cmpn(-s)>0;){var n,o,a,c=e.andln(3)+i&3,l=t.andln(3)+s&3;3===c&&(c=-1),3===l&&(l=-1),o=(1&c)==0?0:(3==(n=e.andln(7)+i&7)||5===n)&&2===l?-c:c,r[0].push(o),a=(1&l)==0?0:(3==(n=t.andln(7)+s&7)||5===n)&&2===c?-l:l,r[1].push(a),2*i===o+1&&(i=1-i),2*s===a+1&&(s=1-s),e.iushrn(1),t.iushrn(1)}return r},t.cachedProperty=function(e,t,r){var i="_"+t;e.prototype[t]=function(){return void 0!==this[i]?this[i]:this[i]=r.call(this)}},t.parseBytes=function(e){return"string"==typeof e?t.toArray(e,"hex"):e},t.intFromLE=function(e){return new i(e,"hex","le")}},21803:function(e,t,r){!function(e,t){"use strict";function i(e,t){if(!e)throw Error(t||"Assertion failed")}function s(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}function n(e,t,r){if(n.isBN(e))return e;this.negative=0,this.words=null,this.length=0,this.red=null,null!==e&&(("le"===t||"be"===t)&&(r=t,t=10),this._init(e||0,t||10,r||"be"))}"object"==typeof e?e.exports=n:t.BN=n,n.BN=n,n.wordSize=26;try{l="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:r(85568).Buffer}catch(e){}function o(e,t){var r=e.charCodeAt(t);return r>=65&&r<=70?r-55:r>=97&&r<=102?r-87:r-48&15}function a(e,t,r){var i=o(e,r);return r-1>=t&&(i|=o(e,r-1)<<4),i}function c(e,t,r,i){for(var s=0,n=Math.min(e.length,r),o=t;o<n;o++){var a=e.charCodeAt(o)-48;s*=i,a>=49?s+=a-49+10:a>=17?s+=a-17+10:s+=a}return s}n.isBN=function(e){return e instanceof n||null!==e&&"object"==typeof e&&e.constructor.wordSize===n.wordSize&&Array.isArray(e.words)},n.max=function(e,t){return e.cmp(t)>0?e:t},n.min=function(e,t){return 0>e.cmp(t)?e:t},n.prototype._init=function(e,t,r){if("number"==typeof e)return this._initNumber(e,t,r);if("object"==typeof e)return this._initArray(e,t,r);"hex"===t&&(t=16),i(t===(0|t)&&t>=2&&t<=36);var s=0;"-"===(e=e.toString().replace(/\s+/g,""))[0]&&(s++,this.negative=1),s<e.length&&(16===t?this._parseHex(e,s,r):(this._parseBase(e,t,s),"le"===r&&this._initArray(this.toArray(),t,r)))},n.prototype._initNumber=function(e,t,r){e<0&&(this.negative=1,e=-e),e<67108864?(this.words=[67108863&e],this.length=1):e<4503599627370496?(this.words=[67108863&e,e/67108864&67108863],this.length=2):(i(e<9007199254740992),this.words=[67108863&e,e/67108864&67108863,1],this.length=3),"le"===r&&this._initArray(this.toArray(),t,r)},n.prototype._initArray=function(e,t,r){if(i("number"==typeof e.length),e.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(e.length/3),this.words=Array(this.length);for(var s,n,o=0;o<this.length;o++)this.words[o]=0;var a=0;if("be"===r)for(o=e.length-1,s=0;o>=0;o-=3)n=e[o]|e[o-1]<<8|e[o-2]<<16,this.words[s]|=n<<a&67108863,this.words[s+1]=n>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===r)for(o=0,s=0;o<e.length;o+=3)n=e[o]|e[o+1]<<8|e[o+2]<<16,this.words[s]|=n<<a&67108863,this.words[s+1]=n>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this.strip()},n.prototype._parseHex=function(e,t,r){this.length=Math.ceil((e.length-t)/6),this.words=Array(this.length);for(var i,s=0;s<this.length;s++)this.words[s]=0;var n=0,o=0;if("be"===r)for(s=e.length-1;s>=t;s-=2)i=a(e,t,s)<<n,this.words[o]|=67108863&i,n>=18?(n-=18,o+=1,this.words[o]|=i>>>26):n+=8;else for(s=(e.length-t)%2==0?t+1:t;s<e.length;s+=2)i=a(e,t,s)<<n,this.words[o]|=67108863&i,n>=18?(n-=18,o+=1,this.words[o]|=i>>>26):n+=8;this.strip()},n.prototype._parseBase=function(e,t,r){this.words=[0],this.length=1;for(var i=0,s=1;s<=67108863;s*=t)i++;i--,s=s/t|0;for(var n=e.length-r,o=n%i,a=Math.min(n,n-o)+r,l=0,h=r;h<a;h+=i)l=c(e,h,h+i,t),this.imuln(s),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l);if(0!==o){var u=1;for(l=c(e,h,e.length,t),h=0;h<o;h++)u*=t;this.imuln(u),this.words[0]+l<67108864?this.words[0]+=l:this._iaddn(l)}this.strip()},n.prototype.copy=function(e){e.words=Array(this.length);for(var t=0;t<this.length;t++)e.words[t]=this.words[t];e.length=this.length,e.negative=this.negative,e.red=this.red},n.prototype.clone=function(){var e=new n(null);return this.copy(e),e},n.prototype._expand=function(e){for(;this.length<e;)this.words[this.length++]=0;return this},n.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},n.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},n.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l,h=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],u=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],d=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function p(e,t,r){r.negative=t.negative^e.negative;var i=e.length+t.length|0;r.length=i,i=i-1|0;var s=0|e.words[0],n=0|t.words[0],o=s*n,a=67108863&o,c=o/67108864|0;r.words[0]=a;for(var l=1;l<i;l++){for(var h=c>>>26,u=67108863&c,d=Math.min(l,t.length-1),p=Math.max(0,l-e.length+1);p<=d;p++){var f=l-p|0;h+=(o=(s=0|e.words[f])*(n=0|t.words[p])+u)/67108864|0,u=67108863&o}r.words[l]=0|u,c=0|h}return 0!==c?r.words[l]=0|c:r.length--,r.strip()}n.prototype.toString=function(e,t){if(t=0|t||1,16===(e=e||10)||"hex"===e){r="";for(var r,s=0,n=0,o=0;o<this.length;o++){var a=this.words[o],c=((a<<s|n)&16777215).toString(16);n=a>>>24-s&16777215,(s+=2)>=26&&(s-=26,o--),r=0!==n||o!==this.length-1?h[6-c.length]+c+r:c+r}for(0!==n&&(r=n.toString(16)+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}if(e===(0|e)&&e>=2&&e<=36){var l=u[e],p=d[e];r="";var f=this.clone();for(f.negative=0;!f.isZero();){var g=f.modn(p).toString(e);r=(f=f.idivn(p)).isZero()?g+r:h[l-g.length]+g+r}for(this.isZero()&&(r="0"+r);r.length%t!=0;)r="0"+r;return 0!==this.negative&&(r="-"+r),r}i(!1,"Base should be between 2 and 36")},n.prototype.toNumber=function(){var e=this.words[0];return 2===this.length?e+=67108864*this.words[1]:3===this.length&&1===this.words[2]?e+=4503599627370496+67108864*this.words[1]:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-e:e},n.prototype.toJSON=function(){return this.toString(16)},n.prototype.toBuffer=function(e,t){return i(void 0!==l),this.toArrayLike(l,e,t)},n.prototype.toArray=function(e,t){return this.toArrayLike(Array,e,t)},n.prototype.toArrayLike=function(e,t,r){var s,n,o=this.byteLength(),a=r||Math.max(1,o);i(o<=a,"byte array longer than desired length"),i(a>0,"Requested array length <= 0"),this.strip();var c=new e(a),l=this.clone();if("le"===t){for(n=0;!l.isZero();n++)s=l.andln(255),l.iushrn(8),c[n]=s;for(;n<a;n++)c[n]=0}else{for(n=0;n<a-o;n++)c[n]=0;for(n=0;!l.isZero();n++)s=l.andln(255),l.iushrn(8),c[a-n-1]=s}return c},Math.clz32?n.prototype._countBits=function(e){return 32-Math.clz32(e)}:n.prototype._countBits=function(e){var t=e,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},n.prototype._zeroBits=function(e){if(0===e)return 26;var t=e,r=0;return(8191&t)==0&&(r+=13,t>>>=13),(127&t)==0&&(r+=7,t>>>=7),(15&t)==0&&(r+=4,t>>>=4),(3&t)==0&&(r+=2,t>>>=2),(1&t)==0&&r++,r},n.prototype.bitLength=function(){var e=this.words[this.length-1],t=this._countBits(e);return(this.length-1)*26+t},n.prototype.zeroBits=function(){if(this.isZero())return 0;for(var e=0,t=0;t<this.length;t++){var r=this._zeroBits(this.words[t]);if(e+=r,26!==r)break}return e},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.toTwos=function(e){return 0!==this.negative?this.abs().inotn(e).iaddn(1):this.clone()},n.prototype.fromTwos=function(e){return this.testn(e-1)?this.notn(e).iaddn(1).ineg():this.clone()},n.prototype.isNeg=function(){return 0!==this.negative},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},n.prototype.iuor=function(e){for(;this.length<e.length;)this.words[this.length++]=0;for(var t=0;t<e.length;t++)this.words[t]=this.words[t]|e.words[t];return this.strip()},n.prototype.ior=function(e){return i((this.negative|e.negative)==0),this.iuor(e)},n.prototype.or=function(e){return this.length>e.length?this.clone().ior(e):e.clone().ior(this)},n.prototype.uor=function(e){return this.length>e.length?this.clone().iuor(e):e.clone().iuor(this)},n.prototype.iuand=function(e){var t;t=this.length>e.length?e:this;for(var r=0;r<t.length;r++)this.words[r]=this.words[r]&e.words[r];return this.length=t.length,this.strip()},n.prototype.iand=function(e){return i((this.negative|e.negative)==0),this.iuand(e)},n.prototype.and=function(e){return this.length>e.length?this.clone().iand(e):e.clone().iand(this)},n.prototype.uand=function(e){return this.length>e.length?this.clone().iuand(e):e.clone().iuand(this)},n.prototype.iuxor=function(e){this.length>e.length?(t=this,r=e):(t=e,r=this);for(var t,r,i=0;i<r.length;i++)this.words[i]=t.words[i]^r.words[i];if(this!==t)for(;i<t.length;i++)this.words[i]=t.words[i];return this.length=t.length,this.strip()},n.prototype.ixor=function(e){return i((this.negative|e.negative)==0),this.iuxor(e)},n.prototype.xor=function(e){return this.length>e.length?this.clone().ixor(e):e.clone().ixor(this)},n.prototype.uxor=function(e){return this.length>e.length?this.clone().iuxor(e):e.clone().iuxor(this)},n.prototype.inotn=function(e){i("number"==typeof e&&e>=0);var t=0|Math.ceil(e/26),r=e%26;this._expand(t),r>0&&t--;for(var s=0;s<t;s++)this.words[s]=67108863&~this.words[s];return r>0&&(this.words[s]=~this.words[s]&67108863>>26-r),this.strip()},n.prototype.notn=function(e){return this.clone().inotn(e)},n.prototype.setn=function(e,t){i("number"==typeof e&&e>=0);var r=e/26|0,s=e%26;return this._expand(r+1),t?this.words[r]=this.words[r]|1<<s:this.words[r]=this.words[r]&~(1<<s),this.strip()},n.prototype.iadd=function(e){if(0!==this.negative&&0===e.negative)return this.negative=0,t=this.isub(e),this.negative^=1,this._normSign();if(0===this.negative&&0!==e.negative)return e.negative=0,t=this.isub(e),e.negative=1,t._normSign();this.length>e.length?(r=this,i=e):(r=e,i=this);for(var t,r,i,s=0,n=0;n<i.length;n++)t=(0|r.words[n])+(0|i.words[n])+s,this.words[n]=67108863&t,s=t>>>26;for(;0!==s&&n<r.length;n++)t=(0|r.words[n])+s,this.words[n]=67108863&t,s=t>>>26;if(this.length=r.length,0!==s)this.words[this.length]=s,this.length++;else if(r!==this)for(;n<r.length;n++)this.words[n]=r.words[n];return this},n.prototype.add=function(e){var t;return 0!==e.negative&&0===this.negative?(e.negative=0,t=this.sub(e),e.negative^=1,t):0===e.negative&&0!==this.negative?(this.negative=0,t=e.sub(this),this.negative=1,t):this.length>e.length?this.clone().iadd(e):e.clone().iadd(this)},n.prototype.isub=function(e){if(0!==e.negative){e.negative=0;var t,r,i=this.iadd(e);return e.negative=1,i._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(e),this.negative=1,this._normSign();var s=this.cmp(e);if(0===s)return this.negative=0,this.length=1,this.words[0]=0,this;s>0?(t=this,r=e):(t=e,r=this);for(var n=0,o=0;o<r.length;o++)n=(i=(0|t.words[o])-(0|r.words[o])+n)>>26,this.words[o]=67108863&i;for(;0!==n&&o<t.length;o++)n=(i=(0|t.words[o])+n)>>26,this.words[o]=67108863&i;if(0===n&&o<t.length&&t!==this)for(;o<t.length;o++)this.words[o]=t.words[o];return this.length=Math.max(this.length,o),t!==this&&(this.negative=1),this.strip()},n.prototype.sub=function(e){return this.clone().isub(e)};var f=function(e,t,r){var i,s,n,o=e.words,a=t.words,c=r.words,l=0,h=0|o[0],u=8191&h,d=h>>>13,p=0|o[1],f=8191&p,g=p>>>13,m=0|o[2],y=8191&m,b=m>>>13,w=0|o[3],v=8191&w,E=w>>>13,I=0|o[4],_=8191&I,C=I>>>13,S=0|o[5],N=8191&S,A=S>>>13,O=0|o[6],M=8191&O,P=O>>>13,x=0|o[7],T=8191&x,D=x>>>13,R=0|o[8],k=8191&R,j=R>>>13,L=0|o[9],U=8191&L,z=L>>>13,$=0|a[0],q=8191&$,B=$>>>13,W=0|a[1],H=8191&W,F=W>>>13,V=0|a[2],K=8191&V,J=V>>>13,Y=0|a[3],G=8191&Y,Q=Y>>>13,Z=0|a[4],X=8191&Z,ee=Z>>>13,et=0|a[5],er=8191&et,ei=et>>>13,es=0|a[6],en=8191&es,eo=es>>>13,ea=0|a[7],ec=8191&ea,el=ea>>>13,eh=0|a[8],eu=8191&eh,ed=eh>>>13,ep=0|a[9],ef=8191&ep,eg=ep>>>13;r.negative=e.negative^t.negative,r.length=19;var em=(l+(i=Math.imul(u,q))|0)+((8191&(s=(s=Math.imul(u,B))+Math.imul(d,q)|0))<<13)|0;l=((n=Math.imul(d,B))+(s>>>13)|0)+(em>>>26)|0,em&=67108863,i=Math.imul(f,q),s=(s=Math.imul(f,B))+Math.imul(g,q)|0,n=Math.imul(g,B);var ey=(l+(i=i+Math.imul(u,H)|0)|0)+((8191&(s=(s=s+Math.imul(u,F)|0)+Math.imul(d,H)|0))<<13)|0;l=((n=n+Math.imul(d,F)|0)+(s>>>13)|0)+(ey>>>26)|0,ey&=67108863,i=Math.imul(y,q),s=(s=Math.imul(y,B))+Math.imul(b,q)|0,n=Math.imul(b,B),i=i+Math.imul(f,H)|0,s=(s=s+Math.imul(f,F)|0)+Math.imul(g,H)|0,n=n+Math.imul(g,F)|0;var eb=(l+(i=i+Math.imul(u,K)|0)|0)+((8191&(s=(s=s+Math.imul(u,J)|0)+Math.imul(d,K)|0))<<13)|0;l=((n=n+Math.imul(d,J)|0)+(s>>>13)|0)+(eb>>>26)|0,eb&=67108863,i=Math.imul(v,q),s=(s=Math.imul(v,B))+Math.imul(E,q)|0,n=Math.imul(E,B),i=i+Math.imul(y,H)|0,s=(s=s+Math.imul(y,F)|0)+Math.imul(b,H)|0,n=n+Math.imul(b,F)|0,i=i+Math.imul(f,K)|0,s=(s=s+Math.imul(f,J)|0)+Math.imul(g,K)|0,n=n+Math.imul(g,J)|0;var ew=(l+(i=i+Math.imul(u,G)|0)|0)+((8191&(s=(s=s+Math.imul(u,Q)|0)+Math.imul(d,G)|0))<<13)|0;l=((n=n+Math.imul(d,Q)|0)+(s>>>13)|0)+(ew>>>26)|0,ew&=67108863,i=Math.imul(_,q),s=(s=Math.imul(_,B))+Math.imul(C,q)|0,n=Math.imul(C,B),i=i+Math.imul(v,H)|0,s=(s=s+Math.imul(v,F)|0)+Math.imul(E,H)|0,n=n+Math.imul(E,F)|0,i=i+Math.imul(y,K)|0,s=(s=s+Math.imul(y,J)|0)+Math.imul(b,K)|0,n=n+Math.imul(b,J)|0,i=i+Math.imul(f,G)|0,s=(s=s+Math.imul(f,Q)|0)+Math.imul(g,G)|0,n=n+Math.imul(g,Q)|0;var ev=(l+(i=i+Math.imul(u,X)|0)|0)+((8191&(s=(s=s+Math.imul(u,ee)|0)+Math.imul(d,X)|0))<<13)|0;l=((n=n+Math.imul(d,ee)|0)+(s>>>13)|0)+(ev>>>26)|0,ev&=67108863,i=Math.imul(N,q),s=(s=Math.imul(N,B))+Math.imul(A,q)|0,n=Math.imul(A,B),i=i+Math.imul(_,H)|0,s=(s=s+Math.imul(_,F)|0)+Math.imul(C,H)|0,n=n+Math.imul(C,F)|0,i=i+Math.imul(v,K)|0,s=(s=s+Math.imul(v,J)|0)+Math.imul(E,K)|0,n=n+Math.imul(E,J)|0,i=i+Math.imul(y,G)|0,s=(s=s+Math.imul(y,Q)|0)+Math.imul(b,G)|0,n=n+Math.imul(b,Q)|0,i=i+Math.imul(f,X)|0,s=(s=s+Math.imul(f,ee)|0)+Math.imul(g,X)|0,n=n+Math.imul(g,ee)|0;var eE=(l+(i=i+Math.imul(u,er)|0)|0)+((8191&(s=(s=s+Math.imul(u,ei)|0)+Math.imul(d,er)|0))<<13)|0;l=((n=n+Math.imul(d,ei)|0)+(s>>>13)|0)+(eE>>>26)|0,eE&=67108863,i=Math.imul(M,q),s=(s=Math.imul(M,B))+Math.imul(P,q)|0,n=Math.imul(P,B),i=i+Math.imul(N,H)|0,s=(s=s+Math.imul(N,F)|0)+Math.imul(A,H)|0,n=n+Math.imul(A,F)|0,i=i+Math.imul(_,K)|0,s=(s=s+Math.imul(_,J)|0)+Math.imul(C,K)|0,n=n+Math.imul(C,J)|0,i=i+Math.imul(v,G)|0,s=(s=s+Math.imul(v,Q)|0)+Math.imul(E,G)|0,n=n+Math.imul(E,Q)|0,i=i+Math.imul(y,X)|0,s=(s=s+Math.imul(y,ee)|0)+Math.imul(b,X)|0,n=n+Math.imul(b,ee)|0,i=i+Math.imul(f,er)|0,s=(s=s+Math.imul(f,ei)|0)+Math.imul(g,er)|0,n=n+Math.imul(g,ei)|0;var eI=(l+(i=i+Math.imul(u,en)|0)|0)+((8191&(s=(s=s+Math.imul(u,eo)|0)+Math.imul(d,en)|0))<<13)|0;l=((n=n+Math.imul(d,eo)|0)+(s>>>13)|0)+(eI>>>26)|0,eI&=67108863,i=Math.imul(T,q),s=(s=Math.imul(T,B))+Math.imul(D,q)|0,n=Math.imul(D,B),i=i+Math.imul(M,H)|0,s=(s=s+Math.imul(M,F)|0)+Math.imul(P,H)|0,n=n+Math.imul(P,F)|0,i=i+Math.imul(N,K)|0,s=(s=s+Math.imul(N,J)|0)+Math.imul(A,K)|0,n=n+Math.imul(A,J)|0,i=i+Math.imul(_,G)|0,s=(s=s+Math.imul(_,Q)|0)+Math.imul(C,G)|0,n=n+Math.imul(C,Q)|0,i=i+Math.imul(v,X)|0,s=(s=s+Math.imul(v,ee)|0)+Math.imul(E,X)|0,n=n+Math.imul(E,ee)|0,i=i+Math.imul(y,er)|0,s=(s=s+Math.imul(y,ei)|0)+Math.imul(b,er)|0,n=n+Math.imul(b,ei)|0,i=i+Math.imul(f,en)|0,s=(s=s+Math.imul(f,eo)|0)+Math.imul(g,en)|0,n=n+Math.imul(g,eo)|0;var e_=(l+(i=i+Math.imul(u,ec)|0)|0)+((8191&(s=(s=s+Math.imul(u,el)|0)+Math.imul(d,ec)|0))<<13)|0;l=((n=n+Math.imul(d,el)|0)+(s>>>13)|0)+(e_>>>26)|0,e_&=67108863,i=Math.imul(k,q),s=(s=Math.imul(k,B))+Math.imul(j,q)|0,n=Math.imul(j,B),i=i+Math.imul(T,H)|0,s=(s=s+Math.imul(T,F)|0)+Math.imul(D,H)|0,n=n+Math.imul(D,F)|0,i=i+Math.imul(M,K)|0,s=(s=s+Math.imul(M,J)|0)+Math.imul(P,K)|0,n=n+Math.imul(P,J)|0,i=i+Math.imul(N,G)|0,s=(s=s+Math.imul(N,Q)|0)+Math.imul(A,G)|0,n=n+Math.imul(A,Q)|0,i=i+Math.imul(_,X)|0,s=(s=s+Math.imul(_,ee)|0)+Math.imul(C,X)|0,n=n+Math.imul(C,ee)|0,i=i+Math.imul(v,er)|0,s=(s=s+Math.imul(v,ei)|0)+Math.imul(E,er)|0,n=n+Math.imul(E,ei)|0,i=i+Math.imul(y,en)|0,s=(s=s+Math.imul(y,eo)|0)+Math.imul(b,en)|0,n=n+Math.imul(b,eo)|0,i=i+Math.imul(f,ec)|0,s=(s=s+Math.imul(f,el)|0)+Math.imul(g,ec)|0,n=n+Math.imul(g,el)|0;var eC=(l+(i=i+Math.imul(u,eu)|0)|0)+((8191&(s=(s=s+Math.imul(u,ed)|0)+Math.imul(d,eu)|0))<<13)|0;l=((n=n+Math.imul(d,ed)|0)+(s>>>13)|0)+(eC>>>26)|0,eC&=67108863,i=Math.imul(U,q),s=(s=Math.imul(U,B))+Math.imul(z,q)|0,n=Math.imul(z,B),i=i+Math.imul(k,H)|0,s=(s=s+Math.imul(k,F)|0)+Math.imul(j,H)|0,n=n+Math.imul(j,F)|0,i=i+Math.imul(T,K)|0,s=(s=s+Math.imul(T,J)|0)+Math.imul(D,K)|0,n=n+Math.imul(D,J)|0,i=i+Math.imul(M,G)|0,s=(s=s+Math.imul(M,Q)|0)+Math.imul(P,G)|0,n=n+Math.imul(P,Q)|0,i=i+Math.imul(N,X)|0,s=(s=s+Math.imul(N,ee)|0)+Math.imul(A,X)|0,n=n+Math.imul(A,ee)|0,i=i+Math.imul(_,er)|0,s=(s=s+Math.imul(_,ei)|0)+Math.imul(C,er)|0,n=n+Math.imul(C,ei)|0,i=i+Math.imul(v,en)|0,s=(s=s+Math.imul(v,eo)|0)+Math.imul(E,en)|0,n=n+Math.imul(E,eo)|0,i=i+Math.imul(y,ec)|0,s=(s=s+Math.imul(y,el)|0)+Math.imul(b,ec)|0,n=n+Math.imul(b,el)|0,i=i+Math.imul(f,eu)|0,s=(s=s+Math.imul(f,ed)|0)+Math.imul(g,eu)|0,n=n+Math.imul(g,ed)|0;var eS=(l+(i=i+Math.imul(u,ef)|0)|0)+((8191&(s=(s=s+Math.imul(u,eg)|0)+Math.imul(d,ef)|0))<<13)|0;l=((n=n+Math.imul(d,eg)|0)+(s>>>13)|0)+(eS>>>26)|0,eS&=67108863,i=Math.imul(U,H),s=(s=Math.imul(U,F))+Math.imul(z,H)|0,n=Math.imul(z,F),i=i+Math.imul(k,K)|0,s=(s=s+Math.imul(k,J)|0)+Math.imul(j,K)|0,n=n+Math.imul(j,J)|0,i=i+Math.imul(T,G)|0,s=(s=s+Math.imul(T,Q)|0)+Math.imul(D,G)|0,n=n+Math.imul(D,Q)|0,i=i+Math.imul(M,X)|0,s=(s=s+Math.imul(M,ee)|0)+Math.imul(P,X)|0,n=n+Math.imul(P,ee)|0,i=i+Math.imul(N,er)|0,s=(s=s+Math.imul(N,ei)|0)+Math.imul(A,er)|0,n=n+Math.imul(A,ei)|0,i=i+Math.imul(_,en)|0,s=(s=s+Math.imul(_,eo)|0)+Math.imul(C,en)|0,n=n+Math.imul(C,eo)|0,i=i+Math.imul(v,ec)|0,s=(s=s+Math.imul(v,el)|0)+Math.imul(E,ec)|0,n=n+Math.imul(E,el)|0,i=i+Math.imul(y,eu)|0,s=(s=s+Math.imul(y,ed)|0)+Math.imul(b,eu)|0,n=n+Math.imul(b,ed)|0;var eN=(l+(i=i+Math.imul(f,ef)|0)|0)+((8191&(s=(s=s+Math.imul(f,eg)|0)+Math.imul(g,ef)|0))<<13)|0;l=((n=n+Math.imul(g,eg)|0)+(s>>>13)|0)+(eN>>>26)|0,eN&=67108863,i=Math.imul(U,K),s=(s=Math.imul(U,J))+Math.imul(z,K)|0,n=Math.imul(z,J),i=i+Math.imul(k,G)|0,s=(s=s+Math.imul(k,Q)|0)+Math.imul(j,G)|0,n=n+Math.imul(j,Q)|0,i=i+Math.imul(T,X)|0,s=(s=s+Math.imul(T,ee)|0)+Math.imul(D,X)|0,n=n+Math.imul(D,ee)|0,i=i+Math.imul(M,er)|0,s=(s=s+Math.imul(M,ei)|0)+Math.imul(P,er)|0,n=n+Math.imul(P,ei)|0,i=i+Math.imul(N,en)|0,s=(s=s+Math.imul(N,eo)|0)+Math.imul(A,en)|0,n=n+Math.imul(A,eo)|0,i=i+Math.imul(_,ec)|0,s=(s=s+Math.imul(_,el)|0)+Math.imul(C,ec)|0,n=n+Math.imul(C,el)|0,i=i+Math.imul(v,eu)|0,s=(s=s+Math.imul(v,ed)|0)+Math.imul(E,eu)|0,n=n+Math.imul(E,ed)|0;var eA=(l+(i=i+Math.imul(y,ef)|0)|0)+((8191&(s=(s=s+Math.imul(y,eg)|0)+Math.imul(b,ef)|0))<<13)|0;l=((n=n+Math.imul(b,eg)|0)+(s>>>13)|0)+(eA>>>26)|0,eA&=67108863,i=Math.imul(U,G),s=(s=Math.imul(U,Q))+Math.imul(z,G)|0,n=Math.imul(z,Q),i=i+Math.imul(k,X)|0,s=(s=s+Math.imul(k,ee)|0)+Math.imul(j,X)|0,n=n+Math.imul(j,ee)|0,i=i+Math.imul(T,er)|0,s=(s=s+Math.imul(T,ei)|0)+Math.imul(D,er)|0,n=n+Math.imul(D,ei)|0,i=i+Math.imul(M,en)|0,s=(s=s+Math.imul(M,eo)|0)+Math.imul(P,en)|0,n=n+Math.imul(P,eo)|0,i=i+Math.imul(N,ec)|0,s=(s=s+Math.imul(N,el)|0)+Math.imul(A,ec)|0,n=n+Math.imul(A,el)|0,i=i+Math.imul(_,eu)|0,s=(s=s+Math.imul(_,ed)|0)+Math.imul(C,eu)|0,n=n+Math.imul(C,ed)|0;var eO=(l+(i=i+Math.imul(v,ef)|0)|0)+((8191&(s=(s=s+Math.imul(v,eg)|0)+Math.imul(E,ef)|0))<<13)|0;l=((n=n+Math.imul(E,eg)|0)+(s>>>13)|0)+(eO>>>26)|0,eO&=67108863,i=Math.imul(U,X),s=(s=Math.imul(U,ee))+Math.imul(z,X)|0,n=Math.imul(z,ee),i=i+Math.imul(k,er)|0,s=(s=s+Math.imul(k,ei)|0)+Math.imul(j,er)|0,n=n+Math.imul(j,ei)|0,i=i+Math.imul(T,en)|0,s=(s=s+Math.imul(T,eo)|0)+Math.imul(D,en)|0,n=n+Math.imul(D,eo)|0,i=i+Math.imul(M,ec)|0,s=(s=s+Math.imul(M,el)|0)+Math.imul(P,ec)|0,n=n+Math.imul(P,el)|0,i=i+Math.imul(N,eu)|0,s=(s=s+Math.imul(N,ed)|0)+Math.imul(A,eu)|0,n=n+Math.imul(A,ed)|0;var eM=(l+(i=i+Math.imul(_,ef)|0)|0)+((8191&(s=(s=s+Math.imul(_,eg)|0)+Math.imul(C,ef)|0))<<13)|0;l=((n=n+Math.imul(C,eg)|0)+(s>>>13)|0)+(eM>>>26)|0,eM&=67108863,i=Math.imul(U,er),s=(s=Math.imul(U,ei))+Math.imul(z,er)|0,n=Math.imul(z,ei),i=i+Math.imul(k,en)|0,s=(s=s+Math.imul(k,eo)|0)+Math.imul(j,en)|0,n=n+Math.imul(j,eo)|0,i=i+Math.imul(T,ec)|0,s=(s=s+Math.imul(T,el)|0)+Math.imul(D,ec)|0,n=n+Math.imul(D,el)|0,i=i+Math.imul(M,eu)|0,s=(s=s+Math.imul(M,ed)|0)+Math.imul(P,eu)|0,n=n+Math.imul(P,ed)|0;var eP=(l+(i=i+Math.imul(N,ef)|0)|0)+((8191&(s=(s=s+Math.imul(N,eg)|0)+Math.imul(A,ef)|0))<<13)|0;l=((n=n+Math.imul(A,eg)|0)+(s>>>13)|0)+(eP>>>26)|0,eP&=67108863,i=Math.imul(U,en),s=(s=Math.imul(U,eo))+Math.imul(z,en)|0,n=Math.imul(z,eo),i=i+Math.imul(k,ec)|0,s=(s=s+Math.imul(k,el)|0)+Math.imul(j,ec)|0,n=n+Math.imul(j,el)|0,i=i+Math.imul(T,eu)|0,s=(s=s+Math.imul(T,ed)|0)+Math.imul(D,eu)|0,n=n+Math.imul(D,ed)|0;var ex=(l+(i=i+Math.imul(M,ef)|0)|0)+((8191&(s=(s=s+Math.imul(M,eg)|0)+Math.imul(P,ef)|0))<<13)|0;l=((n=n+Math.imul(P,eg)|0)+(s>>>13)|0)+(ex>>>26)|0,ex&=67108863,i=Math.imul(U,ec),s=(s=Math.imul(U,el))+Math.imul(z,ec)|0,n=Math.imul(z,el),i=i+Math.imul(k,eu)|0,s=(s=s+Math.imul(k,ed)|0)+Math.imul(j,eu)|0,n=n+Math.imul(j,ed)|0;var eT=(l+(i=i+Math.imul(T,ef)|0)|0)+((8191&(s=(s=s+Math.imul(T,eg)|0)+Math.imul(D,ef)|0))<<13)|0;l=((n=n+Math.imul(D,eg)|0)+(s>>>13)|0)+(eT>>>26)|0,eT&=67108863,i=Math.imul(U,eu),s=(s=Math.imul(U,ed))+Math.imul(z,eu)|0,n=Math.imul(z,ed);var eD=(l+(i=i+Math.imul(k,ef)|0)|0)+((8191&(s=(s=s+Math.imul(k,eg)|0)+Math.imul(j,ef)|0))<<13)|0;l=((n=n+Math.imul(j,eg)|0)+(s>>>13)|0)+(eD>>>26)|0,eD&=67108863;var eR=(l+(i=Math.imul(U,ef))|0)+((8191&(s=(s=Math.imul(U,eg))+Math.imul(z,ef)|0))<<13)|0;return l=((n=Math.imul(z,eg))+(s>>>13)|0)+(eR>>>26)|0,eR&=67108863,c[0]=em,c[1]=ey,c[2]=eb,c[3]=ew,c[4]=ev,c[5]=eE,c[6]=eI,c[7]=e_,c[8]=eC,c[9]=eS,c[10]=eN,c[11]=eA,c[12]=eO,c[13]=eM,c[14]=eP,c[15]=ex,c[16]=eT,c[17]=eD,c[18]=eR,0!==l&&(c[19]=l,r.length++),r};function g(e,t,r){return new m().mulp(e,t,r)}function m(e,t){this.x=e,this.y=t}Math.imul||(f=p),n.prototype.mulTo=function(e,t){var r=this.length+e.length;return 10===this.length&&10===e.length?f(this,e,t):r<63?p(this,e,t):r<1024?function(e,t,r){r.negative=t.negative^e.negative,r.length=e.length+t.length;for(var i=0,s=0,n=0;n<r.length-1;n++){var o=s;s=0;for(var a=67108863&i,c=Math.min(n,t.length-1),l=Math.max(0,n-e.length+1);l<=c;l++){var h=n-l,u=(0|e.words[h])*(0|t.words[l]),d=67108863&u;o=o+(u/67108864|0)|0,a=67108863&(d=d+a|0),s+=(o=o+(d>>>26)|0)>>>26,o&=67108863}r.words[n]=a,i=o,o=s}return 0!==i?r.words[n]=i:r.length--,r.strip()}(this,e,t):g(this,e,t)},m.prototype.makeRBT=function(e){for(var t=Array(e),r=n.prototype._countBits(e)-1,i=0;i<e;i++)t[i]=this.revBin(i,r,e);return t},m.prototype.revBin=function(e,t,r){if(0===e||e===r-1)return e;for(var i=0,s=0;s<t;s++)i|=(1&e)<<t-s-1,e>>=1;return i},m.prototype.permute=function(e,t,r,i,s,n){for(var o=0;o<n;o++)i[o]=t[e[o]],s[o]=r[e[o]]},m.prototype.transform=function(e,t,r,i,s,n){this.permute(n,e,t,r,i,s);for(var o=1;o<s;o<<=1)for(var a=o<<1,c=Math.cos(2*Math.PI/a),l=Math.sin(2*Math.PI/a),h=0;h<s;h+=a)for(var u=c,d=l,p=0;p<o;p++){var f=r[h+p],g=i[h+p],m=r[h+p+o],y=i[h+p+o],b=u*m-d*y;y=u*y+d*m,m=b,r[h+p]=f+m,i[h+p]=g+y,r[h+p+o]=f-m,i[h+p+o]=g-y,p!==a&&(b=c*u-l*d,d=c*d+l*u,u=b)}},m.prototype.guessLen13b=function(e,t){var r=1|Math.max(t,e),i=1&r,s=0;for(r=r/2|0;r;r>>>=1)s++;return 1<<s+1+i},m.prototype.conjugate=function(e,t,r){if(!(r<=1))for(var i=0;i<r/2;i++){var s=e[i];e[i]=e[r-i-1],e[r-i-1]=s,s=t[i],t[i]=-t[r-i-1],t[r-i-1]=-s}},m.prototype.normalize13b=function(e,t){for(var r=0,i=0;i<t/2;i++){var s=8192*Math.round(e[2*i+1]/t)+Math.round(e[2*i]/t)+r;e[i]=67108863&s,r=s<67108864?0:s/67108864|0}return e},m.prototype.convert13b=function(e,t,r,s){for(var n=0,o=0;o<t;o++)n+=0|e[o],r[2*o]=8191&n,n>>>=13,r[2*o+1]=8191&n,n>>>=13;for(o=2*t;o<s;++o)r[o]=0;i(0===n),i((-8192&n)==0)},m.prototype.stub=function(e){for(var t=Array(e),r=0;r<e;r++)t[r]=0;return t},m.prototype.mulp=function(e,t,r){var i=2*this.guessLen13b(e.length,t.length),s=this.makeRBT(i),n=this.stub(i),o=Array(i),a=Array(i),c=Array(i),l=Array(i),h=Array(i),u=Array(i),d=r.words;d.length=i,this.convert13b(e.words,e.length,o,i),this.convert13b(t.words,t.length,l,i),this.transform(o,n,a,c,i,s),this.transform(l,n,h,u,i,s);for(var p=0;p<i;p++){var f=a[p]*h[p]-c[p]*u[p];c[p]=a[p]*u[p]+c[p]*h[p],a[p]=f}return this.conjugate(a,c,i),this.transform(a,c,d,n,i,s),this.conjugate(d,n,i),this.normalize13b(d,i),r.negative=e.negative^t.negative,r.length=e.length+t.length,r.strip()},n.prototype.mul=function(e){var t=new n(null);return t.words=Array(this.length+e.length),this.mulTo(e,t)},n.prototype.mulf=function(e){var t=new n(null);return t.words=Array(this.length+e.length),g(this,e,t)},n.prototype.imul=function(e){return this.clone().mulTo(e,this)},n.prototype.imuln=function(e){i("number"==typeof e),i(e<67108864);for(var t=0,r=0;r<this.length;r++){var s=(0|this.words[r])*e,n=(67108863&s)+(67108863&t);t>>=26,t+=(s/67108864|0)+(n>>>26),this.words[r]=67108863&n}return 0!==t&&(this.words[r]=t,this.length++),this.length=0===e?1:this.length,this},n.prototype.muln=function(e){return this.clone().imuln(e)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this.clone())},n.prototype.pow=function(e){var t=function(e){for(var t=Array(e.bitLength()),r=0;r<t.length;r++){var i=r/26|0,s=r%26;t[r]=(e.words[i]&1<<s)>>>s}return t}(e);if(0===t.length)return new n(1);for(var r=this,i=0;i<t.length&&0===t[i];i++,r=r.sqr());if(++i<t.length)for(var s=r.sqr();i<t.length;i++,s=s.sqr())0!==t[i]&&(r=r.mul(s));return r},n.prototype.iushln=function(e){i("number"==typeof e&&e>=0);var t,r=e%26,s=(e-r)/26,n=67108863>>>26-r<<26-r;if(0!==r){var o=0;for(t=0;t<this.length;t++){var a=this.words[t]&n,c=(0|this.words[t])-a<<r;this.words[t]=c|o,o=a>>>26-r}o&&(this.words[t]=o,this.length++)}if(0!==s){for(t=this.length-1;t>=0;t--)this.words[t+s]=this.words[t];for(t=0;t<s;t++)this.words[t]=0;this.length+=s}return this.strip()},n.prototype.ishln=function(e){return i(0===this.negative),this.iushln(e)},n.prototype.iushrn=function(e,t,r){i("number"==typeof e&&e>=0),s=t?(t-t%26)/26:0;var s,n=e%26,o=Math.min((e-n)/26,this.length),a=67108863^67108863>>>n<<n;if(s-=o,s=Math.max(0,s),r){for(var c=0;c<o;c++)r.words[c]=this.words[c];r.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=s);c--){var h=0|this.words[c];this.words[c]=l<<26-n|h>>>n,l=h&a}return r&&0!==l&&(r.words[r.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},n.prototype.ishrn=function(e,t,r){return i(0===this.negative),this.iushrn(e,t,r)},n.prototype.shln=function(e){return this.clone().ishln(e)},n.prototype.ushln=function(e){return this.clone().iushln(e)},n.prototype.shrn=function(e){return this.clone().ishrn(e)},n.prototype.ushrn=function(e){return this.clone().iushrn(e)},n.prototype.testn=function(e){i("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;return!(this.length<=r)&&!!(this.words[r]&1<<t)},n.prototype.imaskn=function(e){i("number"==typeof e&&e>=0);var t=e%26,r=(e-t)/26;return(i(0===this.negative,"imaskn works only with positive numbers"),this.length<=r)?this:(0!==t&&r++,this.length=Math.min(r,this.length),0!==t&&(this.words[this.length-1]&=67108863^67108863>>>t<<t),this.strip())},n.prototype.maskn=function(e){return this.clone().imaskn(e)},n.prototype.iaddn=function(e){return(i("number"==typeof e),i(e<67108864),e<0)?this.isubn(-e):0!==this.negative?(1===this.length&&(0|this.words[0])<e?(this.words[0]=e-(0|this.words[0]),this.negative=0):(this.negative=0,this.isubn(e),this.negative=1),this):this._iaddn(e)},n.prototype._iaddn=function(e){this.words[0]+=e;for(var t=0;t<this.length&&this.words[t]>=67108864;t++)this.words[t]-=67108864,t===this.length-1?this.words[t+1]=1:this.words[t+1]++;return this.length=Math.max(this.length,t+1),this},n.prototype.isubn=function(e){if(i("number"==typeof e),i(e<67108864),e<0)return this.iaddn(-e);if(0!==this.negative)return this.negative=0,this.iaddn(e),this.negative=1,this;if(this.words[0]-=e,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var t=0;t<this.length&&this.words[t]<0;t++)this.words[t]+=67108864,this.words[t+1]-=1;return this.strip()},n.prototype.addn=function(e){return this.clone().iaddn(e)},n.prototype.subn=function(e){return this.clone().isubn(e)},n.prototype.iabs=function(){return this.negative=0,this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._ishlnsubmul=function(e,t,r){var s,n,o=e.length+r;this._expand(o);var a=0;for(s=0;s<e.length;s++){n=(0|this.words[s+r])+a;var c=(0|e.words[s])*t;n-=67108863&c,a=(n>>26)-(c/67108864|0),this.words[s+r]=67108863&n}for(;s<this.length-r;s++)a=(n=(0|this.words[s+r])+a)>>26,this.words[s+r]=67108863&n;if(0===a)return this.strip();for(i(-1===a),a=0,s=0;s<this.length;s++)a=(n=-(0|this.words[s])+a)>>26,this.words[s]=67108863&n;return this.negative=1,this.strip()},n.prototype._wordDiv=function(e,t){var r,i=this.length-e.length,s=this.clone(),o=e,a=0|o.words[o.length-1];0!=(i=26-this._countBits(a))&&(o=o.ushln(i),s.iushln(i),a=0|o.words[o.length-1]);var c=s.length-o.length;if("mod"!==t){(r=new n(null)).length=c+1,r.words=Array(r.length);for(var l=0;l<r.length;l++)r.words[l]=0}var h=s.clone()._ishlnsubmul(o,1,c);0===h.negative&&(s=h,r&&(r.words[c]=1));for(var u=c-1;u>=0;u--){var d=(0|s.words[o.length+u])*67108864+(0|s.words[o.length+u-1]);for(d=Math.min(d/a|0,67108863),s._ishlnsubmul(o,d,u);0!==s.negative;)d--,s.negative=0,s._ishlnsubmul(o,1,u),s.isZero()||(s.negative^=1);r&&(r.words[u]=d)}return r&&r.strip(),s.strip(),"div"!==t&&0!==i&&s.iushrn(i),{div:r||null,mod:s}},n.prototype.divmod=function(e,t,r){var s,o,a;return(i(!e.isZero()),this.isZero())?{div:new n(0),mod:new n(0)}:0!==this.negative&&0===e.negative?(a=this.neg().divmod(e,t),"mod"!==t&&(s=a.div.neg()),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.iadd(e)),{div:s,mod:o}):0===this.negative&&0!==e.negative?(a=this.divmod(e.neg(),t),"mod"!==t&&(s=a.div.neg()),{div:s,mod:a.mod}):(this.negative&e.negative)!=0?(a=this.neg().divmod(e.neg(),t),"div"!==t&&(o=a.mod.neg(),r&&0!==o.negative&&o.isub(e)),{div:a.div,mod:o}):e.length>this.length||0>this.cmp(e)?{div:new n(0),mod:this}:1===e.length?"div"===t?{div:this.divn(e.words[0]),mod:null}:"mod"===t?{div:null,mod:new n(this.modn(e.words[0]))}:{div:this.divn(e.words[0]),mod:new n(this.modn(e.words[0]))}:this._wordDiv(e,t)},n.prototype.div=function(e){return this.divmod(e,"div",!1).div},n.prototype.mod=function(e){return this.divmod(e,"mod",!1).mod},n.prototype.umod=function(e){return this.divmod(e,"mod",!0).mod},n.prototype.divRound=function(e){var t=this.divmod(e);if(t.mod.isZero())return t.div;var r=0!==t.div.negative?t.mod.isub(e):t.mod,i=e.ushrn(1),s=e.andln(1),n=r.cmp(i);return n<0||1===s&&0===n?t.div:0!==t.div.negative?t.div.isubn(1):t.div.iaddn(1)},n.prototype.modn=function(e){i(e<=67108863);for(var t=67108864%e,r=0,s=this.length-1;s>=0;s--)r=(t*r+(0|this.words[s]))%e;return r},n.prototype.idivn=function(e){i(e<=67108863);for(var t=0,r=this.length-1;r>=0;r--){var s=(0|this.words[r])+67108864*t;this.words[r]=s/e|0,t=s%e}return this.strip()},n.prototype.divn=function(e){return this.clone().idivn(e)},n.prototype.egcd=function(e){i(0===e.negative),i(!e.isZero());var t=this,r=e.clone();t=0!==t.negative?t.umod(e):t.clone();for(var s=new n(1),o=new n(0),a=new n(0),c=new n(1),l=0;t.isEven()&&r.isEven();)t.iushrn(1),r.iushrn(1),++l;for(var h=r.clone(),u=t.clone();!t.isZero();){for(var d=0,p=1;(t.words[0]&p)==0&&d<26;++d,p<<=1);if(d>0)for(t.iushrn(d);d-- >0;)(s.isOdd()||o.isOdd())&&(s.iadd(h),o.isub(u)),s.iushrn(1),o.iushrn(1);for(var f=0,g=1;(r.words[0]&g)==0&&f<26;++f,g<<=1);if(f>0)for(r.iushrn(f);f-- >0;)(a.isOdd()||c.isOdd())&&(a.iadd(h),c.isub(u)),a.iushrn(1),c.iushrn(1);t.cmp(r)>=0?(t.isub(r),s.isub(a),o.isub(c)):(r.isub(t),a.isub(s),c.isub(o))}return{a:a,b:c,gcd:r.iushln(l)}},n.prototype._invmp=function(e){i(0===e.negative),i(!e.isZero());var t,r=this,s=e.clone();r=0!==r.negative?r.umod(e):r.clone();for(var o=new n(1),a=new n(0),c=s.clone();r.cmpn(1)>0&&s.cmpn(1)>0;){for(var l=0,h=1;(r.words[0]&h)==0&&l<26;++l,h<<=1);if(l>0)for(r.iushrn(l);l-- >0;)o.isOdd()&&o.iadd(c),o.iushrn(1);for(var u=0,d=1;(s.words[0]&d)==0&&u<26;++u,d<<=1);if(u>0)for(s.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(c),a.iushrn(1);r.cmp(s)>=0?(r.isub(s),o.isub(a)):(s.isub(r),a.isub(o))}return 0>(t=0===r.cmpn(1)?o:a).cmpn(0)&&t.iadd(e),t},n.prototype.gcd=function(e){if(this.isZero())return e.abs();if(e.isZero())return this.abs();var t=this.clone(),r=e.clone();t.negative=0,r.negative=0;for(var i=0;t.isEven()&&r.isEven();i++)t.iushrn(1),r.iushrn(1);for(;;){for(;t.isEven();)t.iushrn(1);for(;r.isEven();)r.iushrn(1);var s=t.cmp(r);if(s<0){var n=t;t=r,r=n}else if(0===s||0===r.cmpn(1))break;t.isub(r)}return r.iushln(i)},n.prototype.invm=function(e){return this.egcd(e).a.umod(e)},n.prototype.isEven=function(){return(1&this.words[0])==0},n.prototype.isOdd=function(){return(1&this.words[0])==1},n.prototype.andln=function(e){return this.words[0]&e},n.prototype.bincn=function(e){i("number"==typeof e);var t=e%26,r=(e-t)/26,s=1<<t;if(this.length<=r)return this._expand(r+1),this.words[r]|=s,this;for(var n=s,o=r;0!==n&&o<this.length;o++){var a=0|this.words[o];a+=n,n=a>>>26,a&=67108863,this.words[o]=a}return 0!==n&&(this.words[o]=n,this.length++),this},n.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},n.prototype.cmpn=function(e){var t,r=e<0;if(0!==this.negative&&!r)return -1;if(0===this.negative&&r)return 1;if(this.strip(),this.length>1)t=1;else{r&&(e=-e),i(e<=67108863,"Number is too big");var s=0|this.words[0];t=s===e?0:s<e?-1:1}return 0!==this.negative?0|-t:t},n.prototype.cmp=function(e){if(0!==this.negative&&0===e.negative)return -1;if(0===this.negative&&0!==e.negative)return 1;var t=this.ucmp(e);return 0!==this.negative?0|-t:t},n.prototype.ucmp=function(e){if(this.length>e.length)return 1;if(this.length<e.length)return -1;for(var t=0,r=this.length-1;r>=0;r--){var i=0|this.words[r],s=0|e.words[r];if(i!==s){i<s?t=-1:i>s&&(t=1);break}}return t},n.prototype.gtn=function(e){return 1===this.cmpn(e)},n.prototype.gt=function(e){return 1===this.cmp(e)},n.prototype.gten=function(e){return this.cmpn(e)>=0},n.prototype.gte=function(e){return this.cmp(e)>=0},n.prototype.ltn=function(e){return -1===this.cmpn(e)},n.prototype.lt=function(e){return -1===this.cmp(e)},n.prototype.lten=function(e){return 0>=this.cmpn(e)},n.prototype.lte=function(e){return 0>=this.cmp(e)},n.prototype.eqn=function(e){return 0===this.cmpn(e)},n.prototype.eq=function(e){return 0===this.cmp(e)},n.red=function(e){return new _(e)},n.prototype.toRed=function(e){return i(!this.red,"Already a number in reduction context"),i(0===this.negative,"red works only with positives"),e.convertTo(this)._forceRed(e)},n.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},n.prototype._forceRed=function(e){return this.red=e,this},n.prototype.forceRed=function(e){return i(!this.red,"Already a number in reduction context"),this._forceRed(e)},n.prototype.redAdd=function(e){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,e)},n.prototype.redIAdd=function(e){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,e)},n.prototype.redSub=function(e){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,e)},n.prototype.redISub=function(e){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,e)},n.prototype.redShl=function(e){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,e)},n.prototype.redMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.mul(this,e)},n.prototype.redIMul=function(e){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,e),this.red.imul(this,e)},n.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},n.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},n.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},n.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},n.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},n.prototype.redPow=function(e){return i(this.red&&!e.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,e)};var y={k256:null,p224:null,p192:null,p25519:null};function b(e,t){this.name=e,this.p=new n(t,16),this.n=this.p.bitLength(),this.k=new n(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){b.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){b.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function E(){b.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function I(){b.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function _(e){if("string"==typeof e){var t=n._prime(e);this.m=t.p,this.prime=t}else i(e.gtn(1),"modulus must be greater than 1"),this.m=e,this.prime=null}function C(e){_.call(this,e),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new n(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}b.prototype._tmp=function(){var e=new n(null);return e.words=Array(Math.ceil(this.n/13)),e},b.prototype.ireduce=function(e){var t,r=e;do this.split(r,this.tmp),t=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength();while(t>this.n);var i=t<this.n?-1:r.ucmp(this.p);return 0===i?(r.words[0]=0,r.length=1):i>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},b.prototype.split=function(e,t){e.iushrn(this.n,0,t)},b.prototype.imulK=function(e){return e.imul(this.k)},s(w,b),w.prototype.split=function(e,t){for(var r=Math.min(e.length,9),i=0;i<r;i++)t.words[i]=e.words[i];if(t.length=r,e.length<=9){e.words[0]=0,e.length=1;return}var s=e.words[9];for(i=10,t.words[t.length++]=4194303&s;i<e.length;i++){var n=0|e.words[i];e.words[i-10]=(4194303&n)<<4|s>>>22,s=n}s>>>=22,e.words[i-10]=s,0===s&&e.length>10?e.length-=10:e.length-=9},w.prototype.imulK=function(e){e.words[e.length]=0,e.words[e.length+1]=0,e.length+=2;for(var t=0,r=0;r<e.length;r++){var i=0|e.words[r];t+=977*i,e.words[r]=67108863&t,t=64*i+(t/67108864|0)}return 0===e.words[e.length-1]&&(e.length--,0===e.words[e.length-1]&&e.length--),e},s(v,b),s(E,b),s(I,b),I.prototype.imulK=function(e){for(var t=0,r=0;r<e.length;r++){var i=(0|e.words[r])*19+t,s=67108863&i;i>>>=26,e.words[r]=s,t=i}return 0!==t&&(e.words[e.length++]=t),e},n._prime=function(e){var t;if(y[e])return y[e];if("k256"===e)t=new w;else if("p224"===e)t=new v;else if("p192"===e)t=new E;else if("p25519"===e)t=new I;else throw Error("Unknown prime "+e);return y[e]=t,t},_.prototype._verify1=function(e){i(0===e.negative,"red works only with positives"),i(e.red,"red works only with red numbers")},_.prototype._verify2=function(e,t){i((e.negative|t.negative)==0,"red works only with positives"),i(e.red&&e.red===t.red,"red works only with red numbers")},_.prototype.imod=function(e){return this.prime?this.prime.ireduce(e)._forceRed(this):e.umod(this.m)._forceRed(this)},_.prototype.neg=function(e){return e.isZero()?e.clone():this.m.sub(e)._forceRed(this)},_.prototype.add=function(e,t){this._verify2(e,t);var r=e.add(t);return r.cmp(this.m)>=0&&r.isub(this.m),r._forceRed(this)},_.prototype.iadd=function(e,t){this._verify2(e,t);var r=e.iadd(t);return r.cmp(this.m)>=0&&r.isub(this.m),r},_.prototype.sub=function(e,t){this._verify2(e,t);var r=e.sub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r._forceRed(this)},_.prototype.isub=function(e,t){this._verify2(e,t);var r=e.isub(t);return 0>r.cmpn(0)&&r.iadd(this.m),r},_.prototype.shl=function(e,t){return this._verify1(e),this.imod(e.ushln(t))},_.prototype.imul=function(e,t){return this._verify2(e,t),this.imod(e.imul(t))},_.prototype.mul=function(e,t){return this._verify2(e,t),this.imod(e.mul(t))},_.prototype.isqr=function(e){return this.imul(e,e.clone())},_.prototype.sqr=function(e){return this.mul(e,e)},_.prototype.sqrt=function(e){if(e.isZero())return e.clone();var t=this.m.andln(3);if(i(t%2==1),3===t){var r=this.m.add(new n(1)).iushrn(2);return this.pow(e,r)}for(var s=this.m.subn(1),o=0;!s.isZero()&&0===s.andln(1);)o++,s.iushrn(1);i(!s.isZero());var a=new n(1).toRed(this),c=a.redNeg(),l=this.m.subn(1).iushrn(1),h=this.m.bitLength();for(h=new n(2*h*h).toRed(this);0!==this.pow(h,l).cmp(c);)h.redIAdd(c);for(var u=this.pow(h,s),d=this.pow(e,s.addn(1).iushrn(1)),p=this.pow(e,s),f=o;0!==p.cmp(a);){for(var g=p,m=0;0!==g.cmp(a);m++)g=g.redSqr();i(m<f);var y=this.pow(u,new n(1).iushln(f-m-1));d=d.redMul(y),u=y.redSqr(),p=p.redMul(u),f=m}return d},_.prototype.invm=function(e){var t=e._invmp(this.m);return 0!==t.negative?(t.negative=0,this.imod(t).redNeg()):this.imod(t)},_.prototype.pow=function(e,t){if(t.isZero())return new n(1).toRed(this);if(0===t.cmpn(1))return e.clone();var r=Array(16);r[0]=new n(1).toRed(this),r[1]=e;for(var i=2;i<r.length;i++)r[i]=this.mul(r[i-1],e);var s=r[0],o=0,a=0,c=t.bitLength()%26;for(0===c&&(c=26),i=t.length-1;i>=0;i--){for(var l=t.words[i],h=c-1;h>=0;h--){var u=l>>h&1;if(s!==r[0]&&(s=this.sqr(s)),0===u&&0===o){a=0;continue}o<<=1,o|=u,(4==++a||0===i&&0===h)&&(s=this.mul(s,r[o]),a=0,o=0)}c=26}return s},_.prototype.convertTo=function(e){var t=e.umod(this.m);return t===e?t.clone():t},_.prototype.convertFrom=function(e){var t=e.clone();return t.red=null,t},n.mont=function(e){return new C(e)},s(C,_),C.prototype.convertTo=function(e){return this.imod(e.ushln(this.shift))},C.prototype.convertFrom=function(e){var t=this.imod(e.mul(this.rinv));return t.red=null,t},C.prototype.imul=function(e,t){if(e.isZero()||t.isZero())return e.words[0]=0,e.length=1,e;var r=e.imul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),n=s;return s.cmp(this.m)>=0?n=s.isub(this.m):0>s.cmpn(0)&&(n=s.iadd(this.m)),n._forceRed(this)},C.prototype.mul=function(e,t){if(e.isZero()||t.isZero())return new n(0)._forceRed(this);var r=e.mul(t),i=r.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),s=r.isub(i).iushrn(this.shift),o=s;return s.cmp(this.m)>=0?o=s.isub(this.m):0>s.cmpn(0)&&(o=s.iadd(this.m)),o._forceRed(this)},C.prototype.invm=function(e){return this.imod(e._invmp(this.m).mul(this.r2))._forceRed(this)}}(e=r.nmd(e),this)},55445:function(e){"use strict";var t,r="object"==typeof Reflect?Reflect:null,i=r&&"function"==typeof r.apply?r.apply:function(e,t,r){return Function.prototype.apply.call(e,t,r)};t=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var s=Number.isNaN||function(e){return e!=e};function n(){n.init.call(this)}e.exports=n,e.exports.once=function(e,t){return new Promise(function(r,i){var s;function n(r){e.removeListener(t,o),i(r)}function o(){"function"==typeof e.removeListener&&e.removeListener("error",n),r([].slice.call(arguments))}g(e,t,o,{once:!0}),"error"!==t&&(s={once:!0},"function"==typeof e.on&&g(e,"error",n,s))})},n.EventEmitter=n,n.prototype._events=void 0,n.prototype._eventsCount=0,n.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!=typeof e)throw TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function c(e){return void 0===e._maxListeners?n.defaultMaxListeners:e._maxListeners}function l(e,t,r,i){if(a(r),void 0===(n=e._events)?(n=e._events=Object.create(null),e._eventsCount=0):(void 0!==n.newListener&&(e.emit("newListener",t,r.listener?r.listener:r),n=e._events),o=n[t]),void 0===o)o=n[t]=r,++e._eventsCount;else if("function"==typeof o?o=n[t]=i?[r,o]:[o,r]:i?o.unshift(r):o.push(r),(s=c(e))>0&&o.length>s&&!o.warned){o.warned=!0;var s,n,o,l=Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=o.length,console&&console.warn&&console.warn(l)}return e}function h(){if(!this.fired)return(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0==arguments.length)?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,r){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},s=h.bind(i);return s.listener=r,i.wrapFn=s,s}function d(e,t,r){var i=e._events;if(void 0===i)return[];var s=i[t];return void 0===s?[]:"function"==typeof s?r?[s.listener||s]:[s]:r?function(e){for(var t=Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}(s):f(s,s.length)}function p(e){var t=this._events;if(void 0!==t){var r=t[e];if("function"==typeof r)return 1;if(void 0!==r)return r.length}return 0}function f(e,t){for(var r=Array(t),i=0;i<t;++i)r[i]=e[i];return r}function g(e,t,r,i){if("function"==typeof e.on)i.once?e.once(t,r):e.on(t,r);else if("function"==typeof e.addEventListener)e.addEventListener(t,function s(n){i.once&&e.removeEventListener(t,s),r(n)});else throw TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}Object.defineProperty(n,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!=typeof e||e<0||s(e))throw RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),n.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},n.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||s(e))throw RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},n.prototype.getMaxListeners=function(){return c(this)},n.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var s="error"===e,n=this._events;if(void 0!==n)s=s&&void 0===n.error;else if(!s)return!1;if(s){if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var o,a=Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var c=n[e];if(void 0===c)return!1;if("function"==typeof c)i(c,this,t);else for(var l=c.length,h=f(c,l),r=0;r<l;++r)i(h[r],this,t);return!0},n.prototype.addListener=function(e,t){return l(this,e,t,!1)},n.prototype.on=n.prototype.addListener,n.prototype.prependListener=function(e,t){return l(this,e,t,!0)},n.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},n.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},n.prototype.removeListener=function(e,t){var r,i,s,n,o;if(a(t),void 0===(i=this._events)||void 0===(r=i[e]))return this;if(r===t||r.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,r.listener||t));else if("function"!=typeof r){for(s=-1,n=r.length-1;n>=0;n--)if(r[n]===t||r[n].listener===t){o=r[n].listener,s=n;break}if(s<0)return this;0===s?r.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(r,s),1===r.length&&(i[e]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},n.prototype.off=n.prototype.removeListener,n.prototype.removeAllListeners=function(e){var t,r,i;if(void 0===(r=this._events))return this;if(void 0===r.removeListener)return 0==arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete r[e]),this;if(0==arguments.length){var s,n=Object.keys(r);for(i=0;i<n.length;++i)"removeListener"!==(s=n[i])&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=r[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},n.prototype.listeners=function(e){return d(this,e,!0)},n.prototype.rawListeners=function(e){return d(this,e,!1)},n.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):p.call(e,t)},n.prototype.listenerCount=p,n.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]}},28714:function(e,t,r){t.utils=r(20015),t.common=r(49351),t.sha=r(87647),t.ripemd=r(47826),t.hmac=r(53765),t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160},49351:function(e,t,r){"use strict";var i=r(20015),s=r(73045);function n(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}t.BlockHash=n,n.prototype.update=function(e,t){if(e=i.toArray(e,t),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){var r=(e=this.pending).length%this._delta8;this.pending=e.slice(e.length-r,e.length),0===this.pending.length&&(this.pending=null),e=i.join32(e,0,e.length-r,this.endian);for(var s=0;s<e.length;s+=this._delta32)this._update(e,s,s+this._delta32)}return this},n.prototype.digest=function(e){return this.update(this._pad()),s(null===this.pending),this._digest(e)},n.prototype._pad=function(){var e=this.pendingTotal,t=this._delta8,r=t-(e+this.padLength)%t,i=Array(r+this.padLength);i[0]=128;for(var s=1;s<r;s++)i[s]=0;if(e<<=3,"big"===this.endian){for(var n=8;n<this.padLength;n++)i[s++]=0;i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=e>>>24&255,i[s++]=e>>>16&255,i[s++]=e>>>8&255,i[s++]=255&e}else for(n=8,i[s++]=255&e,i[s++]=e>>>8&255,i[s++]=e>>>16&255,i[s++]=e>>>24&255,i[s++]=0,i[s++]=0,i[s++]=0,i[s++]=0;n<this.padLength;n++)i[s++]=0;return i}},53765:function(e,t,r){"use strict";var i=r(20015),s=r(73045);function n(e,t,r){if(!(this instanceof n))return new n(e,t,r);this.Hash=e,this.blockSize=e.blockSize/8,this.outSize=e.outSize/8,this.inner=null,this.outer=null,this._init(i.toArray(t,r))}e.exports=n,n.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),s(e.length<=this.blockSize);for(var t=e.length;t<this.blockSize;t++)e.push(0);for(t=0;t<e.length;t++)e[t]^=54;for(t=0,this.inner=new this.Hash().update(e);t<e.length;t++)e[t]^=106;this.outer=new this.Hash().update(e)},n.prototype.update=function(e,t){return this.inner.update(e,t),this},n.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}},47826:function(e,t,r){"use strict";var i=r(20015),s=r(49351),n=i.rotl32,o=i.sum32,a=i.sum32_3,c=i.sum32_4,l=s.BlockHash;function h(){if(!(this instanceof h))return new h;l.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function u(e,t,r,i){return e<=15?t^r^i:e<=31?t&r|~t&i:e<=47?(t|~r)^i:e<=63?t&i|r&~i:t^(r|~i)}i.inherits(h,l),t.ripemd160=h,h.blockSize=512,h.outSize=160,h.hmacStrength=192,h.padLength=64,h.prototype._update=function(e,t){for(var r=this.h[0],i=this.h[1],s=this.h[2],l=this.h[3],h=this.h[4],m=r,y=i,b=s,w=l,v=h,E=0;E<80;E++){var I,_,C=o(n(c(r,u(E,i,s,l),e[d[E]+t],(I=E)<=15?0:I<=31?1518500249:I<=47?1859775393:I<=63?2400959708:2840853838),f[E]),h);r=h,h=l,l=n(s,10),s=i,i=C,C=o(n(c(m,u(79-E,y,b,w),e[p[E]+t],(_=E)<=15?1352829926:_<=31?1548603684:_<=47?1836072691:_<=63?2053994217:0),g[E]),v),m=v,v=w,w=n(b,10),b=y,y=C}C=a(this.h[1],s,w),this.h[1]=a(this.h[2],l,v),this.h[2]=a(this.h[3],h,m),this.h[3]=a(this.h[4],r,y),this.h[4]=a(this.h[0],i,b),this.h[0]=C},h.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"little"):i.split32(this.h,"little")};var d=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],f=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],g=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},87647:function(e,t,r){"use strict";t.sha1=r(4684),t.sha224=r(45261),t.sha256=r(17795),t.sha384=r(84182),t.sha512=r(54358)},4684:function(e,t,r){"use strict";var i=r(20015),s=r(49351),n=r(31964),o=i.rotl32,a=i.sum32,c=i.sum32_5,l=n.ft_1,h=s.BlockHash,u=[1518500249,1859775393,2400959708,3395469782];function d(){if(!(this instanceof d))return new d;h.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=Array(80)}i.inherits(d,h),e.exports=d,d.blockSize=512,d.outSize=160,d.hmacStrength=80,d.padLength=64,d.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=o(r[i-3]^r[i-8]^r[i-14]^r[i-16],1);var s=this.h[0],n=this.h[1],h=this.h[2],d=this.h[3],p=this.h[4];for(i=0;i<r.length;i++){var f=~~(i/20),g=c(o(s,5),l(f,n,h,d),p,r[i],u[f]);p=d,d=h,h=o(n,30),n=s,s=g}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],n),this.h[2]=a(this.h[2],h),this.h[3]=a(this.h[3],d),this.h[4]=a(this.h[4],p)},d.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},45261:function(e,t,r){"use strict";var i=r(20015),s=r(17795);function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}i.inherits(n,s),e.exports=n,n.blockSize=512,n.outSize=224,n.hmacStrength=192,n.padLength=64,n.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,7),"big"):i.split32(this.h.slice(0,7),"big")}},17795:function(e,t,r){"use strict";var i=r(20015),s=r(49351),n=r(31964),o=r(73045),a=i.sum32,c=i.sum32_4,l=i.sum32_5,h=n.ch32,u=n.maj32,d=n.s0_256,p=n.s1_256,f=n.g0_256,g=n.g1_256,m=s.BlockHash,y=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function b(){if(!(this instanceof b))return new b;m.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=y,this.W=Array(64)}i.inherits(b,m),e.exports=b,b.blockSize=512,b.outSize=256,b.hmacStrength=192,b.padLength=64,b.prototype._update=function(e,t){for(var r=this.W,i=0;i<16;i++)r[i]=e[t+i];for(;i<r.length;i++)r[i]=c(g(r[i-2]),r[i-7],f(r[i-15]),r[i-16]);var s=this.h[0],n=this.h[1],m=this.h[2],y=this.h[3],b=this.h[4],w=this.h[5],v=this.h[6],E=this.h[7];for(o(this.k.length===r.length),i=0;i<r.length;i++){var I=l(E,p(b),h(b,w,v),this.k[i],r[i]),_=a(d(s),u(s,n,m));E=v,v=w,w=b,b=a(y,I),y=m,m=n,n=s,s=a(I,_)}this.h[0]=a(this.h[0],s),this.h[1]=a(this.h[1],n),this.h[2]=a(this.h[2],m),this.h[3]=a(this.h[3],y),this.h[4]=a(this.h[4],b),this.h[5]=a(this.h[5],w),this.h[6]=a(this.h[6],v),this.h[7]=a(this.h[7],E)},b.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},84182:function(e,t,r){"use strict";var i=r(20015),s=r(54358);function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}i.inherits(n,s),e.exports=n,n.blockSize=1024,n.outSize=384,n.hmacStrength=192,n.padLength=128,n.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h.slice(0,12),"big"):i.split32(this.h.slice(0,12),"big")}},54358:function(e,t,r){"use strict";var i=r(20015),s=r(49351),n=r(73045),o=i.rotr64_hi,a=i.rotr64_lo,c=i.shr64_hi,l=i.shr64_lo,h=i.sum64,u=i.sum64_hi,d=i.sum64_lo,p=i.sum64_4_hi,f=i.sum64_4_lo,g=i.sum64_5_hi,m=i.sum64_5_lo,y=s.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function w(){if(!(this instanceof w))return new w;y.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=Array(160)}i.inherits(w,y),e.exports=w,w.blockSize=1024,w.outSize=512,w.hmacStrength=192,w.padLength=128,w.prototype._prepareBlock=function(e,t){for(var r=this.W,i=0;i<32;i++)r[i]=e[t+i];for(;i<r.length;i+=2){var s=function(e,t){var r=o(e,t,19)^o(t,e,29)^c(e,t,6);return r<0&&(r+=4294967296),r}(r[i-4],r[i-3]),n=function(e,t){var r=a(e,t,19)^a(t,e,29)^l(e,t,6);return r<0&&(r+=4294967296),r}(r[i-4],r[i-3]),h=r[i-14],u=r[i-13],d=function(e,t){var r=o(e,t,1)^o(e,t,8)^c(e,t,7);return r<0&&(r+=4294967296),r}(r[i-30],r[i-29]),g=function(e,t){var r=a(e,t,1)^a(e,t,8)^l(e,t,7);return r<0&&(r+=4294967296),r}(r[i-30],r[i-29]),m=r[i-32],y=r[i-31];r[i]=p(s,n,h,u,d,g,m,y),r[i+1]=f(s,n,h,u,d,g,m,y)}},w.prototype._update=function(e,t){this._prepareBlock(e,t);var r=this.W,i=this.h[0],s=this.h[1],c=this.h[2],l=this.h[3],p=this.h[4],f=this.h[5],y=this.h[6],b=this.h[7],w=this.h[8],v=this.h[9],E=this.h[10],I=this.h[11],_=this.h[12],C=this.h[13],S=this.h[14],N=this.h[15];n(this.k.length===r.length);for(var A=0;A<r.length;A+=2){var O=S,M=N,P=function(e,t){var r=o(e,t,14)^o(e,t,18)^o(t,e,9);return r<0&&(r+=4294967296),r}(w,v),x=function(e,t){var r=a(e,t,14)^a(e,t,18)^a(t,e,9);return r<0&&(r+=4294967296),r}(w,v),T=function(e,t,r,i,s){var n=e&r^~e&s;return n<0&&(n+=4294967296),n}(w,0,E,0,_,C),D=function(e,t,r,i,s,n){var o=t&i^~t&n;return o<0&&(o+=4294967296),o}(0,v,0,I,0,C),R=this.k[A],k=this.k[A+1],j=r[A],L=r[A+1],U=g(O,M,P,x,T,D,R,k,j,L),z=m(O,M,P,x,T,D,R,k,j,L);O=function(e,t){var r=o(e,t,28)^o(t,e,2)^o(t,e,7);return r<0&&(r+=4294967296),r}(i,s);var $=u(O,M=function(e,t){var r=a(e,t,28)^a(t,e,2)^a(t,e,7);return r<0&&(r+=4294967296),r}(i,s),P=function(e,t,r,i,s){var n=e&r^e&s^r&s;return n<0&&(n+=4294967296),n}(i,0,c,0,p,f),x=function(e,t,r,i,s,n){var o=t&i^t&n^i&n;return o<0&&(o+=4294967296),o}(0,s,0,l,0,f)),q=d(O,M,P,x);S=_,N=C,_=E,C=I,E=w,I=v,w=u(y,b,U,z),v=d(b,b,U,z),y=p,b=f,p=c,f=l,c=i,l=s,i=u(U,z,$,q),s=d(U,z,$,q)}h(this.h,0,i,s),h(this.h,2,c,l),h(this.h,4,p,f),h(this.h,6,y,b),h(this.h,8,w,v),h(this.h,10,E,I),h(this.h,12,_,C),h(this.h,14,S,N)},w.prototype._digest=function(e){return"hex"===e?i.toHex32(this.h,"big"):i.split32(this.h,"big")}},31964:function(e,t,r){"use strict";var i=r(20015).rotr32;function s(e,t,r){return e&t^e&r^t&r}t.ft_1=function(e,t,r,i){return 0===e?t&r^~t&i:1===e||3===e?t^r^i:2===e?s(t,r,i):void 0},t.ch32=function(e,t,r){return e&t^~e&r},t.maj32=s,t.p32=function(e,t,r){return e^t^r},t.s0_256=function(e){return i(e,2)^i(e,13)^i(e,22)},t.s1_256=function(e){return i(e,6)^i(e,11)^i(e,25)},t.g0_256=function(e){return i(e,7)^i(e,18)^e>>>3},t.g1_256=function(e){return i(e,17)^i(e,19)^e>>>10}},20015:function(e,t,r){"use strict";var i=r(73045),s=r(56853);function n(e){return(e>>>24|e>>>8&65280|e<<8&16711680|(255&e)<<24)>>>0}function o(e){return 1===e.length?"0"+e:e}function a(e){if(7===e.length)return"0"+e;if(6===e.length)return"00"+e;if(5===e.length)return"000"+e;if(4===e.length)return"0000"+e;if(3===e.length)return"00000"+e;if(2===e.length)return"000000"+e;if(1===e.length)return"0000000"+e;else return e}t.inherits=s,t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"==typeof e){if(t){if("hex"===t)for((e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e),s=0;s<e.length;s+=2)r.push(parseInt(e[s]+e[s+1],16))}else for(var i=0,s=0;s<e.length;s++){var n,o,a=e.charCodeAt(s);a<128?r[i++]=a:(a<2048?r[i++]=a>>6|192:((n=e,o=s,(64512&n.charCodeAt(o))!=55296||o<0||o+1>=n.length?1:(64512&n.charCodeAt(o+1))!=56320)?r[i++]=a>>12|224:(a=65536+((1023&a)<<10)+(1023&e.charCodeAt(++s)),r[i++]=a>>18|240,r[i++]=a>>12&63|128),r[i++]=a>>6&63|128),r[i++]=63&a|128)}}else for(s=0;s<e.length;s++)r[s]=0|e[s];return r},t.toHex=function(e){for(var t="",r=0;r<e.length;r++)t+=o(e[r].toString(16));return t},t.htonl=n,t.toHex32=function(e,t){for(var r="",i=0;i<e.length;i++){var s=e[i];"little"===t&&(s=n(s)),r+=a(s.toString(16))}return r},t.zero2=o,t.zero8=a,t.join32=function(e,t,r,s){var n,o=r-t;i(o%4==0);for(var a=Array(o/4),c=0,l=t;c<a.length;c++,l+=4)n="big"===s?e[l]<<24|e[l+1]<<16|e[l+2]<<8|e[l+3]:e[l+3]<<24|e[l+2]<<16|e[l+1]<<8|e[l],a[c]=n>>>0;return a},t.split32=function(e,t){for(var r=Array(4*e.length),i=0,s=0;i<e.length;i++,s+=4){var n=e[i];"big"===t?(r[s]=n>>>24,r[s+1]=n>>>16&255,r[s+2]=n>>>8&255,r[s+3]=255&n):(r[s+3]=n>>>24,r[s+2]=n>>>16&255,r[s+1]=n>>>8&255,r[s]=255&n)}return r},t.rotr32=function(e,t){return e>>>t|e<<32-t},t.rotl32=function(e,t){return e<<t|e>>>32-t},t.sum32=function(e,t){return e+t>>>0},t.sum32_3=function(e,t,r){return e+t+r>>>0},t.sum32_4=function(e,t,r,i){return e+t+r+i>>>0},t.sum32_5=function(e,t,r,i,s){return e+t+r+i+s>>>0},t.sum64=function(e,t,r,i){var s=e[t],n=i+e[t+1]>>>0;e[t]=(n<i?1:0)+r+s>>>0,e[t+1]=n},t.sum64_hi=function(e,t,r,i){return(t+i>>>0<t?1:0)+e+r>>>0},t.sum64_lo=function(e,t,r,i){return t+i>>>0},t.sum64_4_hi=function(e,t,r,i,s,n,o,a){var c,l=t;return e+r+s+o+(0+((l=l+i>>>0)<t?1:0)+((l=l+n>>>0)<n?1:0)+((l=l+a>>>0)<a?1:0))>>>0},t.sum64_4_lo=function(e,t,r,i,s,n,o,a){return t+i+n+a>>>0},t.sum64_5_hi=function(e,t,r,i,s,n,o,a,c,l){var h,u=t;return e+r+s+o+c+(0+((u=u+i>>>0)<t?1:0)+((u=u+n>>>0)<n?1:0)+((u=u+a>>>0)<a?1:0)+((u=u+l>>>0)<l?1:0))>>>0},t.sum64_5_lo=function(e,t,r,i,s,n,o,a,c,l){return t+i+n+a+l>>>0},t.rotr64_hi=function(e,t,r){return(t<<32-r|e>>>r)>>>0},t.rotr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0},t.shr64_hi=function(e,t,r){return e>>>r},t.shr64_lo=function(e,t,r){return(e<<32-r|t>>>r)>>>0}},28072:function(e,t,r){"use strict";var i=r(28714),s=r(83742),n=r(73045);function o(e){if(!(this instanceof o))return new o(e);this.hash=e.hash,this.predResist=!!e.predResist,this.outLen=this.hash.outSize,this.minEntropy=e.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=s.toArray(e.entropy,e.entropyEnc||"hex"),r=s.toArray(e.nonce,e.nonceEnc||"hex"),i=s.toArray(e.pers,e.persEnc||"hex");n(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,r,i)}e.exports=o,o.prototype._init=function(e,t,r){var i=e.concat(t).concat(r);this.K=Array(this.outLen/8),this.V=Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656},o.prototype._hmac=function(){return new i.hmac(this.hash,this.K)},o.prototype._update=function(e){var t=this._hmac().update(this.V).update([0]);e&&(t=t.update(e)),this.K=t.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())},o.prototype.reseed=function(e,t,r,i){"string"!=typeof t&&(i=r,r=t,t=null),e=s.toArray(e,t),r=s.toArray(r,i),n(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(r||[])),this._reseed=1},o.prototype.generate=function(e,t,r,i){if(this._reseed>this.reseedInterval)throw Error("Reseed is required");"string"!=typeof t&&(i=r,r=t,t=null),r&&(r=s.toArray(r,i||"hex"),this._update(r));for(var n=[];n.length<e;)this.V=this._hmac().update(this.V).digest(),n=n.concat(this.V);var o=n.slice(0,e);return this._update(r),this._reseed++,s.encode(o,t)}},56853:function(e){"function"==typeof Object.create?e.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function(e,t){if(t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}}},15586:function(e,t,r){e=r.nmd(e);var i,s,n,o="__lodash_hash_undefined__",a="[object Arguments]",c="[object Array]",l="[object Boolean]",h="[object Date]",u="[object Error]",d="[object Function]",p="[object Map]",f="[object Number]",g="[object Object]",m="[object Promise]",y="[object RegExp]",b="[object Set]",w="[object String]",v="[object WeakMap]",E="[object ArrayBuffer]",I="[object DataView]",_=/^\[object .+?Constructor\]$/,C=/^(?:0|[1-9]\d*)$/,S={};S["[object Float32Array]"]=S["[object Float64Array]"]=S["[object Int8Array]"]=S["[object Int16Array]"]=S["[object Int32Array]"]=S["[object Uint8Array]"]=S["[object Uint8ClampedArray]"]=S["[object Uint16Array]"]=S["[object Uint32Array]"]=!0,S[a]=S[c]=S[E]=S[l]=S[I]=S[h]=S[u]=S[d]=S[p]=S[f]=S[g]=S[y]=S[b]=S[w]=S[v]=!1;var N="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,A="object"==typeof self&&self&&self.Object===Object&&self,O=N||A||Function("return this")(),M=t&&!t.nodeType&&t,P=M&&e&&!e.nodeType&&e,x=P&&P.exports===M,T=x&&N.process,D=function(){try{return T&&T.binding&&T.binding("util")}catch(e){}}(),R=D&&D.isTypedArray;function k(e){var t=-1,r=Array(e.size);return e.forEach(function(e,i){r[++t]=[i,e]}),r}function j(e){var t=-1,r=Array(e.size);return e.forEach(function(e){r[++t]=e}),r}var L=Array.prototype,U=Function.prototype,z=Object.prototype,$=O["__core-js_shared__"],q=U.toString,B=z.hasOwnProperty,W=(i=/[^.]+$/.exec($&&$.keys&&$.keys.IE_PROTO||""))?"Symbol(src)_1."+i:"",H=z.toString,F=RegExp("^"+q.call(B).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),V=x?O.Buffer:void 0,K=O.Symbol,J=O.Uint8Array,Y=z.propertyIsEnumerable,G=L.splice,Q=K?K.toStringTag:void 0,Z=Object.getOwnPropertySymbols,X=V?V.isBuffer:void 0,ee=(s=Object.keys,n=Object,function(e){return s(n(e))}),et=eS(O,"DataView"),er=eS(O,"Map"),ei=eS(O,"Promise"),es=eS(O,"Set"),en=eS(O,"WeakMap"),eo=eS(Object,"create"),ea=eO(et),ec=eO(er),el=eO(ei),eh=eO(es),eu=eO(en),ed=K?K.prototype:void 0,ep=ed?ed.valueOf:void 0;function ef(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function eg(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function em(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function ey(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new em;++t<r;)this.add(e[t])}function eb(e){var t=this.__data__=new eg(e);this.size=t.size}function ew(e,t){for(var r=e.length;r--;)if(eM(e[r][0],t))return r;return -1}function ev(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Q&&Q in Object(e)?function(e){var t=B.call(e,Q),r=e[Q];try{e[Q]=void 0;var i=!0}catch(e){}var s=H.call(e);return i&&(t?e[Q]=r:delete e[Q]),s}(e):H.call(e)}function eE(e){return ej(e)&&ev(e)==a}function eI(e,t,r,i,s,n){var o=1&r,a=e.length,c=t.length;if(a!=c&&!(o&&c>a))return!1;var l=n.get(e);if(l&&n.get(t))return l==t;var h=-1,u=!0,d=2&r?new ey:void 0;for(n.set(e,t),n.set(t,e);++h<a;){var p=e[h],f=t[h];if(i)var g=o?i(f,p,h,t,e,n):i(p,f,h,e,t,n);if(void 0!==g){if(g)continue;u=!1;break}if(d){if(!function(e,t){for(var r=-1,i=null==e?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}(t,function(e,t){if(!d.has(t)&&(p===e||s(p,e,r,i,n)))return d.push(t)})){u=!1;break}}else if(!(p===f||s(p,f,r,i,n))){u=!1;break}}return n.delete(e),n.delete(t),u}function e_(e){var t;return t=function(e){return null!=e&&eR(e.length)&&!eD(e)?function(e,t){var r,i=ex(e),s=!i&&eP(e),n=!i&&!s&&eT(e),o=!i&&!s&&!n&&eL(e),a=i||s||n||o,c=a?function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}(e.length,String):[],l=c.length;for(var h in e)B.call(e,h)&&!(a&&("length"==h||n&&("offset"==h||"parent"==h)||o&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||(r=null==(r=l)?9007199254740991:r)&&("number"==typeof h||C.test(h))&&h>-1&&h%1==0&&h<r))&&c.push(h);return c}(e):function(e){if(t=e&&e.constructor,e!==("function"==typeof t&&t.prototype||z))return ee(e);var t,r=[];for(var i in Object(e))B.call(e,i)&&"constructor"!=i&&r.push(i);return r}(e)}(e),ex(e)?t:function(e,t){for(var r=-1,i=t.length,s=e.length;++r<i;)e[s+r]=t[r];return e}(t,eN(e))}function eC(e,t){var r,i=e.__data__;return("string"==(r=typeof t)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==t:null===t)?i["string"==typeof t?"string":"hash"]:i.map}function eS(e,t){var r=null==e?void 0:e[t];return!(!ek(r)||W&&W in r)&&(eD(r)?F:_).test(eO(r))?r:void 0}ef.prototype.clear=function(){this.__data__=eo?eo(null):{},this.size=0},ef.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},ef.prototype.get=function(e){var t=this.__data__;if(eo){var r=t[e];return r===o?void 0:r}return B.call(t,e)?t[e]:void 0},ef.prototype.has=function(e){var t=this.__data__;return eo?void 0!==t[e]:B.call(t,e)},ef.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=eo&&void 0===t?o:t,this},eg.prototype.clear=function(){this.__data__=[],this.size=0},eg.prototype.delete=function(e){var t=this.__data__,r=ew(t,e);return!(r<0)&&(r==t.length-1?t.pop():G.call(t,r,1),--this.size,!0)},eg.prototype.get=function(e){var t=this.__data__,r=ew(t,e);return r<0?void 0:t[r][1]},eg.prototype.has=function(e){return ew(this.__data__,e)>-1},eg.prototype.set=function(e,t){var r=this.__data__,i=ew(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this},em.prototype.clear=function(){this.size=0,this.__data__={hash:new ef,map:new(er||eg),string:new ef}},em.prototype.delete=function(e){var t=eC(this,e).delete(e);return this.size-=t?1:0,t},em.prototype.get=function(e){return eC(this,e).get(e)},em.prototype.has=function(e){return eC(this,e).has(e)},em.prototype.set=function(e,t){var r=eC(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},ey.prototype.add=ey.prototype.push=function(e){return this.__data__.set(e,o),this},ey.prototype.has=function(e){return this.__data__.has(e)},eb.prototype.clear=function(){this.__data__=new eg,this.size=0},eb.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},eb.prototype.get=function(e){return this.__data__.get(e)},eb.prototype.has=function(e){return this.__data__.has(e)},eb.prototype.set=function(e,t){var r=this.__data__;if(r instanceof eg){var i=r.__data__;if(!er||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new em(i)}return r.set(e,t),this.size=r.size,this};var eN=Z?function(e){return null==e?[]:function(e,t){for(var r=-1,i=null==e?0:e.length,s=0,n=[];++r<i;){var o=e[r];t(o,r,e)&&(n[s++]=o)}return n}(Z(e=Object(e)),function(t){return Y.call(e,t)})}:function(){return[]},eA=ev;function eO(e){if(null!=e){try{return q.call(e)}catch(e){}try{return e+""}catch(e){}}return""}function eM(e,t){return e===t||e!=e&&t!=t}(et&&eA(new et(new ArrayBuffer(1)))!=I||er&&eA(new er)!=p||ei&&eA(ei.resolve())!=m||es&&eA(new es)!=b||en&&eA(new en)!=v)&&(eA=function(e){var t=ev(e),r=t==g?e.constructor:void 0,i=r?eO(r):"";if(i)switch(i){case ea:return I;case ec:return p;case el:return m;case eh:return b;case eu:return v}return t});var eP=eE(function(){return arguments}())?eE:function(e){return ej(e)&&B.call(e,"callee")&&!Y.call(e,"callee")},ex=Array.isArray,eT=X||function(){return!1};function eD(e){if(!ek(e))return!1;var t=ev(e);return t==d||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}function eR(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function ek(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function ej(e){return null!=e&&"object"==typeof e}var eL=R?function(e){return R(e)}:function(e){return ej(e)&&eR(e.length)&&!!S[ev(e)]};e.exports=function(e,t){return function e(t,r,i,s,n){return t===r||(null!=t&&null!=r&&(ej(t)||ej(r))?function(e,t,r,i,s,n){var o=ex(e),d=ex(t),m=o?c:eA(e),v=d?c:eA(t);m=m==a?g:m,v=v==a?g:v;var _=m==g,C=v==g,S=m==v;if(S&&eT(e)){if(!eT(t))return!1;o=!0,_=!1}if(S&&!_)return n||(n=new eb),o||eL(e)?eI(e,t,r,i,s,n):function(e,t,r,i,s,n,o){switch(r){case I:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case E:if(e.byteLength!=t.byteLength||!n(new J(e),new J(t)))break;return!0;case l:case h:case f:return eM(+e,+t);case u:return e.name==t.name&&e.message==t.message;case y:case w:return e==t+"";case p:var a=k;case b:var c=1&i;if(a||(a=j),e.size!=t.size&&!c)break;var d=o.get(e);if(d)return d==t;i|=2,o.set(e,t);var g=eI(a(e),a(t),i,s,n,o);return o.delete(e),g;case"[object Symbol]":if(ep)return ep.call(e)==ep.call(t)}return!1}(e,t,m,r,i,s,n);if(!(1&r)){var N=_&&B.call(e,"__wrapped__"),A=C&&B.call(t,"__wrapped__");if(N||A){var O=N?e.value():e,M=A?t.value():t;return n||(n=new eb),s(O,M,r,i,n)}}return!!S&&(n||(n=new eb),function(e,t,r,i,s,n){var o=1&r,a=e_(e),c=a.length;if(c!=e_(t).length&&!o)return!1;for(var l=c;l--;){var h=a[l];if(!(o?h in t:B.call(t,h)))return!1}var u=n.get(e);if(u&&n.get(t))return u==t;var d=!0;n.set(e,t),n.set(t,e);for(var p=o;++l<c;){var f=e[h=a[l]],g=t[h];if(i)var m=o?i(g,f,h,t,e,n):i(f,g,h,e,t,n);if(!(void 0===m?f===g||s(f,g,r,i,n):m)){d=!1;break}p||(p="constructor"==h)}if(d&&!p){var y=e.constructor,b=t.constructor;y!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof y&&y instanceof y&&"function"==typeof b&&b instanceof b)&&(d=!1)}return n.delete(e),n.delete(t),d}(e,t,r,i,s,n))}(t,r,i,s,e,n):t!=t&&r!=r)}(e,t)}},73045:function(e){function t(e,t){if(!e)throw Error(t||"Assertion failed")}e.exports=t,t.equal=function(e,t,r){if(e!=t)throw Error(r||"Assertion failed: "+e+" != "+t)}},83742:function(e,t){"use strict";function r(e){return 1===e.length?"0"+e:e}function i(e){for(var t="",i=0;i<e.length;i++)t+=r(e[i].toString(16));return t}t.toArray=function(e,t){if(Array.isArray(e))return e.slice();if(!e)return[];var r=[];if("string"!=typeof e){for(var i=0;i<e.length;i++)r[i]=0|e[i];return r}if("hex"===t){(e=e.replace(/[^a-z0-9]+/ig,"")).length%2!=0&&(e="0"+e);for(var i=0;i<e.length;i+=2)r.push(parseInt(e[i]+e[i+1],16))}else for(var i=0;i<e.length;i++){var s=e.charCodeAt(i),n=s>>8,o=255&s;n?r.push(n,o):r.push(o)}return r},t.zero2=r,t.toHex=i,t.encode=function(e,t){return"hex"===t?i(e):e}},35819:function(e,t,r){let i=r(64888),s=r(82216),n=r(962),o=r(35623);function a(e,t,r,n,o){let a=[].slice.call(arguments,1),c=a.length,l="function"==typeof a[c-1];if(!l&&!i())throw Error("Callback required as last argument");if(l){if(c<2)throw Error("Too few arguments provided");2===c?(o=r,r=t,t=n=void 0):3===c&&(t.getContext&&void 0===o?(o=n,n=void 0):(o=n,n=r,r=t,t=void 0))}else{if(c<1)throw Error("Too few arguments provided");return 1===c?(r=t,t=n=void 0):2!==c||t.getContext||(n=r,r=t,t=void 0),new Promise(function(i,o){try{let o=s.create(r,n);i(e(o,t,n))}catch(e){o(e)}})}try{let i=s.create(r,n);o(null,e(i,t,n))}catch(e){o(e)}}t.create=s.create,t.toCanvas=a.bind(null,n.render),t.toDataURL=a.bind(null,n.renderToDataURL),t.toString=a.bind(null,function(e,t,r){return o.render(e,r)})},64888:function(e){e.exports=function(){return"function"==typeof Promise&&Promise.prototype&&Promise.prototype.then}},14691:function(e,t,r){let i=r(62415).getSymbolSize;t.getRowColCoords=function(e){if(1===e)return[];let t=Math.floor(e/7)+2,r=i(e),s=145===r?26:2*Math.ceil((r-13)/(2*t-2)),n=[r-7];for(let e=1;e<t-1;e++)n[e]=n[e-1]-s;return n.push(6),n.reverse()},t.getPositions=function(e){let r=[],i=t.getRowColCoords(e),s=i.length;for(let e=0;e<s;e++)for(let t=0;t<s;t++)(0!==e||0!==t)&&(0!==e||t!==s-1)&&(e!==s-1||0!==t)&&r.push([i[e],i[t]]);return r}},87111:function(e,t,r){let i=r(17956),s=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function n(e){this.mode=i.ALPHANUMERIC,this.data=e}n.getBitsLength=function(e){return 11*Math.floor(e/2)+e%2*6},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){let t;for(t=0;t+2<=this.data.length;t+=2){let r=45*s.indexOf(this.data[t]);r+=s.indexOf(this.data[t+1]),e.put(r,11)}this.data.length%2&&e.put(s.indexOf(this.data[t]),6)},e.exports=n},9298:function(e){function t(){this.buffer=[],this.length=0}t.prototype={get:function(e){return(this.buffer[Math.floor(e/8)]>>>7-e%8&1)==1},put:function(e,t){for(let r=0;r<t;r++)this.putBit((e>>>t-r-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){let t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}},e.exports=t},55526:function(e){function t(e){if(!e||e<1)throw Error("BitMatrix size must be defined and greater than 0");this.size=e,this.data=new Uint8Array(e*e),this.reservedBit=new Uint8Array(e*e)}t.prototype.set=function(e,t,r,i){let s=e*this.size+t;this.data[s]=r,i&&(this.reservedBit[s]=!0)},t.prototype.get=function(e,t){return this.data[e*this.size+t]},t.prototype.xor=function(e,t,r){this.data[e*this.size+t]^=r},t.prototype.isReserved=function(e,t){return this.reservedBit[e*this.size+t]},e.exports=t},48153:function(e,t,r){let i=r(17956);function s(e){this.mode=i.BYTE,"string"==typeof e?this.data=new TextEncoder().encode(e):this.data=new Uint8Array(e)}s.getBitsLength=function(e){return 8*e},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){for(let t=0,r=this.data.length;t<r;t++)e.put(this.data[t],8)},e.exports=s},79386:function(e,t,r){let i=r(29947),s=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],n=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];t.getBlocksCount=function(e,t){switch(t){case i.L:return s[(e-1)*4+0];case i.M:return s[(e-1)*4+1];case i.Q:return s[(e-1)*4+2];case i.H:return s[(e-1)*4+3];default:return}},t.getTotalCodewordsCount=function(e,t){switch(t){case i.L:return n[(e-1)*4+0];case i.M:return n[(e-1)*4+1];case i.Q:return n[(e-1)*4+2];case i.H:return n[(e-1)*4+3];default:return}}},29947:function(e,t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2},t.isValid=function(e){return e&&void 0!==e.bit&&e.bit>=0&&e.bit<4},t.from=function(e,r){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw Error("Unknown EC Level: "+e)}}(e)}catch(e){return r}}},44086:function(e,t,r){let i=r(62415).getSymbolSize;t.getPositions=function(e){let t=i(e);return[[0,0],[t-7,0],[0,t-7]]}},27433:function(e,t,r){let i=r(62415),s=i.getBCHDigit(1335);t.getEncodedBits=function(e,t){let r=e.bit<<3|t,n=r<<10;for(;i.getBCHDigit(n)-s>=0;)n^=1335<<i.getBCHDigit(n)-s;return(r<<10|n)^21522}},63384:function(e,t){let r=new Uint8Array(512),i=new Uint8Array(256);!function(){let e=1;for(let t=0;t<255;t++)r[t]=e,i[e]=t,256&(e<<=1)&&(e^=285);for(let e=255;e<512;e++)r[e]=r[e-255]}(),t.log=function(e){if(e<1)throw Error("log("+e+")");return i[e]},t.exp=function(e){return r[e]},t.mul=function(e,t){return 0===e||0===t?0:r[i[e]+i[t]]}},78514:function(e,t,r){let i=r(17956),s=r(62415);function n(e){this.mode=i.KANJI,this.data=e}n.getBitsLength=function(e){return 13*e},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(e){let t;for(t=0;t<this.data.length;t++){let r=s.toSJIS(this.data[t]);if(r>=33088&&r<=40956)r-=33088;else if(r>=57408&&r<=60351)r-=49472;else throw Error("Invalid SJIS character: "+this.data[t]+"\nMake sure your charset is UTF-8");r=(r>>>8&255)*192+(255&r),e.put(r,13)}},e.exports=n},24483:function(e,t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};let r={N1:3,N2:3,N3:40,N4:10};t.isValid=function(e){return null!=e&&""!==e&&!isNaN(e)&&e>=0&&e<=7},t.from=function(e){return t.isValid(e)?parseInt(e,10):void 0},t.getPenaltyN1=function(e){let t=e.size,i=0,s=0,n=0,o=null,a=null;for(let c=0;c<t;c++){s=n=0,o=a=null;for(let l=0;l<t;l++){let t=e.get(c,l);t===o?s++:(s>=5&&(i+=r.N1+(s-5)),o=t,s=1),(t=e.get(l,c))===a?n++:(n>=5&&(i+=r.N1+(n-5)),a=t,n=1)}s>=5&&(i+=r.N1+(s-5)),n>=5&&(i+=r.N1+(n-5))}return i},t.getPenaltyN2=function(e){let t=e.size,i=0;for(let r=0;r<t-1;r++)for(let s=0;s<t-1;s++){let t=e.get(r,s)+e.get(r,s+1)+e.get(r+1,s)+e.get(r+1,s+1);(4===t||0===t)&&i++}return i*r.N2},t.getPenaltyN3=function(e){let t=e.size,i=0,s=0,n=0;for(let r=0;r<t;r++){s=n=0;for(let o=0;o<t;o++)s=s<<1&2047|e.get(r,o),o>=10&&(1488===s||93===s)&&i++,n=n<<1&2047|e.get(o,r),o>=10&&(1488===n||93===n)&&i++}return i*r.N3},t.getPenaltyN4=function(e){let t=0,i=e.data.length;for(let r=0;r<i;r++)t+=e.data[r];return Math.abs(Math.ceil(100*t/i/5)-10)*r.N4},t.applyMask=function(e,r){let i=r.size;for(let s=0;s<i;s++)for(let n=0;n<i;n++)r.isReserved(n,s)||r.xor(n,s,function(e,r,i){switch(e){case t.Patterns.PATTERN000:return(r+i)%2==0;case t.Patterns.PATTERN001:return r%2==0;case t.Patterns.PATTERN010:return i%3==0;case t.Patterns.PATTERN011:return(r+i)%3==0;case t.Patterns.PATTERN100:return(Math.floor(r/2)+Math.floor(i/3))%2==0;case t.Patterns.PATTERN101:return r*i%2+r*i%3==0;case t.Patterns.PATTERN110:return(r*i%2+r*i%3)%2==0;case t.Patterns.PATTERN111:return(r*i%3+(r+i)%2)%2==0;default:throw Error("bad maskPattern:"+e)}}(e,n,s))},t.getBestMask=function(e,r){let i=Object.keys(t.Patterns).length,s=0,n=1/0;for(let o=0;o<i;o++){r(o),t.applyMask(o,e);let i=t.getPenaltyN1(e)+t.getPenaltyN2(e)+t.getPenaltyN3(e)+t.getPenaltyN4(e);t.applyMask(o,e),i<n&&(n=i,s=o)}return s}},17956:function(e,t,r){let i=r(96623),s=r(80581);t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(e,t){if(!e.ccBits)throw Error("Invalid mode: "+e);if(!i.isValid(t))throw Error("Invalid version: "+t);return t>=1&&t<10?e.ccBits[0]:t<27?e.ccBits[1]:e.ccBits[2]},t.getBestModeForData=function(e){return s.testNumeric(e)?t.NUMERIC:s.testAlphanumeric(e)?t.ALPHANUMERIC:s.testKanji(e)?t.KANJI:t.BYTE},t.toString=function(e){if(e&&e.id)return e.id;throw Error("Invalid mode")},t.isValid=function(e){return e&&e.bit&&e.ccBits},t.from=function(e,r){if(t.isValid(e))return e;try{return function(e){if("string"!=typeof e)throw Error("Param is not a string");switch(e.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw Error("Unknown mode: "+e)}}(e)}catch(e){return r}}},51687:function(e,t,r){let i=r(17956);function s(e){this.mode=i.NUMERIC,this.data=e.toString()}s.getBitsLength=function(e){return 10*Math.floor(e/3)+(e%3?e%3*3+1:0)},s.prototype.getLength=function(){return this.data.length},s.prototype.getBitsLength=function(){return s.getBitsLength(this.data.length)},s.prototype.write=function(e){let t,r;for(t=0;t+3<=this.data.length;t+=3)r=parseInt(this.data.substr(t,3),10),e.put(r,10);let i=this.data.length-t;i>0&&(r=parseInt(this.data.substr(t),10),e.put(r,3*i+1))},e.exports=s},46413:function(e,t,r){let i=r(63384);t.mul=function(e,t){let r=new Uint8Array(e.length+t.length-1);for(let s=0;s<e.length;s++)for(let n=0;n<t.length;n++)r[s+n]^=i.mul(e[s],t[n]);return r},t.mod=function(e,t){let r=new Uint8Array(e);for(;r.length-t.length>=0;){let e=r[0];for(let s=0;s<t.length;s++)r[s]^=i.mul(t[s],e);let s=0;for(;s<r.length&&0===r[s];)s++;r=r.slice(s)}return r},t.generateECPolynomial=function(e){let r=new Uint8Array([1]);for(let s=0;s<e;s++)r=t.mul(r,new Uint8Array([1,i.exp(s)]));return r}},82216:function(e,t,r){let i=r(62415),s=r(29947),n=r(9298),o=r(55526),a=r(14691),c=r(44086),l=r(24483),h=r(79386),u=r(24011),d=r(33379),p=r(27433),f=r(17956),g=r(89940);function m(e,t,r){let i,s;let n=e.size,o=p.getEncodedBits(t,r);for(i=0;i<15;i++)s=(o>>i&1)==1,i<6?e.set(i,8,s,!0):i<8?e.set(i+1,8,s,!0):e.set(n-15+i,8,s,!0),i<8?e.set(8,n-i-1,s,!0):i<9?e.set(8,15-i-1+1,s,!0):e.set(8,15-i-1,s,!0);e.set(n-8,8,1,!0)}t.create=function(e,t){let r,p;if(void 0===e||""===e)throw Error("No input text");let y=s.M;return void 0!==t&&(y=s.from(t.errorCorrectionLevel,s.M),r=d.from(t.version),p=l.from(t.maskPattern),t.toSJISFunc&&i.setToSJISFunction(t.toSJISFunc)),function(e,t,r,s){let p;if(Array.isArray(e))p=g.fromArray(e);else if("string"==typeof e){let i=t;if(!i){let t=g.rawSplit(e);i=d.getBestVersionForData(t,r)}p=g.fromString(e,i||40)}else throw Error("Invalid data");let y=d.getBestVersionForData(p,r);if(!y)throw Error("The amount of data is too big to be stored in a QR Code");if(t){if(t<y)throw Error("\nThe chosen QR Code version cannot contain this amount of data.\nMinimum version required to store current data is: "+y+".\n")}else t=y;let b=function(e,t,r){let s=new n;r.forEach(function(t){s.put(t.mode.bit,4),s.put(t.getLength(),f.getCharCountIndicator(t.mode,e)),t.write(s)});let o=(i.getSymbolTotalCodewords(e)-h.getTotalCodewordsCount(e,t))*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!=0;)s.putBit(0);let a=(o-s.getLengthInBits())/8;for(let e=0;e<a;e++)s.put(e%2?17:236,8);return function(e,t,r){let s,n;let o=i.getSymbolTotalCodewords(t),a=o-h.getTotalCodewordsCount(t,r),c=h.getBlocksCount(t,r),l=o%c,d=c-l,p=Math.floor(o/c),f=Math.floor(a/c),g=f+1,m=p-f,y=new u(m),b=0,w=Array(c),v=Array(c),E=0,I=new Uint8Array(e.buffer);for(let e=0;e<c;e++){let t=e<d?f:g;w[e]=I.slice(b,b+t),v[e]=y.encode(w[e]),b+=t,E=Math.max(E,t)}let _=new Uint8Array(o),C=0;for(s=0;s<E;s++)for(n=0;n<c;n++)s<w[n].length&&(_[C++]=w[n][s]);for(s=0;s<m;s++)for(n=0;n<c;n++)_[C++]=v[n][s];return _}(s,e,t)}(t,r,p),w=new o(i.getSymbolSize(t));return function(e,t){let r=e.size,i=c.getPositions(t);for(let t=0;t<i.length;t++){let s=i[t][0],n=i[t][1];for(let t=-1;t<=7;t++)if(!(s+t<=-1)&&!(r<=s+t))for(let i=-1;i<=7;i++)n+i<=-1||r<=n+i||(t>=0&&t<=6&&(0===i||6===i)||i>=0&&i<=6&&(0===t||6===t)||t>=2&&t<=4&&i>=2&&i<=4?e.set(s+t,n+i,!0,!0):e.set(s+t,n+i,!1,!0))}}(w,t),function(e){let t=e.size;for(let r=8;r<t-8;r++){let t=r%2==0;e.set(r,6,t,!0),e.set(6,r,t,!0)}}(w),function(e,t){let r=a.getPositions(t);for(let t=0;t<r.length;t++){let i=r[t][0],s=r[t][1];for(let t=-2;t<=2;t++)for(let r=-2;r<=2;r++)-2===t||2===t||-2===r||2===r||0===t&&0===r?e.set(i+t,s+r,!0,!0):e.set(i+t,s+r,!1,!0)}}(w,t),m(w,r,0),t>=7&&function(e,t){let r,i,s;let n=e.size,o=d.getEncodedBits(t);for(let t=0;t<18;t++)r=Math.floor(t/3),i=t%3+n-8-3,s=(o>>t&1)==1,e.set(r,i,s,!0),e.set(i,r,s,!0)}(w,t),function(e,t){let r=e.size,i=-1,s=r-1,n=7,o=0;for(let a=r-1;a>0;a-=2)for(6===a&&a--;;){for(let r=0;r<2;r++)if(!e.isReserved(s,a-r)){let i=!1;o<t.length&&(i=(t[o]>>>n&1)==1),e.set(s,a-r,i),-1==--n&&(o++,n=7)}if((s+=i)<0||r<=s){s-=i,i=-i;break}}}(w,b),isNaN(s)&&(s=l.getBestMask(w,m.bind(null,w,r))),l.applyMask(s,w),m(w,r,s),{modules:w,version:t,errorCorrectionLevel:r,maskPattern:s,segments:p}}(e,r,y,p)}},24011:function(e,t,r){let i=r(46413);function s(e){this.genPoly=void 0,this.degree=e,this.degree&&this.initialize(this.degree)}s.prototype.initialize=function(e){this.degree=e,this.genPoly=i.generateECPolynomial(this.degree)},s.prototype.encode=function(e){if(!this.genPoly)throw Error("Encoder not initialized");let t=new Uint8Array(e.length+this.degree);t.set(e);let r=i.mod(t,this.genPoly),s=this.degree-r.length;if(s>0){let e=new Uint8Array(this.degree);return e.set(r,s),e}return r},e.exports=s},80581:function(e,t){let r="[0-9]+",i="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+",s="(?:(?![A-Z0-9 $%*+\\-./:]|"+(i=i.replace(/u/g,"\\u"))+")(?:.|[\r\n]))+";t.KANJI=RegExp(i,"g"),t.BYTE_KANJI=RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),t.BYTE=RegExp(s,"g"),t.NUMERIC=RegExp(r,"g"),t.ALPHANUMERIC=RegExp("[A-Z $%*+\\-./:]+","g");let n=RegExp("^"+i+"$"),o=RegExp("^"+r+"$"),a=RegExp("^[A-Z0-9 $%*+\\-./:]+$");t.testKanji=function(e){return n.test(e)},t.testNumeric=function(e){return o.test(e)},t.testAlphanumeric=function(e){return a.test(e)}},89940:function(e,t,r){let i=r(17956),s=r(51687),n=r(87111),o=r(48153),a=r(78514),c=r(80581),l=r(62415),h=r(46946);function u(e){return unescape(encodeURIComponent(e)).length}function d(e,t,r){let i;let s=[];for(;null!==(i=e.exec(r));)s.push({data:i[0],index:i.index,mode:t,length:i[0].length});return s}function p(e){let t,r;let s=d(c.NUMERIC,i.NUMERIC,e),n=d(c.ALPHANUMERIC,i.ALPHANUMERIC,e);return l.isKanjiModeEnabled()?(t=d(c.BYTE,i.BYTE,e),r=d(c.KANJI,i.KANJI,e)):(t=d(c.BYTE_KANJI,i.BYTE,e),r=[]),s.concat(n,t,r).sort(function(e,t){return e.index-t.index}).map(function(e){return{data:e.data,mode:e.mode,length:e.length}})}function f(e,t){switch(t){case i.NUMERIC:return s.getBitsLength(e);case i.ALPHANUMERIC:return n.getBitsLength(e);case i.KANJI:return a.getBitsLength(e);case i.BYTE:return o.getBitsLength(e)}}function g(e,t){let r;let c=i.getBestModeForData(e);if((r=i.from(t,c))!==i.BYTE&&r.bit<c.bit)throw Error('"'+e+'" cannot be encoded with mode '+i.toString(r)+".\n Suggested mode is: "+i.toString(c));switch(r!==i.KANJI||l.isKanjiModeEnabled()||(r=i.BYTE),r){case i.NUMERIC:return new s(e);case i.ALPHANUMERIC:return new n(e);case i.KANJI:return new a(e);case i.BYTE:return new o(e)}}t.fromArray=function(e){return e.reduce(function(e,t){return"string"==typeof t?e.push(g(t,null)):t.data&&e.push(g(t.data,t.mode)),e},[])},t.fromString=function(e,r){let s=function(e,t){let r={},s={start:{}},n=["start"];for(let o=0;o<e.length;o++){let a=e[o],c=[];for(let e=0;e<a.length;e++){let l=a[e],h=""+o+e;c.push(h),r[h]={node:l,lastCount:0},s[h]={};for(let e=0;e<n.length;e++){let o=n[e];r[o]&&r[o].node.mode===l.mode?(s[o][h]=f(r[o].lastCount+l.length,l.mode)-f(r[o].lastCount,l.mode),r[o].lastCount+=l.length):(r[o]&&(r[o].lastCount=l.length),s[o][h]=f(l.length,l.mode)+4+i.getCharCountIndicator(l.mode,t))}}n=c}for(let e=0;e<n.length;e++)s[n[e]].end=0;return{map:s,table:r}}(function(e){let t=[];for(let r=0;r<e.length;r++){let s=e[r];switch(s.mode){case i.NUMERIC:t.push([s,{data:s.data,mode:i.ALPHANUMERIC,length:s.length},{data:s.data,mode:i.BYTE,length:s.length}]);break;case i.ALPHANUMERIC:t.push([s,{data:s.data,mode:i.BYTE,length:s.length}]);break;case i.KANJI:t.push([s,{data:s.data,mode:i.BYTE,length:u(s.data)}]);break;case i.BYTE:t.push([{data:s.data,mode:i.BYTE,length:u(s.data)}])}}return t}(p(e,l.isKanjiModeEnabled())),r),n=h.find_path(s.map,"start","end"),o=[];for(let e=1;e<n.length-1;e++)o.push(s.table[n[e]].node);return t.fromArray(o.reduce(function(e,t){let r=e.length-1>=0?e[e.length-1]:null;return r&&r.mode===t.mode?e[e.length-1].data+=t.data:e.push(t),e},[]))},t.rawSplit=function(e){return t.fromArray(p(e,l.isKanjiModeEnabled()))}},62415:function(e,t){let r;let i=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];t.getSymbolSize=function(e){if(!e)throw Error('"version" cannot be null or undefined');if(e<1||e>40)throw Error('"version" should be in range from 1 to 40');return 4*e+17},t.getSymbolTotalCodewords=function(e){return i[e]},t.getBCHDigit=function(e){let t=0;for(;0!==e;)t++,e>>>=1;return t},t.setToSJISFunction=function(e){if("function"!=typeof e)throw Error('"toSJISFunc" is not a valid function.');r=e},t.isKanjiModeEnabled=function(){return void 0!==r},t.toSJIS=function(e){return r(e)}},96623:function(e,t){t.isValid=function(e){return!isNaN(e)&&e>=1&&e<=40}},33379:function(e,t,r){let i=r(62415),s=r(79386),n=r(29947),o=r(17956),a=r(96623),c=i.getBCHDigit(7973);function l(e,t){return o.getCharCountIndicator(e,t)+4}t.from=function(e,t){return a.isValid(e)?parseInt(e,10):t},t.getCapacity=function(e,t,r){if(!a.isValid(e))throw Error("Invalid QR Code version");void 0===r&&(r=o.BYTE);let n=(i.getSymbolTotalCodewords(e)-s.getTotalCodewordsCount(e,t))*8;if(r===o.MIXED)return n;let c=n-l(r,e);switch(r){case o.NUMERIC:return Math.floor(c/10*3);case o.ALPHANUMERIC:return Math.floor(c/11*2);case o.KANJI:return Math.floor(c/13);case o.BYTE:default:return Math.floor(c/8)}},t.getBestVersionForData=function(e,r){let i;let s=n.from(r,n.M);if(Array.isArray(e)){if(e.length>1)return function(e,r){for(let i=1;i<=40;i++)if(function(e,t){let r=0;return e.forEach(function(e){let i=l(e.mode,t);r+=i+e.getBitsLength()}),r}(e,i)<=t.getCapacity(i,r,o.MIXED))return i}(e,s);if(0===e.length)return 1;i=e[0]}else i=e;return function(e,r,i){for(let s=1;s<=40;s++)if(r<=t.getCapacity(s,i,e))return s}(i.mode,i.getLength(),s)},t.getEncodedBits=function(e){if(!a.isValid(e)||e<7)throw Error("Invalid QR Code version");let t=e<<12;for(;i.getBCHDigit(t)-c>=0;)t^=7973<<i.getBCHDigit(t)-c;return e<<12|t}},962:function(e,t,r){let i=r(87220);t.render=function(e,t,r){var s;let n=r,o=t;void 0!==n||t&&t.getContext||(n=t,t=void 0),t||(o=function(){try{return document.createElement("canvas")}catch(e){throw Error("You need to specify a canvas element")}}()),n=i.getOptions(n);let a=i.getImageWidth(e.modules.size,n),c=o.getContext("2d"),l=c.createImageData(a,a);return i.qrToImageData(l.data,e,n),s=o,c.clearRect(0,0,s.width,s.height),s.style||(s.style={}),s.height=a,s.width=a,s.style.height=a+"px",s.style.width=a+"px",c.putImageData(l,0,0),o},t.renderToDataURL=function(e,r,i){let s=i;void 0!==s||r&&r.getContext||(s=r,r=void 0),s||(s={});let n=t.render(e,r,s),o=s.type||"image/png",a=s.rendererOpts||{};return n.toDataURL(o,a.quality)}},35623:function(e,t,r){let i=r(87220);function s(e,t){let r=e.a/255,i=t+'="'+e.hex+'"';return r<1?i+" "+t+'-opacity="'+r.toFixed(2).slice(1)+'"':i}function n(e,t,r){let i=e+t;return void 0!==r&&(i+=" "+r),i}t.render=function(e,t,r){let o=i.getOptions(t),a=e.modules.size,c=e.modules.data,l=a+2*o.margin,h=o.color.light.a?"<path "+s(o.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",u="<path "+s(o.color.dark,"stroke")+' d="'+function(e,t,r){let i="",s=0,o=!1,a=0;for(let c=0;c<e.length;c++){let l=Math.floor(c%t),h=Math.floor(c/t);l||o||(o=!0),e[c]?(a++,c>0&&l>0&&e[c-1]||(i+=o?n("M",l+r,.5+h+r):n("m",s,0),s=0,o=!1),l+1<t&&e[c+1]||(i+=n("h",a),a=0)):s++}return i}(c,a,o.margin)+'"/>',d='<svg xmlns="http://www.w3.org/2000/svg" '+(o.width?'width="'+o.width+'" height="'+o.width+'" ':"")+('viewBox="0 0 '+l)+" "+l+'" shape-rendering="crispEdges">'+h+u+"</svg>\n";return"function"==typeof r&&r(null,d),d}},87220:function(e,t){function r(e){if("number"==typeof e&&(e=e.toString()),"string"!=typeof e)throw Error("Color should be defined as hex string");let t=e.slice().replace("#","").split("");if(t.length<3||5===t.length||t.length>8)throw Error("Invalid hex color: "+e);(3===t.length||4===t.length)&&(t=Array.prototype.concat.apply([],t.map(function(e){return[e,e]}))),6===t.length&&t.push("F","F");let r=parseInt(t.join(""),16);return{r:r>>24&255,g:r>>16&255,b:r>>8&255,a:255&r,hex:"#"+t.slice(0,6).join("")}}t.getOptions=function(e){e||(e={}),e.color||(e.color={});let t=void 0===e.margin||null===e.margin||e.margin<0?4:e.margin,i=e.width&&e.width>=21?e.width:void 0,s=e.scale||4;return{width:i,scale:i?4:s,margin:t,color:{dark:r(e.color.dark||"#000000ff"),light:r(e.color.light||"#ffffffff")},type:e.type,rendererOpts:e.rendererOpts||{}}},t.getScale=function(e,t){return t.width&&t.width>=e+2*t.margin?t.width/(e+2*t.margin):t.scale},t.getImageWidth=function(e,r){let i=t.getScale(e,r);return Math.floor((e+2*r.margin)*i)},t.qrToImageData=function(e,r,i){let s=r.modules.size,n=r.modules.data,o=t.getScale(s,i),a=Math.floor((s+2*i.margin)*o),c=i.margin*o,l=[i.color.light,i.color.dark];for(let t=0;t<a;t++)for(let r=0;r<a;r++){let h=(t*a+r)*4,u=i.color.light;t>=c&&r>=c&&t<a-c&&r<a-c&&(u=l[n[Math.floor((t-c)/o)*s+Math.floor((r-c)/o)]?1:0]),e[h++]=u.r,e[h++]=u.g,e[h++]=u.b,e[h]=u.a}}},95172:function(e){"use strict";function t(e){try{return JSON.stringify(e)}catch(e){return'"[Circular]"'}}e.exports=function(e,r,i){var s=i&&i.stringify||t;if("object"==typeof e&&null!==e){var n=r.length+1;if(1===n)return e;var o=Array(n);o[0]=s(e);for(var a=1;a<n;a++)o[a]=s(r[a]);return o.join(" ")}if("string"!=typeof e)return e;var c=r.length;if(0===c)return e;for(var l="",h=0,u=-1,d=e&&e.length||0,p=0;p<d;){if(37===e.charCodeAt(p)&&p+1<d){switch(u=u>-1?u:0,e.charCodeAt(p+1)){case 100:case 102:if(h>=c||null==r[h])break;u<p&&(l+=e.slice(u,p)),l+=Number(r[h]),u=p+2,p++;break;case 105:if(h>=c||null==r[h])break;u<p&&(l+=e.slice(u,p)),l+=Math.floor(Number(r[h])),u=p+2,p++;break;case 79:case 111:case 106:if(h>=c||void 0===r[h])break;u<p&&(l+=e.slice(u,p));var f=typeof r[h];if("string"===f){l+="'"+r[h]+"'",u=p+2,p++;break}if("function"===f){l+=r[h].name||"<anonymous>",u=p+2,p++;break}l+=s(r[h]),u=p+2,p++;break;case 115:if(h>=c)break;u<p&&(l+=e.slice(u,p)),l+=String(r[h]),u=p+2,p++;break;case 37:u<p&&(l+=e.slice(u,p)),l+="%",u=p+2,p++,h--}++h}++p}return -1===u?e:(u<d&&(l+=e.slice(u)),l)}},42060:function(){},44742:function(e){e.exports={style:{fontFamily:"'__Inter_f367f3', '__Inter_Fallback_f367f3'",fontStyle:"normal"},className:"__className_f367f3"}},25566:function(e){var t,r,i,s=e.exports={};function n(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===n||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:n}catch(e){t=n}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var c=[],l=!1,h=-1;function u(){l&&i&&(l=!1,i.length?c=i.concat(c):h=-1,c.length&&d())}function d(){if(!l){var e=a(u);l=!0;for(var t=c.length;t;){for(i=c,c=[];++h<t;)i&&i[h].run();h=-1,t=c.length}i=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function f(){}s.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new p(e,t)),1!==c.length||l||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=f,s.addListener=f,s.once=f,s.off=f,s.removeListener=f,s.removeAllListeners=f,s.emit=f,s.prependListener=f,s.prependOnceListener=f,s.listeners=function(e){return[]},s.binding=function(e){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(e){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},97435:function(e,t,r){"use strict";let i=r(95172);e.exports=n;let s=function(){function e(e){return void 0!==e&&e}try{if("undefined"!=typeof globalThis)return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(t){return e(self)||e(window)||e(this)||{}}}().console||{};function n(e){var t,r;(e=e||{}).browser=e.browser||{};let i=e.browser.transmit;if(i&&"function"!=typeof i.send)throw Error("pino: transmit option must have a send function");let h=e.browser.write||s;e.browser.write&&(e.browser.asObject=!0);let u=e.serializers||{},g=Array.isArray(t=e.browser.serialize)?t.filter(function(e){return"!stdSerializers.err"!==e}):!0===t&&Object.keys(u),m=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(m=!1),"function"==typeof h&&(h.error=h.fatal=h.warn=h.info=h.debug=h.trace=h),!1===e.enabled&&(e.level="silent");let y=e.level||"info",b=Object.create(h);b.log||(b.log=d),Object.defineProperty(b,"levelVal",{get:function(){return"silent"===this.level?1/0:this.levels.values[this.level]}}),Object.defineProperty(b,"level",{get:function(){return this._level},set:function(e){if("silent"!==e&&!this.levels.values[e])throw Error("unknown level "+e);this._level=e,o(w,b,"error","log"),o(w,b,"fatal","error"),o(w,b,"warn","error"),o(w,b,"info","log"),o(w,b,"debug","log"),o(w,b,"trace","log")}});let w={transmit:i,serialize:g,asObject:e.browser.asObject,levels:["error","fatal","warn","info","debug","trace"],timestamp:"function"==typeof(r=e).timestamp?r.timestamp:!1===r.timestamp?p:f};return b.levels=n.levels,b.level=y,b.setMaxListeners=b.getMaxListeners=b.emit=b.addListener=b.on=b.prependListener=b.once=b.prependOnceListener=b.removeListener=b.removeAllListeners=b.listeners=b.listenerCount=b.eventNames=b.write=b.flush=d,b.serializers=u,b._serialize=g,b._stdErrSerialize=m,b.child=function(t,r){if(!t)throw Error("missing bindings for child Pino");r=r||{},g&&t.serializers&&(r.serializers=t.serializers);let s=r.serializers;if(g&&s){var n=Object.assign({},u,s),o=!0===e.browser.serialize?Object.keys(n):g;delete t.serializers,a([t],o,n,this._stdErrSerialize)}function h(e){this._childLevel=(0|e._childLevel)+1,this.error=c(e,t,"error"),this.fatal=c(e,t,"fatal"),this.warn=c(e,t,"warn"),this.info=c(e,t,"info"),this.debug=c(e,t,"debug"),this.trace=c(e,t,"trace"),n&&(this.serializers=n,this._serialize=o),i&&(this._logEvent=l([].concat(e._logEvent.bindings,t)))}return h.prototype=this,new h(this)},i&&(b._logEvent=l()),b}function o(e,t,r,o){let c=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?d:c[r]?c[r]:s[r]||s[o]||d,function(e,t,r){if(e.transmit||t[r]!==d){var o;t[r]=(o=t[r],function(){let c=e.timestamp(),h=Array(arguments.length),u=Object.getPrototypeOf&&Object.getPrototypeOf(this)===s?s:this;for(var d=0;d<h.length;d++)h[d]=arguments[d];if(e.serialize&&!e.asObject&&a(h,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?o.call(u,function(e,t,r,s){e._serialize&&a(r,e._serialize,e.serializers,e._stdErrSerialize);let o=r.slice(),c=o[0],l={};s&&(l.time=s),l.level=n.levels.values[t];let h=(0|e._childLevel)+1;if(h<1&&(h=1),null!==c&&"object"==typeof c){for(;h--&&"object"==typeof o[0];)Object.assign(l,o.shift());c=o.length?i(o.shift(),o):void 0}else"string"==typeof c&&(c=i(o.shift(),o));return void 0!==c&&(l.msg=c),l}(this,r,h,c)):o.apply(u,h),e.transmit){let i=e.transmit.level||t.level,s=n.levels.values[i],o=n.levels.values[r];if(o<s)return;(function(e,t,r){let i=t.send,s=t.ts,n=t.methodLevel,o=t.methodValue,c=t.val,h=e._logEvent.bindings;a(r,e._serialize||Object.keys(e.serializers),e.serializers,void 0===e._stdErrSerialize||e._stdErrSerialize),e._logEvent.ts=s,e._logEvent.messages=r.filter(function(e){return -1===h.indexOf(e)}),e._logEvent.level.label=n,e._logEvent.level.value=o,i(n,e._logEvent,c),e._logEvent=l(h)})(this,{ts:c,methodLevel:r,methodValue:o,transmitLevel:i,transmitValue:n.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},h)}})}}(e,t,r)}function a(e,t,r,i){for(let s in e)if(i&&e[s]instanceof Error)e[s]=n.stdSerializers.err(e[s]);else if("object"==typeof e[s]&&!Array.isArray(e[s]))for(let i in e[s])t&&t.indexOf(i)>-1&&i in r&&(e[s][i]=r[i](e[s][i]))}function c(e,t,r){return function(){let i=Array(1+arguments.length);i[0]=t;for(var s=1;s<i.length;s++)i[s]=arguments[s-1];return e[r].apply(this,i)}}function l(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function h(){return{}}function u(e){return e}function d(){}function p(){return!1}function f(){return Date.now()}n.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},n.stdSerializers={mapHttpRequest:h,mapHttpResponse:h,wrapRequestSerializer:u,wrapResponseSerializer:u,wrapErrorSerializer:u,req:h,res:h,err:function(e){let t={type:e.constructor.name,msg:e.message,stack:e.stack};for(let r in e)void 0===t[r]&&(t[r]=e[r]);return t}},n.stdTimeFunctions=Object.assign({},{nullTime:p,epochTime:f,unixTime:function(){return Math.round(Date.now()/1e3)},isoTime:function(){return new Date(Date.now()).toISOString()}})},93511:function(e,t,r){"use strict";r.d(t,{fl:function(){return N},iv:function(){return l},Ts:function(){return _},Qu:function(){return C},$m:function(){return c}});let i=globalThis,s=i.ShadowRoot&&(void 0===i.ShadyCSS||i.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,n=Symbol(),o=new WeakMap;class a{constructor(e,t,r){if(this._$cssResult$=!0,r!==n)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o,t=this.t;if(s&&void 0===e){let r=void 0!==t&&1===t.length;r&&(e=o.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),r&&o.set(t,e))}return e}toString(){return this.cssText}}let c=e=>new a("string"==typeof e?e:e+"",void 0,n),l=(e,...t)=>new a(1===e.length?e[0]:t.reduce((t,r,i)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(r)+e[i+1],e[0]),e,n),h=(e,t)=>{if(s)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(let r of t){let t=document.createElement("style"),s=i.litNonce;void 0!==s&&t.setAttribute("nonce",s),t.textContent=r.cssText,e.appendChild(t)}},u=s?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(let r of e.cssRules)t+=r.cssText;return c(t)})(e):e,{is:d,defineProperty:p,getOwnPropertyDescriptor:f,getOwnPropertyNames:g,getOwnPropertySymbols:m,getPrototypeOf:y}=Object,b=globalThis,w=b.trustedTypes,v=w?w.emptyScript:"",E=b.reactiveElementPolyfillSupport,I=(e,t)=>e,_={toAttribute(e,t){switch(t){case Boolean:e=e?v:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let r=e;switch(t){case Boolean:r=null!==e;break;case Number:r=null===e?null:Number(e);break;case Object:case Array:try{r=JSON.parse(e)}catch(e){r=null}}return r}},C=(e,t)=>!d(e,t),S={attribute:!0,type:String,converter:_,reflect:!1,useDefault:!1,hasChanged:C};Symbol.metadata??=Symbol("metadata"),b.litPropertyMetadata??=new WeakMap;class N extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=S){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){let r=Symbol(),i=this.getPropertyDescriptor(e,r,t);void 0!==i&&p(this.prototype,e,i)}}static getPropertyDescriptor(e,t,r){let{get:i,set:s}=f(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:i,set(t){let n=i?.call(this);s?.call(this,t),this.requestUpdate(e,n,r)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??S}static _$Ei(){if(this.hasOwnProperty(I("elementProperties")))return;let e=y(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(I("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(I("properties"))){let e=this.properties;for(let t of[...g(e),...m(e)])this.createProperty(t,e[t])}let e=this[Symbol.metadata];if(null!==e){let t=litPropertyMetadata.get(e);if(void 0!==t)for(let[e,r]of t)this.elementProperties.set(e,r)}for(let[e,t]of(this._$Eh=new Map,this.elementProperties)){let r=this._$Eu(e,t);void 0!==r&&this._$Eh.set(r,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){let t=[];if(Array.isArray(e))for(let r of new Set(e.flat(1/0).reverse()))t.unshift(u(r));else void 0!==e&&t.push(u(e));return t}static _$Eu(e,t){let r=t.attribute;return!1===r?void 0:"string"==typeof r?r:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){let e=new Map;for(let t of this.constructor.elementProperties.keys())this.hasOwnProperty(t)&&(e.set(t,this[t]),delete this[t]);e.size>0&&(this._$Ep=e)}createRenderRoot(){let e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return h(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,r){this._$AK(e,r)}_$ET(e,t){let r=this.constructor.elementProperties.get(e),i=this.constructor._$Eu(e,r);if(void 0!==i&&!0===r.reflect){let s=(void 0!==r.converter?.toAttribute?r.converter:_).toAttribute(t,r.type);this._$Em=e,null==s?this.removeAttribute(i):this.setAttribute(i,s),this._$Em=null}}_$AK(e,t){let r=this.constructor,i=r._$Eh.get(e);if(void 0!==i&&this._$Em!==i){let e=r.getPropertyOptions(i),s="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:_;this._$Em=i;let n=s.fromAttribute(t,e.type);this[i]=n??this._$Ej?.get(i)??n,this._$Em=null}}requestUpdate(e,t,r,i=!1,s){if(void 0!==e){let n=this.constructor;if(!1===i&&(s=this[e]),!(((r??=n.getPropertyOptions(e)).hasChanged??C)(s,t)||r.useDefault&&r.reflect&&s===this._$Ej?.get(e)&&!this.hasAttribute(n._$Eu(e,r))))return;this.C(e,t,r)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:r,reflect:i,wrapped:s},n){r&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,n??t??this[e]),!0!==s||void 0!==n)||(this._$AL.has(e)||(this.hasUpdated||r||(t=void 0),this._$AL.set(e,t)),!0===i&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}let e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(let[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}let e=this.constructor.elementProperties;if(e.size>0)for(let[t,r]of e){let{wrapped:e}=r,i=this[t];!0!==e||this._$AL.has(t)||void 0===i||this.C(t,void 0,r,i)}}let e=!1,t=this._$AL;try{(e=this.shouldUpdate(t))?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}}N.elementStyles=[],N.shadowRootOptions={mode:"open"},N[I("elementProperties")]=new Map,N[I("finalized")]=new Map,E?.({ReactiveElement:N}),(b.reactiveElementVersions??=[]).push("2.1.2")},44649:function(e,t,r){"use strict";r.d(t,{b:function(){return i}});let i={WC_NAME_SUFFIX:".reown.id",WC_NAME_SUFFIX_LEGACY:".wcn.id",BLOCKCHAIN_API_RPC_URL:"https://rpc.walletconnect.org",PULSE_API_URL:"https://pulse.walletconnect.org",W3M_API_URL:"https://api.web3modal.org",CONNECTOR_ID:{WALLET_CONNECT:"walletConnect",INJECTED:"injected",WALLET_STANDARD:"announced",COINBASE:"coinbaseWallet",COINBASE_SDK:"coinbaseWalletSDK",SAFE:"safe",LEDGER:"ledger",OKX:"okx",EIP6963:"eip6963",AUTH:"ID_AUTH"},CONNECTOR_NAMES:{AUTH:"Auth"},AUTH_CONNECTOR_SUPPORTED_CHAINS:["eip155","solana"],LIMITS:{PENDING_TRANSACTIONS:99},CHAIN:{EVM:"eip155",SOLANA:"solana",POLKADOT:"polkadot",BITCOIN:"bip122"},CHAIN_NAME_MAP:{eip155:"EVM Networks",solana:"Solana",polkadot:"Polkadot",bip122:"Bitcoin"},ADAPTER_TYPES:{BITCOIN:"bitcoin",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5"},USDT_CONTRACT_ADDRESSES:["0xdac17f958d2ee523a2206206994597c13d831ec7","0xc2132d05d31c914a87c6611c10748aeb04b58e8f","0x9702230a8ea53601f5cd2dc00fdbc13d4df4a8c7","0x919C1c267BC06a7039e03fcc2eF738525769109c","0x48065fbBE25f71C9282ddf5e1cD6D6A887483D5e","0x55d398326f99059fF775485246999027B3197955","0xfd086bc7cd5c481dcc9c85ebe478a1c0b69fcbb9"],HTTP_STATUS_CODES:{SERVICE_UNAVAILABLE:503,FORBIDDEN:403},UNSUPPORTED_NETWORK_NAME:"Unknown Network"}},68903:function(e,t,r){"use strict";r.d(t,{p:function(){return i}});let i={caipNetworkIdToNumber:e=>e?Number(e.split(":")[1]):void 0,parseEvmChainId(e){return"string"==typeof e?this.caipNetworkIdToNumber(e):e},getNetworksByNamespace:(e,t)=>e?.filter(e=>e.chainNamespace===t)||[],getFirstNetworkByNamespace(e,t){return this.getNetworksByNamespace(e,t)[0]}}},61616:function(e,t,r){"use strict";r.d(t,{$U:function(){return o},Vk:function(){return s},mr:function(){return n},uJ:function(){return i}});let i={WALLET_ID:"@appkit/wallet_id",WALLET_NAME:"@appkit/wallet_name",SOLANA_WALLET:"@appkit/solana_wallet",SOLANA_CAIP_CHAIN:"@appkit/solana_caip_chain",ACTIVE_CAIP_NETWORK_ID:"@appkit/active_caip_network_id",CONNECTED_SOCIAL:"@appkit/connected_social",CONNECTED_SOCIAL_USERNAME:"@appkit-wallet/SOCIAL_USERNAME",RECENT_WALLETS:"@appkit/recent_wallets",DEEPLINK_CHOICE:"WALLETCONNECT_DEEPLINK_CHOICE",ACTIVE_NAMESPACE:"@appkit/active_namespace",CONNECTED_NAMESPACES:"@appkit/connected_namespaces",CONNECTION_STATUS:"@appkit/connection_status",SIWX_AUTH_TOKEN:"@appkit/siwx-auth-token",SIWX_NONCE_TOKEN:"@appkit/siwx-nonce-token",TELEGRAM_SOCIAL_PROVIDER:"@appkit/social_provider",NATIVE_BALANCE_CACHE:"@appkit/native_balance_cache",PORTFOLIO_CACHE:"@appkit/portfolio_cache",ENS_CACHE:"@appkit/ens_cache",IDENTITY_CACHE:"@appkit/identity_cache"};function s(e){if(!e)throw Error("Namespace is required for CONNECTED_CONNECTOR_ID");return`@appkit/${e}:connected_connector_id`}let n={setItem(e,t){o()&&void 0!==t&&localStorage.setItem(e,t)},getItem(e){if(o())return localStorage.getItem(e)||void 0},removeItem(e){o()&&localStorage.removeItem(e)},clear(){o()&&localStorage.clear()}};function o(){return"undefined"!=typeof window&&"undefined"!=typeof localStorage}},62714:function(e,t,r){"use strict";function i(e,t){return"light"===t?{"--w3m-accent":e?.["--w3m-accent"]||"hsla(231, 100%, 70%, 1)","--w3m-background":"#fff"}:{"--w3m-accent":e?.["--w3m-accent"]||"hsla(230, 100%, 67%, 1)","--w3m-background":"#121313"}}r.d(t,{t:function(){return i}})},68584:function(e,t,r){"use strict";r.d(t,{N:function(){return h}});var i=r(33085),s=r(59712),n=r(53357),o=r(61704),a=r(92144),c=r(66909);let l=(0,i.sj)({currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[]}),h={state:l,replaceState(e){e&&Object.assign(l,(0,i.iH)(e))},subscribe:e=>a.R.subscribeChainProp("accountState",t=>{if(t)return e(t)}),subscribeKey(e,t,r){let i;return a.R.subscribeChainProp("accountState",r=>{if(r){let s=r[e];i!==s&&(i=s,t(s))}},r)},setStatus(e,t){a.R.setAccountProp("status",e,t)},getCaipAddress:e=>a.R.getAccountProp("caipAddress",e),setCaipAddress(e,t){let r=e?n.j.getPlainAddress(e):void 0;t===a.R.state.activeChain&&(a.R.state.activeCaipAddress=e),a.R.setAccountProp("caipAddress",e,t),a.R.setAccountProp("address",r,t)},setBalance(e,t,r){a.R.setAccountProp("balance",e,r),a.R.setAccountProp("balanceSymbol",t,r)},setProfileName(e,t){a.R.setAccountProp("profileName",e,t)},setProfileImage(e,t){a.R.setAccountProp("profileImage",e,t)},setUser(e,t){a.R.setAccountProp("user",e,t)},setAddressExplorerUrl(e,t){a.R.setAccountProp("addressExplorerUrl",e,t)},setSmartAccountDeployed(e,t){a.R.setAccountProp("smartAccountDeployed",e,t)},setCurrentTab(e){a.R.setAccountProp("currentTab",e,a.R.state.activeChain)},setTokenBalance(e,t){e&&a.R.setAccountProp("tokenBalance",e,t)},setShouldUpdateToAddress(e,t){a.R.setAccountProp("shouldUpdateToAddress",e,t)},setAllAccounts(e,t){a.R.setAccountProp("allAccounts",e,t)},addAddressLabel(e,t,r){let i=a.R.getAccountProp("addressLabels",r)||new Map;i.set(e,t),a.R.setAccountProp("addressLabels",i,r)},removeAddressLabel(e,t){let r=a.R.getAccountProp("addressLabels",t)||new Map;r.delete(e),a.R.setAccountProp("addressLabels",r,t)},setConnectedWalletInfo(e,t){a.R.setAccountProp("connectedWalletInfo",e,t,!1)},setPreferredAccountType(e,t){a.R.setAccountProp("preferredAccountType",e,t)},setSocialProvider(e,t){e&&a.R.setAccountProp("socialProvider",e,t)},setSocialWindow(e,t){a.R.setAccountProp("socialWindow",e?(0,i.iH)(e):void 0,t)},setFarcasterUrl(e,t){a.R.setAccountProp("farcasterUrl",e,t)},async fetchTokenBalance(e){l.balanceLoading=!0;let t=a.R.state.activeCaipNetwork?.caipNetworkId,r=a.R.state.activeCaipNetwork?.chainNamespace,i=a.R.state.activeCaipAddress,h=i?n.j.getPlainAddress(i):void 0;if(l.lastRetry&&!n.j.isAllowedRetry(l.lastRetry,30*s.bq.ONE_SEC_MS))return l.balanceLoading=!1,[];try{if(h&&t&&r){let e=(await o.L.getBalance(h,t)).balances.filter(e=>"0"!==e.quantity.decimals);return this.setTokenBalance(e,r),l.lastRetry=void 0,l.balanceLoading=!1,e}}catch(t){l.lastRetry=Date.now(),e?.(t),c.SnackController.showError("Token Balance Unavailable")}finally{l.balanceLoading=!1}return[]},resetAccount(e){a.R.resetAccount(e)}}},72723:function(e,t,r){"use strict";r.d(t,{AlertController:function(){return a}});var i=r(33085),s=r(55543),n=r(48415);let o=(0,i.sj)({message:"",variant:"info",open:!1}),a={state:o,subscribeKey:(e,t)=>(0,s.VW)(o,e,t),open(e,t){let{debug:r}=n.OptionsController.state,{shortMessage:i,longMessage:s}=e;r&&(o.message=i,o.variant=t,o.open=!0),s&&console.error("function"==typeof s?s():s)},close(){o.open=!1,o.message="",o.variant="info"}}},17766:function(e,t,r){"use strict";r.d(t,{ApiController:function(){return y}});var i=r(33085),s=r(55543),n=r(63043),o=r(53357),a=r(39905),c=r(36801),l=r(22472),h=r(92144),u=r(54173),d=r(31929),p=r(48415);let f=o.j.getApiUrl(),g=new a.V({baseUrl:f,clientId:null}),m=(0,i.sj)({promises:{},page:1,count:0,featured:[],allFeatured:[],recommended:[],allRecommended:[],wallets:[],search:[],isAnalyticsEnabled:!1,excludedWallets:[],isFetchingRecommendedWallets:!1}),y={state:m,subscribeKey:(e,t)=>(0,s.VW)(m,e,t),_getSdkProperties(){let{projectId:e,sdkType:t,sdkVersion:r}=p.OptionsController.state;return{projectId:e,st:t||"appkit",sv:r||"html-wagmi-4.2.2"}},_filterOutExtensions:e=>p.OptionsController.state.isUniversalProvider?e.filter(e=>!!(e.mobile_link||e.desktop_link||e.webapp_link)):e,async _fetchWalletImage(e){let t=`${g.baseUrl}/getWalletImage/${e}`,r=await g.getBlob({path:t,params:y._getSdkProperties()});l.W.setWalletImage(e,URL.createObjectURL(r))},async _fetchNetworkImage(e){let t=`${g.baseUrl}/public/getAssetImage/${e}`,r=await g.getBlob({path:t,params:y._getSdkProperties()});l.W.setNetworkImage(e,URL.createObjectURL(r))},async _fetchConnectorImage(e){let t=`${g.baseUrl}/public/getAssetImage/${e}`,r=await g.getBlob({path:t,params:y._getSdkProperties()});l.W.setConnectorImage(e,URL.createObjectURL(r))},async _fetchCurrencyImage(e){let t=`${g.baseUrl}/public/getCurrencyImage/${e}`,r=await g.getBlob({path:t,params:y._getSdkProperties()});l.W.setCurrencyImage(e,URL.createObjectURL(r))},async _fetchTokenImage(e){let t=`${g.baseUrl}/public/getTokenImage/${e}`,r=await g.getBlob({path:t,params:y._getSdkProperties()});l.W.setTokenImage(e,URL.createObjectURL(r))},async fetchNetworkImages(){let e=h.R.getAllRequestedCaipNetworks(),t=e?.map(({assets:e})=>e?.imageId).filter(Boolean).filter(e=>!n.f.getNetworkImageById(e));t&&await Promise.allSettled(t.map(e=>y._fetchNetworkImage(e)))},async fetchConnectorImages(){let{connectors:e}=u.ConnectorController.state,t=e.map(({imageId:e})=>e).filter(Boolean);await Promise.allSettled(t.map(e=>y._fetchConnectorImage(e)))},async fetchCurrencyImages(e=[]){await Promise.allSettled(e.map(e=>y._fetchCurrencyImage(e)))},async fetchTokenImages(e=[]){await Promise.allSettled(e.map(e=>y._fetchTokenImage(e)))},async fetchFeaturedWallets(){let{featuredWalletIds:e}=p.OptionsController.state;if(e?.length){let{data:t}=await g.get({path:"/getWallets",params:{...y._getSdkProperties(),page:"1",entries:e?.length?String(e.length):"4",include:e?.join(",")}});t.sort((t,r)=>e.indexOf(t.id)-e.indexOf(r.id));let r=t.map(e=>e.image_id).filter(Boolean);await Promise.allSettled(r.map(e=>y._fetchWalletImage(e))),m.featured=t,m.allFeatured=t}},async fetchRecommendedWallets(){try{m.isFetchingRecommendedWallets=!0;let{includeWalletIds:e,excludeWalletIds:t,featuredWalletIds:r}=p.OptionsController.state,i=[...t??[],...r??[]].filter(Boolean),s=h.R.getRequestedCaipNetworkIds().join(","),{data:n,count:o}=await g.get({path:"/getWallets",params:{...y._getSdkProperties(),page:"1",chains:s,entries:"4",include:e?.join(","),exclude:i?.join(",")}}),a=c.M.getRecentWallets(),l=n.map(e=>e.image_id).filter(Boolean),u=a.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...l,...u].map(e=>y._fetchWalletImage(e))),m.recommended=n,m.allRecommended=n,m.count=o??0}catch{}finally{m.isFetchingRecommendedWallets=!1}},async fetchWallets({page:e}){let{includeWalletIds:t,excludeWalletIds:r,featuredWalletIds:i}=p.OptionsController.state,s=h.R.getRequestedCaipNetworkIds().join(","),n=[...m.recommended.map(({id:e})=>e),...r??[],...i??[]].filter(Boolean),{data:a,count:c}=await g.get({path:"/getWallets",params:{...y._getSdkProperties(),page:String(e),entries:"40",chains:s,include:t?.join(","),exclude:n.join(",")}}),l=a.slice(0,20).map(e=>e.image_id).filter(Boolean);await Promise.allSettled(l.map(e=>y._fetchWalletImage(e))),m.wallets=o.j.uniqueBy([...m.wallets,...y._filterOutExtensions(a)],"id"),m.count=c>m.count?c:m.count,m.page=e},async initializeExcludedWallets({ids:e}){let t=h.R.getRequestedCaipNetworkIds().join(","),{data:r}=await g.get({path:"/getWallets",params:{...y._getSdkProperties(),page:"1",entries:String(e.length),chains:t,include:e?.join(",")}});r&&r.forEach(e=>{e?.rdns&&m.excludedWallets.push({rdns:e.rdns,name:e.name})})},async searchWallet({search:e,badge:t}){let{includeWalletIds:r,excludeWalletIds:i}=p.OptionsController.state;m.search=[];let s=h.R.getRequestedCaipNetworkIds().join(","),{data:n}=await g.get({path:"/getWallets",params:{...y._getSdkProperties(),page:"1",entries:"100",search:e?.trim(),badge_type:t,chains:s,include:r?.join(","),exclude:i?.join(",")}});d.X.sendEvent({type:"track",event:"SEARCH_WALLET",properties:{badge:t??"",search:e??""}});let a=n.map(e=>e.image_id).filter(Boolean);await Promise.allSettled([...a.map(e=>y._fetchWalletImage(e)),o.j.wait(300)]),m.search=y._filterOutExtensions(n)},initPromise:(e,t)=>m.promises[e]||(m.promises[e]=t()),prefetch:({fetchConnectorImages:e=!0,fetchFeaturedWallets:t=!0,fetchRecommendedWallets:r=!0,fetchNetworkImages:i=!0}={})=>Promise.allSettled([e&&y.initPromise("connectorImages",y.fetchConnectorImages),t&&y.initPromise("featuredWallets",y.fetchFeaturedWallets),r&&y.initPromise("recommendedWallets",y.fetchRecommendedWallets),i&&y.initPromise("networkImages",y.fetchNetworkImages)].filter(Boolean)),prefetchAnalyticsConfig(){p.OptionsController.state.features?.analytics&&y.fetchAnalyticsConfig()},async fetchAnalyticsConfig(){try{let{isAnalyticsEnabled:e}=await g.get({path:"/getAnalyticsConfig",params:y._getSdkProperties()});p.OptionsController.setFeatures({analytics:e})}catch(e){p.OptionsController.setFeatures({analytics:!1})}},setFilterByNamespace(e){if(!e){m.featured=m.allFeatured,m.recommended=m.allRecommended;return}let t=h.R.getRequestedCaipNetworkIds().join(",");m.featured=m.allFeatured.filter(e=>e.chains?.some(e=>t.includes(e))),m.recommended=m.allRecommended.filter(e=>e.chains?.some(e=>t.includes(e)))}}},22472:function(e,t,r){"use strict";r.d(t,{W:function(){return o}});var i=r(33085),s=r(55543);let n=(0,i.sj)({walletImages:{},networkImages:{},chainImages:{},connectorImages:{},tokenImages:{},currencyImages:{}}),o={state:n,subscribeNetworkImages:e=>(0,i.Ld)(n.networkImages,()=>e(n.networkImages)),subscribeKey:(e,t)=>(0,s.VW)(n,e,t),subscribe:e=>(0,i.Ld)(n,()=>e(n)),setWalletImage(e,t){n.walletImages[e]=t},setNetworkImage(e,t){n.networkImages[e]=t},setChainImage(e,t){n.chainImages[e]=t},setConnectorImage(e,t){n.connectorImages={...n.connectorImages,[e]:t}},setTokenImage(e,t){n.tokenImages[e]=t},setCurrencyImage(e,t){n.currencyImages[e]=t}}},61704:function(e,t,r){"use strict";r.d(t,{L:function(){return g}});var i=r(33085),s=r(59712),n=r(53357),o=r(39905),a=r(36801),c=r(68584),l=r(92144),h=r(48415),u=r(66909);let d={purchaseCurrencies:[{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"USD Coin",symbol:"USDC",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]},{id:"2b92315d-eab7-5bef-84fa-089a131333f5",name:"Ether",symbol:"ETH",networks:[{name:"ethereum-mainnet",display_name:"Ethereum",chain_id:"1",contract_address:"0xA0b86991c6218b36c1d19D4a2e9Eb0cE3606eB48"},{name:"polygon-mainnet",display_name:"Polygon",chain_id:"137",contract_address:"0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174"}]}],paymentCurrencies:[{id:"USD",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]},{id:"EUR",payment_method_limits:[{id:"card",min:"10.00",max:"7500.00"},{id:"ach_bank_account",min:"10.00",max:"25000.00"}]}]},p=n.j.getBlockchainApiUrl(),f=(0,i.sj)({clientId:null,api:new o.V({baseUrl:p,clientId:null}),supportedChains:{http:[],ws:[]}}),g={state:f,async get(e){let{st:t,sv:r}=g.getSdkProperties(),i=h.OptionsController.state.projectId,s={...e.params||{},st:t,sv:r,projectId:i};return f.api.get({...e,params:s})},getSdkProperties(){let{sdkType:e,sdkVersion:t}=h.OptionsController.state;return{st:e||"unknown",sv:t||"unknown"}},async isNetworkSupported(e){if(!e)return!1;try{f.supportedChains.http.length||await g.getSupportedNetworks()}catch(e){return!1}return f.supportedChains.http.includes(e)},async getSupportedNetworks(){let e=await g.get({path:"v1/supported-chains"});return f.supportedChains=e,e},async fetchIdentity({address:e,caipNetworkId:t}){if(!await g.isNetworkSupported(t))return{avatar:"",name:""};let r=a.M.getIdentityFromCacheForAddress(e);if(r)return r;let i=await g.get({path:`/v1/identity/${e}`,params:{sender:l.R.state.activeCaipAddress?n.j.getPlainAddress(l.R.state.activeCaipAddress):void 0}});return a.M.updateIdentityCache({address:e,identity:i,timestamp:Date.now()}),i},fetchTransactions:async({account:e,cursor:t,onramp:r,signal:i,cache:s,chainId:n})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/account/${e}/history`,params:{cursor:t,onramp:r,chainId:n},signal:i,cache:s}):{data:[],next:void 0},fetchSwapQuote:async({amount:e,userAddress:t,from:r,to:i,gasPrice:s})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/quotes",headers:{"Content-Type":"application/json"},params:{amount:e,userAddress:t,from:r,to:i,gasPrice:s}}):{quotes:[]},fetchSwapTokens:async({chainId:e})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/tokens",params:{chainId:e}}):{tokens:[]},fetchTokenPrice:async({addresses:e})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/fungible/price",body:{currency:"usd",addresses:e,projectId:h.OptionsController.state.projectId},headers:{"Content-Type":"application/json"}}):{fungibles:[]},fetchSwapAllowance:async({tokenAddress:e,userAddress:t})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:"/v1/convert/allowance",params:{tokenAddress:e,userAddress:t},headers:{"Content-Type":"application/json"}}):{allowance:"0"},async fetchGasPrice({chainId:e}){let{st:t,sv:r}=g.getSdkProperties();if(!await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId))throw Error("Network not supported for Gas Price");return g.get({path:"/v1/convert/gas-price",headers:{"Content-Type":"application/json"},params:{chainId:e,st:t,sv:r}})},async generateSwapCalldata({amount:e,from:t,to:r,userAddress:i,disableEstimate:n}){if(!await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId))throw Error("Network not supported for Swaps");return f.api.post({path:"/v1/convert/build-transaction",headers:{"Content-Type":"application/json"},body:{amount:e,eip155:{slippage:s.bq.CONVERT_SLIPPAGE_TOLERANCE},projectId:h.OptionsController.state.projectId,from:t,to:r,userAddress:i,disableEstimate:n}})},async generateApproveCalldata({from:e,to:t,userAddress:r}){let{st:i,sv:s}=g.getSdkProperties();if(!await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId))throw Error("Network not supported for Swaps");return g.get({path:"/v1/convert/build-approve",headers:{"Content-Type":"application/json"},params:{userAddress:r,from:e,to:t,st:i,sv:s}})},async getBalance(e,t,r){let{st:i,sv:s}=g.getSdkProperties();if(!await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId))return u.SnackController.showError("Token Balance Unavailable"),{balances:[]};let n=`${t}:${e}`,o=a.M.getBalanceCacheForCaipAddress(n);if(o)return o;let c=await g.get({path:`/v1/account/${e}/balance`,params:{currency:"usd",chainId:t,forceUpdate:r,st:i,sv:s}});return a.M.updateBalanceCache({caipAddress:n,balance:c,timestamp:Date.now()}),c},lookupEnsName:async e=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/account/${e}`,params:{apiVersion:"2"}}):{addresses:{},attributes:[]},reverseLookupEnsName:async({address:e})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/reverse/${e}`,params:{sender:c.N.state.address,apiVersion:"2"}}):[],getEnsNameSuggestions:async e=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/profile/suggestions/${e}`,params:{zone:"reown.id"}}):{suggestions:[]},registerEnsName:async({coinType:e,address:t,message:r,signature:i})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:"/v1/profile/account",body:{coin_type:e,address:t,message:r,signature:i},headers:{"Content-Type":"application/json"}}):{success:!1},generateOnRampURL:async({destinationWallets:e,partnerUserId:t,defaultNetwork:r,purchaseAmount:i,paymentAmount:s})=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?(await f.api.post({path:"/v1/generators/onrampurl",params:{projectId:h.OptionsController.state.projectId},body:{destinationWallets:e,defaultNetwork:r,partnerUserId:t,defaultExperience:"buy",presetCryptoAmount:i,presetFiatAmount:s}})).url:"",async getOnrampOptions(){if(!await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId))return{paymentCurrencies:[],purchaseCurrencies:[]};try{return await g.get({path:"/v1/onramp/options"})}catch(e){return d}},async getOnrampQuote({purchaseCurrency:e,paymentCurrency:t,amount:r,network:i}){try{if(!await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId))return null;return await f.api.post({path:"/v1/onramp/quote",params:{projectId:h.OptionsController.state.projectId},body:{purchaseCurrency:e,paymentCurrency:t,amount:r,network:i}})}catch(e){return{coinbaseFee:{amount:r,currency:t.id},networkFee:{amount:r,currency:t.id},paymentSubtotal:{amount:r,currency:t.id},paymentTotal:{amount:r,currency:t.id},purchaseAmount:{amount:r,currency:t.id},quoteId:"mocked-quote-id"}}},getSmartSessions:async e=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?g.get({path:`/v1/sessions/${e}`}):[],revokeSmartSession:async(e,t,r)=>await g.isNetworkSupported(l.R.state.activeCaipNetwork?.caipNetworkId)?f.api.post({path:`/v1/sessions/${e}/revoke`,params:{projectId:h.OptionsController.state.projectId},body:{pci:t,signature:r}}):{success:!1},setClientId(e){f.clientId=e,f.api=new o.V({baseUrl:p,clientId:e})}}},92144:function(e,t,r){"use strict";r.d(t,{R:function(){return F}});var i=r(33085),s=r(55543),n=r(68903),o=r(44649),a=r(54173);function c(e,t){return a.ConnectorController.getConnectorId(e)===t}var l=r(59712),h=r(53357),u=r(36801),d=r(68584),p=r(93046),f=r(31929),g=r(89512),m=r(48415),y=r(96986),b=r(86777),w="[big.js] ",v=w+"Invalid ",E=v+"decimal places",I=v+"rounding mode",_=w+"Division by zero",C={},S=void 0,N=/^-?(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i;function A(e,t,r,i){var s=e.c;if(r===S&&(r=e.constructor.RM),0!==r&&1!==r&&2!==r&&3!==r)throw Error(I);if(t<1)i=3===r&&(i||!!s[0])||0===t&&(1===r&&s[0]>=5||2===r&&(s[0]>5||5===s[0]&&(i||s[1]!==S))),s.length=1,i?(e.e=e.e-t+1,s[0]=1):s[0]=e.e=0;else if(t<s.length){if(i=1===r&&s[t]>=5||2===r&&(s[t]>5||5===s[t]&&(i||s[t+1]!==S||1&s[t-1]))||3===r&&(i||!!s[0]),s.length=t,i){for(;++s[--t]>9;)if(s[t]=0,0===t){++e.e,s.unshift(1);break}}for(t=s.length;!s[--t];)s.pop()}return e}function O(e,t,r){var i=e.e,s=e.c.join(""),n=s.length;if(t)s=s.charAt(0)+(n>1?"."+s.slice(1):"")+(i<0?"e":"e+")+i;else if(i<0){for(;++i;)s="0"+s;s="0."+s}else if(i>0){if(++i>n)for(i-=n;i--;)s+="0";else i<n&&(s=s.slice(0,i)+"."+s.slice(i))}else n>1&&(s=s.charAt(0)+"."+s.slice(1));return e.s<0&&r?"-"+s:s}C.abs=function(){var e=new this.constructor(this);return e.s=1,e},C.cmp=function(e){var t,r=this.c,i=(e=new this.constructor(e)).c,s=this.s,n=e.s,o=this.e,a=e.e;if(!r[0]||!i[0])return r[0]?s:i[0]?-n:0;if(s!=n)return s;if(t=s<0,o!=a)return o>a^t?1:-1;for(s=-1,n=(o=r.length)<(a=i.length)?o:a;++s<n;)if(r[s]!=i[s])return r[s]>i[s]^t?1:-1;return o==a?0:o>a^t?1:-1},C.div=function(e){var t=this.constructor,r=this.c,i=(e=new t(e)).c,s=this.s==e.s?1:-1,n=t.DP;if(n!==~~n||n<0||n>1e6)throw Error(E);if(!i[0])throw Error(_);if(!r[0])return e.s=s,e.c=[e.e=0],e;var o,a,c,l,h,u=i.slice(),d=o=i.length,p=r.length,f=r.slice(0,o),g=f.length,m=e,y=m.c=[],b=0,w=n+(m.e=this.e-e.e)+1;for(m.s=s,s=w<0?0:w,u.unshift(0);g++<o;)f.push(0);do{for(c=0;c<10;c++){if(o!=(g=f.length))l=o>g?1:-1;else for(h=-1,l=0;++h<o;)if(i[h]!=f[h]){l=i[h]>f[h]?1:-1;break}if(l<0){for(a=g==o?i:u;g;){if(f[--g]<a[g]){for(h=g;h&&!f[--h];)f[h]=9;--f[h],f[g]+=10}f[g]-=a[g]}for(;!f[0];)f.shift()}else break}y[b++]=l?c:++c,f[0]&&l?f[g]=r[d]||0:f=[r[d]]}while((d++<p||f[0]!==S)&&s--);return!y[0]&&1!=b&&(y.shift(),m.e--,w--),b>w&&A(m,w,t.RM,f[0]!==S),m},C.eq=function(e){return 0===this.cmp(e)},C.gt=function(e){return this.cmp(e)>0},C.gte=function(e){return this.cmp(e)>-1},C.lt=function(e){return 0>this.cmp(e)},C.lte=function(e){return 1>this.cmp(e)},C.minus=C.sub=function(e){var t,r,i,s,n=this.constructor,o=this.s,a=(e=new n(e)).s;if(o!=a)return e.s=-a,this.plus(e);var c=this.c.slice(),l=this.e,h=e.c,u=e.e;if(!c[0]||!h[0])return h[0]?e.s=-a:c[0]?e=new n(this):e.s=1,e;if(o=l-u){for((s=o<0)?(o=-o,i=c):(u=l,i=h),i.reverse(),a=o;a--;)i.push(0);i.reverse()}else for(r=((s=c.length<h.length)?c:h).length,o=a=0;a<r;a++)if(c[a]!=h[a]){s=c[a]<h[a];break}if(s&&(i=c,c=h,h=i,e.s=-e.s),(a=(r=h.length)-(t=c.length))>0)for(;a--;)c[t++]=0;for(a=t;r>o;){if(c[--r]<h[r]){for(t=r;t&&!c[--t];)c[t]=9;--c[t],c[r]+=10}c[r]-=h[r]}for(;0===c[--a];)c.pop();for(;0===c[0];)c.shift(),--u;return c[0]||(e.s=1,c=[u=0]),e.c=c,e.e=u,e},C.mod=function(e){var t,r=this,i=r.constructor,s=r.s,n=(e=new i(e)).s;if(!e.c[0])throw Error(_);return(r.s=e.s=1,t=1==e.cmp(r),r.s=s,e.s=n,t)?new i(r):(s=i.DP,n=i.RM,i.DP=i.RM=0,r=r.div(e),i.DP=s,i.RM=n,this.minus(r.times(e)))},C.neg=function(){var e=new this.constructor(this);return e.s=-e.s,e},C.plus=C.add=function(e){var t,r,i,s=this.constructor;if(e=new s(e),this.s!=e.s)return e.s=-e.s,this.minus(e);var n=this.e,o=this.c,a=e.e,c=e.c;if(!o[0]||!c[0])return c[0]||(o[0]?e=new s(this):e.s=this.s),e;if(o=o.slice(),t=n-a){for(t>0?(a=n,i=c):(t=-t,i=o),i.reverse();t--;)i.push(0);i.reverse()}for(o.length-c.length<0&&(i=c,c=o,o=i),t=c.length,r=0;t;o[t]%=10)r=(o[--t]=o[t]+c[t]+r)/10|0;for(r&&(o.unshift(r),++a),t=o.length;0===o[--t];)o.pop();return e.c=o,e.e=a,e},C.pow=function(e){var t=this,r=new t.constructor("1"),i=r,s=e<0;if(e!==~~e||e<-1e6||e>1e6)throw Error(v+"exponent");for(s&&(e=-e);1&e&&(i=i.times(t)),e>>=1;)t=t.times(t);return s?r.div(i):i},C.prec=function(e,t){if(e!==~~e||e<1||e>1e6)throw Error(v+"precision");return A(new this.constructor(this),e,t)},C.round=function(e,t){if(e===S)e=0;else if(e!==~~e||e<-1e6||e>1e6)throw Error(E);return A(new this.constructor(this),e+this.e+1,t)},C.sqrt=function(){var e,t,r,i=this.constructor,s=this.s,n=this.e,o=new i("0.5");if(!this.c[0])return new i(this);if(s<0)throw Error(w+"No square root");0===(s=Math.sqrt(+O(this,!0,!0)))||s===1/0?((t=this.c.join("")).length+n&1||(t+="0"),n=((n+1)/2|0)-(n<0||1&n),e=new i(((s=Math.sqrt(t))==1/0?"5e":(s=s.toExponential()).slice(0,s.indexOf("e")+1))+n)):e=new i(s+""),n=e.e+(i.DP+=4);do r=e,e=o.times(r.plus(this.div(r)));while(r.c.slice(0,n).join("")!==e.c.slice(0,n).join(""));return A(e,(i.DP-=4)+e.e+1,i.RM)},C.times=C.mul=function(e){var t,r=this.constructor,i=this.c,s=(e=new r(e)).c,n=i.length,o=s.length,a=this.e,c=e.e;if(e.s=this.s==e.s?1:-1,!i[0]||!s[0])return e.c=[e.e=0],e;for(e.e=a+c,n<o&&(t=i,i=s,s=t,c=n,n=o,o=c),t=Array(c=n+o);c--;)t[c]=0;for(a=o;a--;){for(o=0,c=n+a;c>a;)o=t[c]+s[a]*i[c-a-1]+o,t[c--]=o%10,o=o/10|0;t[c]=o}for(o?++e.e:t.shift(),a=t.length;!t[--a];)t.pop();return e.c=t,e},C.toExponential=function(e,t){var r=this,i=r.c[0];if(e!==S){if(e!==~~e||e<0||e>1e6)throw Error(E);for(r=A(new r.constructor(r),++e,t);r.c.length<e;)r.c.push(0)}return O(r,!0,!!i)},C.toFixed=function(e,t){var r=this,i=r.c[0];if(e!==S){if(e!==~~e||e<0||e>1e6)throw Error(E);for(r=A(new r.constructor(r),e+r.e+1,t),e=e+r.e+1;r.c.length<e;)r.c.push(0)}return O(r,!1,!!i)},C[Symbol.for("nodejs.util.inspect.custom")]=C.toJSON=C.toString=function(){var e=this.constructor;return O(this,this.e<=e.NE||this.e>=e.PE,!!this.c[0])},C.toNumber=function(){var e=+O(this,!0,!0);if(!0===this.constructor.strict&&!this.eq(e.toString()))throw Error(w+"Imprecise conversion");return e},C.toPrecision=function(e,t){var r=this,i=r.constructor,s=r.c[0];if(e!==S){if(e!==~~e||e<1||e>1e6)throw Error(v+"precision");for(r=A(new i(r),e,t);r.c.length<e;)r.c.push(0)}return O(r,e<=r.e||r.e<=i.NE||r.e>=i.PE,!!s)},C.valueOf=function(){var e=this.constructor;if(!0===e.strict)throw Error(w+"valueOf disallowed");return O(this,this.e<=e.NE||this.e>=e.PE,!0)};var M=function e(){function t(r){if(!(this instanceof t))return r===S?e():new t(r);if(r instanceof t)this.s=r.s,this.e=r.e,this.c=r.c.slice();else{if("string"!=typeof r){if(!0===t.strict&&"bigint"!=typeof r)throw TypeError(v+"value");r=0===r&&1/r<0?"-0":String(r)}!function(e,t){var r,i,s;if(!N.test(t))throw Error(v+"number");for(e.s="-"==t.charAt(0)?(t=t.slice(1),-1):1,(r=t.indexOf("."))>-1&&(t=t.replace(".","")),(i=t.search(/e/i))>0?(r<0&&(r=i),r+=+t.slice(i+1),t=t.substring(0,i)):r<0&&(r=t.length),s=t.length,i=0;i<s&&"0"==t.charAt(i);)++i;if(i==s)e.c=[e.e=0];else{for(;s>0&&"0"==t.charAt(--s););for(e.e=r-i-1,e.c=[],r=0;i<=s;)e.c[r++]=+t.charAt(i++)}}(this,r)}this.constructor=t}return t.prototype=C,t.DP=20,t.RM=1,t.NE=-7,t.PE=21,t.strict=!1,t.roundDown=0,t.roundHalfUp=1,t.roundHalfEven=2,t.roundUp=3,t}();let P={bigNumber:e=>new M(e||0),multiply(e,t){if(void 0===e||void 0===t)return new M(0);let r=new M(e),i=new M(t);return r.times(i)},formatNumberToLocalString:(e,t=2)=>void 0===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}),parseLocalStringToNumber:e=>void 0===e?0:parseFloat(e.replace(/,/gu,""))},x=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_value",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],T=[{type:"function",name:"transfer",stateMutability:"nonpayable",inputs:[{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[]},{type:"function",name:"transferFrom",stateMutability:"nonpayable",inputs:[{name:"sender",type:"address"},{name:"recipient",type:"address"},{name:"amount",type:"uint256"}],outputs:[{name:"",type:"bool"}]}],D={getERC20Abi:e=>o.b.USDT_CONTRACT_ADDRESSES.includes(e)?T:x};var R=r(4786),k=r(61704),j=r(39502);let L={createBalance(e,t){let r={name:e.metadata.name||"",symbol:e.metadata.symbol||"",decimals:e.metadata.decimals||0,value:e.metadata.value||0,price:e.metadata.price||0,iconUrl:e.metadata.iconUrl||""};return{name:r.name,symbol:r.symbol,chainId:t,address:"native"===e.address?void 0:this.convertAddressToCAIP10Address(e.address,t),value:r.value,price:r.price,quantity:{decimals:r.decimals.toString(),numeric:this.convertHexToBalance({hex:e.balance,decimals:r.decimals})},iconUrl:r.iconUrl}},convertHexToBalance:({hex:e,decimals:t})=>(0,j.b)(BigInt(e),t),convertAddressToCAIP10Address:(e,t)=>`${t}:${e}`,createCAIP2ChainId:(e,t)=>`${t}:${parseInt(e,16)}`,getChainIdHexFromCAIP2ChainId(e){let t=e.split(":");if(t.length<2||!t[1])return"0x0";let r=parseInt(t[1],10);return isNaN(r)?"0x0":`0x${r.toString(16)}`},isWalletGetAssetsResponse(e){return"object"==typeof e&&null!==e&&Object.values(e).every(e=>Array.isArray(e)&&e.every(e=>this.isValidAsset(e)))},isValidAsset:e=>"object"==typeof e&&null!==e&&"string"==typeof e.address&&"string"==typeof e.balance&&("ERC20"===e.type||"NATIVE"===e.type)&&"object"==typeof e.metadata&&null!==e.metadata&&"string"==typeof e.metadata.name&&"string"==typeof e.metadata.symbol&&"number"==typeof e.metadata.decimals&&"number"==typeof e.metadata.price&&"string"==typeof e.metadata.iconUrl},U={async getMyTokensWithBalance(e){let t=d.N.state.address,r=F.state.activeCaipNetwork;if(!t||!r)return[];if("eip155"===r.chainNamespace){let e=await this.getEIP155Balances(t,r);if(e)return this.filterLowQualityTokens(e)}let i=await k.L.getBalance(t,r.caipNetworkId,e);return this.filterLowQualityTokens(i.balances)},async getEIP155Balances(e,t){try{let r=L.getChainIdHexFromCAIP2ChainId(t.caipNetworkId),i=await p.ConnectionController.getCapabilities(e);if(!i?.[r]?.assetDiscovery?.supported)return null;let s=await p.ConnectionController.walletGetAssets({account:e,chainFilter:[r]});if(!L.isWalletGetAssetsResponse(s))return null;return(s[r]||[]).map(e=>L.createBalance(e,t.caipNetworkId))}catch(e){return null}},filterLowQualityTokens:e=>e.filter(e=>"0"!==e.quantity.decimals),mapBalancesToSwapTokens:e=>e?.map(e=>({...e,address:e?.address?e.address:F.getActiveNetworkTokenAddress(),decimals:parseInt(e.quantity.decimals,10),logoUri:e.iconUrl,eip2612:!1}))||[]};var z=r(66909);let $=(0,i.sj)({tokenBalances:[],loading:!1}),q={state:$,subscribe:e=>(0,i.Ld)($,()=>e($)),subscribeKey:(e,t)=>(0,s.VW)($,e,t),setToken(e){e&&($.token=(0,i.iH)(e))},setTokenAmount(e){$.sendTokenAmount=e},setReceiverAddress(e){$.receiverAddress=e},setReceiverProfileImageUrl(e){$.receiverProfileImageUrl=e},setReceiverProfileName(e){$.receiverProfileName=e},setGasPrice(e){$.gasPrice=e},setGasPriceInUsd(e){$.gasPriceInUSD=e},setNetworkBalanceInUsd(e){$.networkBalanceInUSD=e},setLoading(e){$.loading=e},sendToken(){switch(F.state.activeCaipNetwork?.chainNamespace){case"eip155":this.sendEvmToken();return;case"solana":this.sendSolanaToken();return;default:throw Error("Unsupported chain")}},sendEvmToken(){this.state.token?.address&&this.state.sendTokenAmount&&this.state.receiverAddress?(f.X.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:d.N.state.preferredAccountType===R.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token.address,amount:this.state.sendTokenAmount,network:F.state.activeCaipNetwork?.caipNetworkId||""}}),this.sendERC20Token({receiverAddress:this.state.receiverAddress,tokenAddress:this.state.token.address,sendTokenAmount:this.state.sendTokenAmount,decimals:this.state.token.quantity.decimals})):this.state.receiverAddress&&this.state.sendTokenAmount&&this.state.gasPrice&&this.state.token?.quantity.decimals&&(f.X.sendEvent({type:"track",event:"SEND_INITIATED",properties:{isSmartAccount:d.N.state.preferredAccountType===R.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol,amount:this.state.sendTokenAmount,network:F.state.activeCaipNetwork?.caipNetworkId||""}}),this.sendNativeToken({receiverAddress:this.state.receiverAddress,sendTokenAmount:this.state.sendTokenAmount,gasPrice:this.state.gasPrice,decimals:this.state.token.quantity.decimals}))},async fetchTokenBalance(e){$.loading=!0;let t=F.state.activeCaipNetwork?.caipNetworkId,r=F.state.activeCaipNetwork?.chainNamespace,i=F.state.activeCaipAddress,s=i?h.j.getPlainAddress(i):void 0;if($.lastRetry&&!h.j.isAllowedRetry($.lastRetry,30*l.bq.ONE_SEC_MS))return $.loading=!1,[];try{if(s&&t&&r){let e=await U.getMyTokensWithBalance();return $.tokenBalances=e,$.lastRetry=void 0,e}}catch(t){$.lastRetry=Date.now(),e?.(t),z.SnackController.showError("Token Balance Unavailable")}finally{$.loading=!1}return[]},fetchNetworkBalance(){if(0===$.tokenBalances.length)return;let e=U.mapBalancesToSwapTokens($.tokenBalances);if(!e)return;let t=e.find(e=>e.address===F.getActiveNetworkTokenAddress());t&&($.networkBalanceInUSD=t?P.multiply(t.quantity.numeric,t.price).toString():"0")},isInsufficientNetworkTokenForGas:(e,t)=>!!P.bigNumber(e).eq(0)||P.bigNumber(P.bigNumber(t||"0")).gt(e),hasInsufficientGasFunds(){let e=!0;return d.N.state.preferredAccountType===R.y_.ACCOUNT_TYPES.SMART_ACCOUNT?e=!1:$.networkBalanceInUSD&&(e=this.isInsufficientNetworkTokenForGas($.networkBalanceInUSD,$.gasPriceInUSD)),e},async sendNativeToken(e){b.RouterController.pushTransactionStack({view:"Account",goBack:!1});let t=e.receiverAddress,r=d.N.state.address,i=p.ConnectionController.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));try{await p.ConnectionController.sendTransaction({chainNamespace:"eip155",to:t,address:r,data:"0x",value:i??BigInt(0),gasPrice:e.gasPrice}),z.SnackController.showSuccess("Transaction started"),f.X.sendEvent({type:"track",event:"SEND_SUCCESS",properties:{isSmartAccount:d.N.state.preferredAccountType===R.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:F.state.activeCaipNetwork?.caipNetworkId||""}}),this.resetSend()}catch(r){console.error("SendController:sendERC20Token - failed to send native token",r);let t=r instanceof Error?r.message:"Unknown error";f.X.sendEvent({type:"track",event:"SEND_ERROR",properties:{message:t,isSmartAccount:d.N.state.preferredAccountType===R.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:F.state.activeCaipNetwork?.caipNetworkId||""}}),z.SnackController.showError("Something went wrong")}},async sendERC20Token(e){b.RouterController.pushTransactionStack({view:"Account",goBack:!1});let t=p.ConnectionController.parseUnits(e.sendTokenAmount.toString(),Number(e.decimals));try{if(d.N.state.address&&e.sendTokenAmount&&e.receiverAddress&&e.tokenAddress){let r=h.j.getPlainAddress(e.tokenAddress);await p.ConnectionController.writeContract({fromAddress:d.N.state.address,tokenAddress:r,args:[e.receiverAddress,t??BigInt(0)],method:"transfer",abi:D.getERC20Abi(r),chainNamespace:"eip155"}),z.SnackController.showSuccess("Transaction started"),this.resetSend()}}catch(r){console.error("SendController:sendERC20Token - failed to send erc20 token",r);let t=r instanceof Error?r.message:"Unknown error";f.X.sendEvent({type:"track",event:"SEND_ERROR",properties:{message:t,isSmartAccount:d.N.state.preferredAccountType===R.y_.ACCOUNT_TYPES.SMART_ACCOUNT,token:this.state.token?.symbol||"",amount:e.sendTokenAmount,network:F.state.activeCaipNetwork?.caipNetworkId||""}}),z.SnackController.showError("Something went wrong")}},sendSolanaToken(){if(!this.state.sendTokenAmount||!this.state.receiverAddress){z.SnackController.showError("Please enter a valid amount and receiver address");return}b.RouterController.pushTransactionStack({view:"Account",goBack:!1}),p.ConnectionController.sendTransaction({chainNamespace:"solana",to:this.state.receiverAddress,value:this.state.sendTokenAmount}).then(()=>{this.resetSend(),d.N.fetchTokenBalance()}).catch(e=>{z.SnackController.showError("Failed to send transaction. Please try again."),console.error("SendController:sendToken - failed to send solana transaction",e)})},resetSend(){$.token=void 0,$.sendTokenAmount=void 0,$.receiverAddress=void 0,$.receiverProfileImageUrl=void 0,$.receiverProfileName=void 0,$.loading=!1,$.tokenBalances=[]}},B={currentTab:0,tokenBalance:[],smartAccountDeployed:!1,addressLabels:new Map,allAccounts:[],user:void 0},W={caipNetwork:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]},H=(0,i.sj)({chains:(0,s.Yr)(),activeCaipAddress:void 0,activeChain:void 0,activeCaipNetwork:void 0,noAdapters:!1,universalAdapter:{networkControllerClient:void 0,connectionControllerClient:void 0},isSwitchingNamespace:!1}),F={state:H,subscribe:e=>(0,i.Ld)(H,()=>{e(H)}),subscribeKey:(e,t)=>(0,s.VW)(H,e,t),subscribeChainProp(e,t,r){let s;return(0,i.Ld)(H.chains,()=>{let i=r||H.activeChain;if(i){let r=H.chains.get(i)?.[e];s!==r&&(s=r,t(r))}})},initialize(e,t,r){let{chainId:s,namespace:n}=u.M.getActiveNetworkProps(),o=t?.find(e=>e.id.toString()===s?.toString()),a=e.find(e=>e?.namespace===n)||e?.[0],c=new Set([...t?.map(e=>e.chainNamespace)??[]]);e?.length!==0&&a||(H.noAdapters=!0),!H.noAdapters&&(H.activeChain=a?.namespace,H.activeCaipNetwork=o,this.setChainNetworkData(a?.namespace,{caipNetwork:o}),H.activeChain&&y.I.set({activeChain:a?.namespace})),c.forEach(e=>{let s=t?.filter(t=>t.chainNamespace===e);F.state.chains.set(e,{namespace:e,networkState:(0,i.sj)({...W,caipNetwork:s?.[0]}),accountState:(0,i.sj)(B),caipNetworks:s??[],...r}),this.setRequestedCaipNetworks(s??[],e)})},removeAdapter(e){if(H.activeChain===e){let t=Array.from(H.chains.entries()).find(([t])=>t!==e);if(t){let e=t[1]?.caipNetworks?.[0];e&&this.setActiveCaipNetwork(e)}}H.chains.delete(e)},addAdapter(e,{networkControllerClient:t,connectionControllerClient:r},i){H.chains.set(e.namespace,{namespace:e.namespace,networkState:{...W,caipNetwork:i[0]},accountState:B,caipNetworks:i,connectionControllerClient:r,networkControllerClient:t}),this.setRequestedCaipNetworks(i?.filter(t=>t.chainNamespace===e.namespace)??[],e.namespace)},addNetwork(e){let t=H.chains.get(e.chainNamespace);if(t){let r=[...t.caipNetworks||[]];t.caipNetworks?.find(t=>t.id===e.id)||r.push(e),H.chains.set(e.chainNamespace,{...t,caipNetworks:r}),this.setRequestedCaipNetworks(r,e.chainNamespace)}},removeNetwork(e,t){let r=H.chains.get(e);if(r){let i=H.activeCaipNetwork?.id===t,s=[...r.caipNetworks?.filter(e=>e.id!==t)||[]];i&&r?.caipNetworks?.[0]&&this.setActiveCaipNetwork(r.caipNetworks[0]),H.chains.set(e,{...r,caipNetworks:s}),this.setRequestedCaipNetworks(s||[],e)}},setAdapterNetworkState(e,t){let r=H.chains.get(e);r&&(r.networkState={...r.networkState||W,...t},H.chains.set(e,r))},setChainAccountData(e,t,r=!0){if(!e)throw Error("Chain is required to update chain account data");let i=H.chains.get(e);if(i){let r={...i.accountState||B,...t};H.chains.set(e,{...i,accountState:r}),(1===H.chains.size||H.activeChain===e)&&(t.caipAddress&&(H.activeCaipAddress=t.caipAddress),d.N.replaceState(r))}},setChainNetworkData(e,t){if(!e)return;let r=H.chains.get(e);if(r){let i={...r.networkState||W,...t};H.chains.set(e,{...r,networkState:i})}},setAccountProp(e,t,r,i=!0){this.setChainAccountData(r,{[e]:t},i),"status"===e&&"disconnected"===t&&r&&a.ConnectorController.removeConnectorId(r)},setActiveNamespace(e){H.activeChain=e;let t=e?H.chains.get(e):void 0,r=t?.networkState?.caipNetwork;r?.id&&e&&(H.activeCaipAddress=t?.accountState?.caipAddress,H.activeCaipNetwork=r,this.setChainNetworkData(e,{caipNetwork:r}),u.M.setActiveCaipNetworkId(r?.caipNetworkId),y.I.set({activeChain:e,selectedNetworkId:r?.caipNetworkId}))},setActiveCaipNetwork(e){if(!e)return;H.activeChain!==e.chainNamespace&&this.setIsSwitchingNamespace(!0);let t=H.chains.get(e.chainNamespace);H.activeChain=e.chainNamespace,H.activeCaipNetwork=e,this.setChainNetworkData(e.chainNamespace,{caipNetwork:e}),t?.accountState?.address?H.activeCaipAddress=`${e.chainNamespace}:${e.id}:${t?.accountState?.address}`:H.activeCaipAddress=void 0,this.setAccountProp("caipAddress",H.activeCaipAddress,e.chainNamespace),t&&d.N.replaceState(t.accountState),q.resetSend(),y.I.set({activeChain:H.activeChain,selectedNetworkId:H.activeCaipNetwork?.caipNetworkId}),u.M.setActiveCaipNetworkId(e.caipNetworkId),this.checkIfSupportedNetwork(e.chainNamespace)||!m.OptionsController.state.enableNetworkSwitch||m.OptionsController.state.allowUnsupportedChain||p.ConnectionController.state.wcBasic||this.showUnsupportedChainUI()},addCaipNetwork(e){if(!e)return;let t=H.chains.get(e.chainNamespace);t&&t?.caipNetworks?.push(e)},async switchActiveNamespace(e){if(!e)return;let t=e!==F.state.activeChain,r=F.getNetworkData(e)?.caipNetwork,i=F.getCaipNetworkByNamespace(e,r?.id);t&&i&&await F.switchActiveNetwork(i)},async switchActiveNetwork(e){let t=F.state.chains.get(F.state.activeChain);t?.caipNetworks?.some(e=>e.id===H.activeCaipNetwork?.id)||b.RouterController.goBack();let r=this.getNetworkControllerClient(e.chainNamespace);r&&(await r.switchCaipNetwork(e),f.X.sendEvent({type:"track",event:"SWITCH_NETWORK",properties:{network:e.caipNetworkId}}))},getNetworkControllerClient(e){let t=e||H.activeChain,r=H.chains.get(t);if(!r)throw Error("Chain adapter not found");if(!r.networkControllerClient)throw Error("NetworkController client not set");return r.networkControllerClient},getConnectionControllerClient(e){let t=e||H.activeChain;if(!t)throw Error("Chain is required to get connection controller client");let r=H.chains.get(t);if(!r?.connectionControllerClient)throw Error("ConnectionController client not set");return r.connectionControllerClient},getAccountProp(e,t){let r=H.activeChain;if(t&&(r=t),!r)return;let i=H.chains.get(r)?.accountState;if(i)return i[e]},getNetworkProp(e,t){let r=H.chains.get(t)?.networkState;if(r)return r[e]},getRequestedCaipNetworks(e){let t=H.chains.get(e),{approvedCaipNetworkIds:r=[],requestedCaipNetworks:i=[]}=t?.networkState||{};return h.j.sortRequestedNetworks(r,i)},getAllRequestedCaipNetworks(){let e=[];return H.chains.forEach(t=>{let r=this.getRequestedCaipNetworks(t.namespace);e.push(...r)}),e},setRequestedCaipNetworks(e,t){this.setAdapterNetworkState(t,{requestedCaipNetworks:e})},getAllApprovedCaipNetworkIds(){let e=[];return H.chains.forEach(t=>{let r=this.getApprovedCaipNetworkIds(t.namespace);e.push(...r)}),e},getActiveCaipNetwork:()=>H.activeCaipNetwork,getActiveCaipAddress:()=>H.activeCaipAddress,getApprovedCaipNetworkIds(e){let t=H.chains.get(e);return t?.networkState?.approvedCaipNetworkIds||[]},async setApprovedCaipNetworksData(e){let t=this.getNetworkControllerClient(),r=await t?.getApprovedCaipNetworksData();this.setAdapterNetworkState(e,{approvedCaipNetworkIds:r?.approvedCaipNetworkIds,supportsAllNetworks:r?.supportsAllNetworks})},checkIfSupportedNetwork(e,t){let r=t||H.activeCaipNetwork,i=this.getRequestedCaipNetworks(e);return!i.length||i?.some(e=>e.id===r?.id)},checkIfSupportedChainId(e){if(!H.activeChain)return!0;let t=this.getRequestedCaipNetworks(H.activeChain);return t?.some(t=>t.id===e)},setSmartAccountEnabledNetworks(e,t){this.setAdapterNetworkState(t,{smartAccountEnabledNetworks:e})},checkIfSmartAccountEnabled(){let e=n.p.caipNetworkIdToNumber(H.activeCaipNetwork?.caipNetworkId),t=H.activeChain;if(!t||!e)return!1;let r=this.getNetworkProp("smartAccountEnabledNetworks",t);return!!r?.includes(Number(e))},getActiveNetworkTokenAddress(){let e=H.activeCaipNetwork?.chainNamespace||"eip155",t=H.activeCaipNetwork?.id||1,r=l.bq.NATIVE_TOKEN_ADDRESS[e];return`${e}:${t}:${r}`},showUnsupportedChainUI(){g.I.open({view:"UnsupportedChain"})},checkIfNamesSupported(){let e=H.activeCaipNetwork;return!!(e?.chainNamespace&&l.bq.NAMES_SUPPORTED_CHAIN_NAMESPACES.includes(e.chainNamespace))},resetNetwork(e){this.setAdapterNetworkState(e,{approvedCaipNetworkIds:void 0,supportsAllNetworks:!0,smartAccountEnabledNetworks:[]})},resetAccount(e){if(!e)throw Error("Chain is required to set account prop");H.activeCaipAddress=void 0,this.setChainAccountData(e,{smartAccountDeployed:!1,currentTab:0,caipAddress:void 0,address:void 0,balance:void 0,balanceSymbol:void 0,profileName:void 0,profileImage:void 0,addressExplorerUrl:void 0,tokenBalance:[],connectedWalletInfo:void 0,preferredAccountType:void 0,socialProvider:void 0,socialWindow:void 0,farcasterUrl:void 0,allAccounts:[],user:void 0,status:"disconnected"}),a.ConnectorController.removeConnectorId(e)},async disconnect(e){let t=function(e){let t=Array.from(F.state.chains.keys()),r=[];return e?(r.push([e,F.state.chains.get(e)]),c(e,o.b.CONNECTOR_ID.WALLET_CONNECT)?t.forEach(t=>{t!==e&&c(t,o.b.CONNECTOR_ID.WALLET_CONNECT)&&r.push([t,F.state.chains.get(t)])}):c(e,o.b.CONNECTOR_ID.AUTH)&&t.forEach(t=>{t!==e&&c(t,o.b.CONNECTOR_ID.AUTH)&&r.push([t,F.state.chains.get(t)])})):r=Array.from(F.state.chains.entries()),r}(e);try{q.resetSend();let r=await Promise.allSettled(t.map(async([e,t])=>{try{let{caipAddress:r}=this.getAccountData(e)||{};r&&t.connectionControllerClient?.disconnect&&await t.connectionControllerClient.disconnect(e),this.resetAccount(e),this.resetNetwork(e)}catch(t){throw Error(`Failed to disconnect chain ${e}: ${t.message}`)}}));p.ConnectionController.resetWcConnection();let i=r.filter(e=>"rejected"===e.status);if(i.length>0)throw Error(i.map(e=>e.reason.message).join(", "));u.M.deleteConnectedSocialProvider(),e?a.ConnectorController.removeConnectorId(e):a.ConnectorController.resetConnectorIds(),f.X.sendEvent({type:"track",event:"DISCONNECT_SUCCESS",properties:{namespace:e||"all"}})}catch(e){console.error(e.message||"Failed to disconnect chains"),f.X.sendEvent({type:"track",event:"DISCONNECT_ERROR",properties:{message:e.message||"Failed to disconnect chains"}})}},setIsSwitchingNamespace(e){H.isSwitchingNamespace=e},getFirstCaipNetworkSupportsAuthConnector(){let e=[];if(H.chains.forEach(t=>{o.b.AUTH_CONNECTOR_SUPPORTED_CHAINS.find(e=>e===t.namespace)&&t.namespace&&e.push(t.namespace)}),e.length>0){let t=e[0];return t?H.chains.get(t)?.caipNetworks?.[0]:void 0}},getAccountData:e=>e?F.state.chains.get(e)?.accountState:d.N.state,getNetworkData(e){let t=e||H.activeChain;if(t)return F.state.chains.get(t)?.networkState},getCaipNetworkByNamespace(e,t){if(!e)return;let r=F.state.chains.get(e);return r?.caipNetworks?.find(e=>e.id===t)||r?.networkState?.caipNetwork||r?.caipNetworks?.[0]},getRequestedCaipNetworkIds(){let e=a.ConnectorController.state.filterByNamespace;return(e?[H.chains.get(e)]:Array.from(H.chains.values())).flatMap(e=>e?.caipNetworks||[]).map(e=>e.caipNetworkId)}}},93046:function(e,t,r){"use strict";let i;r.d(t,{ConnectionController:function(){return I}});var s=r(33085),n=r(55543),o=r(53357),a=r(41505),c=r(36801),l=r(92144),h=r(54173),u=r(31929),d=r(89512),p=r(86777),f=r(4786),g=r(68584),m=r(61704),y=r(48415),b=r(66909);let w=(0,s.sj)({transactions:[],coinbaseTransactions:{},transactionsByYear:{},lastNetworkInView:void 0,loading:!1,empty:!1,next:void 0}),v={state:w,subscribe:e=>(0,s.Ld)(w,()=>e(w)),setLastNetworkInView(e){w.lastNetworkInView=e},async fetchTransactions(e,t){if(!e)throw Error("Transactions can't be fetched without an accountAddress");w.loading=!0;try{let r=await m.L.fetchTransactions({account:e,cursor:w.next,onramp:t,cache:"coinbase"===t?"no-cache":void 0,chainId:l.R.state.activeCaipNetwork?.caipNetworkId}),i=this.filterSpamTransactions(r.data),s=this.filterByConnectedChain(i),n=[...w.transactions,...s];w.loading=!1,"coinbase"===t?w.coinbaseTransactions=this.groupTransactionsByYearAndMonth(w.coinbaseTransactions,r.data):(w.transactions=n,w.transactionsByYear=this.groupTransactionsByYearAndMonth(w.transactionsByYear,s)),w.empty=0===n.length,w.next=r.next?r.next:void 0}catch(t){u.X.sendEvent({type:"track",event:"ERROR_FETCH_TRANSACTIONS",properties:{address:e,projectId:y.OptionsController.state.projectId,cursor:w.next,isSmartAccount:g.N.state.preferredAccountType===f.y_.ACCOUNT_TYPES.SMART_ACCOUNT}}),b.SnackController.showError("Failed to fetch transactions"),w.loading=!1,w.empty=!0,w.next=void 0}},groupTransactionsByYearAndMonth:(e={},t=[])=>(t.forEach(t=>{let r=new Date(t.metadata.minedAt).getFullYear(),i=new Date(t.metadata.minedAt).getMonth(),s=e[r]??{},n=(s[i]??[]).filter(e=>e.id!==t.id);e[r]={...s,[i]:[...n,t].sort((e,t)=>new Date(t.metadata.minedAt).getTime()-new Date(e.metadata.minedAt).getTime())}}),e),filterSpamTransactions:e=>e.filter(e=>!e.transfers.every(e=>e.nft_info?.flags.is_spam===!0)),filterByConnectedChain(e){let t=l.R.state.activeCaipNetwork?.caipNetworkId;return e.filter(e=>e.metadata.chain===t)},clearCursor(){w.next=void 0},resetTransactions(){w.transactions=[],w.transactionsByYear={},w.lastNetworkInView=void 0,w.loading=!1,w.empty=!1,w.next=void 0}},E=(0,s.sj)({wcError:!1,buffering:!1,status:"disconnected"}),I={state:E,subscribeKey:(e,t)=>(0,n.VW)(E,e,t),_getClient:()=>E._client,setClient(e){E._client=(0,s.iH)(e)},async connectWalletConnect(){if(o.j.isTelegram()||o.j.isSafari()&&o.j.isIos()){if(i){await i,i=void 0;return}if(!o.j.isPairingExpired(E?.wcPairingExpiry)){let e=E.wcUri;E.wcUri=e;return}i=this._getClient()?.connectWalletConnect?.().catch(()=>void 0),this.state.status="connecting",await i,i=void 0,E.wcPairingExpiry=void 0,this.state.status="connected"}else await this._getClient()?.connectWalletConnect?.()},async connectExternal(e,t,r=!0){await this._getClient()?.connectExternal?.(e),r&&l.R.setActiveNamespace(t)},async reconnectExternal(e){await this._getClient()?.reconnectExternal?.(e);let t=e.chain||l.R.state.activeChain;t&&h.ConnectorController.setConnectorId(e.id,t)},async setPreferredAccountType(e){d.I.setLoading(!0,l.R.state.activeChain);let t=h.ConnectorController.getAuthConnector();t&&(await t?.provider.setPreferredAccount(e),await this.reconnectExternal(t),d.I.setLoading(!1,l.R.state.activeChain),u.X.sendEvent({type:"track",event:"SET_PREFERRED_ACCOUNT_TYPE",properties:{accountType:e,network:l.R.state.activeCaipNetwork?.caipNetworkId||""}}))},async signMessage(e){return this._getClient()?.signMessage(e)},parseUnits(e,t){return this._getClient()?.parseUnits(e,t)},formatUnits(e,t){return this._getClient()?.formatUnits(e,t)},async sendTransaction(e){return this._getClient()?.sendTransaction(e)},async getCapabilities(e){return this._getClient()?.getCapabilities(e)},async grantPermissions(e){return this._getClient()?.grantPermissions(e)},async walletGetAssets(e){return this._getClient()?.walletGetAssets(e)??{}},async estimateGas(e){return this._getClient()?.estimateGas(e)},async writeContract(e){return this._getClient()?.writeContract(e)},async getEnsAddress(e){return this._getClient()?.getEnsAddress(e)},async getEnsAvatar(e){return this._getClient()?.getEnsAvatar(e)},checkInstalled(e){return this._getClient()?.checkInstalled?.(e)||!1},resetWcConnection(){E.wcUri=void 0,E.wcPairingExpiry=void 0,E.wcLinking=void 0,E.recentWallet=void 0,E.status="disconnected",v.resetTransactions(),c.M.deleteWalletConnectDeepLink()},resetUri(){E.wcUri=void 0,E.wcPairingExpiry=void 0},finalizeWcConnection(){let{wcLinking:e,recentWallet:t}=I.state;e&&c.M.setWalletConnectDeepLink(e),t&&c.M.setAppKitRecent(t),u.X.sendEvent({type:"track",event:"CONNECT_SUCCESS",properties:{method:e?"mobile":"qrcode",name:p.RouterController.state.data?.wallet?.name||"Unknown"}})},setWcBasic(e){E.wcBasic=e},setUri(e){E.wcUri=e,E.wcPairingExpiry=o.j.getPairingExpiry()},setWcLinking(e){E.wcLinking=e},setWcError(e){E.wcError=e,E.buffering=!1},setRecentWallet(e){E.recentWallet=e},setBuffering(e){E.buffering=e},setStatus(e){E.status=e},async disconnect(e){try{d.I.setLoading(!0,e),await a.w.clearSessions(),await l.R.disconnect(e),d.I.setLoading(!1,e),h.ConnectorController.setFilterByNamespace(void 0)}catch(e){throw Error("Failed to disconnect")}}}},54173:function(e,t,r){"use strict";r.d(t,{ConnectorController:function(){return m}});var i=r(33085),s=r(55543),n=r(44649),o=r(62714),a=r(92144);let c={handleSolanaDeeplinkRedirect(e){if(a.R.state.activeChain===n.b.CHAIN.SOLANA){let t=window.location.href,r=encodeURIComponent(t);if("Phantom"===e&&!("phantom"in window)){let e=t.startsWith("https")?"https":"http",i=t.split("/")[2],s=encodeURIComponent(`${e}://${i}`);window.location.href=`https://phantom.app/ul/browse/${r}?ref=${s}`}"Coinbase Wallet"!==e||"coinbaseSolana"in window||(window.location.href=`https://go.cb-w.com/dapp?cb_url=${r}`)}}};var l=r(36801),h=r(17766),u=r(48415),d=r(86777),p=r(52005);let f={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},g=(0,i.sj)({allConnectors:[],connectors:[],activeConnector:void 0,filterByNamespace:void 0,activeConnectorIds:{...f}}),m={state:g,subscribe:e=>(0,i.Ld)(g,()=>{e(g)}),subscribeKey:(e,t)=>(0,s.VW)(g,e,t),initialize(e){e.forEach(e=>{let t=l.M.getConnectedConnectorId(e);t&&this.setConnectorId(t,e)})},setActiveConnector(e){e&&(g.activeConnector=(0,i.iH)(e))},setConnectors(e){e.filter(e=>!g.allConnectors.some(t=>t.id===e.id&&this.getConnectorName(t.name)===this.getConnectorName(e.name)&&t.chain===e.chain)).forEach(e=>{"MULTI_CHAIN"!==e.type&&g.allConnectors.push((0,i.iH)(e))}),g.connectors=this.mergeMultiChainConnectors(g.allConnectors)},removeAdapter(e){g.allConnectors=g.allConnectors.filter(t=>t.chain!==e),g.connectors=this.mergeMultiChainConnectors(g.allConnectors)},mergeMultiChainConnectors(e){let t=this.generateConnectorMapByName(e),r=[];return t.forEach(e=>{let t=e[0],i=t?.id===n.b.CONNECTOR_ID.AUTH;e.length>1&&t?r.push({name:t.name,imageUrl:t.imageUrl,imageId:t.imageId,connectors:[...e],type:i?"AUTH":"MULTI_CHAIN",chain:"eip155",id:t?.id||""}):t&&r.push(t)}),r},generateConnectorMapByName(e){let t=new Map;return e.forEach(e=>{let{name:r}=e,i=this.getConnectorName(r);if(!i)return;let s=t.get(i)||[];s.find(t=>t.chain===e.chain)||s.push(e),t.set(i,s)}),t},getConnectorName:e=>e&&({"Trust Wallet":"Trust"})[e]||e,getUniqueConnectorsByName(e){let t=[];return e.forEach(e=>{t.find(t=>t.chain===e.chain)||t.push(e)}),t},addConnector(e){if(e.id===n.b.CONNECTOR_ID.AUTH){let t=(0,i.CO)(u.OptionsController.state),r=p.ThemeController.getSnapshot().themeMode,s=p.ThemeController.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType}),e?.provider?.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:o.t(s,r)}),this.setConnectors([e])}else this.setConnectors([e])},getAuthConnector(e){let t=e||a.R.state.activeChain,r=g.connectors.find(e=>e.id===n.b.CONNECTOR_ID.AUTH);return r?r?.connectors?.length?r.connectors.find(e=>e.chain===t):r:void 0},getAnnouncedConnectorRdns:()=>g.connectors.filter(e=>"ANNOUNCED"===e.type).map(e=>e.info?.rdns),getConnectorById:e=>g.allConnectors.find(t=>t.id===e),getConnector:(e,t)=>g.allConnectors.filter(e=>e.chain===a.R.state.activeChain).find(r=>r.explorerId===e||r.info?.rdns===t),syncIfAuthConnector(e){if("ID_AUTH"!==e.id)return;let t=(0,i.CO)(u.OptionsController.state),r=p.ThemeController.getSnapshot().themeMode,s=p.ThemeController.getSnapshot().themeVariables;e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,sdkType:t.sdkType,projectId:t.projectId}),e.provider.syncTheme({themeMode:r,themeVariables:s,w3mThemeVariables:(0,o.t)(s,r)})},getConnectorsByNamespace(e){let t=g.allConnectors.filter(t=>t.chain===e);return this.mergeMultiChainConnectors(t)},selectWalletConnector(e){let t=m.getConnector(e.id,e.rdns);a.R.state.activeChain===n.b.CHAIN.SOLANA&&c.handleSolanaDeeplinkRedirect(t?.name||e.name||""),t?d.RouterController.push("ConnectingExternal",{connector:t}):d.RouterController.push("ConnectingWalletConnect",{wallet:e})},getConnectors(e){return e?this.getConnectorsByNamespace(e):this.mergeMultiChainConnectors(g.allConnectors)},setFilterByNamespace(e){g.filterByNamespace=e,g.connectors=this.getConnectors(e),h.ApiController.setFilterByNamespace(e)},setConnectorId(e,t){e&&(g.activeConnectorIds={...g.activeConnectorIds,[t]:e},l.M.setConnectedConnectorId(t,e))},removeConnectorId(e){g.activeConnectorIds={...g.activeConnectorIds,[e]:void 0},l.M.deleteConnectedConnectorId(e)},getConnectorId(e){if(e)return g.activeConnectorIds[e]},isConnected:e=>e?!!g.activeConnectorIds[e]:Object.values(g.activeConnectorIds).some(e=>!!e),resetConnectorIds(){g.activeConnectorIds={...f}}}},31929:function(e,t,r){"use strict";r.d(t,{X:function(){return g}});var i=r(33085),s=r(44649),n=r(61616),o=r(53357),a=r(39905),c=r(68584),l=r(72723),h=r(48415);let u=o.j.getAnalyticsUrl(),d=new a.V({baseUrl:u,clientId:null}),p=["MODAL_CREATED"],f=(0,i.sj)({timestamp:Date.now(),reportedErrors:{},data:{type:"track",event:"MODAL_CREATED"}}),g={state:f,subscribe:e=>(0,i.Ld)(f,()=>e(f)),getSdkProperties(){let{projectId:e,sdkType:t,sdkVersion:r}=h.OptionsController.state;return{projectId:e,st:t,sv:r||"html-wagmi-4.2.2"}},async _sendAnalyticsEvent(e){try{let t=c.N.state.address;if(p.includes(e.data.event)||"undefined"==typeof window)return;await d.post({path:"/e",params:g.getSdkProperties(),body:{eventId:o.j.getUUID(),url:window.location.href,domain:window.location.hostname,timestamp:e.timestamp,props:{...e.data,address:t}}}),f.reportedErrors.FORBIDDEN=!1}catch(e){e instanceof Error&&e.cause instanceof Response&&e.cause.status===s.b.HTTP_STATUS_CODES.FORBIDDEN&&!f.reportedErrors.FORBIDDEN&&(l.AlertController.open({shortMessage:"Invalid App Configuration",longMessage:`Origin ${(0,n.$U)()?window.origin:"uknown"} not found on Allowlist - update configuration on cloud.reown.com`},"error"),f.reportedErrors.FORBIDDEN=!0)}},sendEvent(e){f.timestamp=Date.now(),f.data=e,h.OptionsController.state.features?.analytics&&g._sendAnalyticsEvent(f)}}},89512:function(e,t,r){"use strict";r.d(t,{I:function(){return m}});var i=r(33085),s=r(55543),n=r(53357),o=r(68584),a=r(17766),c=r(92144),l=r(93046),h=r(54173),u=r(31929),d=r(48415),p=r(96986),f=r(86777);let g=(0,i.sj)({loading:!1,loadingNamespaceMap:new Map,open:!1,shake:!1,namespace:void 0}),m={state:g,subscribe:e=>(0,i.Ld)(g,()=>e(g)),subscribeKey:(e,t)=>(0,s.VW)(g,e,t),async open(e){let t="connected"===o.N.state.status;l.ConnectionController.state.wcBasic?a.ApiController.prefetch({fetchNetworkImages:!1,fetchConnectorImages:!1}):await a.ApiController.prefetch({fetchConnectorImages:!t,fetchFeaturedWallets:!t,fetchRecommendedWallets:!t}),e?.namespace?(await c.R.switchActiveNamespace(e.namespace),m.setLoading(!0,e.namespace)):m.setLoading(!0),h.ConnectorController.setFilterByNamespace(e?.namespace);let r=c.R.getAccountData(e?.namespace)?.caipAddress;c.R.state.noAdapters&&!r?n.j.isMobile()?f.RouterController.reset("AllWallets"):f.RouterController.reset("ConnectingWalletConnectBasic"):e?.view?f.RouterController.reset(e.view):r?f.RouterController.reset("Account"):f.RouterController.reset("Connect"),g.open=!0,p.I.set({open:!0}),u.X.sendEvent({type:"track",event:"MODAL_OPEN",properties:{connected:!!r}})},close(){let e=d.OptionsController.state.enableEmbedded,t=!!c.R.state.activeCaipAddress;g.open&&u.X.sendEvent({type:"track",event:"MODAL_CLOSE",properties:{connected:t}}),g.open=!1,m.clearLoading(),e?t?f.RouterController.replace("Account"):f.RouterController.push("Connect"):p.I.set({open:!1}),l.ConnectionController.resetUri()},setLoading(e,t){t&&g.loadingNamespaceMap.set(t,e),g.loading=e,p.I.set({loading:e})},clearLoading(){g.loadingNamespaceMap.clear(),g.loading=!1},shake(){g.shake||(g.shake=!0,setTimeout(()=>{g.shake=!1},500))}}},48415:function(e,t,r){"use strict";r.d(t,{OptionsController:function(){return l}});var i=r(33085),s=r(55543),n=r(59712),o=r(53357);let a={getFeatureValue(e,t){let r=t?.[e];return void 0===r?n.bq.DEFAULT_FEATURES[e]:r},filterSocialsByPlatform(e){if(!e||!e.length)return e;if(o.j.isTelegram()){if(o.j.isIos())return e.filter(e=>"google"!==e);if(o.j.isMac())return e.filter(e=>"x"!==e);if(o.j.isAndroid())return e.filter(e=>!["facebook","x"].includes(e))}return e}},c=(0,i.sj)({features:n.bq.DEFAULT_FEATURES,projectId:"",sdkType:"appkit",sdkVersion:"html-wagmi-undefined",defaultAccountTypes:n.bq.DEFAULT_ACCOUNT_TYPES,enableNetworkSwitch:!0}),l={state:c,subscribeKey:(e,t)=>(0,s.VW)(c,e,t),setOptions(e){Object.assign(c,e)},setFeatures(e){if(!e)return;c.features||(c.features=n.bq.DEFAULT_FEATURES);let t={...c.features,...e};c.features=t,c.features.socials&&(c.features.socials=a.filterSocialsByPlatform(c.features.socials))},setProjectId(e){c.projectId=e},setCustomRpcUrls(e){c.customRpcUrls=e},setAllWallets(e){c.allWallets=e},setIncludeWalletIds(e){c.includeWalletIds=e},setExcludeWalletIds(e){c.excludeWalletIds=e},setFeaturedWalletIds(e){c.featuredWalletIds=e},setTokens(e){c.tokens=e},setTermsConditionsUrl(e){c.termsConditionsUrl=e},setPrivacyPolicyUrl(e){c.privacyPolicyUrl=e},setCustomWallets(e){c.customWallets=e},setIsSiweEnabled(e){c.isSiweEnabled=e},setIsUniversalProvider(e){c.isUniversalProvider=e},setSdkVersion(e){c.sdkVersion=e},setMetadata(e){c.metadata=e},setDisableAppend(e){c.disableAppend=e},setEIP6963Enabled(e){c.enableEIP6963=e},setDebug(e){c.debug=e},setEnableWalletConnect(e){c.enableWalletConnect=e},setEnableWalletGuide(e){c.enableWalletGuide=e},setEnableAuthLogger(e){c.enableAuthLogger=e},setEnableWallets(e){c.enableWallets=e},setHasMultipleAddresses(e){c.hasMultipleAddresses=e},setSIWX(e){c.siwx=e},setConnectMethodsOrder(e){c.features={...c.features,connectMethodsOrder:e}},setWalletFeaturesOrder(e){c.features={...c.features,walletFeaturesOrder:e}},setSocialsOrder(e){c.features={...c.features,socials:e}},setCollapseWallets(e){c.features={...c.features,collapseWallets:e}},setEnableEmbedded(e){c.enableEmbedded=e},setAllowUnsupportedChain(e){c.allowUnsupportedChain=e},setManualWCControl(e){c.manualWCControl=e},setEnableNetworkSwitch(e){c.enableNetworkSwitch=e},setDefaultAccountTypes(e={}){Object.entries(e).forEach(([e,t])=>{t&&(c.defaultAccountTypes[e]=t)})},setUniversalProviderConfigOverride(e){c.universalProviderConfigOverride=e},getUniversalProviderConfigOverride:()=>c.universalProviderConfigOverride,getSnapshot:()=>(0,i.CO)(c)}},96986:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});var i=r(33085);let s=(0,i.sj)({loading:!1,open:!1,selectedNetworkId:void 0,activeChain:void 0,initialized:!1}),n={state:s,subscribe:e=>(0,i.Ld)(s,()=>e(s)),set(e){Object.assign(s,{...s,...e})}}},86777:function(e,t,r){"use strict";r.d(t,{RouterController:function(){return u}});var i=r(33085),s=r(55543),n=r(68584),o=r(92144),a=r(54173),c=r(89512),l=r(48415);let h=(0,i.sj)({view:"Connect",history:["Connect"],transactionStack:[]}),u={state:h,subscribeKey:(e,t)=>(0,s.VW)(h,e,t),pushTransactionStack(e){h.transactionStack.push(e)},popTransactionStack(e){let t=h.transactionStack.pop();if(t){if(e)this.goBack(),t?.onCancel?.();else{if(t.goBack)this.goBack();else if(t.replace){let e=h.history.indexOf("ConnectingSiwe");e>0?this.goBackToIndex(e-1):(c.I.close(),h.history=[])}else t.view&&this.reset(t.view);t?.onSuccess?.()}}},push(e,t){e!==h.view&&(h.view=e,h.history.push(e),h.data=t)},reset(e,t){h.view=e,h.history=[e],h.data=t},replace(e,t){h.history.at(-1)!==e&&(h.view=e,h.history[h.history.length-1]=e,h.data=t)},goBack(){let e=!o.R.state.activeCaipAddress&&"ConnectingFarcaster"===this.state.view;if(h.history.length>1&&!h.history.includes("UnsupportedChain")){h.history.pop();let[e]=h.history.slice(-1);e&&(h.view=e)}else c.I.close();h.data?.wallet&&(h.data.wallet=void 0),setTimeout(()=>{if(e){n.N.setFarcasterUrl(void 0,o.R.state.activeChain);let e=a.ConnectorController.getAuthConnector();e?.provider?.reload();let t=(0,i.CO)(l.OptionsController.state);e?.provider?.syncDappData?.({metadata:t.metadata,sdkVersion:t.sdkVersion,projectId:t.projectId,sdkType:t.sdkType})}},100)},goBackToIndex(e){if(h.history.length>1){h.history=h.history.slice(0,e+1);let[t]=h.history.slice(-1);t&&(h.view=t)}}}},66909:function(e,t,r){"use strict";r.d(t,{SnackController:function(){return c}});var i=r(33085),s=r(55543),n=r(53357);let o=Object.freeze({message:"",variant:"success",svg:void 0,open:!1,autoClose:!0}),a=(0,i.sj)({...o}),c={state:a,subscribeKey:(e,t)=>(0,s.VW)(a,e,t),showLoading(e,t={}){this._showMessage({message:e,variant:"loading",...t})},showSuccess(e){this._showMessage({message:e,variant:"success"})},showSvg(e,t){this._showMessage({message:e,svg:t})},showError(e){let t=n.j.parseError(e);this._showMessage({message:t,variant:"error"})},hide(){a.message=o.message,a.variant=o.variant,a.svg=o.svg,a.open=o.open,a.autoClose=o.autoClose},_showMessage({message:e,svg:t,variant:r="success",autoClose:i=o.autoClose}){a.open?(a.open=!1,setTimeout(()=>{a.message=e,a.variant=r,a.svg=t,a.open=!0,a.autoClose=i},150)):(a.message=e,a.variant=r,a.svg=t,a.open=!0,a.autoClose=i)}}},52005:function(e,t,r){"use strict";r.d(t,{ThemeController:function(){return a}});var i=r(33085),s=r(62714),n=r(54173);let o=(0,i.sj)({themeMode:"dark",themeVariables:{},w3mThemeVariables:void 0}),a={state:o,subscribe:e=>(0,i.Ld)(o,()=>e(o)),setThemeMode(e){o.themeMode=e;try{let t=n.ConnectorController.getAuthConnector();if(t){let r=a.getSnapshot().themeVariables;t.provider.syncTheme({themeMode:e,themeVariables:r,w3mThemeVariables:(0,s.t)(r,e)})}}catch{console.info("Unable to sync theme to auth connector")}},setThemeVariables(e){o.themeVariables={...o.themeVariables,...e};try{let e=n.ConnectorController.getAuthConnector();if(e){let t=a.getSnapshot().themeVariables;e.provider.syncTheme({themeVariables:t,w3mThemeVariables:(0,s.t)(o.themeVariables,o.themeMode)})}}catch{console.info("Unable to sync theme to auth connector")}},getSnapshot:()=>(0,i.CO)(o)}},63043:function(e,t,r){"use strict";r.d(t,{f:function(){return c}});var i=r(33085),s=r(17766),n=r(22472);let o={eip155:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",solana:"a1b58899-f671-4276-6a5e-56ca5bd59700",polkadot:"",bip122:"0b4838db-0161-4ffe-022d-532bf03dba00"},a=(0,i.sj)({networkImagePromises:{}}),c={async fetchWalletImage(e){if(e)return await s.ApiController._fetchWalletImage(e),this.getWalletImageById(e)},async fetchNetworkImage(e){if(e)return this.getNetworkImageById(e)||(a.networkImagePromises[e]||(a.networkImagePromises[e]=s.ApiController._fetchNetworkImage(e)),await a.networkImagePromises[e],this.getNetworkImageById(e))},getWalletImageById(e){if(e)return n.W.state.walletImages[e]},getWalletImage:e=>e?.image_url?e?.image_url:e?.image_id?n.W.state.walletImages[e.image_id]:void 0,getNetworkImage:e=>e?.assets?.imageUrl?e?.assets?.imageUrl:e?.assets?.imageId?n.W.state.networkImages[e.assets.imageId]:void 0,getNetworkImageById(e){if(e)return n.W.state.networkImages[e]},getConnectorImage:e=>e?.imageUrl?e.imageUrl:e?.imageId?n.W.state.connectorImages[e.imageId]:void 0,getChainImage:e=>n.W.state.networkImages[o[e]]}},59712:function(e,t,r){"use strict";r.d(t,{bq:function(){return n}});var i=r(25566);let s=(void 0!==i&&void 0!==i.env?i.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",n={FOUR_MINUTES_MS:24e4,TEN_SEC_MS:1e4,FIVE_SEC_MS:5e3,THREE_SEC_MS:3e3,ONE_SEC_MS:1e3,SECURE_SITE:s,SECURE_SITE_DASHBOARD:`${s}/dashboard`,SECURE_SITE_FAVICON:`${s}/images/favicon.png`,RESTRICTED_TIMEZONES:["ASIA/SHANGHAI","ASIA/URUMQI","ASIA/CHONGQING","ASIA/HARBIN","ASIA/KASHGAR","ASIA/MACAU","ASIA/HONG_KONG","ASIA/MACAO","ASIA/BEIJING","ASIA/HARBIN"],WC_COINBASE_PAY_SDK_CHAINS:["ethereum","arbitrum","polygon","berachain","avalanche-c-chain","optimism","celo","base"],WC_COINBASE_PAY_SDK_FALLBACK_CHAIN:"ethereum",WC_COINBASE_PAY_SDK_CHAIN_NAME_MAP:{Ethereum:"ethereum","Arbitrum One":"arbitrum",Polygon:"polygon",Berachain:"berachain",Avalanche:"avalanche-c-chain","OP Mainnet":"optimism",Celo:"celo",Base:"base"},WC_COINBASE_ONRAMP_APP_ID:"bf18c88d-495a-463b-b249-0b9d3656cf5e",SWAP_SUGGESTED_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP"],SWAP_POPULAR_TOKENS:["ETH","UNI","1INCH","AAVE","SOL","ADA","AVAX","DOT","LINK","NITRO","GAIA","MILK","TRX","NEAR","GNO","WBTC","DAI","WETH","USDC","USDT","ARB","BAL","BICO","CRV","ENS","MATIC","OP","METAL","DAI","CHAMP","WOLF","SALE","BAL","BUSD","MUST","BTCpx","ROUTE","HEX","WELT","amDAI","VSQ","VISION","AURUM","pSP","SNX","VC","LINK","CHP","amUSDT","SPHERE","FOX","GIDDY","GFC","OMEN","OX_OLD","DE","WNT"],BALANCE_SUPPORTED_CHAINS:["eip155","solana"],SWAP_SUPPORTED_NETWORKS:["eip155:1","eip155:42161","eip155:10","eip155:324","eip155:8453","eip155:56","eip155:137","eip155:100","eip155:43114","eip155:250","eip155:8217","eip155:1313161554"],NAMES_SUPPORTED_CHAIN_NAMESPACES:["eip155"],ONRAMP_SUPPORTED_CHAIN_NAMESPACES:["eip155","solana"],ACTIVITY_ENABLED_CHAIN_NAMESPACES:["eip155","solana"],NATIVE_TOKEN_ADDRESS:{eip155:"0xeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee",solana:"So11111111111111111111111111111111111111111",polkadot:"0x",bip122:"0x"},CONVERT_SLIPPAGE_TOLERANCE:1,CONNECT_LABELS:{MOBILE:"Open and continue in a new browser tab"},DEFAULT_FEATURES:{swaps:!0,onramp:!0,receive:!0,send:!0,email:!0,emailShowWallets:!0,socials:["google","x","discord","farcaster","github","apple","facebook"],connectorTypeOrder:["walletConnect","recent","injected","featured","custom","external","recommended"],history:!0,analytics:!0,allWallets:!0,legalCheckbox:!1,smartSessions:!1,collapseWallets:!1,walletFeaturesOrder:["onramp","swaps","receive","send"],connectMethodsOrder:void 0},DEFAULT_ACCOUNT_TYPES:{bip122:"payment",eip155:"smartAccount",polkadot:"eoa",solana:"eoa"},ADAPTER_TYPES:{UNIVERSAL:"universal",SOLANA:"solana",WAGMI:"wagmi",ETHERS:"ethers",ETHERS5:"ethers5",BITCOIN:"bitcoin"}}},53357:function(e,t,r){"use strict";r.d(t,{j:function(){return o}});var i=r(44649),s=r(59712),n=r(36801);let o={isMobile(){return!!this.isClient()&&!!(window?.matchMedia("(pointer:coarse)")?.matches||/Android|webOS|iPhone|iPad|iPod|BlackBerry|Opera Mini/u.test(navigator.userAgent))},checkCaipNetwork:(e,t="")=>e?.caipNetworkId.toLocaleLowerCase().includes(t.toLowerCase()),isAndroid(){if(!this.isMobile())return!1;let e=window?.navigator.userAgent.toLowerCase();return o.isMobile()&&e.includes("android")},isIos(){if(!this.isMobile())return!1;let e=window?.navigator.userAgent.toLowerCase();return e.includes("iphone")||e.includes("ipad")},isSafari(){return!!this.isClient()&&(window?.navigator.userAgent.toLowerCase()).includes("safari")},isClient:()=>"undefined"!=typeof window,isPairingExpired:e=>!e||e-Date.now()<=s.bq.TEN_SEC_MS,isAllowedRetry:(e,t=s.bq.ONE_SEC_MS)=>Date.now()-e>=t,copyToClopboard(e){navigator.clipboard.writeText(e)},isIframe(){try{return window?.self!==window?.top}catch(e){return!1}},getPairingExpiry:()=>Date.now()+s.bq.FOUR_MINUTES_MS,getNetworkId:e=>e?.split(":")[1],getPlainAddress:e=>e?.split(":")[2],wait:async e=>new Promise(t=>{setTimeout(t,e)}),debounce(e,t=500){let r;return(...i)=>{r&&clearTimeout(r),r=setTimeout(function(){e(...i)},t)}},isHttpUrl:e=>e.startsWith("http://")||e.startsWith("https://"),formatNativeUrl(e,t){if(o.isHttpUrl(e))return this.formatUniversalUrl(e,t);let r=e;r.includes("://")||(r=e.replaceAll("/","").replaceAll(":",""),r=`${r}://`),r.endsWith("/")||(r=`${r}/`),this.isTelegram()&&this.isAndroid()&&(t=encodeURIComponent(t));let i=encodeURIComponent(t);return{redirect:`${r}wc?uri=${i}`,href:r}},formatUniversalUrl(e,t){if(!o.isHttpUrl(e))return this.formatNativeUrl(e,t);let r=e;r.endsWith("/")||(r=`${r}/`);let i=encodeURIComponent(t);return{redirect:`${r}wc?uri=${i}`,href:r}},getOpenTargetForPlatform(e){return"popupWindow"===e?e:this.isTelegram()?n.M.getTelegramSocialProvider()?"_top":"_blank":e},openHref(e,t,r){window?.open(e,this.getOpenTargetForPlatform(t),r||"noreferrer noopener")},returnOpenHref(e,t,r){return window?.open(e,this.getOpenTargetForPlatform(t),r||"noreferrer noopener")},isTelegram:()=>"undefined"!=typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto),preloadImage:async e=>Promise.race([new Promise((t,r)=>{let i=new Image;i.onload=t,i.onerror=r,i.crossOrigin="anonymous",i.src=e}),o.wait(2e3)]),formatBalance(e,t){let r="0.000";if("string"==typeof e){let t=Number(e);if(t){let e=Math.floor(1e3*t)/1e3;e&&(r=e.toString())}}return`${r}${t?` ${t}`:""}`},formatBalance2(e,t){let r;if("0"===e)r="0";else if("string"==typeof e){let t=Number(e);t&&(r=t.toString().match(/^-?\d+(?:\.\d{0,3})?/u)?.[0])}return{value:r??"0",rest:"0"===r?"000":"",symbol:t}},getApiUrl:()=>i.b.W3M_API_URL,getBlockchainApiUrl:()=>i.b.BLOCKCHAIN_API_RPC_URL,getAnalyticsUrl:()=>i.b.PULSE_API_URL,getUUID:()=>crypto?.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}),parseError:e=>"string"==typeof e?e:"string"==typeof e?.issues?.[0]?.message?e.issues[0].message:e instanceof Error?e.message:"Unknown error",sortRequestedNetworks(e,t=[]){let r={};return t&&e&&(e.forEach((e,t)=>{r[e]=t}),t.sort((e,t)=>{let i=r[e.id],s=r[t.id];return void 0!==i&&void 0!==s?i-s:void 0!==i?-1:void 0!==s?1:0})),t},calculateBalance(e){let t=0;for(let r of e)t+=r.value??0;return t},formatTokenBalance(e){let[t,r]=e.toFixed(2).split(".");return{dollars:t,pennies:r}},isAddress(e,t="eip155"){switch(t){case"eip155":if(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)&&(/^(?:0x)?[0-9a-f]{40}$/iu.test(e)||/^(?:0x)?[0-9A-F]{40}$/iu.test(e)))return!0;return!1;case"solana":return/[1-9A-HJ-NP-Za-km-z]{32,44}$/iu.test(e);default:return!1}},uniqueBy(e,t){let r=new Set;return e.filter(e=>{let i=e[t];return!r.has(i)&&(r.add(i),!0)})},generateSdkVersion(e,t,r){let i=0===e.length?s.bq.ADAPTER_TYPES.UNIVERSAL:e.map(e=>e.adapterType).join(",");return`${t}-${i}-${r}`},createAccount:(e,t,r,i,s)=>({namespace:e,address:t,type:r,publicKey:i,path:s}),isCaipAddress(e){if("string"!=typeof e)return!1;let t=e.split(":"),r=t[0];return 3===t.filter(Boolean).length&&r in i.b.CHAIN_NAME_MAP},isMac(){let e=window?.navigator.userAgent.toLowerCase();return e.includes("macintosh")&&!e.includes("safari")},formatTelegramSocialLoginUrl(e){let t=`--${encodeURIComponent(window?.location.href)}`,r="state=";if("auth.magic.link"===new URL(e).host){let i="provider_authorization_url=",s=e.substring(e.indexOf(i)+i.length),n=this.injectIntoUrl(decodeURIComponent(s),r,t);return e.replace(s,encodeURIComponent(n))}return this.injectIntoUrl(e,r,t)},injectIntoUrl(e,t,r){let i=e.indexOf(t);if(-1===i)throw Error(`${t} parameter not found in the URL: ${e}`);let s=e.indexOf("&",i),n=t.length,o=-1!==s?s:e.length,a=e.substring(0,i+n);return a+(e.substring(i+n,o)+r)+e.substring(s)}}},39905:function(e,t,r){"use strict";async function i(...e){let t=await fetch(...e);if(!t.ok)throw Error(`HTTP status code: ${t.status}`,{cause:t});return t}r.d(t,{V:function(){return s}});class s{constructor({baseUrl:e,clientId:t}){this.baseUrl=e,this.clientId=t}async get({headers:e,signal:t,cache:r,...s}){let n=this.createUrl(s);return(await i(n,{method:"GET",headers:e,signal:t,cache:r})).json()}async getBlob({headers:e,signal:t,...r}){let s=this.createUrl(r);return(await i(s,{method:"GET",headers:e,signal:t})).blob()}async post({body:e,headers:t,signal:r,...s}){let n=this.createUrl(s);return(await i(n,{method:"POST",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async put({body:e,headers:t,signal:r,...s}){let n=this.createUrl(s);return(await i(n,{method:"PUT",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}async delete({body:e,headers:t,signal:r,...s}){let n=this.createUrl(s);return(await i(n,{method:"DELETE",headers:t,body:e?JSON.stringify(e):void 0,signal:r})).json()}createUrl({path:e,params:t}){let r=new URL(e,this.baseUrl);return t&&Object.entries(t).forEach(([e,t])=>{t&&r.searchParams.append(e,t)}),this.clientId&&r.searchParams.append("clientId",this.clientId),r}}},41505:function(e,t,r){"use strict";r.d(t,{w:function(){return g}}),r(15133),r(5071),r(38979),r(5276),r(55445),r(82957).Buffer,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var i=r(44649),s=r(4786),n=r(68584),o=r(92144),a=r(93046),c=r(54173),l=r(31929),h=r(89512),u=r(48415),d=r(86777),p=r(66909),f=r(53357);let g={getSIWX:()=>u.OptionsController.state.siwx,async initializeIfEnabled(){let e=u.OptionsController.state.siwx,t=o.R.getActiveCaipAddress();if(!(e&&t))return;let[r,i,s]=t.split(":");if(o.R.checkIfSupportedNetwork(r))try{if((await e.getSessions(`${r}:${i}`,s)).length)return;await h.I.open({view:"SIWXSignMessage"})}catch(e){console.error("SIWXUtil:initializeIfEnabled",e),l.X.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:this.getSIWXEventProperties()}),await a.ConnectionController._getClient()?.disconnect().catch(console.error),d.RouterController.reset("Connect"),p.SnackController.showError("A problem occurred while trying initialize authentication")}},async requestSignMessage(){let e=u.OptionsController.state.siwx,t=f.j.getPlainAddress(o.R.getActiveCaipAddress()),r=o.R.getActiveCaipNetwork(),s=a.ConnectionController._getClient();if(!e)throw Error("SIWX is not enabled");if(!t)throw Error("No ActiveCaipAddress found");if(!r)throw Error("No ActiveCaipNetwork or client found");if(!s)throw Error("No ConnectionController client found");try{let n=await e.createMessage({chainId:r.caipNetworkId,accountAddress:t}),o=n.toString();c.ConnectorController.getConnectorId(r.chainNamespace)===i.b.CONNECTOR_ID.AUTH&&d.RouterController.pushTransactionStack({view:null,goBack:!1,replace:!0});let a=await s.signMessage(o);await e.addSession({data:n,message:o,signature:a}),h.I.close(),l.X.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:this.getSIWXEventProperties()})}catch(t){let e=this.getSIWXEventProperties();h.I.state.open&&"ApproveTransaction"!==d.RouterController.state.view||await h.I.open({view:"SIWXSignMessage"}),e.isSmartAccount?p.SnackController.showError("This application might not support Smart Accounts"):p.SnackController.showError("Signature declined"),l.X.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:e}),console.error("SWIXUtil:requestSignMessage",t)}},async cancelSignMessage(){try{let e=this.getSIWX();e?.getRequired?.()?await a.ConnectionController.disconnect():h.I.close(),d.RouterController.reset("Connect"),l.X.sendEvent({event:"CLICK_CANCEL_SIWX",type:"track",properties:this.getSIWXEventProperties()})}catch(e){console.error("SIWXUtil:cancelSignMessage",e)}},async getSessions(){let e=u.OptionsController.state.siwx,t=f.j.getPlainAddress(o.R.getActiveCaipAddress()),r=o.R.getActiveCaipNetwork();return e&&t&&r?e.getSessions(r.caipNetworkId,t):[]},async isSIWXCloseDisabled(){let e=this.getSIWX();if(e){let t="ApproveTransaction"===d.RouterController.state.view,r="SIWXSignMessage"===d.RouterController.state.view;if(t||r)return e.getRequired?.()&&0===(await this.getSessions()).length}return!1},async universalProviderAuthenticate({universalProvider:e,chains:t,methods:r}){let i=g.getSIWX(),s=new Set(t.map(e=>e.split(":")[0]));if(!i||1!==s.size||!s.has("eip155"))return!1;let a=await i.createMessage({chainId:o.R.getActiveCaipNetwork()?.caipNetworkId||"",accountAddress:""}),c=await e.authenticate({nonce:a.nonce,domain:a.domain,uri:a.uri,exp:a.expirationTime,iat:a.issuedAt,nbf:a.notBefore,requestId:a.requestId,version:a.version,resources:a.resources,statement:a.statement,chainId:a.chainId,methods:r,chains:[a.chainId,...t.filter(e=>e!==a.chainId)]});if(p.SnackController.showLoading("Authenticating...",{autoClose:!1}),n.N.setConnectedWalletInfo({...c.session.peer.metadata,name:c.session.peer.metadata.name,icon:c.session.peer.metadata.icons?.[0],type:"WALLET_CONNECT"},Array.from(s)[0]),c?.auths?.length){let t=c.auths.map(t=>{let r=e.client.formatAuthMessage({request:t.p,iss:t.p.iss});return{data:{...t.p,accountAddress:t.p.iss.split(":").slice(-1).join(""),chainId:t.p.iss.split(":").slice(2,4).join(":"),uri:t.p.aud,version:t.p.version||a.version,expirationTime:t.p.exp,issuedAt:t.p.iat,notBefore:t.p.nbf},message:r,signature:t.s.s,cacao:t}});try{await i.setSessions(t),l.X.sendEvent({type:"track",event:"SIWX_AUTH_SUCCESS",properties:g.getSIWXEventProperties()})}catch(t){throw console.error("SIWX:universalProviderAuth - failed to set sessions",t),l.X.sendEvent({type:"track",event:"SIWX_AUTH_ERROR",properties:g.getSIWXEventProperties()}),await e.disconnect().catch(console.error),t}finally{p.SnackController.hide()}}return!0},getSIWXEventProperties:()=>({network:o.R.state.activeCaipNetwork?.caipNetworkId||"",isSmartAccount:n.N.state.preferredAccountType===s.y_.ACCOUNT_TYPES.SMART_ACCOUNT}),async clearSessions(){let e=this.getSIWX();e&&await e.setSessions([])}}},36801:function(e,t,r){"use strict";r.d(t,{M:function(){return s}});var i=r(61616);let s={cacheExpiry:{portfolio:3e4,nativeBalance:3e4,ens:3e5,identity:3e5},isCacheExpired:(e,t)=>Date.now()-e>t,getActiveNetworkProps(){let e=s.getActiveNamespace(),t=s.getActiveCaipNetworkId(),r=t?t.split(":")[1]:void 0;return{namespace:e,caipNetworkId:t,chainId:r?isNaN(Number(r))?r:Number(r):void 0}},setWalletConnectDeepLink({name:e,href:t}){try{i.mr.setItem(i.uJ.DEEPLINK_CHOICE,JSON.stringify({href:t,name:e}))}catch{console.info("Unable to set WalletConnect deep link")}},getWalletConnectDeepLink(){try{let e=i.mr.getItem(i.uJ.DEEPLINK_CHOICE);if(e)return JSON.parse(e)}catch{console.info("Unable to get WalletConnect deep link")}},deleteWalletConnectDeepLink(){try{i.mr.removeItem(i.uJ.DEEPLINK_CHOICE)}catch{console.info("Unable to delete WalletConnect deep link")}},setActiveNamespace(e){try{i.mr.setItem(i.uJ.ACTIVE_NAMESPACE,e)}catch{console.info("Unable to set active namespace")}},setActiveCaipNetworkId(e){try{i.mr.setItem(i.uJ.ACTIVE_CAIP_NETWORK_ID,e),s.setActiveNamespace(e.split(":")[0])}catch{console.info("Unable to set active caip network id")}},getActiveCaipNetworkId(){try{return i.mr.getItem(i.uJ.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to get active caip network id");return}},deleteActiveCaipNetworkId(){try{i.mr.removeItem(i.uJ.ACTIVE_CAIP_NETWORK_ID)}catch{console.info("Unable to delete active caip network id")}},deleteConnectedConnectorId(e){try{let t=(0,i.Vk)(e);i.mr.removeItem(t)}catch{console.info("Unable to delete connected connector id")}},setAppKitRecent(e){try{let t=s.getRecentWallets();t.find(t=>t.id===e.id)||(t.unshift(e),t.length>2&&t.pop(),i.mr.setItem(i.uJ.RECENT_WALLETS,JSON.stringify(t)))}catch{console.info("Unable to set AppKit recent")}},getRecentWallets(){try{let e=i.mr.getItem(i.uJ.RECENT_WALLETS);return e?JSON.parse(e):[]}catch{console.info("Unable to get AppKit recent")}return[]},setConnectedConnectorId(e,t){try{let r=(0,i.Vk)(e);i.mr.setItem(r,t)}catch{console.info("Unable to set Connected Connector Id")}},getActiveNamespace(){try{return i.mr.getItem(i.uJ.ACTIVE_NAMESPACE)}catch{console.info("Unable to get active namespace")}},getConnectedConnectorId(e){if(e)try{let t=(0,i.Vk)(e);return i.mr.getItem(t)}catch(t){console.info("Unable to get connected connector id in namespace ",e)}},setConnectedSocialProvider(e){try{i.mr.setItem(i.uJ.CONNECTED_SOCIAL,e)}catch{console.info("Unable to set connected social provider")}},getConnectedSocialProvider(){try{return i.mr.getItem(i.uJ.CONNECTED_SOCIAL)}catch{console.info("Unable to get connected social provider")}},deleteConnectedSocialProvider(){try{i.mr.removeItem(i.uJ.CONNECTED_SOCIAL)}catch{console.info("Unable to delete connected social provider")}},getConnectedSocialUsername(){try{return i.mr.getItem(i.uJ.CONNECTED_SOCIAL_USERNAME)}catch{console.info("Unable to get connected social username")}},getStoredActiveCaipNetworkId(){let e=i.mr.getItem(i.uJ.ACTIVE_CAIP_NETWORK_ID);return e?.split(":")?.[1]},setConnectionStatus(e){try{i.mr.setItem(i.uJ.CONNECTION_STATUS,e)}catch{console.info("Unable to set connection status")}},getConnectionStatus(){try{return i.mr.getItem(i.uJ.CONNECTION_STATUS)}catch{return}},getConnectedNamespaces(){try{let e=i.mr.getItem(i.uJ.CONNECTED_NAMESPACES);if(!e?.length)return[];return e.split(",")}catch{return[]}},setConnectedNamespaces(e){try{let t=Array.from(new Set(e));i.mr.setItem(i.uJ.CONNECTED_NAMESPACES,t.join(","))}catch{console.info("Unable to set namespaces in storage")}},addConnectedNamespace(e){try{let t=s.getConnectedNamespaces();t.includes(e)||(t.push(e),s.setConnectedNamespaces(t))}catch{console.info("Unable to add connected namespace")}},removeConnectedNamespace(e){try{let t=s.getConnectedNamespaces(),r=t.indexOf(e);r>-1&&(t.splice(r,1),s.setConnectedNamespaces(t))}catch{console.info("Unable to remove connected namespace")}},getTelegramSocialProvider(){try{return i.mr.getItem(i.uJ.TELEGRAM_SOCIAL_PROVIDER)}catch{return console.info("Unable to get telegram social provider"),null}},setTelegramSocialProvider(e){try{i.mr.setItem(i.uJ.TELEGRAM_SOCIAL_PROVIDER,e)}catch{console.info("Unable to set telegram social provider")}},removeTelegramSocialProvider(){try{i.mr.removeItem(i.uJ.TELEGRAM_SOCIAL_PROVIDER)}catch{console.info("Unable to remove telegram social provider")}},getBalanceCache(){let e={};try{let t=i.mr.getItem(i.uJ.PORTFOLIO_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromBalanceCache(e){try{let t=s.getBalanceCache();i.mr.setItem(i.uJ.PORTFOLIO_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getBalanceCacheForCaipAddress(e){try{let t=s.getBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.portfolio))return t.balance;s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateBalanceCache(e){try{let t=s.getBalanceCache();t[e.caipAddress]=e,i.mr.setItem(i.uJ.PORTFOLIO_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getNativeBalanceCache(){let e={};try{let t=i.mr.getItem(i.uJ.NATIVE_BALANCE_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get balance cache")}return e},removeAddressFromNativeBalanceCache(e){try{let t=s.getBalanceCache();i.mr.setItem(i.uJ.NATIVE_BALANCE_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove address from balance cache",e)}},getNativeBalanceCacheForCaipAddress(e){try{let t=s.getNativeBalanceCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.nativeBalance))return t;console.info("Discarding cache for address",e),s.removeAddressFromBalanceCache(e)}catch{console.info("Unable to get balance cache for address",e)}},updateNativeBalanceCache(e){try{let t=s.getNativeBalanceCache();t[e.caipAddress]=e,i.mr.setItem(i.uJ.NATIVE_BALANCE_CACHE,JSON.stringify(t))}catch{console.info("Unable to update balance cache",e)}},getEnsCache(){let e={};try{let t=i.mr.getItem(i.uJ.ENS_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get ens name cache")}return e},getEnsFromCacheForAddress(e){try{let t=s.getEnsCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.ens))return t.ens;s.removeEnsFromCache(e)}catch{console.info("Unable to get ens name from cache",e)}},updateEnsCache(e){try{let t=s.getEnsCache();t[e.address]=e,i.mr.setItem(i.uJ.ENS_CACHE,JSON.stringify(t))}catch{console.info("Unable to update ens name cache",e)}},removeEnsFromCache(e){try{let t=s.getEnsCache();i.mr.setItem(i.uJ.ENS_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove ens name from cache",e)}},getIdentityCache(){let e={};try{let t=i.mr.getItem(i.uJ.IDENTITY_CACHE);e=t?JSON.parse(t):{}}catch{console.info("Unable to get identity cache")}return e},getIdentityFromCacheForAddress(e){try{let t=s.getIdentityCache()[e];if(t&&!this.isCacheExpired(t.timestamp,this.cacheExpiry.identity))return t.identity;s.removeIdentityFromCache(e)}catch{console.info("Unable to get identity from cache",e)}},updateIdentityCache(e){try{let t=s.getIdentityCache();t[e.address]={identity:e.identity,timestamp:e.timestamp},i.mr.setItem(i.uJ.IDENTITY_CACHE,JSON.stringify(t))}catch{console.info("Unable to update identity cache",e)}},removeIdentityFromCache(e){try{let t=s.getIdentityCache();i.mr.setItem(i.uJ.IDENTITY_CACHE,JSON.stringify({...t,[e]:void 0}))}catch{console.info("Unable to remove identity from cache",e)}},clearAddressCache(){try{i.mr.removeItem(i.uJ.PORTFOLIO_CACHE),i.mr.removeItem(i.uJ.NATIVE_BALANCE_CACHE),i.mr.removeItem(i.uJ.ENS_CACHE),i.mr.removeItem(i.uJ.IDENTITY_CACHE)}catch{console.info("Unable to clear address cache")}}}},46773:function(e,t,r){"use strict";r.d(t,{C:function(){return p}});var i=r(44649),s=r(48415),n=r(36801),o=r(17766),a=r(53357),c=r(93046),l=r(92144),h=r(54173),u=r(54090),d=r(70768);let p={getConnectorsByType(e,t,r){let{customWallets:i}=s.OptionsController.state,o=n.M.getRecentWallets(),a=d.J.filterOutDuplicateWallets(t),c=d.J.filterOutDuplicateWallets(r),l=e.filter(e=>"MULTI_CHAIN"===e.type),h=e.filter(e=>"ANNOUNCED"===e.type),u=e.filter(e=>"INJECTED"===e.type);return{custom:i,recent:o,external:e.filter(e=>"EXTERNAL"===e.type),multiChain:l,announced:h,injected:u,recommended:a,featured:c}},showConnector(e){let t=e.info?.rdns,r=!!t&&o.ApiController.state.excludedWallets.some(e=>e.rdns===t),i=!!e.name&&o.ApiController.state.excludedWallets.some(t=>u.g.isLowerCaseMatch(t.name,e.name));return("INJECTED"!==e.type||(!!a.j.isMobile()||"Browser Wallet"!==e.name)&&(!!t||!!c.ConnectionController.checkInstalled())&&!r&&!i)&&("ANNOUNCED"!==e.type||!r&&!i)},getIsConnectedWithWC:()=>Array.from(l.R.state.chains.values()).some(e=>h.ConnectorController.getConnectorId(e.namespace)===i.b.CONNECTOR_ID.WALLET_CONNECT),getConnectorTypeOrder({recommended:e,featured:t,custom:r,recent:i,announced:n,injected:o,multiChain:a,external:c,overriddenConnectors:l=s.OptionsController.state.features?.connectorTypeOrder??[]}){let h=p.getIsConnectedWithWC(),u=[{type:"walletConnect",isEnabled:s.OptionsController.state.enableWalletConnect&&!h},{type:"recent",isEnabled:i.length>0},{type:"injected",isEnabled:[...o,...n,...a].length>0},{type:"featured",isEnabled:t.length>0},{type:"custom",isEnabled:r&&r.length>0},{type:"external",isEnabled:c.length>0},{type:"recommended",isEnabled:e.length>0}].filter(e=>e.isEnabled),d=new Set(u.map(e=>e.type)),f=l.filter(e=>d.has(e)).map(e=>({type:e,isEnabled:!0})),g=u.filter(({type:e})=>!f.some(({type:t})=>t===e));return Array.from(new Set([...f,...g].map(({type:e})=>e)))}}},54946:function(e,t,r){"use strict";r.d(t,{b:function(){return s}});var i=r(25566);let s={ACCOUNT_TABS:[{label:"Tokens"},{label:"NFTs"},{label:"Activity"}],SECURE_SITE_ORIGIN:(void 0!==i&&void 0!==i.env?i.env.NEXT_PUBLIC_SECURE_SITE_ORIGIN:void 0)||"https://secure.walletconnect.org",VIEW_DIRECTION:{Next:"next",Prev:"prev"},DEFAULT_CONNECT_METHOD_ORDER:["email","social","wallet"],ANIMATION_DURATIONS:{HeaderText:120,ModalHeight:150,ViewTransition:150}}},70768:function(e,t,r){"use strict";r.d(t,{J:function(){return h}});var i=r(48415),s=r(54173),n=r(36801),o=r(53357),a=r(17766),c=r(46773),l=r(54946);let h={filterOutDuplicatesByRDNS(e){let t=i.OptionsController.state.enableEIP6963?s.ConnectorController.state.connectors:[],r=n.M.getRecentWallets(),a=t.map(e=>e.info?.rdns).filter(Boolean),c=r.map(e=>e.rdns).filter(Boolean),l=a.concat(c);if(l.includes("io.metamask.mobile")&&o.j.isMobile()){let e=l.indexOf("io.metamask.mobile");l[e]="io.metamask"}return e.filter(e=>!l.includes(String(e?.rdns)))},filterOutDuplicatesByIds(e){let t=s.ConnectorController.state.connectors.filter(e=>"ANNOUNCED"===e.type||"INJECTED"===e.type),r=n.M.getRecentWallets(),i=t.map(e=>e.explorerId),o=r.map(e=>e.id),a=i.concat(o);return e.filter(e=>!a.includes(e?.id))},filterOutDuplicateWallets(e){let t=this.filterOutDuplicatesByRDNS(e);return this.filterOutDuplicatesByIds(t)},markWalletsAsInstalled(e){let{connectors:t}=s.ConnectorController.state,r=t.filter(e=>"ANNOUNCED"===e.type).reduce((e,t)=>(t.info?.rdns&&(e[t.info.rdns]=!0),e),{});return e.map(e=>({...e,installed:!!e.rdns&&!!r[e.rdns??""]})).sort((e,t)=>Number(t.installed)-Number(e.installed))},getConnectOrderMethod(e,t){let r=e?.connectMethodsOrder||i.OptionsController.state.features?.connectMethodsOrder,n=t||s.ConnectorController.state.connectors;if(r)return r;let{injected:o,announced:h}=c.C.getConnectorsByType(n,a.ApiController.state.recommended,a.ApiController.state.featured),u=o.filter(c.C.showConnector),d=h.filter(c.C.showConnector);return u.length||d.length?["wallet","email","social"]:l.b.DEFAULT_CONNECT_METHOD_ORDER}}},30795:function(e,t,r){"use strict";r.d(t,{Hg:function(){return s.H},Mo:function(){return h.M},n:function(){return i.n},Hs:function(){return i.Hs},R:function(){return i.R}});var i=r(84249),s=r(3874),n=r(71096),o=r(70939),a=r(45721),c=r(96961);n.extend(a),n.extend(c);let l={...o,name:"en-web3-modal",relativeTime:{future:"in %s",past:"%s ago",s:"%d sec",m:"1 min",mm:"%d min",h:"1 hr",hh:"%d hrs",d:"1 d",dd:"%d d",M:"1 mo",MM:"%d mo",y:"1 yr",yy:"%d yr"}};n.locale("en-web3-modal",l);var h=r(57116)},84249:function(e,t,r){"use strict";let i,s,n;r.d(t,{Bp:function(){return f},ET:function(){return d},Hs:function(){return l},R:function(){return h},ZM:function(){return p},n:function(){return c}});var o=r(31133),a=r(62714);function c(e,t){i=document.createElement("style"),s=document.createElement("style"),n=document.createElement("style"),i.textContent=u(e).core.cssText,s.textContent=u(e).dark.cssText,n.textContent=u(e).light.cssText,document.head.appendChild(i),document.head.appendChild(s),document.head.appendChild(n),l(t)}function l(e){s&&n&&("light"===e?(s.removeAttribute("media"),n.media="enabled"):(n.removeAttribute("media"),s.media="enabled"))}function h(e){i&&s&&n&&(i.textContent=u(e).core.cssText,s.textContent=u(e).dark.cssText,n.textContent=u(e).light.cssText)}function u(e){return{core:(0,o.iv)`
      @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');
      @keyframes w3m-shake {
        0% {
          transform: scale(1) rotate(0deg);
        }
        20% {
          transform: scale(1) rotate(-1deg);
        }
        40% {
          transform: scale(1) rotate(1.5deg);
        }
        60% {
          transform: scale(1) rotate(-1.5deg);
        }
        80% {
          transform: scale(1) rotate(1deg);
        }
        100% {
          transform: scale(1) rotate(0deg);
        }
      }
      @keyframes w3m-iframe-fade-out {
        0% {
          opacity: 1;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes w3m-iframe-zoom-in {
        0% {
          transform: translateY(50px);
          opacity: 0;
        }
        100% {
          transform: translateY(0px);
          opacity: 1;
        }
      }
      @keyframes w3m-iframe-zoom-in-mobile {
        0% {
          transform: scale(0.95);
          opacity: 0;
        }
        100% {
          transform: scale(1);
          opacity: 1;
        }
      }
      :root {
        --w3m-modal-width: 360px;
        --w3m-color-mix-strength: ${(0,o.$m)(e?.["--w3m-color-mix-strength"]?`${e["--w3m-color-mix-strength"]}%`:"0%")};
        --w3m-font-family: ${(0,o.$m)(e?.["--w3m-font-family"]||"Inter, Segoe UI, Roboto, Oxygen, Ubuntu, Cantarell, Fira Sans, Droid Sans, Helvetica Neue, sans-serif;")};
        --w3m-font-size-master: ${(0,o.$m)(e?.["--w3m-font-size-master"]||"10px")};
        --w3m-border-radius-master: ${(0,o.$m)(e?.["--w3m-border-radius-master"]||"4px")};
        --w3m-z-index: ${(0,o.$m)(e?.["--w3m-z-index"]||999)};

        --wui-font-family: var(--w3m-font-family);

        --wui-font-size-mini: calc(var(--w3m-font-size-master) * 0.8);
        --wui-font-size-micro: var(--w3m-font-size-master);
        --wui-font-size-tiny: calc(var(--w3m-font-size-master) * 1.2);
        --wui-font-size-small: calc(var(--w3m-font-size-master) * 1.4);
        --wui-font-size-paragraph: calc(var(--w3m-font-size-master) * 1.6);
        --wui-font-size-medium: calc(var(--w3m-font-size-master) * 1.8);
        --wui-font-size-large: calc(var(--w3m-font-size-master) * 2);
        --wui-font-size-title-6: calc(var(--w3m-font-size-master) * 2.2);
        --wui-font-size-medium-title: calc(var(--w3m-font-size-master) * 2.4);
        --wui-font-size-2xl: calc(var(--w3m-font-size-master) * 4);

        --wui-border-radius-5xs: var(--w3m-border-radius-master);
        --wui-border-radius-4xs: calc(var(--w3m-border-radius-master) * 1.5);
        --wui-border-radius-3xs: calc(var(--w3m-border-radius-master) * 2);
        --wui-border-radius-xxs: calc(var(--w3m-border-radius-master) * 3);
        --wui-border-radius-xs: calc(var(--w3m-border-radius-master) * 4);
        --wui-border-radius-s: calc(var(--w3m-border-radius-master) * 5);
        --wui-border-radius-m: calc(var(--w3m-border-radius-master) * 7);
        --wui-border-radius-l: calc(var(--w3m-border-radius-master) * 9);
        --wui-border-radius-3xl: calc(var(--w3m-border-radius-master) * 20);

        --wui-font-weight-light: 400;
        --wui-font-weight-regular: 500;
        --wui-font-weight-medium: 600;
        --wui-font-weight-bold: 700;

        --wui-letter-spacing-2xl: -1.6px;
        --wui-letter-spacing-medium-title: -0.96px;
        --wui-letter-spacing-title-6: -0.88px;
        --wui-letter-spacing-large: -0.8px;
        --wui-letter-spacing-medium: -0.72px;
        --wui-letter-spacing-paragraph: -0.64px;
        --wui-letter-spacing-small: -0.56px;
        --wui-letter-spacing-tiny: -0.48px;
        --wui-letter-spacing-micro: -0.2px;
        --wui-letter-spacing-mini: -0.16px;

        --wui-spacing-0: 0px;
        --wui-spacing-4xs: 2px;
        --wui-spacing-3xs: 4px;
        --wui-spacing-xxs: 6px;
        --wui-spacing-2xs: 7px;
        --wui-spacing-xs: 8px;
        --wui-spacing-1xs: 10px;
        --wui-spacing-s: 12px;
        --wui-spacing-m: 14px;
        --wui-spacing-l: 16px;
        --wui-spacing-2l: 18px;
        --wui-spacing-xl: 20px;
        --wui-spacing-xxl: 24px;
        --wui-spacing-2xl: 32px;
        --wui-spacing-3xl: 40px;
        --wui-spacing-4xl: 90px;
        --wui-spacing-5xl: 95px;

        --wui-icon-box-size-xxs: 14px;
        --wui-icon-box-size-xs: 20px;
        --wui-icon-box-size-sm: 24px;
        --wui-icon-box-size-md: 32px;
        --wui-icon-box-size-mdl: 36px;
        --wui-icon-box-size-lg: 40px;
        --wui-icon-box-size-2lg: 48px;
        --wui-icon-box-size-xl: 64px;

        --wui-icon-size-inherit: inherit;
        --wui-icon-size-xxs: 10px;
        --wui-icon-size-xs: 12px;
        --wui-icon-size-sm: 14px;
        --wui-icon-size-md: 16px;
        --wui-icon-size-mdl: 18px;
        --wui-icon-size-lg: 20px;
        --wui-icon-size-xl: 24px;
        --wui-icon-size-xxl: 28px;

        --wui-wallet-image-size-inherit: inherit;
        --wui-wallet-image-size-sm: 40px;
        --wui-wallet-image-size-md: 56px;
        --wui-wallet-image-size-lg: 80px;

        --wui-visual-size-size-inherit: inherit;
        --wui-visual-size-sm: 40px;
        --wui-visual-size-md: 55px;
        --wui-visual-size-lg: 80px;

        --wui-box-size-md: 100px;
        --wui-box-size-lg: 120px;

        --wui-ease-out-power-2: cubic-bezier(0, 0, 0.22, 1);
        --wui-ease-out-power-1: cubic-bezier(0, 0, 0.55, 1);

        --wui-ease-in-power-3: cubic-bezier(0.66, 0, 1, 1);
        --wui-ease-in-power-2: cubic-bezier(0.45, 0, 1, 1);
        --wui-ease-in-power-1: cubic-bezier(0.3, 0, 1, 1);

        --wui-ease-inout-power-1: cubic-bezier(0.45, 0, 0.55, 1);

        --wui-duration-lg: 200ms;
        --wui-duration-md: 125ms;
        --wui-duration-sm: 75ms;

        --wui-path-network-sm: path(
          'M15.4 2.1a5.21 5.21 0 0 1 5.2 0l11.61 6.7a5.21 5.21 0 0 1 2.61 4.52v13.4c0 1.87-1 3.59-2.6 4.52l-11.61 6.7c-1.62.93-3.6.93-5.22 0l-11.6-6.7a5.21 5.21 0 0 1-2.61-4.51v-13.4c0-1.87 1-3.6 2.6-4.52L15.4 2.1Z'
        );

        --wui-path-network-md: path(
          'M43.4605 10.7248L28.0485 1.61089C25.5438 0.129705 22.4562 0.129705 19.9515 1.61088L4.53951 10.7248C2.03626 12.2051 0.5 14.9365 0.5 17.886V36.1139C0.5 39.0635 2.03626 41.7949 4.53951 43.2752L19.9515 52.3891C22.4562 53.8703 25.5438 53.8703 28.0485 52.3891L43.4605 43.2752C45.9637 41.7949 47.5 39.0635 47.5 36.114V17.8861C47.5 14.9365 45.9637 12.2051 43.4605 10.7248Z'
        );

        --wui-path-network-lg: path(
          'M78.3244 18.926L50.1808 2.45078C45.7376 -0.150261 40.2624 -0.150262 35.8192 2.45078L7.6756 18.926C3.23322 21.5266 0.5 26.3301 0.5 31.5248V64.4752C0.5 69.6699 3.23322 74.4734 7.6756 77.074L35.8192 93.5492C40.2624 96.1503 45.7376 96.1503 50.1808 93.5492L78.3244 77.074C82.7668 74.4734 85.5 69.6699 85.5 64.4752V31.5248C85.5 26.3301 82.7668 21.5266 78.3244 18.926Z'
        );

        --wui-width-network-sm: 36px;
        --wui-width-network-md: 48px;
        --wui-width-network-lg: 86px;

        --wui-height-network-sm: 40px;
        --wui-height-network-md: 54px;
        --wui-height-network-lg: 96px;

        --wui-icon-size-network-xs: 12px;
        --wui-icon-size-network-sm: 16px;
        --wui-icon-size-network-md: 24px;
        --wui-icon-size-network-lg: 42px;

        --wui-color-inherit: inherit;

        --wui-color-inverse-100: #fff;
        --wui-color-inverse-000: #000;

        --wui-cover: rgba(20, 20, 20, 0.8);

        --wui-color-modal-bg: var(--wui-color-modal-bg-base);

        --wui-color-accent-100: var(--wui-color-accent-base-100);
        --wui-color-accent-090: var(--wui-color-accent-base-090);
        --wui-color-accent-080: var(--wui-color-accent-base-080);

        --wui-color-success-100: var(--wui-color-success-base-100);
        --wui-color-success-125: var(--wui-color-success-base-125);

        --wui-color-warning-100: var(--wui-color-warning-base-100);

        --wui-color-error-100: var(--wui-color-error-base-100);
        --wui-color-error-125: var(--wui-color-error-base-125);

        --wui-color-blue-100: var(--wui-color-blue-base-100);
        --wui-color-blue-90: var(--wui-color-blue-base-90);

        --wui-icon-box-bg-error-100: var(--wui-icon-box-bg-error-base-100);
        --wui-icon-box-bg-blue-100: var(--wui-icon-box-bg-blue-base-100);
        --wui-icon-box-bg-success-100: var(--wui-icon-box-bg-success-base-100);
        --wui-icon-box-bg-inverse-100: var(--wui-icon-box-bg-inverse-base-100);

        --wui-all-wallets-bg-100: var(--wui-all-wallets-bg-100);

        --wui-avatar-border: var(--wui-avatar-border-base);

        --wui-thumbnail-border: var(--wui-thumbnail-border-base);

        --wui-wallet-button-bg: var(--wui-wallet-button-bg-base);

        --wui-box-shadow-blue: var(--wui-color-accent-glass-020);
      }

      @supports (background: color-mix(in srgb, white 50%, black)) {
        :root {
          --wui-color-modal-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-modal-bg-base)
          );

          --wui-box-shadow-blue: color-mix(in srgb, var(--wui-color-accent-100) 20%, transparent);

          --wui-color-accent-100: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 100%,
            transparent
          );
          --wui-color-accent-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-090: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 90%,
            transparent
          );
          --wui-color-accent-glass-080: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 80%,
            transparent
          );
          --wui-color-accent-glass-020: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 20%,
            transparent
          );
          --wui-color-accent-glass-015: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 15%,
            transparent
          );
          --wui-color-accent-glass-010: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 10%,
            transparent
          );
          --wui-color-accent-glass-005: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 5%,
            transparent
          );
          --wui-color-accent-002: color-mix(
            in srgb,
            var(--wui-color-accent-base-100) 2%,
            transparent
          );

          --wui-color-fg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-100)
          );
          --wui-color-fg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-125)
          );
          --wui-color-fg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-150)
          );
          --wui-color-fg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-175)
          );
          --wui-color-fg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-200)
          );
          --wui-color-fg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-225)
          );
          --wui-color-fg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-250)
          );
          --wui-color-fg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-275)
          );
          --wui-color-fg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-300)
          );
          --wui-color-fg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-325)
          );
          --wui-color-fg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-fg-350)
          );

          --wui-color-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-100)
          );
          --wui-color-bg-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-125)
          );
          --wui-color-bg-150: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-150)
          );
          --wui-color-bg-175: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-175)
          );
          --wui-color-bg-200: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-200)
          );
          --wui-color-bg-225: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-225)
          );
          --wui-color-bg-250: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-250)
          );
          --wui-color-bg-275: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-275)
          );
          --wui-color-bg-300: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-300)
          );
          --wui-color-bg-325: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-325)
          );
          --wui-color-bg-350: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-bg-350)
          );

          --wui-color-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-100)
          );
          --wui-color-success-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-success-base-125)
          );

          --wui-color-warning-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-warning-base-100)
          );

          --wui-color-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-100)
          );
          --wui-color-blue-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-100)
          );
          --wui-color-blue-90: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-blue-base-90)
          );
          --wui-color-error-125: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-color-error-base-125)
          );

          --wui-icon-box-bg-error-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-error-base-100)
          );
          --wui-icon-box-bg-accent-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-blue-base-100)
          );
          --wui-icon-box-bg-success-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-success-base-100)
          );
          --wui-icon-box-bg-inverse-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-icon-box-bg-inverse-base-100)
          );

          --wui-all-wallets-bg-100: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-all-wallets-bg-100)
          );

          --wui-avatar-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-avatar-border-base)
          );

          --wui-thumbnail-border: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-thumbnail-border-base)
          );

          --wui-wallet-button-bg: color-mix(
            in srgb,
            var(--w3m-color-mix) var(--w3m-color-mix-strength),
            var(--wui-wallet-button-bg-base)
          );
        }
      }
    `,light:(0,o.iv)`
      :root {
        --w3m-color-mix: ${(0,o.$m)(e?.["--w3m-color-mix"]||"#fff")};
        --w3m-accent: ${(0,o.$m)((0,a.t)(e,"dark")["--w3m-accent"])};
        --w3m-default: #fff;

        --wui-color-modal-bg-base: ${(0,o.$m)((0,a.t)(e,"dark")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(230, 100%, 67%, 1);
        --wui-color-blueberry-090: hsla(231, 76%, 61%, 1);
        --wui-color-blueberry-080: hsla(230, 59%, 55%, 1);
        --wui-color-blueberry-050: hsla(231, 100%, 70%, 0.1);

        --wui-color-fg-100: #e4e7e7;
        --wui-color-fg-125: #d0d5d5;
        --wui-color-fg-150: #a8b1b1;
        --wui-color-fg-175: #a8b0b0;
        --wui-color-fg-200: #949e9e;
        --wui-color-fg-225: #868f8f;
        --wui-color-fg-250: #788080;
        --wui-color-fg-275: #788181;
        --wui-color-fg-300: #6e7777;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #363636;

        --wui-color-bg-100: #141414;
        --wui-color-bg-125: #191a1a;
        --wui-color-bg-150: #1e1f1f;
        --wui-color-bg-175: #222525;
        --wui-color-bg-200: #272a2a;
        --wui-color-bg-225: #2c3030;
        --wui-color-bg-250: #313535;
        --wui-color-bg-275: #363b3b;
        --wui-color-bg-300: #3b4040;
        --wui-color-bg-325: #252525;
        --wui-color-bg-350: #ffffff;

        --wui-color-success-base-100: #26d962;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f25a67;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 217, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 217, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 217, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 217, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 217, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 217, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 217, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 217, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 217, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 217, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(242, 90, 103, 0.01);
        --wui-color-error-glass-002: rgba(242, 90, 103, 0.02);
        --wui-color-error-glass-005: rgba(242, 90, 103, 0.05);
        --wui-color-error-glass-010: rgba(242, 90, 103, 0.1);
        --wui-color-error-glass-015: rgba(242, 90, 103, 0.15);
        --wui-color-error-glass-020: rgba(242, 90, 103, 0.2);
        --wui-color-error-glass-025: rgba(242, 90, 103, 0.25);
        --wui-color-error-glass-030: rgba(242, 90, 103, 0.3);
        --wui-color-error-glass-060: rgba(242, 90, 103, 0.6);
        --wui-color-error-glass-080: rgba(242, 90, 103, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-color-gray-glass-001: rgba(255, 255, 255, 0.01);
        --wui-color-gray-glass-002: rgba(255, 255, 255, 0.02);
        --wui-color-gray-glass-005: rgba(255, 255, 255, 0.05);
        --wui-color-gray-glass-010: rgba(255, 255, 255, 0.1);
        --wui-color-gray-glass-015: rgba(255, 255, 255, 0.15);
        --wui-color-gray-glass-020: rgba(255, 255, 255, 0.2);
        --wui-color-gray-glass-025: rgba(255, 255, 255, 0.25);
        --wui-color-gray-glass-030: rgba(255, 255, 255, 0.3);
        --wui-color-gray-glass-060: rgba(255, 255, 255, 0.6);
        --wui-color-gray-glass-080: rgba(255, 255, 255, 0.8);
        --wui-color-gray-glass-090: rgba(255, 255, 255, 0.9);

        --wui-color-dark-glass-100: rgba(42, 42, 42, 1);

        --wui-icon-box-bg-error-base-100: #3c2426;
        --wui-icon-box-bg-blue-base-100: #20303f;
        --wui-icon-box-bg-success-base-100: #1f3a28;
        --wui-icon-box-bg-inverse-base-100: #243240;

        --wui-all-wallets-bg-100: #222b35;

        --wui-avatar-border-base: #252525;

        --wui-thumbnail-border-base: #252525;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --w3m-card-embedded-shadow-color: rgb(17 17 18 / 25%);
      }
    `,dark:(0,o.iv)`
      :root {
        --w3m-color-mix: ${(0,o.$m)(e?.["--w3m-color-mix"]||"#000")};
        --w3m-accent: ${(0,o.$m)((0,a.t)(e,"light")["--w3m-accent"])};
        --w3m-default: #000;

        --wui-color-modal-bg-base: ${(0,o.$m)((0,a.t)(e,"light")["--w3m-background"])};
        --wui-color-accent-base-100: var(--w3m-accent);

        --wui-color-blueberry-100: hsla(231, 100%, 70%, 1);
        --wui-color-blueberry-090: hsla(231, 97%, 72%, 1);
        --wui-color-blueberry-080: hsla(231, 92%, 74%, 1);

        --wui-color-fg-100: #141414;
        --wui-color-fg-125: #2d3131;
        --wui-color-fg-150: #474d4d;
        --wui-color-fg-175: #636d6d;
        --wui-color-fg-200: #798686;
        --wui-color-fg-225: #828f8f;
        --wui-color-fg-250: #8b9797;
        --wui-color-fg-275: #95a0a0;
        --wui-color-fg-300: #9ea9a9;
        --wui-color-fg-325: #9a9a9a;
        --wui-color-fg-350: #d0d0d0;

        --wui-color-bg-100: #ffffff;
        --wui-color-bg-125: #f5fafa;
        --wui-color-bg-150: #f3f8f8;
        --wui-color-bg-175: #eef4f4;
        --wui-color-bg-200: #eaf1f1;
        --wui-color-bg-225: #e5eded;
        --wui-color-bg-250: #e1e9e9;
        --wui-color-bg-275: #dce7e7;
        --wui-color-bg-300: #d8e3e3;
        --wui-color-bg-325: #f3f3f3;
        --wui-color-bg-350: #202020;

        --wui-color-success-base-100: #26b562;
        --wui-color-success-base-125: #30a46b;

        --wui-color-warning-base-100: #f3a13f;

        --wui-color-error-base-100: #f05142;
        --wui-color-error-base-125: #df4a34;

        --wui-color-blue-base-100: rgba(102, 125, 255, 1);
        --wui-color-blue-base-90: rgba(102, 125, 255, 0.9);

        --wui-color-success-glass-001: rgba(38, 181, 98, 0.01);
        --wui-color-success-glass-002: rgba(38, 181, 98, 0.02);
        --wui-color-success-glass-005: rgba(38, 181, 98, 0.05);
        --wui-color-success-glass-010: rgba(38, 181, 98, 0.1);
        --wui-color-success-glass-015: rgba(38, 181, 98, 0.15);
        --wui-color-success-glass-020: rgba(38, 181, 98, 0.2);
        --wui-color-success-glass-025: rgba(38, 181, 98, 0.25);
        --wui-color-success-glass-030: rgba(38, 181, 98, 0.3);
        --wui-color-success-glass-060: rgba(38, 181, 98, 0.6);
        --wui-color-success-glass-080: rgba(38, 181, 98, 0.8);

        --wui-color-success-glass-reown-020: rgba(48, 164, 107, 0.2);

        --wui-color-warning-glass-reown-020: rgba(243, 161, 63, 0.2);

        --wui-color-error-glass-001: rgba(240, 81, 66, 0.01);
        --wui-color-error-glass-002: rgba(240, 81, 66, 0.02);
        --wui-color-error-glass-005: rgba(240, 81, 66, 0.05);
        --wui-color-error-glass-010: rgba(240, 81, 66, 0.1);
        --wui-color-error-glass-015: rgba(240, 81, 66, 0.15);
        --wui-color-error-glass-020: rgba(240, 81, 66, 0.2);
        --wui-color-error-glass-025: rgba(240, 81, 66, 0.25);
        --wui-color-error-glass-030: rgba(240, 81, 66, 0.3);
        --wui-color-error-glass-060: rgba(240, 81, 66, 0.6);
        --wui-color-error-glass-080: rgba(240, 81, 66, 0.8);

        --wui-color-error-glass-reown-020: rgba(223, 74, 52, 0.2);

        --wui-icon-box-bg-error-base-100: #f4dfdd;
        --wui-icon-box-bg-blue-base-100: #d9ecfb;
        --wui-icon-box-bg-success-base-100: #daf0e4;
        --wui-icon-box-bg-inverse-base-100: #dcecfc;

        --wui-all-wallets-bg-100: #e8f1fa;

        --wui-avatar-border-base: #f3f4f4;

        --wui-thumbnail-border-base: #eaefef;

        --wui-wallet-button-bg-base: var(--wui-color-bg-125);

        --wui-color-gray-glass-001: rgba(0, 0, 0, 0.01);
        --wui-color-gray-glass-002: rgba(0, 0, 0, 0.02);
        --wui-color-gray-glass-005: rgba(0, 0, 0, 0.05);
        --wui-color-gray-glass-010: rgba(0, 0, 0, 0.1);
        --wui-color-gray-glass-015: rgba(0, 0, 0, 0.15);
        --wui-color-gray-glass-020: rgba(0, 0, 0, 0.2);
        --wui-color-gray-glass-025: rgba(0, 0, 0, 0.25);
        --wui-color-gray-glass-030: rgba(0, 0, 0, 0.3);
        --wui-color-gray-glass-060: rgba(0, 0, 0, 0.6);
        --wui-color-gray-glass-080: rgba(0, 0, 0, 0.8);
        --wui-color-gray-glass-090: rgba(0, 0, 0, 0.9);

        --wui-color-dark-glass-100: rgba(233, 233, 233, 1);

        --w3m-card-embedded-shadow-color: rgb(224 225 233 / 25%);
      }
    `}}let d=(0,o.iv)`
  *,
  *::after,
  *::before,
  :host {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-style: normal;
    text-rendering: optimizeSpeed;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
    font-family: var(--wui-font-family);
    backface-visibility: hidden;
  }
`,p=(0,o.iv)`
  button,
  a {
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    transition:
      color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      background-color var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border var(--wui-duration-lg) var(--wui-ease-out-power-1),
      border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1),
      box-shadow var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: background-color, color, border, box-shadow, border-radius;
    outline: none;
    border: none;
    column-gap: var(--wui-spacing-3xs);
    background-color: transparent;
    text-decoration: none;
  }

  wui-flex {
    transition: border-radius var(--wui-duration-lg) var(--wui-ease-out-power-1);
    will-change: border-radius;
  }

  button:disabled > wui-wallet-image,
  button:disabled > wui-all-wallets-image,
  button:disabled > wui-network-image,
  button:disabled > wui-image,
  button:disabled > wui-transaction-visual,
  button:disabled > wui-logo {
    filter: grayscale(1);
  }

  @media (hover: hover) and (pointer: fine) {
    button:hover:enabled {
      background-color: var(--wui-color-gray-glass-005);
    }

    button:active:enabled {
      background-color: var(--wui-color-gray-glass-010);
    }
  }

  button:disabled > wui-icon-box {
    opacity: 0.5;
  }

  input {
    border: none;
    outline: none;
    appearance: none;
  }
`,f=(0,o.iv)`
  .wui-color-inherit {
    color: var(--wui-color-inherit);
  }

  .wui-color-accent-100 {
    color: var(--wui-color-accent-100);
  }

  .wui-color-error-100 {
    color: var(--wui-color-error-100);
  }

  .wui-color-blue-100 {
    color: var(--wui-color-blue-100);
  }

  .wui-color-blue-90 {
    color: var(--wui-color-blue-90);
  }

  .wui-color-error-125 {
    color: var(--wui-color-error-125);
  }

  .wui-color-success-100 {
    color: var(--wui-color-success-100);
  }

  .wui-color-success-125 {
    color: var(--wui-color-success-125);
  }

  .wui-color-inverse-100 {
    color: var(--wui-color-inverse-100);
  }

  .wui-color-inverse-000 {
    color: var(--wui-color-inverse-000);
  }

  .wui-color-fg-100 {
    color: var(--wui-color-fg-100);
  }

  .wui-color-fg-200 {
    color: var(--wui-color-fg-200);
  }

  .wui-color-fg-300 {
    color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    color: var(--wui-color-fg-350);
  }

  .wui-bg-color-inherit {
    background-color: var(--wui-color-inherit);
  }

  .wui-bg-color-blue-100 {
    background-color: var(--wui-color-accent-100);
  }

  .wui-bg-color-error-100 {
    background-color: var(--wui-color-error-100);
  }

  .wui-bg-color-error-125 {
    background-color: var(--wui-color-error-125);
  }

  .wui-bg-color-success-100 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-success-125 {
    background-color: var(--wui-color-success-100);
  }

  .wui-bg-color-inverse-100 {
    background-color: var(--wui-color-inverse-100);
  }

  .wui-bg-color-inverse-000 {
    background-color: var(--wui-color-inverse-000);
  }

  .wui-bg-color-fg-100 {
    background-color: var(--wui-color-fg-100);
  }

  .wui-bg-color-fg-200 {
    background-color: var(--wui-color-fg-200);
  }

  .wui-bg-color-fg-300 {
    background-color: var(--wui-color-fg-300);
  }

  .wui-color-fg-325 {
    background-color: var(--wui-color-fg-325);
  }

  .wui-color-fg-350 {
    background-color: var(--wui-color-fg-350);
  }
`},3874:function(e,t,r){"use strict";r.d(t,{H:function(){return i}});let i={getSpacingStyles:(e,t)=>Array.isArray(e)?e[t]?`var(--wui-spacing-${e[t]})`:void 0:"string"==typeof e?`var(--wui-spacing-${e})`:void 0,getFormattedDate:e=>new Intl.DateTimeFormat("en-US",{month:"short",day:"numeric"}).format(e),getHostName(e){try{return new URL(e).hostname}catch(e){return""}},getTruncateString:({string:e,charsStart:t,charsEnd:r,truncate:i})=>e.length<=t+r?e:"end"===i?`${e.substring(0,t)}...`:"start"===i?`...${e.substring(e.length-r)}`:`${e.substring(0,Math.floor(t))}...${e.substring(e.length-Math.floor(r))}`,generateAvatarColors(e){let t=e.toLowerCase().replace(/^0x/iu,"").replace(/[^a-f0-9]/gu,"").substring(0,6).padEnd(6,"0"),r=this.hexToRgb(t),i=getComputedStyle(document.documentElement).getPropertyValue("--w3m-border-radius-master"),s=100-3*Number(i?.replace("px","")),n=`${s}% ${s}% at 65% 40%`,o=[];for(let e=0;e<5;e+=1){let t=this.tintColor(r,.15*e);o.push(`rgb(${t[0]}, ${t[1]}, ${t[2]})`)}return`
    --local-color-1: ${o[0]};
    --local-color-2: ${o[1]};
    --local-color-3: ${o[2]};
    --local-color-4: ${o[3]};
    --local-color-5: ${o[4]};
    --local-radial-circle: ${n}
   `},hexToRgb(e){let t=parseInt(e,16);return[t>>16&255,t>>8&255,255&t]},tintColor(e,t){let[r,i,s]=e;return[Math.round(r+(255-r)*t),Math.round(i+(255-i)*t),Math.round(s+(255-s)*t)]},isNumber:e=>/^[0-9]+$/u.test(e),getColorTheme:e=>e||("undefined"!=typeof window&&window.matchMedia?window.matchMedia("(prefers-color-scheme: dark)")?.matches?"dark":"light":"dark"),splitBalance(e){let t=e.split(".");return 2===t.length?[t[0],t[1]]:["0","00"]},roundNumber:(e,t,r)=>e.toString().length>=t?Number(e).toFixed(r):e,formatNumberToLocalString:(e,t=2)=>void 0===e?"0.00":"number"==typeof e?e.toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t}):parseFloat(e).toLocaleString("en-US",{maximumFractionDigits:t,minimumFractionDigits:t})}},57116:function(e,t,r){"use strict";function i(e){return function(t){return"function"==typeof t?(customElements.get(e)||customElements.define(e,t),t):function(e,t){let{kind:r,elements:i}=t;return{kind:r,elements:i,finisher(t){customElements.get(e)||customElements.define(e,t)}}}(e,t)}}r.d(t,{M:function(){return i}})},88578:function(e,t,r){"use strict";r.d(t,{b:function(){return i}});let i={METMASK_CONNECTOR_NAME:"MetaMask",TRUST_CONNECTOR_NAME:"Trust Wallet",SOLFLARE_CONNECTOR_NAME:"Solflare",PHANTOM_CONNECTOR_NAME:"Phantom",COIN98_CONNECTOR_NAME:"Coin98",MAGIC_EDEN_CONNECTOR_NAME:"Magic Eden",BACKPACK_CONNECTOR_NAME:"Backpack",BITGET_CONNECTOR_NAME:"Bitget Wallet",FRONTIER_CONNECTOR_NAME:"Frontier",XVERSE_CONNECTOR_NAME:"Xverse Wallet",LEATHER_CONNECTOR_NAME:"Leather",EIP155:"eip155",ADD_CHAIN_METHOD:"wallet_addEthereumChain",EIP6963_ANNOUNCE_EVENT:"eip6963:announceProvider",EIP6963_REQUEST_EVENT:"eip6963:requestProvider",CONNECTOR_RDNS_MAP:{coinbaseWallet:"com.coinbase.wallet",coinbaseWalletSDK:"com.coinbase.wallet"},CONNECTOR_TYPE_EXTERNAL:"EXTERNAL",CONNECTOR_TYPE_WALLET_CONNECT:"WALLET_CONNECT",CONNECTOR_TYPE_INJECTED:"INJECTED",CONNECTOR_TYPE_ANNOUNCED:"ANNOUNCED",CONNECTOR_TYPE_AUTH:"AUTH",CONNECTOR_TYPE_MULTI_CHAIN:"MULTI_CHAIN",CONNECTOR_TYPE_W3M_AUTH:"ID_AUTH"}},54090:function(e,t,r){"use strict";r.d(t,{g:function(){return s}});var i=r(88578);let s={getCaipTokens(e){if(!e)return;let t={};return Object.entries(e).forEach(([e,r])=>{t[`${i.b.EIP155}:${e}`]=r}),t},isLowerCaseMatch:(e,t)=>e?.toLowerCase()===t?.toLowerCase()}},4786:function(e,t,r){"use strict";r.d(t,{y_:function(){return s}});var i=r(25566);void 0!==i&&void 0!==i.env&&i.env.NEXT_PUBLIC_SECURE_SITE_SDK_URL,void 0!==i&&void 0!==i.env&&i.env.NEXT_PUBLIC_DEFAULT_LOG_LEVEL,void 0!==i&&void 0!==i.env&&i.env.NEXT_PUBLIC_SECURE_SITE_SDK_VERSION;let s={SAFE_RPC_METHODS:["eth_accounts","eth_blockNumber","eth_call","eth_chainId","eth_estimateGas","eth_feeHistory","eth_gasPrice","eth_getAccount","eth_getBalance","eth_getBlockByHash","eth_getBlockByNumber","eth_getBlockReceipts","eth_getBlockTransactionCountByHash","eth_getBlockTransactionCountByNumber","eth_getCode","eth_getFilterChanges","eth_getFilterLogs","eth_getLogs","eth_getProof","eth_getStorageAt","eth_getTransactionByBlockHashAndIndex","eth_getTransactionByBlockNumberAndIndex","eth_getTransactionByHash","eth_getTransactionCount","eth_getTransactionReceipt","eth_getUncleCountByBlockHash","eth_getUncleCountByBlockNumber","eth_maxPriorityFeePerGas","eth_newBlockFilter","eth_newFilter","eth_newPendingTransactionFilter","eth_sendRawTransaction","eth_syncing","eth_uninstallFilter","wallet_getCapabilities","wallet_getCallsStatus","eth_getUserOperationReceipt","eth_estimateUserOperationGas","eth_getUserOperationByHash","eth_supportedEntryPoints","wallet_getAssets"],NOT_SAFE_RPC_METHODS:["personal_sign","eth_signTypedData_v4","eth_sendTransaction","solana_signMessage","solana_signTransaction","solana_signAllTransactions","solana_signAndSendTransaction","wallet_sendCalls","wallet_grantPermissions","wallet_revokePermissions","eth_sendUserOperation"],GET_CHAIN_ID:"eth_chainId",RPC_METHOD_NOT_ALLOWED_MESSAGE:"Requested RPC call is not allowed",RPC_METHOD_NOT_ALLOWED_UI_MESSAGE:"Action not allowed",ACCOUNT_TYPES:{EOA:"eoa",SMART_ACCOUNT:"smartAccount"}}},36789:function(e,t,r){"use strict";function i(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function s(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function n(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");i(e.outputLen),i(e.blockLen)}function o(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function a(e,t){s(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}r.d(t,{$h:function(){return o},eB:function(){return a},gk:function(){return s},k8:function(){return i},z3:function(){return n}})},48466:function(e,t,r){"use strict";r.d(t,{kb:function(){return d},l1:function(){return l},eV:function(){return u},GL:function(){return o},iA:function(){return c},O6:function(){return f},np:function(){return a},O0:function(){return h},Jq:function(){return n},hE:function(){return p}});let i="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;var s=r(36789);function n(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function o(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function a(e,t){return e<<32-t|e>>>t}let c=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function l(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}}function h(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),(0,s.gk)(e),e}function u(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];(0,s.gk)(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}class d{clone(){return this._cloneInto()}}function p(e){let t=t=>e().update(h(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function f(e=32){if(i&&"function"==typeof i.getRandomValues)return i.getRandomValues(new Uint8Array(e));if(i&&"function"==typeof i.randomBytes)return i.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}},59805:function(e,t,r){"use strict";r.d(t,{mI:function(){return a},i1:function(){return i},H:function(){return l},su:function(){return c}});var i,s,n=r(95589),o=r(74659);(s=i||(i={})).Installed="Installed",s.NotDetected="NotDetected",s.Loadable="Loadable",s.Unsupported="Unsupported";class a extends n{get connected(){return!!this.publicKey}async autoConnect(){await this.connect()}async prepareTransaction(e,t,r={}){let i=this.publicKey;if(!i)throw new o.oS;return e.feePayer=e.feePayer||i,e.recentBlockhash=e.recentBlockhash||(await t.getLatestBlockhash({commitment:r.preflightCommitment,minContextSlot:r.minContextSlot})).blockhash,e}}function c(e){if("undefined"==typeof window||"undefined"==typeof document)return;let t=[];function r(){if(e())for(let e of t)e()}let i=setInterval(r,1e3);t.push(()=>clearInterval(i)),"loading"===document.readyState&&(document.addEventListener("DOMContentLoaded",r,{once:!0}),t.push(()=>document.removeEventListener("DOMContentLoaded",r))),"complete"!==document.readyState&&(window.addEventListener("load",r,{once:!0}),t.push(()=>window.removeEventListener("load",r))),r()}function l(){if(!navigator)return!1;let e=navigator.userAgent.toLowerCase(),t=e.includes("iphone")||e.includes("ipad"),r=e.includes("safari");return t&&r}},74659:function(e,t,r){"use strict";r.d(t,{$w:function(){return a},IW:function(){return p},Nx:function(){return u},OZ:function(){return s},PY:function(){return f},UG:function(){return l},W8:function(){return n},at:function(){return c},bD:function(){return m},cO:function(){return h},fk:function(){return g},hd:function(){return y},lj:function(){return i},oS:function(){return d},p6:function(){return o}});class i extends Error{constructor(e,t){super(e),this.error=t}}class s extends i{constructor(){super(...arguments),this.name="WalletNotReadyError"}}class n extends i{constructor(){super(...arguments),this.name="WalletLoadError"}}class o extends i{constructor(){super(...arguments),this.name="WalletConfigError"}}class a extends i{constructor(){super(...arguments),this.name="WalletConnectionError"}}class c extends i{constructor(){super(...arguments),this.name="WalletDisconnectedError"}}class l extends i{constructor(){super(...arguments),this.name="WalletDisconnectionError"}}class h extends i{constructor(){super(...arguments),this.name="WalletAccountError"}}class u extends i{constructor(){super(...arguments),this.name="WalletPublicKeyError"}}class d extends i{constructor(){super(...arguments),this.name="WalletNotConnectedError"}}class p extends i{constructor(){super(...arguments),this.name="WalletSendTransactionError"}}class f extends i{constructor(){super(...arguments),this.name="WalletSignTransactionError"}}class g extends i{constructor(){super(...arguments),this.name="WalletSignMessageError"}}class m extends i{constructor(){super(...arguments),this.name="WalletSignInError"}}class y extends i{constructor(){super(...arguments),this.name="WalletWindowClosedError"}}},95462:function(e,t,r){"use strict";r.d(t,{eC:function(){return a},qz:function(){return c},sz:function(){return o}});var i=r(59805),s=r(74659),n=r(43887);class o extends i.mI{async sendTransaction(e,t,r={}){let i=!0;try{if((0,n.W)(e)){if(!this.supportedTransactionVersions)throw new s.IW("Sending versioned transactions isn't supported by this wallet");if(!this.supportedTransactionVersions.has(e.version))throw new s.IW(`Sending transaction version ${e.version} isn't supported by this wallet`);try{let i=(e=await this.signTransaction(e)).serialize();return await t.sendRawTransaction(i,r)}catch(e){if(e instanceof s.PY)throw i=!1,e;throw new s.IW(e?.message,e)}}else try{let{signers:i,...s}=r;e=await this.prepareTransaction(e,t,s),i?.length&&e.partialSign(...i);let n=(e=await this.signTransaction(e)).serialize();return await t.sendRawTransaction(n,s)}catch(e){if(e instanceof s.PY)throw i=!1,e;throw new s.IW(e?.message,e)}}catch(e){throw i&&this.emit("error",e),e}}async signAllTransactions(e){for(let t of e)if((0,n.W)(t)){if(!this.supportedTransactionVersions)throw new s.PY("Signing versioned transactions isn't supported by this wallet");if(!this.supportedTransactionVersions.has(t.version))throw new s.PY(`Signing transaction version ${t.version} isn't supported by this wallet`)}let t=[];for(let r of e)t.push(await this.signTransaction(r));return t}}class a extends o{}class c extends a{}},43887:function(e,t,r){"use strict";function i(e){return"version"in e}r.d(t,{W:function(){return i}})},86454:function(e,t,r){"use strict";var i,s;r.d(t,{Q:function(){return i}}),(s=i||(i={})).Mainnet="mainnet-beta",s.Testnet="testnet",s.Devnet="devnet"},4298:function(e,t,r){"use strict";r.d(t,{O:function(){return c}});var i=r(95462),s=r(59805),n=r(74659),o=r(43887),a=r(64024);class c extends i.eC{constructor(e={}){super(),this.name="Phantom",this.url="https://phantom.app",this.icon="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMDgiIGhlaWdodD0iMTA4IiB2aWV3Qm94PSIwIDAgMTA4IDEwOCIgZmlsbD0ibm9uZSI+CjxyZWN0IHdpZHRoPSIxMDgiIGhlaWdodD0iMTA4IiByeD0iMjYiIGZpbGw9IiNBQjlGRjIiLz4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00Ni41MjY3IDY5LjkyMjlDNDIuMDA1NCA3Ni44NTA5IDM0LjQyOTIgODUuNjE4MiAyNC4zNDggODUuNjE4MkMxOS41ODI0IDg1LjYxODIgMTUgODMuNjU2MyAxNSA3NS4xMzQyQzE1IDUzLjQzMDUgNDQuNjMyNiAxOS44MzI3IDcyLjEyNjggMTkuODMyN0M4Ny43NjggMTkuODMyNyA5NCAzMC42ODQ2IDk0IDQzLjAwNzlDOTQgNTguODI1OCA4My43MzU1IDc2LjkxMjIgNzMuNTMyMSA3Ni45MTIyQzcwLjI5MzkgNzYuOTEyMiA2OC43MDUzIDc1LjEzNDIgNjguNzA1MyA3Mi4zMTRDNjguNzA1MyA3MS41NzgzIDY4LjgyNzUgNzAuNzgxMiA2OS4wNzE5IDY5LjkyMjlDNjUuNTg5MyA3NS44Njk5IDU4Ljg2ODUgODEuMzg3OCA1Mi41NzU0IDgxLjM4NzhDNDcuOTkzIDgxLjM4NzggNDUuNjcxMyA3OC41MDYzIDQ1LjY3MTMgNzQuNDU5OEM0NS42NzEzIDcyLjk4ODQgNDUuOTc2OCA3MS40NTU2IDQ2LjUyNjcgNjkuOTIyOVpNODMuNjc2MSA0Mi41Nzk0QzgzLjY3NjEgNDYuMTcwNCA4MS41NTc1IDQ3Ljk2NTggNzkuMTg3NSA0Ny45NjU4Qzc2Ljc4MTYgNDcuOTY1OCA3NC42OTg5IDQ2LjE3MDQgNzQuNjk4OSA0Mi41Nzk0Qzc0LjY5ODkgMzguOTg4NSA3Ni43ODE2IDM3LjE5MzEgNzkuMTg3NSAzNy4xOTMxQzgxLjU1NzUgMzcuMTkzMSA4My42NzYxIDM4Ljk4ODUgODMuNjc2MSA0Mi41Nzk0Wk03MC4yMTAzIDQyLjU3OTVDNzAuMjEwMyA0Ni4xNzA0IDY4LjA5MTYgNDcuOTY1OCA2NS43MjE2IDQ3Ljk2NThDNjMuMzE1NyA0Ny45NjU4IDYxLjIzMyA0Ni4xNzA0IDYxLjIzMyA0Mi41Nzk1QzYxLjIzMyAzOC45ODg1IDYzLjMxNTcgMzcuMTkzMSA2NS43MjE2IDM3LjE5MzFDNjguMDkxNiAzNy4xOTMxIDcwLjIxMDMgMzguOTg4NSA3MC4yMTAzIDQyLjU3OTVaIiBmaWxsPSIjRkZGREY4Ii8+Cjwvc3ZnPg==",this.supportedTransactionVersions=new Set(["legacy",0]),this._readyState="undefined"==typeof window||"undefined"==typeof document?s.i1.Unsupported:s.i1.NotDetected,this._disconnected=()=>{let e=this._wallet;e&&(e.off("disconnect",this._disconnected),e.off("accountChanged",this._accountChanged),this._wallet=null,this._publicKey=null,this.emit("error",new n.at),this.emit("disconnect"))},this._accountChanged=e=>{let t=this._publicKey;if(t){try{e=new a.nh(e.toBytes())}catch(e){this.emit("error",new n.Nx(e?.message,e));return}t.equals(e)||(this._publicKey=e,this.emit("connect",e))}},this._connecting=!1,this._wallet=null,this._publicKey=null,this._readyState!==s.i1.Unsupported&&((0,s.H)()?(this._readyState=s.i1.Loadable,this.emit("readyStateChange",this._readyState)):(0,s.su)(()=>!!(window.phantom?.solana?.isPhantom||window.solana?.isPhantom)&&(this._readyState=s.i1.Installed,this.emit("readyStateChange",this._readyState),!0)))}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async autoConnect(){this.readyState===s.i1.Installed&&await this.connect()}async connect(){try{let e;if(this.connected||this.connecting)return;if(this.readyState===s.i1.Loadable){let e=encodeURIComponent(window.location.href),t=encodeURIComponent(window.location.origin);window.location.href=`https://phantom.app/ul/browse/${e}?ref=${t}`;return}if(this.readyState!==s.i1.Installed)throw new n.OZ;this._connecting=!0;let t=window.phantom?.solana||window.solana;if(!t.isConnected)try{await t.connect()}catch(e){throw new n.$w(e?.message,e)}if(!t.publicKey)throw new n.cO;try{e=new a.nh(t.publicKey.toBytes())}catch(e){throw new n.Nx(e?.message,e)}t.on("disconnect",this._disconnected),t.on("accountChanged",this._accountChanged),this._wallet=t,this._publicKey=e,this.emit("connect",e)}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}async disconnect(){let e=this._wallet;if(e){e.off("disconnect",this._disconnected),e.off("accountChanged",this._accountChanged),this._wallet=null,this._publicKey=null;try{await e.disconnect()}catch(e){this.emit("error",new n.UG(e?.message,e))}}this.emit("disconnect")}async sendTransaction(e,t,r={}){try{let i=this._wallet;if(!i)throw new n.oS;try{let{signers:s,...n}=r;(0,o.W)(e)?s?.length&&e.sign(s):(e=await this.prepareTransaction(e,t,n),s?.length&&e.partialSign(...s)),n.preflightCommitment=n.preflightCommitment||t.commitment;let{signature:a}=await i.signAndSendTransaction(e,n);return a}catch(e){if(e instanceof n.lj)throw e;throw new n.IW(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signTransaction(e){try{let t=this._wallet;if(!t)throw new n.oS;try{return await t.signTransaction(e)||e}catch(e){throw new n.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAllTransactions(e){try{let t=this._wallet;if(!t)throw new n.oS;try{return await t.signAllTransactions(e)||e}catch(e){throw new n.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signMessage(e){try{let t=this._wallet;if(!t)throw new n.oS;try{let{signature:r}=await t.signMessage(e);return r}catch(e){throw new n.fk(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}},12948:function(e,t,r){"use strict";r.d(t,{s:function(){return f}});var i=r(2265),s=r(72941),n=r(59805),o=r(15408),a=r(54887);let c=({id:e,children:t,expanded:r=!1})=>{let s=(0,i.useRef)(null),n=(0,i.useRef)(!0),o=()=>{let e=s.current;e&&requestAnimationFrame(()=>{e.style.height=e.scrollHeight+"px"})},a=()=>{let e=s.current;e&&requestAnimationFrame(()=>{e.style.height=e.offsetHeight+"px",e.style.overflow="hidden",requestAnimationFrame(()=>{e.style.height="0"})})};return(0,i.useLayoutEffect)(()=>{r?o():a()},[r]),(0,i.useLayoutEffect)(()=>{let e=s.current;if(e)return n.current&&(t(),n.current=!1),e.addEventListener("transitionend",i),()=>e.removeEventListener("transitionend",i);function t(){e&&(e.style.overflow=r?"initial":"hidden",r&&(e.style.height="auto"))}function i(r){e&&r.target===e&&"height"===r.propertyName&&t()}},[r]),i.createElement("div",{className:"wallet-adapter-collapse",id:e,ref:s,role:"region",style:{height:0,transition:n.current?void 0:"height 250ms ease-out"}},t)};var l=r(76625),h=r(90724);let u=({handleClick:e,tabIndex:t,wallet:r})=>i.createElement("li",null,i.createElement(l.z,{onClick:e,startIcon:i.createElement(h.o,{wallet:r}),tabIndex:t},r.adapter.name,r.readyState===n.i1.Installed&&i.createElement("span",null,"Detected"))),d=()=>i.createElement("svg",{width:"97",height:"96",viewBox:"0 0 97 96",fill:"none",xmlns:"http://www.w3.org/2000/svg"},i.createElement("circle",{cx:"48.5",cy:"48",r:"48",fill:"url(#paint0_linear_880_5115)",fillOpacity:"0.1"}),i.createElement("circle",{cx:"48.5",cy:"48",r:"47",stroke:"url(#paint1_linear_880_5115)",strokeOpacity:"0.4",strokeWidth:"2"}),i.createElement("g",{clipPath:"url(#clip0_880_5115)"},i.createElement("path",{d:"M65.5769 28.1523H31.4231C27.6057 28.1523 24.5 31.258 24.5 35.0754V60.9215C24.5 64.7389 27.6057 67.8446 31.4231 67.8446H65.5769C69.3943 67.8446 72.5 64.7389 72.5 60.9215V35.0754C72.5 31.258 69.3943 28.1523 65.5769 28.1523ZM69.7308 52.1523H59.5769C57.2865 52.1523 55.4231 50.289 55.4231 47.9985C55.4231 45.708 57.2864 43.8446 59.5769 43.8446H69.7308V52.1523ZM69.7308 41.0754H59.5769C55.7595 41.0754 52.6539 44.1811 52.6539 47.9985C52.6539 51.8159 55.7595 54.9215 59.5769 54.9215H69.7308V60.9215C69.7308 63.2119 67.8674 65.0754 65.5769 65.0754H31.4231C29.1327 65.0754 27.2692 63.212 27.2692 60.9215V35.0754C27.2692 32.785 29.1326 30.9215 31.4231 30.9215H65.5769C67.8673 30.9215 69.7308 32.7849 69.7308 35.0754V41.0754Z",fill:"url(#paint2_linear_880_5115)"}),i.createElement("path",{d:"M61.4231 46.6172H59.577C58.8123 46.6172 58.1924 47.2371 58.1924 48.0018C58.1924 48.7665 58.8123 49.3863 59.577 49.3863H61.4231C62.1878 49.3863 62.8077 48.7664 62.8077 48.0018C62.8077 47.2371 62.1878 46.6172 61.4231 46.6172Z",fill:"url(#paint3_linear_880_5115)"})),i.createElement("defs",null,i.createElement("linearGradient",{id:"paint0_linear_880_5115",x1:"3.41664",y1:"98.0933",x2:"103.05",y2:"8.42498",gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#9945FF"}),i.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),i.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),i.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),i.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),i.createElement("stop",{offset:"1",stopColor:"#00D18C"})),i.createElement("linearGradient",{id:"paint1_linear_880_5115",x1:"3.41664",y1:"98.0933",x2:"103.05",y2:"8.42498",gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#9945FF"}),i.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),i.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),i.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),i.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),i.createElement("stop",{offset:"1",stopColor:"#00D18C"})),i.createElement("linearGradient",{id:"paint2_linear_880_5115",x1:"25.9583",y1:"68.7101",x2:"67.2337",y2:"23.7879",gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#9945FF"}),i.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),i.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),i.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),i.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),i.createElement("stop",{offset:"1",stopColor:"#00D18C"})),i.createElement("linearGradient",{id:"paint3_linear_880_5115",x1:"58.3326",y1:"49.4467",x2:"61.0002",y2:"45.4453",gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#9945FF"}),i.createElement("stop",{offset:"0.14",stopColor:"#8A53F4"}),i.createElement("stop",{offset:"0.42",stopColor:"#6377D6"}),i.createElement("stop",{offset:"0.79",stopColor:"#24B0A7"}),i.createElement("stop",{offset:"0.99",stopColor:"#00D18C"}),i.createElement("stop",{offset:"1",stopColor:"#00D18C"})),i.createElement("clipPath",{id:"clip0_880_5115"},i.createElement("rect",{width:"48",height:"48",fill:"white",transform:"translate(24.5 24)"})))),p=({className:e="",container:t="body"})=>{let r=(0,i.useRef)(null),{wallets:l,select:h}=(0,o.O)(),{setVisible:p}=(0,s.h)(),[f,g]=(0,i.useState)(!1),[m,y]=(0,i.useState)(!1),[b,w]=(0,i.useState)(null),[v,E]=(0,i.useMemo)(()=>{let e=[],t=[];for(let r of l)r.readyState===n.i1.Installed?e.push(r):t.push(r);return e.length?[e,t]:[t,[]]},[l]),I=(0,i.useCallback)(()=>{y(!1),setTimeout(()=>p(!1),150)},[p]),_=(0,i.useCallback)(e=>{e.preventDefault(),I()},[I]),C=(0,i.useCallback)((e,t)=>{h(t),_(e)},[h,_]),S=(0,i.useCallback)(()=>g(!f),[f]),N=(0,i.useCallback)(e=>{let t=r.current;if(!t)return;let i=t.querySelectorAll("button"),s=i[0],n=i[i.length-1];e.shiftKey?document.activeElement===s&&(n.focus(),e.preventDefault()):document.activeElement===n&&(s.focus(),e.preventDefault())},[r]);return(0,i.useLayoutEffect)(()=>{let e=e=>{"Escape"===e.key?I():"Tab"===e.key&&N(e)},{overflow:t}=window.getComputedStyle(document.body);return setTimeout(()=>y(!0),0),document.body.style.overflow="hidden",window.addEventListener("keydown",e,!1),()=>{document.body.style.overflow=t,window.removeEventListener("keydown",e,!1)}},[I,N]),(0,i.useLayoutEffect)(()=>w(document.querySelector(t)),[t]),b&&(0,a.createPortal)(i.createElement("div",{"aria-labelledby":"wallet-adapter-modal-title","aria-modal":"true",className:`wallet-adapter-modal ${m&&"wallet-adapter-modal-fade-in"} ${e}`,ref:r,role:"dialog"},i.createElement("div",{className:"wallet-adapter-modal-container"},i.createElement("div",{className:"wallet-adapter-modal-wrapper"},i.createElement("button",{onClick:_,className:"wallet-adapter-modal-button-close"},i.createElement("svg",{width:"14",height:"14"},i.createElement("path",{d:"M14 12.461 8.3 6.772l5.234-5.233L12.006 0 6.772 5.234 1.54 0 0 1.539l5.234 5.233L0 12.006l1.539 1.528L6.772 8.3l5.69 5.7L14 12.461z"}))),v.length?i.createElement(i.Fragment,null,i.createElement("h1",{className:"wallet-adapter-modal-title"},"Connect a wallet on Solana to continue"),i.createElement("ul",{className:"wallet-adapter-modal-list"},v.map(e=>i.createElement(u,{key:e.adapter.name,handleClick:t=>C(t,e.adapter.name),wallet:e})),E.length?i.createElement(c,{expanded:f,id:"wallet-adapter-modal-collapse"},E.map(e=>i.createElement(u,{key:e.adapter.name,handleClick:t=>C(t,e.adapter.name),tabIndex:f?0:-1,wallet:e}))):null),E.length?i.createElement("button",{className:"wallet-adapter-modal-list-more",onClick:S,tabIndex:0},i.createElement("span",null,f?"Less ":"More ","options"),i.createElement("svg",{width:"13",height:"7",viewBox:"0 0 13 7",xmlns:"http://www.w3.org/2000/svg",className:`${f?"wallet-adapter-modal-list-more-icon-rotate":""}`},i.createElement("path",{d:"M0.71418 1.626L5.83323 6.26188C5.91574 6.33657 6.0181 6.39652 6.13327 6.43762C6.24844 6.47872 6.37371 6.5 6.50048 6.5C6.62725 6.5 6.75252 6.47872 6.8677 6.43762C6.98287 6.39652 7.08523 6.33657 7.16774 6.26188L12.2868 1.626C12.7753 1.1835 12.3703 0.5 11.6195 0.5H1.37997C0.629216 0.5 0.224175 1.1835 0.71418 1.626Z"}))):null):i.createElement(i.Fragment,null,i.createElement("h1",{className:"wallet-adapter-modal-title"},"You'll need a wallet on Solana to continue"),i.createElement("div",{className:"wallet-adapter-modal-middle"},i.createElement(d,null)),E.length?i.createElement(i.Fragment,null,i.createElement("button",{className:"wallet-adapter-modal-list-more",onClick:S,tabIndex:0},i.createElement("span",null,f?"Hide ":"Already have a wallet? View ","options"),i.createElement("svg",{width:"13",height:"7",viewBox:"0 0 13 7",xmlns:"http://www.w3.org/2000/svg",className:`${f?"wallet-adapter-modal-list-more-icon-rotate":""}`},i.createElement("path",{d:"M0.71418 1.626L5.83323 6.26188C5.91574 6.33657 6.0181 6.39652 6.13327 6.43762C6.24844 6.47872 6.37371 6.5 6.50048 6.5C6.62725 6.5 6.75252 6.47872 6.8677 6.43762C6.98287 6.39652 7.08523 6.33657 7.16774 6.26188L12.2868 1.626C12.7753 1.1835 12.3703 0.5 11.6195 0.5H1.37997C0.629216 0.5 0.224175 1.1835 0.71418 1.626Z"}))),i.createElement(c,{expanded:f,id:"wallet-adapter-modal-collapse"},i.createElement("ul",{className:"wallet-adapter-modal-list"},E.map(e=>i.createElement(u,{key:e.adapter.name,handleClick:t=>C(t,e.adapter.name),tabIndex:f?0:-1,wallet:e}))))):null))),i.createElement("div",{className:"wallet-adapter-modal-overlay",onMouseDown:_})),b)},f=({children:e,...t})=>{let[r,n]=(0,i.useState)(!1);return i.createElement(s.g.Provider,{value:{visible:r,setVisible:n}},e,r&&i.createElement(p,{...t}))}},54968:function(e,t,r){"use strict";r.d(t,{U:function(){return o}});var i=r(64024),s=r(2265),n=r(13816);let o=({children:e,endpoint:t,config:r={commitment:"confirmed"}})=>{let o=(0,s.useMemo)(()=>new i.ew(t,r),[t,r]);return s.createElement(n.h.Provider,{value:{connection:o}},e)}},92417:function(e,t,r){"use strict";let i,s,n,o;r.d(t,{n:function(){return tK}});var a,c,l,h,u,d,p,f,g,m,y,b,w,v,E,I,_,C,S,N,A,O,M,P,x,T,D,R,k,j,L,U,z,$,q,B,W,H,F,V,K,J,Y,G,Q,Z,X,ee,et,er,ei,es,en,eo,ea,ec,el,eh,eu,ed,ep,ef,eg,em,ey,eb,ew,ev,eE,eI,e_,eC,eS,eN,eA,eO,eM=r(95462),eP=r(59805),ex=r(74659),eT=r(64024);let eD="solana:signIn";var eR=r(34402),ek=r(77684),ej=r(10282);r(35819);let eL=`(?:\\nURI: (?<uri>[^\\n]+))?(?:\\nVersion: (?<version>[^\\n]+))?(?:\\nChain ID: (?<chainId>[^\\n]+))?(?:\\nNonce: (?<nonce>[^\\n]+))?(?:\\nIssued At: (?<issuedAt>[^\\n]+))?(?:\\nExpiration Time: (?<expirationTime>[^\\n]+))?(?:\\nNot Before: (?<notBefore>[^\\n]+))?(?:\\nRequest ID: (?<requestId>[^\\n]+))?(?:\\nResources:(?<resources>(?:\\n- [^\\n]+)*))?`;RegExp(`^(?<domain>[^\\n]+?) wants you to sign in with your Solana account:\\n(?<address>[^\\n]+)(?:\\n|$)(?:\\n(?<statement>[\\S\\s]*?)(?:\\n|$))??${eL}\\n*$`);var eU=e=>{var t;return Object.freeze({...t={read(t,r){let i=0===r?t:t.slice(r);if(0===i.length)return["",0];let s=i.findIndex(e=>0!==e);s=-1===s?i.length:s;let n=e[0].repeat(s);return s===i.length?[n,t.length]:[n+function(e,t){let r=BigInt(t.length),i=[];for(;e>0n;)i.unshift(t[Number(e%r)]),e/=r;return i.join("")}(i.slice(s).reduce((e,t)=>256n*e+BigInt(t),0n),e),t.length]}},decode:(e,r=0)=>t.read(e,r)[0]})},ez=()=>eU("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");let e$={ERROR_ASSOCIATION_PORT_OUT_OF_RANGE:"ERROR_ASSOCIATION_PORT_OUT_OF_RANGE",ERROR_FORBIDDEN_WALLET_BASE_URL:"ERROR_FORBIDDEN_WALLET_BASE_URL",ERROR_SECURE_CONTEXT_REQUIRED:"ERROR_SECURE_CONTEXT_REQUIRED",ERROR_SESSION_CLOSED:"ERROR_SESSION_CLOSED",ERROR_SESSION_TIMEOUT:"ERROR_SESSION_TIMEOUT",ERROR_WALLET_NOT_FOUND:"ERROR_WALLET_NOT_FOUND",ERROR_INVALID_PROTOCOL_VERSION:"ERROR_INVALID_PROTOCOL_VERSION"};class eq extends Error{constructor(...e){let[t,r,i]=e;super(r),this.code=t,this.data=i,this.name="SolanaMobileWalletAdapterError"}}class eB extends Error{constructor(...e){let[t,r,i,s]=e;super(i),this.code=r,this.data=s,this.jsonRpcMessageId=t,this.name="SolanaMobileWalletAdapterProtocolError"}}function eW(e,t,r,i){return new(r||(r=Promise))(function(s,n){function o(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function eH(e,t){let r=window.btoa(String.fromCharCode.call(null,...e));return t?r.replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,""):r}function eF(e){return new Uint8Array(window.atob(e).split("").map(e=>e.charCodeAt(0)))}function eV(e,t){return eW(this,void 0,void 0,function*(){let r=yield crypto.subtle.exportKey("raw",e),i=yield crypto.subtle.sign({hash:"SHA-256",name:"ECDSA"},t,r),s=new Uint8Array(r.byteLength+i.byteLength);return s.set(new Uint8Array(r),0),s.set(new Uint8Array(i),r.byteLength),s})}let eK="solana:cloneAuthorization";function eJ(e,t){return eW(this,void 0,void 0,function*(){let r=e.slice(0,4),s=e.slice(4,16),n=e.slice(16),o=yield crypto.subtle.decrypt(eY(r,s),t,n);return(void 0===i&&(i=new TextDecoder("utf-8")),i).decode(o)})}function eY(e,t){return{additionalData:e,iv:t,name:"AES-GCM",tagLength:128}}function eG(){return eW(this,void 0,void 0,function*(){return yield crypto.subtle.generateKey({name:"ECDH",namedCurve:"P-256"},!1,["deriveKey","deriveBits"])})}function eQ(e){if(e<49152||e>65535)throw new eq(e$.ERROR_ASSOCIATION_PORT_OUT_OF_RANGE,`Association port number must be between 49152 and 65535. ${e} given.`,{port:e});return e}function eZ(e){return e.replace(/(^\/+|\/+$)/g,"").split("/")}let eX={Firefox:0,Other:1},e0=null,e1=[150,150,200,500,500,750,750,1e3];function e2(e){return new DataView(e).getUint32(0,!1)}var e3=r(59186),e5=r(3005),e4=r(83747),e8=r(59147),e6=r(88746);function e9(e,t,r,i){return new(r||(r=Promise))(function(s,n){function o(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function e7(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function te(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r}let tt=`
<div class="mobile-wallet-adapter-embedded-modal-container" role="dialog" aria-modal="true" aria-labelledby="modal-title">
    <div data-modal-close style="position: absolute; width: 100%; height: 100%;"></div>
	<div class="mobile-wallet-adapter-embedded-modal-card">
		<div>
			<button data-modal-close class="mobile-wallet-adapter-embedded-modal-close">
				<svg width="14" height="14">
					<path d="M 6.7125,8.3036995 1.9082,13.108199 c -0.2113,0.2112 -0.4765,0.3168 -0.7957,0.3168 -0.3192,0 -0.5844,-0.1056 -0.7958,-0.3168 C 0.1056,12.896899 0,12.631699 0,12.312499 c 0,-0.3192 0.1056,-0.5844 0.3167,-0.7958 L 5.1212,6.7124995 0.3167,1.9082 C 0.1056,1.6969 0,1.4317 0,1.1125 0,0.7933 0.1056,0.5281 0.3167,0.3167 0.5281,0.1056 0.7933,0 1.1125,0 1.4317,0 1.6969,0.1056 1.9082,0.3167 L 6.7125,5.1212 11.5167,0.3167 C 11.7281,0.1056 11.9933,0 12.3125,0 c 0.3192,0 0.5844,0.1056 0.7957,0.3167 0.2112,0.2114 0.3168,0.4766 0.3168,0.7958 0,0.3192 -0.1056,0.5844 -0.3168,0.7957 L 8.3037001,6.7124995 13.1082,11.516699 c 0.2112,0.2114 0.3168,0.4766 0.3168,0.7958 0,0.3192 -0.1056,0.5844 -0.3168,0.7957 -0.2113,0.2112 -0.4765,0.3168 -0.7957,0.3168 -0.3192,0 -0.5844,-0.1056 -0.7958,-0.3168 z" />
				</svg>
			</button>
		</div>
		<div class="mobile-wallet-adapter-embedded-modal-content"></div>
	</div>
</div>
`,tr=`
.mobile-wallet-adapter-embedded-modal-container {
    display: flex; /* Use flexbox to center content */
    justify-content: center; /* Center horizontally */
    align-items: center; /* Center vertically */
    position: fixed; /* Stay in place */
    z-index: 1; /* Sit on top */
    left: 0;
    top: 0;
    width: 100%; /* Full width */
    height: 100%; /* Full height */
    background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
    overflow-y: auto; /* enable scrolling */
}

.mobile-wallet-adapter-embedded-modal-card {
    display: flex;
    flex-direction: column;
    margin: auto 20px;
    max-width: 780px;
    padding: 20px;
    border-radius: 24px;
    background: #ffffff;
    font-family: "Inter Tight", "PT Sans", Calibri, sans-serif;
    transform: translateY(-200%);
    animation: slide-in 0.5s forwards;
}

@keyframes slide-in {
    100% { transform: translateY(0%); }
}

.mobile-wallet-adapter-embedded-modal-close {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 32px;
    height: 32px;
    cursor: pointer;
    background: #e4e9e9;
    border: none;
    border-radius: 50%;
}

.mobile-wallet-adapter-embedded-modal-close:focus-visible {
    outline-color: red;
}

.mobile-wallet-adapter-embedded-modal-close svg {
    fill: #546266;
    transition: fill 200ms ease 0s;
}

.mobile-wallet-adapter-embedded-modal-close:hover svg {
    fill: #fff;
}
`,ti=`
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter+Tight:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
`;class ts{constructor(){c.add(this),l.set(this,null),h.set(this,{}),u.set(this,!1),this.dom=null,this.open=()=>{console.debug("Modal open"),e7(this,c,"m",p).call(this),e7(this,l,"f")&&(e7(this,l,"f").style.display="flex")},this.close=e=>{var t;console.debug("Modal close"),e7(this,c,"m",f).call(this),e7(this,l,"f")&&(e7(this,l,"f").style.display="none"),null===(t=e7(this,h,"f").close)||void 0===t||t.forEach(t=>t(e))},g.set(this,e=>{"Escape"===e.key&&this.close(e)}),this.init=this.init.bind(this),te(this,l,document.getElementById("mobile-wallet-adapter-embedded-root-ui"),"f")}init(){return e9(this,void 0,void 0,function*(){console.log("Injecting modal"),e7(this,c,"m",d).call(this)})}addEventListener(e,t){var r;return(null===(r=e7(this,h,"f")[e])||void 0===r?void 0:r.push(t))||(e7(this,h,"f")[e]=[t]),()=>this.removeEventListener(e,t)}removeEventListener(e,t){var r;e7(this,h,"f")[e]=null===(r=e7(this,h,"f")[e])||void 0===r?void 0:r.filter(e=>t!==e)}}function tn(e){return window.btoa(String.fromCharCode.call(null,...e))}function to(e){return new Uint8Array(window.atob(e).split("").map(e=>e.charCodeAt(0)))}l=new WeakMap,h=new WeakMap,u=new WeakMap,g=new WeakMap,c=new WeakSet,d=function(){if(document.getElementById("mobile-wallet-adapter-embedded-root-ui")){e7(this,l,"f")||te(this,l,document.getElementById("mobile-wallet-adapter-embedded-root-ui"),"f");return}te(this,l,document.createElement("div"),"f"),e7(this,l,"f").id="mobile-wallet-adapter-embedded-root-ui",e7(this,l,"f").innerHTML=tt,e7(this,l,"f").style.display="none";let e=e7(this,l,"f").querySelector(".mobile-wallet-adapter-embedded-modal-content");e&&(e.innerHTML=this.contentHtml);let t=document.createElement("style");t.id="mobile-wallet-adapter-embedded-modal-styles",t.textContent=tr+this.contentStyles;let r=document.createElement("div");r.innerHTML=ti,this.dom=r.attachShadow({mode:"closed"}),this.dom.appendChild(t),this.dom.appendChild(e7(this,l,"f")),document.body.appendChild(r)},p=function(){!e7(this,l,"f")||e7(this,u,"f")||([...e7(this,l,"f").querySelectorAll("[data-modal-close]")].forEach(e=>null==e?void 0:e.addEventListener("click",this.close)),window.addEventListener("load",this.close),document.addEventListener("keydown",e7(this,g,"f")),te(this,u,!0,"f"))},f=function(){e7(this,u,"f")&&(window.removeEventListener("load",this.close),document.removeEventListener("keydown",e7(this,g,"f")),e7(this,l,"f")&&([...e7(this,l,"f").querySelectorAll("[data-modal-close]")].forEach(e=>null==e?void 0:e.removeEventListener("click",this.close)),te(this,u,!1,"f")))};let ta="Mobile Wallet Adapter",tc=[ek.G,ej.R,eR.g,eD];class tl{constructor(e){m.add(this),y.set(this,{}),b.set(this,"1.0.0"),w.set(this,ta),v.set(this,"https://solanamobile.com/wallets"),E.set(this,"data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik03IDIuNUgxN0MxNy44Mjg0IDIuNSAxOC41IDMuMTcxNTcgMTguNSA0VjIwQzE4LjUgMjAuODI4NCAxNy44Mjg0IDIxLjUgMTcgMjEuNUg3QzYuMTcxNTcgMjEuNSA1LjUgMjAuODI4NCA1LjUgMjBWNEM1LjUgMy4xNzE1NyA2LjE3MTU3IDIuNSA3IDIuNVpNMyA0QzMgMS43OTA4NiA0Ljc5MDg2IDAgNyAwSDE3QzE5LjIwOTEgMCAyMSAxLjc5MDg2IDIxIDRWMjBDMjEgMjIuMjA5MSAxOS4yMDkxIDI0IDE3IDI0SDdDNC43OTA4NiAyNCAzIDIyLjIwOTEgMyAyMFY0Wk0xMSA0LjYxNTM4QzEwLjQ0NzcgNC42MTUzOCAxMCA1LjA2MzEgMTAgNS42MTUzOFY2LjM4NDYyQzEwIDYuOTM2OSAxMC40NDc3IDcuMzg0NjIgMTEgNy4zODQ2MkgxM0MxMy41NTIzIDcuMzg0NjIgMTQgNi45MzY5IDE0IDYuMzg0NjJWNS42MTUzOEMxNCA1LjA2MzEgMTMuNTUyMyA0LjYxNTM4IDEzIDQuNjE1MzhIMTFaIiBmaWxsPSIjRENCOEZGIi8+Cjwvc3ZnPgo="),I.set(this,void 0),_.set(this,void 0),C.set(this,void 0),S.set(this,!1),N.set(this,0),A.set(this,[]),O.set(this,void 0),M.set(this,void 0),P.set(this,void 0),x.set(this,(e,t)=>{var r;return(null===(r=e7(this,y,"f")[e])||void 0===r?void 0:r.push(t))||(e7(this,y,"f")[e]=[t]),()=>e7(this,m,"m",D).call(this,e,t)}),R.set(this,({silent:e}={})=>e9(this,void 0,void 0,function*(){if(e7(this,S,"f")||this.connected)return{accounts:this.accounts};te(this,S,!0,"f");try{if(e){let e=yield e7(this,C,"f").get();if(!e)return{accounts:this.accounts};yield e7(this,L,"f").call(this,e.capabilities),yield e7(this,j,"f").call(this,e)}else yield e7(this,k,"f").call(this)}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}finally{te(this,S,!1,"f")}return{accounts:this.accounts}})),k.set(this,e=>e9(this,void 0,void 0,function*(){try{let t=yield e7(this,C,"f").get();if(t)return e7(this,j,"f").call(this,t),t;let r=yield e7(this,O,"f").select(e7(this,A,"f"));return yield e7(this,$,"f").call(this,t=>e9(this,void 0,void 0,function*(){let[i,s]=yield Promise.all([t.getCapabilities(),t.authorize({chain:r,identity:e7(this,I,"f"),sign_in_payload:e})]),n=e7(this,B,"f").call(this,s.accounts),o=Object.assign(Object.assign({},s),{accounts:n,chain:r,capabilities:i});return Promise.all([e7(this,L,"f").call(this,i),e7(this,C,"f").set(o),e7(this,j,"f").call(this,o)]),o}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),j.set(this,e=>e9(this,void 0,void 0,function*(){var t;let r=null==e7(this,_,"f")||(null===(t=e7(this,_,"f"))||void 0===t?void 0:t.accounts.length)!==e.accounts.length||e7(this,_,"f").accounts.some((t,r)=>t.address!==e.accounts[r].address);te(this,_,e,"f"),r&&e7(this,m,"m",T).call(this,"change",{accounts:this.accounts})})),L.set(this,e=>e9(this,void 0,void 0,function*(){let t=e.features.includes("solana:signTransactions"),r=e.supports_sign_and_send_transactions,i=ek.G in this.features!==r||ej.R in this.features!==t;te(this,M,Object.assign(Object.assign({},(r||!r&&!t)&&{[ek.G]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:e7(this,F,"f")}}),t&&{[ej.R]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:e7(this,V,"f")}}),"f"),i&&e7(this,m,"m",T).call(this,"change",{features:this.features})})),U.set(this,(e,t,r)=>e9(this,void 0,void 0,function*(){var i,s;try{let[n,o]=yield Promise.all([null!==(s=null===(i=e7(this,_,"f"))||void 0===i?void 0:i.capabilities)&&void 0!==s?s:yield e.getCapabilities(),e.authorize({auth_token:t,identity:e7(this,I,"f"),chain:r})]),a=e7(this,B,"f").call(this,o.accounts),c=Object.assign(Object.assign({},o),{accounts:a,chain:r,capabilities:n});Promise.all([e7(this,C,"f").set(c),e7(this,j,"f").call(this,c)])}catch(e){throw e7(this,z,"f").call(this),Error(e instanceof Error&&e.message||"Unknown error")}})),z.set(this,()=>e9(this,void 0,void 0,function*(){var e;e7(this,C,"f").clear(),te(this,S,!1,"f"),te(this,N,(e=e7(this,N,"f"),++e),"f"),te(this,_,void 0,"f"),e7(this,m,"m",T).call(this,"change",{accounts:this.accounts})})),$.set(this,e=>e9(this,void 0,void 0,function*(){var t;let r=null===(t=e7(this,_,"f"))||void 0===t?void 0:t.wallet_uri_base,i=e7(this,N,"f");try{return yield function(e,t){return eW(this,void 0,void 0,function*(){let r;!function(){if("undefined"==typeof window||!0!==window.isSecureContext)throw new eq(e$.ERROR_SECURE_CONTEXT_REQUIRED,"The mobile wallet adapter protocol must be used in a secure context (`https`).")}();let i=yield function(){return eW(this,void 0,void 0,function*(){return yield crypto.subtle.generateKey({name:"ECDSA",namedCurve:"P-256"},!1,["sign"])})}(),s=yield function(e,t){return eW(this,void 0,void 0,function*(){let r=eQ(49152+Math.floor(16384*Math.random())),i=yield function(e,t,r,i=["v1"]){return eW(this,void 0,void 0,function*(){let s=eQ(t),n=function(e){let t="",r=new Uint8Array(e),i=r.byteLength;for(let e=0;e<i;e++)t+=String.fromCharCode(r[e]);return window.btoa(t)}((yield crypto.subtle.exportKey("raw",e))),o=function(e,t){let r=null;if(t){try{r=new URL(t)}catch(e){}if((null==r?void 0:r.protocol)!=="https:")throw new eq(e$.ERROR_FORBIDDEN_WALLET_BASE_URL,"Base URLs supplied by wallets must be valid `https` URLs")}return r||(r=new URL("solana-wallet:/")),new URL(e.startsWith("/")?e:[...eZ(r.pathname),...eZ(e)].join("/"),r)}("v1/associate/local",r);return o.searchParams.set("association",n.replace(/[/+=]/g,e=>({"/":"_","+":"-","=":"."})[e])),o.searchParams.set("port",`${s}`),i.forEach(e=>{o.searchParams.set("v",e)}),o})}(e,r,t);return yield function(e){return eW(this,void 0,void 0,function*(){if("https:"===e.protocol)window.location.assign(e);else try{switch(-1!==navigator.userAgent.indexOf("Firefox/")?eX.Firefox:eX.Other){case eX.Firefox:null==e0&&((e0=document.createElement("iframe")).style.display="none",document.body.appendChild(e0)),e0.contentWindow.location.href=e.toString();break;case eX.Other:{let t=new Promise((e,t)=>{function r(){clearTimeout(s),window.removeEventListener("blur",i)}function i(){r(),e()}window.addEventListener("blur",i);let s=setTimeout(()=>{r(),t()},3e3)});window.location.assign(e),yield t}}}catch(e){throw new eq(e$.ERROR_WALLET_NOT_FOUND,"Found no installed wallet that supports the mobile wallet protocol.")}})}(i),r})}(i.publicKey,null==t?void 0:t.baseUri),n=`ws://localhost:${s}/solana-wallet`,o=(()=>{let e=[...e1];return()=>e.length>1?e.shift():e[0]})(),a=1,c=0,l={__type:"disconnected"};return new Promise((t,s)=>{let h,u,d;let p={},f=()=>eW(this,void 0,void 0,function*(){if("connecting"!==l.__type){console.warn(`Expected adapter state to be \`connecting\` at the moment the websocket opens. Got \`${l.__type}\`.`);return}h.removeEventListener("open",f);let{associationKeypair:e}=l,t=yield eG();h.send((yield eV(t.publicKey,e.privateKey))),l={__type:"hello_req_sent",associationPublicKey:e.publicKey,ecdhPrivateKey:t.privateKey}}),g=e=>{e.wasClean?l={__type:"disconnected"}:s(new eq(e$.ERROR_SESSION_CLOSED,`The wallet session dropped unexpectedly (${e.code}: ${e.reason}).`,{closeEvent:e})),u()},m=e=>eW(this,void 0,void 0,function*(){u(),Date.now()-r>=3e4?s(new eq(e$.ERROR_SESSION_TIMEOUT,`Failed to connect to the wallet websocket at ${n}.`)):(yield new Promise(e=>{let t=o();d=window.setTimeout(e,t)}),b())}),y=r=>eW(this,void 0,void 0,function*(){let n=yield r.data.arrayBuffer();switch(l.__type){case"connecting":if(0!==n.byteLength)throw Error("Encountered unexpected message while connecting");let o=yield eG();h.send((yield eV(o.publicKey,i.privateKey))),l={__type:"hello_req_sent",associationPublicKey:i.publicKey,ecdhPrivateKey:o.privateKey};break;case"connected":try{let e=n.slice(0,4),t=e2(e);if(t!==c+1)throw Error("Encrypted message has invalid sequence number");c=t;let r=yield function(e,t){return eW(this,void 0,void 0,function*(){let r=JSON.parse((yield eJ(e,t)));if(Object.hasOwnProperty.call(r,"error"))throw new eB(r.id,r.error.code,r.error.message);return r})}(n,l.sharedSecret),i=p[r.id];delete p[r.id],i.resolve(r.result)}catch(e){if(e instanceof eB){let t=p[e.jsonRpcMessageId];delete p[e.jsonRpcMessageId],t.reject(e)}else throw e}break;case"hello_req_sent":{var d,f;if(0===n.byteLength){let e=yield eG();h.send((yield eV(e.publicKey,i.privateKey))),l={__type:"hello_req_sent",associationPublicKey:i.publicKey,ecdhPrivateKey:e.privateKey};break}let r=yield function(e,t,r){return eW(this,void 0,void 0,function*(){let[i,s]=yield Promise.all([crypto.subtle.exportKey("raw",t),crypto.subtle.importKey("raw",e.slice(0,65),{name:"ECDH",namedCurve:"P-256"},!1,[])]),n=yield crypto.subtle.deriveBits({name:"ECDH",public:s},r,256),o=yield crypto.subtle.importKey("raw",n,"HKDF",!1,["deriveKey"]);return yield crypto.subtle.deriveKey({name:"HKDF",hash:"SHA-256",salt:new Uint8Array(i),info:new Uint8Array},o,{name:"AES-GCM",length:128},!1,["encrypt","decrypt"])})}(n,l.associationPublicKey,l.ecdhPrivateKey),o=n.slice(65),g=0!==o.byteLength?yield eW(this,void 0,void 0,function*(){let e=e2(o.slice(0,4));if(e!==c+1)throw Error("Encrypted message has invalid sequence number");return c=e,function(e,t){return eW(this,void 0,void 0,function*(){let r=JSON.parse((yield eJ(e,t))),i="legacy";if(Object.hasOwnProperty.call(r,"v"))switch(r.v){case 1:case"1":case"v1":i="v1";break;case"legacy":i="legacy";break;default:throw new eq(e$.ERROR_INVALID_PROTOCOL_VERSION,`Unknown/unsupported protocol version: ${r.v}`)}return{protocol_version:i}})}(o,r)}):{protocol_version:"legacy"};l={__type:"connected",sharedSecret:r,sessionProperties:g};let m=(d=g.protocol_version,f=(e,t)=>eW(this,void 0,void 0,function*(){let i=a++;return h.send((yield function(e,t){return eW(this,void 0,void 0,function*(){let r=JSON.stringify(e);return function(e,t,r){return eW(this,void 0,void 0,function*(){let i=function(e){if(e>=4294967296)throw Error("Outbound sequence number overflow. The maximum sequence number is 32-bytes.");let t=new ArrayBuffer(4);return new DataView(t).setUint32(0,e,!1),new Uint8Array(t)}(t),s=new Uint8Array(12);crypto.getRandomValues(s);let n=yield crypto.subtle.encrypt(eY(i,s),r,new TextEncoder().encode(e)),o=new Uint8Array(i.byteLength+s.byteLength+n.byteLength);return o.set(new Uint8Array(i),0),o.set(new Uint8Array(s),i.byteLength),o.set(new Uint8Array(n),i.byteLength+s.byteLength),o})}(r,e.id,t)})}({id:i,jsonrpc:"2.0",method:e,params:null!=t?t:{}},r))),new Promise((t,r)=>{p[i]={resolve(i){switch(e){case"authorize":case"reauthorize":{let{wallet_uri_base:e}=i;if(null!=e)try{!function(e){let t;try{t=new URL(e)}catch(e){throw new eq(e$.ERROR_FORBIDDEN_WALLET_BASE_URL,"Invalid base URL supplied by wallet")}if("https:"!==t.protocol)throw new eq(e$.ERROR_FORBIDDEN_WALLET_BASE_URL,"Base URLs supplied by wallets must be valid `https` URLs")}(e)}catch(e){r(e);return}}}t(i)},reject:r}})}),new Proxy({},{get:(e,t)=>"then"===t?null:(null==e[t]&&(e[t]=function(e){return eW(this,void 0,void 0,function*(){let{method:r,params:i}=function(e,t,r){let i=t,s=e.toString().replace(/[A-Z]/g,e=>`_${e.toLowerCase()}`).toLowerCase();switch(e){case"authorize":{let{chain:e}=i;if("legacy"===r){switch(e){case"solana:testnet":e="testnet";break;case"solana:devnet":e="devnet";break;case"solana:mainnet":e="mainnet-beta";break;default:e=i.cluster}i.cluster=e}else{switch(e){case"testnet":case"devnet":e=`solana:${e}`;break;case"mainnet-beta":e="solana:mainnet"}i.chain=e}}case"reauthorize":{let{auth_token:e,identity:t}=i;e&&("legacy"===r?(s="reauthorize",i={auth_token:e,identity:t}):s="authorize")}}return{method:s,params:i}}(t,e,d),s=yield f(r,i);return"authorize"===r&&i.sign_in_payload&&!s.sign_in_result&&(s.sign_in_result=yield function(e,t,r){var i;return eW(this,void 0,void 0,function*(){var s,n,o;let a=null!==(i=e.domain)&&void 0!==i?i:window.location.host,c=t.accounts[0].address,l=(n=Object.assign(Object.assign({},e),{domain:a,address:(s=eF(c),ez().decode(s))}),(o=function(e){let t=`${e.domain} wants you to sign in with your Solana account:
`;t+=`${e.address}`,e.statement&&(t+=`

${e.statement}`);let r=[];if(e.uri&&r.push(`URI: ${e.uri}`),e.version&&r.push(`Version: ${e.version}`),e.chainId&&r.push(`Chain ID: ${e.chainId}`),e.nonce&&r.push(`Nonce: ${e.nonce}`),e.issuedAt&&r.push(`Issued At: ${e.issuedAt}`),e.expirationTime&&r.push(`Expiration Time: ${e.expirationTime}`),e.notBefore&&r.push(`Not Before: ${e.notBefore}`),e.requestId&&r.push(`Request ID: ${e.requestId}`),e.resources)for(let t of(r.push("Resources:"),e.resources))r.push(`- ${t}`);return r.length&&(t+=`

${r.join("\n")}`),t}(n),window.btoa(o)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")),h=eF((yield r("sign_messages",{addresses:[c],payloads:[l]})).signed_payloads[0]),u=eH(h.slice(0,h.length-64)),d=eH(h.slice(h.length-64));return{address:c,signed_message:0==u.length?l:u,signature:d}})}(i.sign_in_payload,s,f)),function(e,t,r){if("getCapabilities"===e)switch(r){case"legacy":{let e=["solana:signTransactions"];return!0===t.supports_clone_authorization&&e.push(eK),Object.assign(Object.assign({},t),{features:e})}case"v1":return Object.assign(Object.assign({},t),{supports_sign_and_send_transactions:!0,supports_clone_authorization:t.features.includes(eK)})}return t}(t,s,d)})}),e[t]),defineProperty:()=>!1,deleteProperty:()=>!1}));try{t((yield e(m)))}catch(e){s(e)}finally{u(),h.close()}}}}),b=()=>{u&&u(),l={__type:"connecting",associationKeypair:i},void 0===r&&(r=Date.now()),(h=new WebSocket(n,["com.solana.mobilewalletadapter.v1"])).addEventListener("open",f),h.addEventListener("close",g),h.addEventListener("error",m),h.addEventListener("message",y),u=()=>{window.clearTimeout(d),h.removeEventListener("open",f),h.removeEventListener("close",g),h.removeEventListener("error",m),h.removeEventListener("message",y)}};b()})})}(e,r?{baseUri:r}:void 0)}catch(e){throw e7(this,N,"f")!==i&&(yield new Promise(()=>{})),e instanceof Error&&"SolanaMobileWalletAdapterError"===e.name&&"ERROR_WALLET_NOT_FOUND"===e.code&&(yield e7(this,P,"f").call(this,this)),e}})),q.set(this,()=>{if(!e7(this,_,"f"))throw Error("Wallet not connected");return{authToken:e7(this,_,"f").auth_token,chain:e7(this,_,"f").chain}}),B.set(this,e=>e.map(e=>{var t,r;let i=to(e.address);return{address:e8.encode(i),publicKey:i,label:e.label,icon:e.icon,chains:null!==(t=e.chains)&&void 0!==t?t:e7(this,A,"f"),features:null!==(r=e.features)&&void 0!==r?r:tc}})),W.set(this,e=>e9(this,void 0,void 0,function*(){let{authToken:t,chain:r}=e7(this,q,"f").call(this);try{let i=e.map(e=>tn(e));return yield e7(this,$,"f").call(this,e=>e9(this,void 0,void 0,function*(){return yield e7(this,U,"f").call(this,e,t,r),(yield e.signTransactions({payloads:i})).signed_payloads.map(to)}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),H.set(this,(e,t)=>e9(this,void 0,void 0,function*(){let{authToken:r,chain:i}=e7(this,q,"f").call(this);try{return yield e7(this,$,"f").call(this,s=>e9(this,void 0,void 0,function*(){let[n,o]=yield Promise.all([s.getCapabilities(),e7(this,U,"f").call(this,s,r,i)]);if(n.supports_sign_and_send_transactions){let r=tn(e);return(yield s.signAndSendTransactions(Object.assign(Object.assign({},t),{payloads:[r]}))).signatures.map(to)[0]}throw Error("connected wallet does not support signAndSendTransaction")}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),F.set(this,(...e)=>e9(this,void 0,void 0,function*(){let t=[];for(let r of e){let e=yield e7(this,H,"f").call(this,r.transaction,r.options);t.push({signature:e})}return t})),V.set(this,(...e)=>e9(this,void 0,void 0,function*(){return(yield e7(this,W,"f").call(this,e.map(({transaction:e})=>e))).map(e=>({signedTransaction:e}))})),K.set(this,(...e)=>e9(this,void 0,void 0,function*(){let{authToken:t,chain:r}=e7(this,q,"f").call(this),i=e.map(({account:e})=>tn(e.publicKey)),s=e.map(({message:e})=>tn(e));try{return yield e7(this,$,"f").call(this,e=>e9(this,void 0,void 0,function*(){return yield e7(this,U,"f").call(this,e,t,r),(yield e.signMessages({addresses:i,payloads:s})).signed_payloads.map(to).map(e=>({signedMessage:e,signature:e.slice(-64)}))}))}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}})),J.set(this,(...e)=>e9(this,void 0,void 0,function*(){let t=[];if(!(e.length>1))return[(yield e7(this,Y,"f").call(this,e[0]))];for(let r of e)t.push((yield e7(this,Y,"f").call(this,r)));return t})),Y.set(this,e=>e9(this,void 0,void 0,function*(){var t,r,i;te(this,S,!0,"f");try{let s=yield e7(this,k,"f").call(this,Object.assign(Object.assign({},e),{domain:null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:window.location.host}));if(!s.sign_in_result)throw Error("Sign in failed, no sign in result returned by wallet");let n=s.sign_in_result.address,o=s.accounts.find(e=>e.address==n);return{account:Object.assign(Object.assign({},null!=o?o:{address:e8.encode(to(n))}),{publicKey:to(n),chains:null!==(r=null==o?void 0:o.chains)&&void 0!==r?r:e7(this,A,"f"),features:null!==(i=null==o?void 0:o.features)&&void 0!==i?i:s.capabilities.features}),signedMessage:to(s.sign_in_result.signed_message),signature:to(s.sign_in_result.signature)}}catch(e){throw Error(e instanceof Error&&e.message||"Unknown error")}finally{te(this,S,!1,"f")}})),te(this,C,e.authorizationCache,"f"),te(this,I,e.appIdentity,"f"),te(this,A,e.chains,"f"),te(this,O,e.chainSelector,"f"),te(this,P,e.onWalletNotFound,"f"),te(this,M,{[ek.G]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:e7(this,F,"f")},[ej.R]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:e7(this,V,"f")}},"f")}get version(){return e7(this,b,"f")}get name(){return e7(this,w,"f")}get url(){return e7(this,v,"f")}get icon(){return e7(this,E,"f")}get chains(){return e7(this,A,"f")}get features(){return Object.assign({[e3.V]:{version:"1.0.0",connect:e7(this,R,"f")},[e5.R]:{version:"1.0.0",disconnect:e7(this,z,"f")},[e4.k]:{version:"1.0.0",on:e7(this,x,"f")},[eR.g]:{version:"1.0.0",signMessage:e7(this,K,"f")},[eD]:{version:"1.0.0",signIn:e7(this,J,"f")}},e7(this,M,"f"))}get accounts(){var e,t;return null!==(t=null===(e=e7(this,_,"f"))||void 0===e?void 0:e.accounts)&&void 0!==t?t:[]}get connected(){return!!e7(this,_,"f")}get isAuthorized(){return!!e7(this,_,"f")}get currentAuthorization(){return e7(this,_,"f")}get cachedAuthorizationResult(){return e7(this,C,"f").get()}}y=new WeakMap,b=new WeakMap,w=new WeakMap,v=new WeakMap,E=new WeakMap,I=new WeakMap,_=new WeakMap,C=new WeakMap,S=new WeakMap,N=new WeakMap,A=new WeakMap,O=new WeakMap,M=new WeakMap,P=new WeakMap,x=new WeakMap,R=new WeakMap,k=new WeakMap,j=new WeakMap,L=new WeakMap,U=new WeakMap,z=new WeakMap,$=new WeakMap,q=new WeakMap,B=new WeakMap,W=new WeakMap,H=new WeakMap,F=new WeakMap,V=new WeakMap,K=new WeakMap,J=new WeakMap,Y=new WeakMap,m=new WeakSet,T=function(e,...t){var r;null===(r=e7(this,y,"f")[e])||void 0===r||r.forEach(e=>e.apply(null,t))},D=function(e,t){var r;e7(this,y,"f")[e]=null===(r=e7(this,y,"f")[e])||void 0===r?void 0:r.filter(e=>t!==e)},new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakSet,new WeakMap;class th extends ts{constructor(){super(...arguments),this.contentStyles=td,this.contentHtml=tu}initWithError(e){super.init(),this.populateError(e)}populateError(e){var t,r;let i=null===(t=this.dom)||void 0===t?void 0:t.getElementById("mobile-wallet-adapter-error-message"),s=null===(r=this.dom)||void 0===r?void 0:r.getElementById("mobile-wallet-adapter-error-action");if(i){if("SolanaMobileWalletAdapterError"===e.name)switch(e.code){case"ERROR_WALLET_NOT_FOUND":i.innerHTML="To use mobile wallet adapter, you must have a compatible mobile wallet application installed on your device.",s&&s.addEventListener("click",()=>{window.location.href="https://solanamobile.com/wallets"});return;case"ERROR_BROWSER_NOT_SUPPORTED":i.innerHTML="This browser appears to be incompatible with mobile wallet adapter. Open this page in a compatible mobile browser app and try again.",s&&(s.style.display="none");return}i.innerHTML=`An unexpected error occurred: ${e.message}`}else console.log("Failed to locate error dialog element")}}let tu=`
<svg class="mobile-wallet-adapter-embedded-modal-error-icon" xmlns="http://www.w3.org/2000/svg" height="50px" viewBox="0 -960 960 960" width="50px" fill="#000000"><path d="M 280,-80 Q 197,-80 138.5,-138.5 80,-197 80,-280 80,-363 138.5,-421.5 197,-480 280,-480 q 83,0 141.5,58.5 58.5,58.5 58.5,141.5 0,83 -58.5,141.5 Q 363,-80 280,-80 Z M 824,-120 568,-376 Q 556,-389 542.5,-402.5 529,-416 516,-428 q 38,-24 61,-64 23,-40 23,-88 0,-75 -52.5,-127.5 Q 495,-760 420,-760 345,-760 292.5,-707.5 240,-655 240,-580 q 0,6 0.5,11.5 0.5,5.5 1.5,11.5 -18,2 -39.5,8 -21.5,6 -38.5,14 -2,-11 -3,-22 -1,-11 -1,-23 0,-109 75.5,-184.5 Q 311,-840 420,-840 q 109,0 184.5,75.5 75.5,75.5 75.5,184.5 0,43 -13.5,81.5 Q 653,-460 629,-428 l 251,252 z m -615,-61 71,-71 70,71 29,-28 -71,-71 71,-71 -28,-28 -71,71 -71,-71 -28,28 71,71 -71,71 z"/></svg>
<div class="mobile-wallet-adapter-embedded-modal-title">We can't find a wallet.</div>
<div id="mobile-wallet-adapter-error-message" class="mobile-wallet-adapter-embedded-modal-subtitle"></div>
<div>
    <button data-error-action id="mobile-wallet-adapter-error-action" class="mobile-wallet-adapter-embedded-modal-error-action">
        Find a wallet
    </button>
</div>
`,td=`
.mobile-wallet-adapter-embedded-modal-content {
    text-align: center;
}

.mobile-wallet-adapter-embedded-modal-error-icon {
    margin-top: 24px;
}

.mobile-wallet-adapter-embedded-modal-title {
    margin: 18px 100px auto 100px;
    color: #000000;
    font-size: 2.75em;
    font-weight: 600;
}

.mobile-wallet-adapter-embedded-modal-subtitle {
    margin: 30px 60px 40px 60px;
    color: #000000;
    font-size: 1.25em;
    font-weight: 400;
}

.mobile-wallet-adapter-embedded-modal-error-action {
    display: block;
    width: 100%;
    height: 56px;
    /*margin-top: 40px;*/
    font-size: 1.25em;
    /*line-height: 24px;*/
    /*letter-spacing: -1%;*/
    background: #000000;
    color: #FFFFFF;
    border-radius: 18px;
}

/* Smaller screens */
@media all and (max-width: 600px) {
    .mobile-wallet-adapter-embedded-modal-title {
        font-size: 1.5em;
        margin-right: 12px;
        margin-left: 12px;
    }
    .mobile-wallet-adapter-embedded-modal-subtitle {
        margin-right: 12px;
        margin-left: 12px;
    }
}
`,tp="SolanaMobileWalletAdapterDefaultAuthorizationCache";function tf(e,t,r,i){return new(r||(r=Promise))(function(s,n){function o(e){try{c(i.next(e))}catch(e){n(e)}}function a(e){try{c(i.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):((t=e.value)instanceof r?t:new r(function(e){e(t)})).then(o,a)}c((i=i.apply(e,t||[])).next())})}function tg(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)}function tm(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r}let ty="standard:connect";function tb(e){return window.btoa(String.fromCharCode.call(null,...e))}function tw(e){switch(e){case"mainnet-beta":return"solana:mainnet";case"testnet":return"solana:testnet";case"devnet":return"solana:devnet";default:return e}}class tv extends eM.qz{constructor(e,t){super(),G.add(this),this.supportedTransactionVersions=new Set(["legacy",0]),Q.set(this,void 0),Z.set(this,!1),X.set(this,"undefined"!=typeof window&&window.isSecureContext&&"undefined"!=typeof document&&/android/i.test(navigator.userAgent)?eP.i1.Loadable:eP.i1.Unsupported),ee.set(this,void 0),et.set(this,void 0),er.set(this,void 0),ei.set(this,e=>tf(this,void 0,void 0,function*(){if(e.accounts&&e.accounts.length>0){tg(this,G,"m",en).call(this);let t=yield tg(this,ee,"f").call(this,e.accounts);t!==tg(this,et,"f")&&(tm(this,et,t,"f"),tm(this,er,void 0,"f"),this.emit("connect",this.publicKey))}})),tm(this,ee,e=>tf(this,void 0,void 0,function*(){var r;let i=yield t.addressSelector.select(e.map(({publicKey:e})=>tb(e)));return null!==(r=e.find(({publicKey:e})=>tb(e)===i))&&void 0!==r?r:e[0]}),"f"),tm(this,Q,e,"f"),tg(this,Q,"f").features["standard:events"].on("change",tg(this,ei,"f")),this.name=tg(this,Q,"f").name,this.icon=tg(this,Q,"f").icon,this.url=tg(this,Q,"f").url}get publicKey(){var e;if(!tg(this,er,"f")&&tg(this,et,"f"))try{tm(this,er,new eT.nh(tg(this,et,"f").publicKey),"f")}catch(e){throw new ex.Nx(e instanceof Error&&(null==e?void 0:e.message)||"Unknown error",e)}return null!==(e=tg(this,er,"f"))&&void 0!==e?e:null}get connected(){return tg(this,Q,"f").connected}get connecting(){return tg(this,Z,"f")}get readyState(){return tg(this,X,"f")}autoConnect_DO_NOT_USE_OR_YOU_WILL_BE_FIRED(){return tf(this,void 0,void 0,function*(){return yield this.autoConnect()})}autoConnect(){return tf(this,void 0,void 0,function*(){tg(this,G,"m",es).call(this,!0)})}connect(){return tf(this,void 0,void 0,function*(){tg(this,G,"m",es).call(this)})}performAuthorization(e){return tf(this,void 0,void 0,function*(){try{let t=yield tg(this,Q,"f").cachedAuthorizationResult;if(t)return yield tg(this,Q,"f").features[ty].connect({silent:!0}),t;return e?yield tg(this,Q,"f").features[eD].signIn(e):yield tg(this,Q,"f").features[ty].connect(),yield yield tg(this,Q,"f").cachedAuthorizationResult}catch(e){throw new ex.$w(e instanceof Error&&e.message||"Unknown error",e)}})}disconnect(){return tf(this,void 0,void 0,function*(){return yield tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){tm(this,Z,!1,"f"),tm(this,er,void 0,"f"),tm(this,et,void 0,"f"),yield tg(this,Q,"f").features["standard:disconnect"].disconnect(),this.emit("disconnect")}))})}signIn(e){return tf(this,void 0,void 0,function*(){return tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){var t;if(tg(this,X,"f")!==eP.i1.Installed&&tg(this,X,"f")!==eP.i1.Loadable)throw new ex.OZ;tm(this,Z,!0,"f");try{let r=yield tg(this,Q,"f").features[eD].signIn(Object.assign(Object.assign({},e),{domain:null!==(t=null==e?void 0:e.domain)&&void 0!==t?t:window.location.host}));if(r.length>0)return r[0];throw Error("Sign in failed, no sign in result returned by wallet")}catch(e){throw new ex.$w(e instanceof Error&&e.message||"Unknown error",e)}finally{tm(this,Z,!1,"f")}}))})}signMessage(e){return tf(this,void 0,void 0,function*(){return yield tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){let t=tg(this,G,"m",eo).call(this);try{return(yield tg(this,Q,"f").features[eR.g].signMessage({account:t,message:e}))[0].signature}catch(e){throw new ex.fk(null==e?void 0:e.message,e)}}))})}sendTransaction(e,t,r){return tf(this,void 0,void 0,function*(){return yield tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){let i=tg(this,G,"m",eo).call(this);try{if(ek.G in tg(this,Q,"f").features){let t=tw(tg(this,Q,"f").currentAuthorization.chain),[s]=(yield tg(this,Q,"f").features[ek.G].signAndSendTransaction({account:i,transaction:e.serialize(),chain:t,options:r?{skipPreflight:r.skipPreflight,maxRetries:r.maxRetries}:void 0})).map(e=>tb(e.signature));return s}{let[i]=yield tg(this,G,"m",ea).call(this,[e]);if("version"in i)return yield t.sendTransaction(i);{let e=i.serialize();return yield t.sendRawTransaction(e,Object.assign(Object.assign({},r),{preflightCommitment:function(){let e,i;switch(t.commitment){case"confirmed":case"finalized":case"processed":e=t.commitment;break;default:e="finalized"}switch(null==r?void 0:r.preflightCommitment){case"confirmed":case"finalized":case"processed":i=r.preflightCommitment;break;case void 0:i=e;break;default:i="finalized"}let s="finalized"===i?2:"confirmed"===i?1:0,n="finalized"===e?2:"confirmed"===e?1:0;return s<n?i:e}()}))}}}catch(e){throw new ex.IW(null==e?void 0:e.message,e)}}))})}signTransaction(e){return tf(this,void 0,void 0,function*(){return yield tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){let[t]=yield tg(this,G,"m",ea).call(this,[e]);return t}))})}signAllTransactions(e){return tf(this,void 0,void 0,function*(){return yield tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){return yield tg(this,G,"m",ea).call(this,e)}))})}}Q=new WeakMap,Z=new WeakMap,X=new WeakMap,ee=new WeakMap,et=new WeakMap,er=new WeakMap,ei=new WeakMap,G=new WeakSet,es=function(e=!1){return tf(this,void 0,void 0,function*(){if(!this.connecting&&!this.connected)return yield tg(this,G,"m",ec).call(this,()=>tf(this,void 0,void 0,function*(){if(tg(this,X,"f")!==eP.i1.Installed&&tg(this,X,"f")!==eP.i1.Loadable)throw new ex.OZ;tm(this,Z,!0,"f");try{yield tg(this,Q,"f").features[ty].connect({silent:e})}catch(e){throw new ex.$w(e instanceof Error&&e.message||"Unknown error",e)}finally{tm(this,Z,!1,"f")}}))})},en=function(){tg(this,X,"f")!==eP.i1.Installed&&this.emit("readyStateChange",tm(this,X,eP.i1.Installed,"f"))},eo=function(){if(!tg(this,Q,"f").isAuthorized||!tg(this,et,"f"))throw new ex.oS;return tg(this,et,"f")},ea=function(e){return tf(this,void 0,void 0,function*(){let t=tg(this,G,"m",eo).call(this);try{if(ej.R in tg(this,Q,"f").features)return tg(this,Q,"f").features[ej.R].signTransaction(...e.map(e=>({account:t,transaction:e.serialize()}))).then(e=>e.map(e=>{let t=e.signedTransaction,r=t[0],i=eT.EC.deserializeMessageVersion(t.slice(64*r+1,t.length));return"legacy"===i?eT.YW.from(t):eT.GS.deserialize(t)}));throw Error("Connected wallet does not support signing transactions")}catch(e){throw new ex.PY(null==e?void 0:e.message,e)}})},ec=function(e){return tf(this,void 0,void 0,function*(){try{return yield e()}catch(e){throw this.emit("error",e),e}})};class tE extends tv{constructor(e){var t;let r=tw(null!==(t=e.chain)&&void 0!==t?t:e.cluster);super(new tl({appIdentity:e.appIdentity,authorizationCache:{set:e.authorizationResultCache.set,get:()=>tf(this,void 0,void 0,function*(){return yield e.authorizationResultCache.get()}),clear:e.authorizationResultCache.clear},chains:[r],chainSelector:{select(e){return e9(this,void 0,void 0,function*(){return 1===e.length?e[0]:e.includes(e6.aI)?e6.aI:e[0]})}},onWalletNotFound:()=>tf(this,void 0,void 0,function*(){e.onWalletNotFound(this)})}),{addressSelector:e.addressSelector,chain:r})}}class tI extends tE{}function t_(e){return tf(this,void 0,void 0,function*(){return function(){return e9(this,void 0,void 0,function*(){if("undefined"!=typeof window){let e=window.navigator.userAgent.toLowerCase(),t=new th;e.includes("wv")?t.initWithError({name:"SolanaMobileWalletAdapterError",code:"ERROR_BROWSER_NOT_SUPPORTED",message:""}):t.initWithError({name:"SolanaMobileWalletAdapterError",code:"ERROR_WALLET_NOT_FOUND",message:""}),t.open()}})}()})}let tC=function(e){return e3.V in e.features&&e4.k in e.features&&(ek.G in e.features||ej.R in e.features)};var tS=r(43887);function tN(e){switch(e){case"processed":case"confirmed":case"finalized":case void 0:return e;case"recent":return"processed";case"single":case"singleGossip":return"confirmed";case"max":case"root":return"finalized";default:return}}new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap,new WeakMap;var tA=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},tO=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};class tM extends eP.mI{get name(){return tA(this,em,"f").name}get url(){return"https://github.com/solana-labs/wallet-standard"}get icon(){return tA(this,em,"f").icon}get readyState(){return tA(this,ey,"f")}get publicKey(){return tA(this,eu,"f")}get connecting(){return tA(this,ed,"f")}get supportedTransactionVersions(){return tA(this,eg,"f")}get wallet(){return tA(this,em,"f")}get standard(){return!0}constructor({wallet:e}){super(),el.add(this),eh.set(this,void 0),eu.set(this,void 0),ed.set(this,void 0),ep.set(this,void 0),ef.set(this,void 0),eg.set(this,void 0),em.set(this,void 0),ey.set(this,"undefined"==typeof window||"undefined"==typeof document?eP.i1.Unsupported:eP.i1.Installed),eI.set(this,e=>{if("accounts"in e){let e=tA(this,em,"f").accounts[0];tA(this,eh,"f")&&!tA(this,ep,"f")&&e!==tA(this,eh,"f")&&(e?tA(this,el,"m",ew).call(this,e):(this.emit("error",new ex.at),tA(this,el,"m",ev).call(this)))}"features"in e&&tA(this,el,"m",eE).call(this)}),tO(this,em,e,"f"),tO(this,eh,null,"f"),tO(this,eu,null,"f"),tO(this,ed,!1,"f"),tO(this,ep,!1,"f"),tO(this,ef,tA(this,em,"f").features[e4.k].on("change",tA(this,eI,"f")),"f"),tA(this,el,"m",eE).call(this)}destroy(){tO(this,eh,null,"f"),tO(this,eu,null,"f"),tO(this,ed,!1,"f"),tO(this,ep,!1,"f");let e=tA(this,ef,"f");e&&(tO(this,ef,null,"f"),e())}async autoConnect(){return tA(this,el,"m",eb).call(this,{silent:!0})}async connect(){return tA(this,el,"m",eb).call(this)}async disconnect(){if(e5.R in tA(this,em,"f").features)try{tO(this,ep,!0,"f"),await tA(this,em,"f").features[e5.R].disconnect()}catch(e){this.emit("error",new ex.UG(e?.message,e))}finally{tO(this,ep,!1,"f")}tA(this,el,"m",ev).call(this)}async sendTransaction(e,t,r={}){try{var i;let s;let n=tA(this,eh,"f");if(!n)throw new ex.oS;if(ek.G in tA(this,em,"f").features){if(n.features.includes(ek.G))s=ek.G;else if(ej.R in tA(this,em,"f").features&&n.features.includes(ej.R))s=ej.R;else throw new ex.cO}else if(ej.R in tA(this,em,"f").features){if(!n.features.includes(ej.R))throw new ex.cO;s=ej.R}else throw new ex.p6;let o=(i=t.rpcEndpoint).includes("https://api.mainnet-beta.solana.com")?e6.aI:/\bdevnet\b/i.test(i)?e6.BR:/\btestnet\b/i.test(i)?e6.gv:/\blocalhost\b/i.test(i)||/\b127\.0\.0\.1\b/.test(i)?e6.l1:e6.aI;if(!n.chains.includes(o))throw new ex.IW;try{let i;let{signers:a,...c}=r;if((0,tS.W)(e)?(a?.length&&e.sign(a),i=e.serialize()):(e=await this.prepareTransaction(e,t,c),a?.length&&e.partialSign(...a),i=new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))),s===ek.G){let[e]=await tA(this,em,"f").features[ek.G].signAndSendTransaction({account:n,chain:o,transaction:i,options:{preflightCommitment:tN(c.preflightCommitment||t.commitment),skipPreflight:c.skipPreflight,maxRetries:c.maxRetries,minContextSlot:c.minContextSlot}});return e8.encode(e.signature)}{let[e]=await tA(this,em,"f").features[ej.R].signTransaction({account:n,chain:o,transaction:i,options:{preflightCommitment:tN(c.preflightCommitment||t.commitment),minContextSlot:c.minContextSlot}});return await t.sendRawTransaction(e.signedTransaction,{...c,preflightCommitment:tN(c.preflightCommitment||t.commitment)})}}catch(e){if(e instanceof ex.lj)throw e;throw new ex.IW(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}eh=new WeakMap,eu=new WeakMap,ed=new WeakMap,ep=new WeakMap,ef=new WeakMap,eg=new WeakMap,em=new WeakMap,ey=new WeakMap,eI=new WeakMap,el=new WeakSet,eb=async function(e){try{if(this.connected||this.connecting)return;if(tA(this,ey,"f")!==eP.i1.Installed)throw new ex.OZ;if(tO(this,ed,!0,"f"),!tA(this,em,"f").accounts.length)try{await tA(this,em,"f").features[e3.V].connect(e)}catch(e){throw new ex.$w(e?.message,e)}let t=tA(this,em,"f").accounts[0];if(!t)throw new ex.cO;tA(this,el,"m",ew).call(this,t)}catch(e){throw this.emit("error",e),e}finally{tO(this,ed,!1,"f")}},ew=function(e){let t;try{t=new eT.nh(e.address)}catch(e){throw new ex.Nx(e?.message,e)}tO(this,eh,e,"f"),tO(this,eu,t,"f"),tA(this,el,"m",eE).call(this),this.emit("connect",t)},ev=function(){tO(this,eh,null,"f"),tO(this,eu,null,"f"),tA(this,el,"m",eE).call(this),this.emit("disconnect")},eE=function(){let e=ek.G in tA(this,em,"f").features?tA(this,em,"f").features[ek.G].supportedTransactionVersions:tA(this,em,"f").features[ej.R].supportedTransactionVersions;tO(this,eg,!function(e,t){if(e===t)return!0;let r=e.length;if(r!==t.length)return!1;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}(e,["legacy"])?new Set(e):null,"f"),ej.R in tA(this,em,"f").features&&tA(this,eh,"f")?.features.includes(ej.R)?(this.signTransaction=tA(this,el,"m",e_),this.signAllTransactions=tA(this,el,"m",eC)):(delete this.signTransaction,delete this.signAllTransactions),eR.g in tA(this,em,"f").features&&tA(this,eh,"f")?.features.includes(eR.g)?this.signMessage=tA(this,el,"m",eS):delete this.signMessage,eD in tA(this,em,"f").features?this.signIn=tA(this,el,"m",eN):delete this.signIn},e_=async function(e){try{let t=tA(this,eh,"f");if(!t)throw new ex.oS;if(!(ej.R in tA(this,em,"f").features))throw new ex.p6;if(!t.features.includes(ej.R))throw new ex.cO;try{let r=(await tA(this,em,"f").features[ej.R].signTransaction({account:t,transaction:(0,tS.W)(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))}))[0].signedTransaction;return(0,tS.W)(e)?eT.GS.deserialize(r):eT.YW.from(r)}catch(e){if(e instanceof ex.lj)throw e;throw new ex.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}},eC=async function(e){try{let t=tA(this,eh,"f");if(!t)throw new ex.oS;if(!(ej.R in tA(this,em,"f").features))throw new ex.p6;if(!t.features.includes(ej.R))throw new ex.cO;try{let r=await tA(this,em,"f").features[ej.R].signTransaction(...e.map(e=>({account:t,transaction:(0,tS.W)(e)?e.serialize():new Uint8Array(e.serialize({requireAllSignatures:!1,verifySignatures:!1}))})));return e.map((e,t)=>{let i=r[t].signedTransaction;return(0,tS.W)(e)?eT.GS.deserialize(i):eT.YW.from(i)})}catch(e){throw new ex.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}},eS=async function(e){try{let t=tA(this,eh,"f");if(!t)throw new ex.oS;if(!(eR.g in tA(this,em,"f").features))throw new ex.p6;if(!t.features.includes(eR.g))throw new ex.cO;try{return(await tA(this,em,"f").features[eR.g].signMessage({account:t,message:e}))[0].signature}catch(e){throw new ex.fk(e?.message,e)}}catch(e){throw this.emit("error",e),e}},eN=async function(e={}){try{let t;if(!(eD in tA(this,em,"f").features))throw new ex.p6;try{[t]=await tA(this,em,"f").features[eD].signIn(e)}catch(e){throw new ex.bD(e?.message,e)}if(!t)throw new ex.bD;return tA(this,el,"m",ew).call(this,t.account),t}catch(e){throw this.emit("error",e),e}};var tP=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},tx=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};let tT=new Set,tD={};function tR(...e){return(e=e.filter(e=>!tT.has(e))).length?(e.forEach(e=>{s=void 0,tT.add(e)}),tD.register?.forEach(t=>tL(()=>t(...e))),function(){e.forEach(e=>{s=void 0,tT.delete(e)}),tD.unregister?.forEach(t=>tL(()=>t(...e)))}):()=>{}}function tk(){return s||(s=[...tT]),s}function tj(e,t){return tD[e]?.push(t)||(tD[e]=[t]),function(){tD[e]=tD[e]?.filter(e=>t!==e)}}function tL(e){try{e()}catch(e){console.error(e)}}class tU extends Event{get detail(){return tP(this,eA,"f")}get type(){return"wallet-standard:app-ready"}constructor(e){super("wallet-standard:app-ready",{bubbles:!1,cancelable:!1,composed:!1}),eA.set(this,void 0),tx(this,eA,e,"f")}preventDefault(){throw Error("preventDefault cannot be called")}stopImmediatePropagation(){throw Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw Error("stopPropagation cannot be called")}}eA=new WeakMap;var tz=r(2265);function t$(e){let t=(0,tz.useRef)(void 0);return void 0===t.current&&(t.current={value:e()}),t.current.value}function tq(e){return e.filter(tC).map(e=>new tM({wallet:e}))}(a=eO||(eO={}))[a.DESKTOP_WEB=0]="DESKTOP_WEB",a[a.MOBILE_WEB=1]="MOBILE_WEB";var tB=r(13816);class tW extends ex.lj{constructor(){super(...arguments),this.name="WalletNotSelectedError"}}var tH=r(15408);function tF({children:e,wallets:t,adapter:r,isUnloadingRef:i,onAutoConnectRequest:s,onConnectError:n,onError:o,onSelectWallet:a}){let c=(0,tz.useRef)(!1),[l,h]=(0,tz.useState)(!1),u=(0,tz.useRef)(!1),[d,p]=(0,tz.useState)(!1),[f,g]=(0,tz.useState)(()=>r?.publicKey??null),[m,y]=(0,tz.useState)(()=>r?.connected??!1),b=(0,tz.useRef)(o);(0,tz.useEffect)(()=>(b.current=o,()=>{b.current=void 0}),[o]);let w=(0,tz.useRef)((e,t)=>(!i.current&&(b.current?b.current(e,t):(console.error(e,t),e instanceof ex.OZ&&"undefined"!=typeof window&&t&&window.open(t.url,"_blank"))),e)),[v,E]=(0,tz.useState)(()=>t.map(e=>({adapter:e,readyState:e.readyState})).filter(({readyState:e})=>e!==eP.i1.Unsupported));(0,tz.useEffect)(()=>{function e(e){E(t=>{let r=t.findIndex(({adapter:e})=>e===this);if(-1===r)return t;let{adapter:i}=t[r];return[...t.slice(0,r),{adapter:i,readyState:e},...t.slice(r+1)].filter(({readyState:e})=>e!==eP.i1.Unsupported)})}return E(e=>t.map((t,r)=>{let i=e[r];return i&&i.adapter===t&&i.readyState===t.readyState?i:{adapter:t,readyState:t.readyState}}).filter(({readyState:e})=>e!==eP.i1.Unsupported)),t.forEach(t=>t.on("readyStateChange",e,t)),()=>{t.forEach(t=>t.off("readyStateChange",e,t))}},[r,t]);let I=(0,tz.useMemo)(()=>v.find(e=>e.adapter===r)??null,[r,v]);(0,tz.useEffect)(()=>{if(!r)return;let e=e=>{g(e),c.current=!1,h(!1),y(!0),u.current=!1,p(!1)},t=()=>{i.current||(g(null),c.current=!1,h(!1),y(!1),u.current=!1,p(!1))},s=e=>{w.current(e,r)};return r.on("connect",e),r.on("disconnect",t),r.on("error",s),()=>{r.off("connect",e),r.off("disconnect",t),r.off("error",s),t()}},[r,i]);let _=(0,tz.useRef)(!1);(0,tz.useEffect)(()=>()=>{_.current=!1},[r]),(0,tz.useEffect)(()=>{_.current||c.current||m||!s||I?.readyState!==eP.i1.Installed&&I?.readyState!==eP.i1.Loadable||(c.current=!0,h(!0),_.current=!0,async function(){try{await s()}catch{n()}finally{h(!1),c.current=!1}}())},[m,s,n,I]);let C=(0,tz.useCallback)(async(e,t,i)=>{if(!r)throw w.current(new tW);if(!m)throw w.current(new ex.oS,r);return await r.sendTransaction(e,t,i)},[r,m]),S=(0,tz.useMemo)(()=>r&&"signTransaction"in r?async e=>{if(!m)throw w.current(new ex.oS,r);return await r.signTransaction(e)}:void 0,[r,m]),N=(0,tz.useMemo)(()=>r&&"signAllTransactions"in r?async e=>{if(!m)throw w.current(new ex.oS,r);return await r.signAllTransactions(e)}:void 0,[r,m]),A=(0,tz.useMemo)(()=>r&&"signMessage"in r?async e=>{if(!m)throw w.current(new ex.oS,r);return await r.signMessage(e)}:void 0,[r,m]),O=(0,tz.useMemo)(()=>r&&"signIn"in r?async e=>await r.signIn(e):void 0,[r]),M=(0,tz.useCallback)(async()=>{if(c.current||u.current||I?.adapter.connected)return;if(!I)throw w.current(new tW);let{adapter:e,readyState:t}=I;if(!(t===eP.i1.Installed||t===eP.i1.Loadable))throw w.current(new ex.OZ,e);c.current=!0,h(!0);try{await e.connect()}catch(e){throw n(),e}finally{h(!1),c.current=!1}},[n,I]),P=(0,tz.useCallback)(async()=>{if(!u.current&&r){u.current=!0,p(!0);try{await r.disconnect()}finally{p(!1),u.current=!1}}},[r]);return tz.createElement(tH.z.Provider,{value:{autoConnect:!!s,wallets:v,wallet:I,publicKey:f,connected:m,connecting:l,disconnecting:d,select:a,connect:M,disconnect:P,sendTransaction:C,signTransaction:S,signAllTransactions:N,signMessage:A,signIn:O}},e)}function tV(e){return function({adapters:e,userAgentString:t}){return e.some(e=>e.name!==ta&&e.readyState===eP.i1.Installed)?eO.DESKTOP_WEB:t&&/android/i.test(t)&&!/(WebView|Version\/.+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+)|; wv\).+(Chrome)\/(\d+)\.(\d+)\.(\d+)\.(\d+))/i.test(t)?eO.MOBILE_WEB:eO.DESKTOP_WEB}({adapters:e,userAgentString:(void 0===n&&(n=globalThis.navigator?.userAgent??null),n)})===eO.MOBILE_WEB}function tK({children:e,wallets:t,autoConnect:r,localStorageKey:i="walletName",onError:s}){let{connection:n}=(0,tB.R)(),a=function(e){let t=t$(()=>new Set),{get:r,on:i}=t$(()=>(function(){if(o||(o=function(){if(o||(o=Object.freeze({register:tR,get:tk,on:tj}),"undefined"==typeof window))return o;let e=Object.freeze({register:tR});try{window.addEventListener("wallet-standard:register-wallet",({detail:t})=>t(e))}catch(e){console.error("wallet-standard:register-wallet event listener could not be added\n",e)}try{window.dispatchEvent(new tU(e))}catch(e){console.error("wallet-standard:app-ready event could not be dispatched\n",e)}return o}(),"undefined"==typeof window))return o;let e=window.navigator.wallets||[];if(!Array.isArray(e))return console.error("window.navigator.wallets is not an array"),o;let{register:t}=o,r=(...e)=>e.forEach(e=>tL(()=>e({register:t})));try{Object.defineProperty(window.navigator,"wallets",{value:Object.freeze({push:r})})}catch(e){return console.error("window.navigator.wallets could not be set"),o}return r(...e),o})()),[s,n]=(0,tz.useState)(()=>tq(r()));(0,tz.useEffect)(()=>{let e=[i("register",(...e)=>n(t=>[...t,...tq(e)])),i("unregister",(...e)=>n(t=>t.filter(t=>e.some(e=>e===t.wallet))))];return()=>e.forEach(e=>e())},[i]);let a=function(e){let t=(0,tz.useRef)(void 0);return(0,tz.useEffect)(()=>{t.current=e}),t.current}(s);return(0,tz.useEffect)(()=>{if(!a)return;let e=new Set(s);new Set(a.filter(t=>!e.has(t))).forEach(e=>e.destroy())},[a,s]),(0,tz.useEffect)(()=>()=>s.forEach(e=>e.destroy()),[]),(0,tz.useMemo)(()=>[...s,...e.filter(({name:e})=>!s.some(t=>t.name===e)||(t.has(e)||(t.add(e),console.warn(`${e} was registered as a Standard Wallet. The Wallet Adapter for ${e} can be removed from your app.`)),!1))],[s,e,t])}(t),c=(0,tz.useMemo)(()=>{var e;if(!tV(a))return null;let t=a.find(e=>e.name===ta);return t||new tI({addressSelector:{select(e){return tf(this,void 0,void 0,function*(){return e[0]})}},appIdentity:{uri:function(){let e=globalThis.location;if(e)return`${e.protocol}//${e.host}`}()},authorizationResultCache:function(){let e;try{e=window.localStorage}catch(e){}return{clear(){return e9(this,void 0,void 0,function*(){if(e)try{e.removeItem(tp)}catch(e){}})},get(){return e9(this,void 0,void 0,function*(){if(e)try{let t=JSON.parse(e.getItem(tp));if(!t||!t.accounts)return t||void 0;{let e=t.accounts.map(e=>Object.assign(Object.assign({},e),{publicKey:"publicKey"in e?new Uint8Array(Object.values(e.publicKey)):e8.decode(e.address)}));return Object.assign(Object.assign({},t),{accounts:e})}}catch(e){}})},set(t){return e9(this,void 0,void 0,function*(){if(e)try{e.setItem(tp,JSON.stringify(t))}catch(e){}})}}}(),cluster:(e=n?.rpcEndpoint)?/devnet/i.test(e)?"devnet":/testnet/i.test(e)?"testnet":"mainnet-beta":"mainnet-beta",onWalletNotFound:t_})},[a,n?.rpcEndpoint]),l=(0,tz.useMemo)(()=>null==c||-1!==a.indexOf(c)?a:[c,...a],[a,c]),[h,u]=function(e,t){let r=(0,tz.useState)(()=>{try{let t=localStorage.getItem(e);if(t)return JSON.parse(t)}catch(e){"undefined"!=typeof window&&console.error(e)}return null}),i=r[0],s=(0,tz.useRef)(!0);return(0,tz.useEffect)(()=>{if(s.current){s.current=!1;return}try{null===i?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(i))}catch(e){"undefined"!=typeof window&&console.error(e)}},[i,e]),r}(i,0),d=(0,tz.useMemo)(()=>l.find(e=>e.name===h)??null,[l,h]),p=(0,tz.useCallback)(e=>{h!==e&&(d&&d.name!==ta&&d.disconnect(),u(e))},[d,u,h]);(0,tz.useEffect)(()=>{if(d)return d.on("disconnect",e),()=>{d.off("disconnect",e)};function e(){m.current||u(null)}},[d,a,u,h]);let f=(0,tz.useRef)(!1),g=(0,tz.useMemo)(()=>{if(r&&d)return async()=>{(!0===r||await r(d))&&(f.current?await d.connect():await d.autoConnect())}},[r,d]),m=(0,tz.useRef)(!1);(0,tz.useEffect)(()=>{if(h===ta&&tV(a)){m.current=!1;return}function e(){m.current=!0}return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}},[a,h]);let y=(0,tz.useCallback)(()=>{d&&p(null)},[d,p]),b=(0,tz.useCallback)(e=>{f.current=!0,p(e)},[p]);return tz.createElement(tF,{wallets:l,adapter:d,isUnloadingRef:m,onAutoConnectRequest:g,onConnectError:y,onError:s,onSelectWallet:b},e)}},11867:function(e,t,r){"use strict";r.d(t,{e:function(){return U}});var i,s,n,o,a,c,l,h,u,d,p,f,g,m,y,b=r(95462),w=r(59805),v=r(74659),E=r(43887),I=r(64024),_=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},C=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};class S extends Event{get detail(){return _(this,i,"f")}get type(){return"wallet-standard:register-wallet"}constructor(e){super("wallet-standard:register-wallet",{bubbles:!1,cancelable:!1,composed:!1}),i.set(this,void 0),C(this,i,e,"f")}preventDefault(){throw Error("preventDefault cannot be called")}stopImmediatePropagation(){throw Error("stopImmediatePropagation cannot be called")}stopPropagation(){throw Error("stopPropagation cannot be called")}}i=new WeakMap;var N=r(88746),A=r(77684),O=r(10282),M=r(34402),P=r(59186),x=r(3005),T=r(83747),D=function(e,t,r,i){if("a"===r&&!i)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?i:"a"===r?i.call(e):i?i.value:t.get(e)},R=function(e,t,r,i,s){if("m"===i)throw TypeError("Private method is not writable");if("a"===i&&!s)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!s:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?s.call(e,r):s?s.value=r:t.set(e,r),r};class k{constructor(){s.add(this),n.set(this,{}),o.set(this,"1.0.0"),a.set(this,"MetaMask"),c.set(this,"data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjMxIiB2aWV3Qm94PSIwIDAgMzEgMzEiIHdpZHRoPSIzMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PGxpbmVhckdyYWRpZW50IGlkPSJhIiBncmFkaWVudFVuaXRzPSJ1c2VyU3BhY2VPblVzZSIgeDE9IjIwLjI1IiB4Mj0iMjYuNTcxIiB5MT0iMjcuMTczIiB5Mj0iMTkuODU4Ij48c3RvcCBvZmZzZXQ9Ii4wOCIgc3RvcC1jb2xvcj0iIzk5NDVmZiIvPjxzdG9wIG9mZnNldD0iLjMiIHN0b3AtY29sb3I9IiM4NzUyZjMiLz48c3RvcCBvZmZzZXQ9Ii41IiBzdG9wLWNvbG9yPSIjNTQ5N2Q1Ii8+PHN0b3Agb2Zmc2V0PSIuNiIgc3RvcC1jb2xvcj0iIzQzYjRjYSIvPjxzdG9wIG9mZnNldD0iLjcyIiBzdG9wLWNvbG9yPSIjMjhlMGI5Ii8+PHN0b3Agb2Zmc2V0PSIuOTciIHN0b3AtY29sb3I9IiMxOWZiOWIiLz48L2xpbmVhckdyYWRpZW50PjxnIHN0cm9rZS1saW5lam9pbj0icm91bmQiIHN0cm9rZS13aWR0aD0iLjA5NCI+PHBhdGggZD0ibTI2LjEwOSAzLjY0My05LjM2OSA2Ljk1OSAxLjczMy00LjEwNSA3LjYzNy0yLjg1M3oiIGZpbGw9IiNlMjc2MWIiIHN0cm9rZT0iI2UyNzYxYiIvPjxnIGZpbGw9IiNlNDc2MWIiIHN0cm9rZT0iI2U0NzYxYiI+PHBhdGggZD0ibTQuNDgxIDMuNjQzIDkuMjk0IDcuMDI0LTEuNjQ4LTQuMTcxem0xOC4yNTggMTYuMTMtMi40OTUgMy44MjMgNS4zMzkgMS40NjkgMS41MzUtNS4yMDctNC4zNzgtLjA4NXptLTE5LjI0Ny4wODUgMS41MjUgNS4yMDcgNS4zMzktMS40NjktMi40OTUtMy44MjN6Ii8+PHBhdGggZD0ibTEwLjA1NSAxMy4zMTMtMS40ODggMi4yNTEgNS4zMDEuMjM1LS4xODgtNS42OTd6bTEwLjQ4IDAtMy42NzItMy4yNzctLjEyMiA1Ljc2MyA1LjI5Mi0uMjM1LTEuNDk3LTIuMjUxem0tMTAuMTc4IDEwLjI4MyAzLjE4My0xLjU1NC0yLjc0OS0yLjE0Ny0uNDMzIDMuNzAxem02LjY5NS0xLjU1NCAzLjE5MiAxLjU1NC0uNDQzLTMuNzAxeiIvPjwvZz48cGF0aCBkPSJtMjAuMjQ0IDIzLjU5Ni0zLjE5Mi0xLjU1NC4yNTQgMi4wODEtLjAyOC44NzZ6bS05Ljg4NyAwIDIuOTY2IDEuNDAzLS4wMTktLjg3Ni4yMzUtMi4wODEtMy4xODMgMS41NTR6IiBmaWxsPSIjZDdjMWIzIiBzdHJva2U9IiNkN2MxYjMiLz48cGF0aCBkPSJtMTMuMzY5IDE4LjUyMS0yLjY1NS0uNzgxIDEuODc0LS44NTd6bTMuODUxIDAgLjc4MS0xLjYzOCAxLjg4My44NTctMi42NjUuNzgxeiIgZmlsbD0iIzIzMzQ0NyIgc3Ryb2tlPSIjMjMzNDQ3Ii8+PHBhdGggZD0ibTEwLjM1NyAyMy41OTYuNDUyLTMuODIzLTIuOTQ3LjA4NXptOS40MzUtMy44MjMuNDUyIDMuODIzIDIuNDk1LTMuNzM4em0yLjI0MS00LjIwOS01LjI5Mi4yMzUuNDkgMi43MjEuNzgyLTEuNjM4IDEuODgzLjg1N3ptLTExLjMxOCAyLjE3NSAxLjg4My0uODU3Ljc3MiAxLjYzOC40OTktMi43MjEtNS4zMDEtLjIzNXoiIGZpbGw9IiNjZDYxMTYiIHN0cm9rZT0iI2NkNjExNiIvPjxwYXRoIGQ9Im04LjU2NyAxNS41NjQgMi4yMjIgNC4zMzEtLjA3NS0yLjE1NnptMTEuMzI4IDIuMTc1LS4wOTQgMi4xNTYgMi4yMzItNC4zMzEtMi4xMzcgMi4xNzV6bS02LjAyNi0xLjk0LS40OTkgMi43MjEuNjIxIDMuMjExLjE0MS00LjIyOC0uMjY0LTEuNzA0em0yLjg3MiAwLS4yNTQgMS42OTUuMTEzIDQuMjM3LjYzMS0zLjIxMXoiIGZpbGw9IiNlNDc1MWYiIHN0cm9rZT0iI2U0NzUxZiIvPjxwYXRoIGQ9Im0xNy4yMyAxOC41Mi0uNjMxIDMuMjExLjQ1Mi4zMTEgMi43NS0yLjE0Ny4wOTQtMi4xNTZ6bS02LjUxNi0uNzgxLjA3NSAyLjE1NiAyLjc1IDIuMTQ3LjQ1Mi0uMzExLS42MjItMy4yMTF6IiBmaWxsPSIjZjY4NTFiIiBzdHJva2U9IiNmNjg1MWIiLz48cGF0aCBkPSJtMTcuMjc3IDI0Ljk5OS4wMjgtLjg3Ni0uMjM1LS4yMDdoLTMuNTVsLS4yMTcuMjA3LjAxOS44NzYtMi45NjYtMS40MDMgMS4wMzYuODQ4IDIuMSAxLjQ1OWgzLjYwNmwyLjEwOS0xLjQ1OSAxLjAzNi0uODQ4eiIgZmlsbD0iI2MwYWQ5ZSIgc3Ryb2tlPSIjYzBhZDllIi8+PHBhdGggZD0ibTE3LjA1MSAyMi4wNDItLjQ1Mi0uMzExaC0yLjYwOGwtLjQ1Mi4zMTEtLjIzNSAyLjA4MS4yMTctLjIwN2gzLjU1bC4yMzUuMjA3LS4yNTQtMi4wODF6IiBmaWxsPSIjMTYxNjE2IiBzdHJva2U9IiMxNjE2MTYiLz48cGF0aCBkPSJtMjYuNTA1IDExLjA1My44LTMuODQyLTEuMTk2LTMuNTY5LTkuMDU4IDYuNzIzIDMuNDg0IDIuOTQ3IDQuOTI1IDEuNDQxIDEuMDkyLTEuMjcxLS40NzEtLjMzOS43NTMtLjY4Ny0uNTg0LS40NTIuNzUzLS41NzQtLjQ5OS0uMzc3em0tMjMuMjExLTMuODQxLjggMy44NDItLjUwOC4zNzcuNzUzLjU3NC0uNTc0LjQ1Mi43NTMuNjg3LS40NzEuMzM5IDEuMDgzIDEuMjcxIDQuOTI1LTEuNDQxIDMuNDg0LTIuOTQ3LTkuMDU5LTYuNzIzeiIgZmlsbD0iIzc2M2QxNiIgc3Ryb2tlPSIjNzYzZDE2Ii8+PHBhdGggZD0ibTI1LjQ2IDE0Ljc1NC00LjkyNS0xLjQ0MSAxLjQ5NyAyLjI1MS0yLjIzMiA0LjMzMSAyLjkzOC0uMDM4aDQuMzc4bC0xLjY1Ny01LjEwNHptLTE1LjQwNS0xLjQ0MS00LjkyNSAxLjQ0MS0xLjYzOCA1LjEwNGg0LjM2OWwyLjkyOC4wMzgtMi4yMjItNC4zMzEgMS40ODgtMi4yNTF6bTYuNjg1IDIuNDg2LjMxMS01LjQzMyAxLjQzMS0zLjg3aC02LjM1NmwxLjQxMyAzLjg3LjMyOSA1LjQzMy4xMTMgMS43MTQuMDA5IDQuMjE5aDIuNjFsLjAxOS00LjIxOS4xMjItMS43MTR6IiBmaWxsPSIjZjY4NTFiIiBzdHJva2U9IiNmNjg1MWIiLz48L2c+PGNpcmNsZSBjeD0iMjMuNSIgY3k9IjIzLjUiIGZpbGw9IiMwMDAiIHI9IjYuNSIvPjxwYXRoIGQ9Im0yNy40NzMgMjUuNTQ1LTEuMzEgMS4zNjhjLS4wMjkuMDMtLjA2My4wNTMtLjEwMS4wN2EuMzEuMzEgMCAwIDEgLS4xMjEuMDI0aC02LjIwOWMtLjAzIDAtLjA1OS0uMDA4LS4wODMtLjAyNGEuMTUuMTUgMCAwIDEgLS4wNTYtLjA2NWMtLjAxMi0uMDI2LS4wMTUtLjA1Ni0uMDEtLjA4NHMuMDE4LS4wNTUuMDM5LS4wNzZsMS4zMTEtMS4zNjhjLjAyOC0uMDMuMDYzLS4wNTMuMTAxLS4wNjlhLjMxLjMxIDAgMCAxIC4xMjEtLjAyNWg2LjIwOGMuMDMgMCAuMDU5LjAwOC4wODMuMDI0YS4xNS4xNSAwIDAgMSAuMDU2LjA2NWMuMDEyLjAyNi4wMTUuMDU2LjAxLjA4NHMtLjAxOC4wNTUtLjAzOS4wNzZ6bS0xLjMxLTIuNzU2Yy0uMDI5LS4wMy0uMDYzLS4wNTMtLjEwMS0uMDdhLjMxLjMxIDAgMCAwIC0uMTIxLS4wMjRoLTYuMjA5Yy0uMDMgMC0uMDU5LjAwOC0uMDgzLjAyNHMtLjA0NC4wMzgtLjA1Ni4wNjUtLjAxNS4wNTYtLjAxLjA4NC4wMTguMDU1LjAzOS4wNzZsMS4zMTEgMS4zNjhjLjAyOC4wMy4wNjMuMDUzLjEwMS4wNjlhLjMxLjMxIDAgMCAwIC4xMjEuMDI1aDYuMjA4Yy4wMyAwIC4wNTktLjAwOC4wODMtLjAyNGEuMTUuMTUgMCAwIDAgLjA1Ni0uMDY1Yy4wMTItLjAyNi4wMTUtLjA1Ni4wMS0uMDg0cy0uMDE4LS4wNTUtLjAzOS0uMDc2em0tNi40MzEtLjk4M2g2LjIwOWEuMzEuMzEgMCAwIDAgLjEyMS0uMDI0Yy4wMzgtLjAxNi4wNzMtLjA0LjEwMS0uMDdsMS4zMS0xLjM2OGMuMDItLjAyMS4wMzQtLjA0Ny4wMzktLjA3NnMuMDAxLS4wNTgtLjAxLS4wODRhLjE1LjE1IDAgMCAwIC0uMDU2LS4wNjVjLS4wMjUtLjAxNi0uMDU0LS4wMjQtLjA4My0uMDI0aC02LjIwOGEuMzEuMzEgMCAwIDAgLS4xMjEuMDI1Yy0uMDM4LjAxNi0uMDcyLjA0LS4xMDEuMDY5bC0xLjMxIDEuMzY4Yy0uMDIuMDIxLS4wMzQuMDQ3LS4wMzkuMDc2cy0uMDAxLjA1OC4wMS4wODQuMDMxLjA0OS4wNTYuMDY1LjA1NC4wMjQuMDgzLjAyNHoiIGZpbGw9InVybCgjYSkiLz48L3N2Zz4="),l.set(this,null),h.set(this,(e,t)=>(D(this,n,"f")[e]?.push(t)||(D(this,n,"f")[e]=[t]),()=>D(this,s,"m",d).call(this,e,t))),p.set(this,async()=>{if(!D(this,l,"f")){let e;try{e=(await r.e(7572).then(r.bind(r,27572))).default}catch(e){throw Error("Unable to load Solflare MetaMask SDK")}R(this,l,new e,"f"),D(this,l,"f").on("standard_change",e=>D(this,s,"m",u).call(this,"change",e))}return this.accounts.length||await D(this,l,"f").connect(),{accounts:this.accounts}}),f.set(this,async()=>{D(this,l,"f")&&await D(this,l,"f").disconnect()}),g.set(this,async(...e)=>{if(!D(this,l,"f"))throw new v.oS;return await D(this,l,"f").standardSignAndSendTransaction(...e)}),m.set(this,async(...e)=>{if(!D(this,l,"f"))throw new v.oS;return await D(this,l,"f").standardSignTransaction(...e)}),y.set(this,async(...e)=>{if(!D(this,l,"f"))throw new v.oS;return await D(this,l,"f").standardSignMessage(...e)})}get version(){return D(this,o,"f")}get name(){return D(this,a,"f")}get icon(){return D(this,c,"f")}get chains(){return[N.aI,N.BR,N.gv]}get features(){return{[P.V]:{version:"1.0.0",connect:D(this,p,"f")},[x.R]:{version:"1.0.0",disconnect:D(this,f,"f")},[T.k]:{version:"1.0.0",on:D(this,h,"f")},[A.G]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signAndSendTransaction:D(this,g,"f")},[O.R]:{version:"1.0.0",supportedTransactionVersions:["legacy",0],signTransaction:D(this,m,"f")},[M.g]:{version:"1.0.0",signMessage:D(this,y,"f")}}}get accounts(){return D(this,l,"f")?D(this,l,"f").standardAccounts:[]}}n=new WeakMap,o=new WeakMap,a=new WeakMap,c=new WeakMap,l=new WeakMap,h=new WeakMap,p=new WeakMap,f=new WeakMap,g=new WeakMap,m=new WeakMap,y=new WeakMap,s=new WeakSet,u=function(e,...t){D(this,n,"f")[e]?.forEach(e=>e.apply(null,t))},d=function(e,t){D(this,n,"f")[e]=D(this,n,"f")[e]?.filter(e=>t!==e)};let j=!1;async function L(){let e="solflare-detect-metamask";function t(){window.postMessage({target:"metamask-contentscript",data:{name:"metamask-provider",data:{id:e,jsonrpc:"2.0",method:"wallet_getSnaps"}}},window.location.origin)}function r(i){let s=i.data;s?.target==="metamask-inpage"&&s.data?.name==="metamask-provider"&&(s.data.data?.id===e?(window.removeEventListener("message",r),!s.data.data.error&&(j||(function(e){let t=({register:t})=>t(e);try{window.dispatchEvent(new S(t))}catch(e){console.error("wallet-standard:register-wallet event could not be dispatched\n",e)}try{window.addEventListener("wallet-standard:app-ready",({detail:e})=>t(e))}catch(e){console.error("wallet-standard:app-ready event listener could not be added\n",e)}}(new k),j=!0))):t())}window.addEventListener("message",r),window.setTimeout(()=>window.removeEventListener("message",r),5e3),t()}class U extends b.eC{constructor(e={}){super(),this.name="Solflare",this.url="https://solflare.com",this.icon="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz48c3ZnIGlkPSJTIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MCA1MCI+PGRlZnM+PHN0eWxlPi5jbHMtMXtmaWxsOiMwMjA1MGE7c3Ryb2tlOiNmZmVmNDY7c3Ryb2tlLW1pdGVybGltaXQ6MTA7c3Ryb2tlLXdpZHRoOi41cHg7fS5jbHMtMntmaWxsOiNmZmVmNDY7fTwvc3R5bGU+PC9kZWZzPjxyZWN0IGNsYXNzPSJjbHMtMiIgeD0iMCIgd2lkdGg9IjUwIiBoZWlnaHQ9IjUwIiByeD0iMTIiIHJ5PSIxMiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTI0LjIzLDI2LjQybDIuNDYtMi4zOCw0LjU5LDEuNWMzLjAxLDEsNC41MSwyLjg0LDQuNTEsNS40MywwLDEuOTYtLjc1LDMuMjYtMi4yNSw0LjkzbC0uNDYuNS4xNy0xLjE3Yy42Ny00LjI2LS41OC02LjA5LTQuNzItNy40M2wtNC4zLTEuMzhoMFpNMTguMDUsMTEuODVsMTIuNTIsNC4xNy0yLjcxLDIuNTktNi41MS0yLjE3Yy0yLjI1LS43NS0zLjAxLTEuOTYtMy4zLTQuNTF2LS4wOGgwWk0xNy4zLDMzLjA2bDIuODQtMi43MSw1LjM0LDEuNzVjMi44LjkyLDMuNzYsMi4xMywzLjQ2LDUuMThsLTExLjY1LTQuMjJoMFpNMTMuNzEsMjAuOTVjMC0uNzkuNDItMS41NCwxLjEzLTIuMTcuNzUsMS4wOSwyLjA1LDIuMDUsNC4wOSwyLjcxbDQuNDIsMS40Ni0yLjQ2LDIuMzgtNC4zNC0xLjQyYy0yLS42Ny0yLjg0LTEuNjctMi44NC0yLjk2TTI2LjgyLDQyLjg3YzkuMTgtNi4wOSwxNC4xMS0xMC4yMywxNC4xMS0xNS4zMiwwLTMuMzgtMi01LjI2LTYuNDMtNi43MmwtMy4zNC0xLjEzLDkuMTQtOC43Ny0xLjg0LTEuOTYtMi43MSwyLjM4LTEyLjgxLTQuMjJjLTMuOTcsMS4yOS04Ljk3LDUuMDktOC45Nyw4Ljg5LDAsLjQyLjA0LjgzLjE3LDEuMjktMy4zLDEuODgtNC42MywzLjYzLTQuNjMsNS44LDAsMi4wNSwxLjA5LDQuMDksNC41NSw1LjIybDIuNzUuOTItOS41Miw5LjE0LDEuODQsMS45NiwyLjk2LTIuNzEsMTQuNzMsNS4yMmgwWiIvPjwvc3ZnPg==",this.supportedTransactionVersions=new Set(["legacy",0]),this._readyState="undefined"==typeof window||"undefined"==typeof document?w.i1.Unsupported:w.i1.Loadable,this._disconnected=()=>{let e=this._wallet;e&&(e.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null,this.emit("error",new v.at),this.emit("disconnect"))},this._accountChanged=e=>{if(!e)return;let t=this._publicKey;if(t){try{e=new I.nh(e.toBytes())}catch(e){this.emit("error",new v.Nx(e?.message,e));return}t.equals(e)||(this._publicKey=e,this.emit("connect",e))}},this._connecting=!1,this._publicKey=null,this._wallet=null,this._config=e,this._readyState!==w.i1.Unsupported&&((0,w.su)(()=>(!!window.solflare?.isSolflare||!!window.SolflareApp)&&(this._readyState=w.i1.Installed,this.emit("readyStateChange",this._readyState),!0)),L())}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get connected(){return!!this._wallet?.connected}get readyState(){return this._readyState}async autoConnect(){this.readyState===w.i1.Loadable&&(0,w.H)()||await this.connect()}async connect(){try{let e,t,i;if(this.connected||this.connecting)return;if(this._readyState!==w.i1.Loadable&&this._readyState!==w.i1.Installed)throw new v.OZ;if(this.readyState===w.i1.Loadable&&(0,w.H)()){let e=encodeURIComponent(window.location.href),t=encodeURIComponent(window.location.origin);window.location.href=`https://solflare.com/ul/v1/browse/${e}?ref=${t}`;return}try{e=(await r.e(5161).then(r.bind(r,15161))).default}catch(e){throw new v.W8(e?.message,e)}try{t=new e({network:this._config.network})}catch(e){throw new v.p6(e?.message,e)}if(this._connecting=!0,!t.connected)try{await t.connect()}catch(e){throw new v.$w(e?.message,e)}if(!t.publicKey)throw new v.$w;try{i=new I.nh(t.publicKey.toBytes())}catch(e){throw new v.Nx(e?.message,e)}t.on("disconnect",this._disconnected),t.on("accountChanged",this._accountChanged),this._wallet=t,this._publicKey=i,this.emit("connect",i)}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}async disconnect(){let e=this._wallet;if(e){e.off("disconnect",this._disconnected),e.off("accountChanged",this._accountChanged),this._wallet=null,this._publicKey=null;try{await e.disconnect()}catch(e){this.emit("error",new v.UG(e?.message,e))}}this.emit("disconnect")}async sendTransaction(e,t,r={}){try{let i=this._wallet;if(!i)throw new v.oS;try{let{signers:s,...n}=r;return(0,E.W)(e)?s?.length&&e.sign(s):(e=await this.prepareTransaction(e,t,n),s?.length&&e.partialSign(...s)),n.preflightCommitment=n.preflightCommitment||t.commitment,await i.signAndSendTransaction(e,n)}catch(e){if(e instanceof v.lj)throw e;throw new v.IW(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signTransaction(e){try{let t=this._wallet;if(!t)throw new v.oS;try{return await t.signTransaction(e)||e}catch(e){throw new v.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAllTransactions(e){try{let t=this._wallet;if(!t)throw new v.oS;try{return await t.signAllTransactions(e)||e}catch(e){throw new v.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signMessage(e){try{let t=this._wallet;if(!t)throw new v.oS;try{return await t.signMessage(e,"utf8")}catch(e){throw new v.fk(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}},25223:function(e,t,r){"use strict";r.d(t,{X:function(){return a}});var i=r(95462),s=r(59805),n=r(74659),o=r(64024);class a extends i.eC{constructor({params:e={showTorusButton:!1}}={params:{showTorusButton:!1}}){super(),this.name="Torus",this.url="https://tor.us",this.icon="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzMiIGhlaWdodD0iMzIiIHZpZXdCb3g9IjAgMCAzMyAzMiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTYuNSIgY3k9IjE2IiByPSIxNiIgZmlsbD0iIzAzNjRGRiIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjIxODYgOS40OTIxOUMxMC40NTM5IDkuNDkyMTkgOS44MzM5OCAxMC4xMTIxIDkuODMzOTggMTAuODc2OFYxMi40ODk4QzkuODMzOTggMTMuMjU0NSAxMC40NTM5IDEzLjg3NDQgMTEuMjE4NiAxMy44NzQ0SDEzLjY2ODRWMjIuODk3NkMxMy42Njg0IDIzLjY2MjMgMTQuMjg4MyAyNC4yODIyIDE1LjA1MyAyNC4yODIySDE2LjY2NkMxNy40MzA3IDI0LjI4MjIgMTguMDUwNiAyMy42NjIzIDE4LjA1MDYgMjIuODk3NlYxMi41MDE1QzE4LjA1MDYgMTIuNDk3NiAxOC4wNTA2IDEyLjQ5MzcgMTguMDUwNiAxMi40ODk4VjEwLjg3NjhDMTguMDUwNiAxMC4xMTIxIDE3LjQzMDcgOS40OTIxOSAxNi42NjYgOS40OTIxOUgxNS4wNTNIMTEuMjE4NloiIGZpbGw9IndoaXRlIi8+CjxwYXRoIGQ9Ik0yMS4zMzc2IDEzLjg3NDRDMjIuNTQ3NyAxMy44NzQ0IDIzLjUyODcgMTIuODkzNCAyMy41Mjg3IDExLjY4MzNDMjMuNTI4NyAxMC40NzMyIDIyLjU0NzcgOS40OTIxOSAyMS4zMzc2IDkuNDkyMTlDMjAuMTI3NSA5LjQ5MjE5IDE5LjE0NjUgMTAuNDczMiAxOS4xNDY1IDExLjY4MzNDMTkuMTQ2NSAxMi44OTM0IDIwLjEyNzUgMTMuODc0NCAyMS4zMzc2IDEzLjg3NDRaIiBmaWxsPSJ3aGl0ZSIvPgo8L3N2Zz4K",this.supportedTransactionVersions=null,this._readyState="undefined"==typeof window||"undefined"==typeof document?s.i1.Unsupported:s.i1.Loadable,this._connecting=!1,this._wallet=null,this._publicKey=null,this._params=e}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get connected(){return!!this._wallet?.isLoggedIn}get readyState(){return this._readyState}async connect(){try{let e,t,i,a;if(this.connected||this.connecting)return;if(this._readyState!==s.i1.Loadable)throw new n.OZ;this._connecting=!0;try{e=(await Promise.all([r.e(8218),r.e(5628),r.e(1156)]).then(r.bind(r,91429))).default}catch(e){throw new n.W8(e?.message,e)}try{t=window.torus||new e}catch(e){throw new n.p6(e?.message,e)}if(!t.isInitialized)try{await t.init(this._params)}catch(e){throw new n.$w(e?.message,e)}try{i=await t.login()}catch(e){throw new n.cO(e?.message,e)}try{a=new o.nh(i[0])}catch(e){throw new n.Nx(e?.message,e)}this._wallet=t,this._publicKey=a,this.emit("connect",a)}catch(e){throw this.emit("error",e),e}finally{this._connecting=!1}}async disconnect(){let e=this._wallet;if(e){this._wallet=null,this._publicKey=null;try{e.isLoggedIn&&await e.cleanUp()}catch(e){this.emit("error",new n.UG(e?.message,e))}}this.emit("disconnect")}async sendTransaction(e,t,r={}){try{let i=this._wallet;if(!i)throw new n.oS;try{let{signers:s,...n}=r;e=await this.prepareTransaction(e,t,n),s?.length&&e.partialSign(...s),n.preflightCommitment=n.preflightCommitment||t.commitment;let{signature:o}=await i.signAndSendTransaction(e,n);return o}catch(e){if(e instanceof n.lj)throw e;throw new n.IW(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signTransaction(e){try{let t=this._wallet;if(!t)throw new n.oS;try{return await t.signTransaction(e)||e}catch(e){throw new n.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAllTransactions(e){try{let t=this._wallet;if(!t)throw new n.oS;try{return await t.signAllTransactions(e)||e}catch(e){throw new n.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signMessage(e){try{let t=this._wallet;if(!t)throw new n.oS;try{return await t.signMessage(e)}catch(e){throw new n.fk(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}},88746:function(e,t,r){"use strict";r.d(t,{BR:function(){return s},aI:function(){return i},gv:function(){return n},l1:function(){return o}});let i="solana:mainnet",s="solana:devnet",n="solana:testnet",o="solana:localnet"},77684:function(e,t,r){"use strict";r.d(t,{G:function(){return i}});let i="solana:signAndSendTransaction"},34402:function(e,t,r){"use strict";r.d(t,{g:function(){return i}});let i="solana:signMessage"},10282:function(e,t,r){"use strict";r.d(t,{R:function(){return i}});let i="solana:signTransaction"},59186:function(e,t,r){"use strict";r.d(t,{V:function(){return i}});let i="standard:connect"},3005:function(e,t,r){"use strict";r.d(t,{R:function(){return i}});let i="standard:disconnect"},83747:function(e,t,r){"use strict";r.d(t,{k:function(){return i}});let i="standard:events"},37416:function(e,t,r){"use strict";let i,s;r.d(t,{Z:function(){return Nq}});var n,o,a,c,l,h,u,d,p,f,g,m,y,b,w,v,E,I,_,C,S,N,A,O,M,P,x,T,D={};r.r(D),r.d(D,{identity:function(){return sS}});var R={};r.r(R),r.d(R,{base2:function(){return sN}});var k={};r.r(k),r.d(k,{base8:function(){return sA}});var j={};r.r(j),r.d(j,{base10:function(){return sO}});var L={};r.r(L),r.d(L,{base16:function(){return sM},base16upper:function(){return sP}});var U={};r.r(U),r.d(U,{base32:function(){return sx},base32hex:function(){return sk},base32hexpad:function(){return sL},base32hexpadupper:function(){return sU},base32hexupper:function(){return sj},base32pad:function(){return sD},base32padupper:function(){return sR},base32upper:function(){return sT},base32z:function(){return sz}});var z={};r.r(z),r.d(z,{base36:function(){return s$},base36upper:function(){return sq}});var $={};r.r($),r.d($,{base58btc:function(){return sB},base58flickr:function(){return sW}});var q={};r.r(q),r.d(q,{base64:function(){return sH},base64pad:function(){return sF},base64url:function(){return sV},base64urlpad:function(){return sK}});var B={};r.r(B),r.d(B,{base256emoji:function(){return sQ}});var W={};r.r(W),r.d(W,{sha256:function(){return ne},sha512:function(){return nt}});var H={};r.r(H),r.d(H,{identity:function(){return nr}});var F={};r.r(F),r.d(F,{code:function(){return ns},decode:function(){return no},encode:function(){return nn},name:function(){return ni}});var V={};r.r(V),r.d(V,{code:function(){return nh},decode:function(){return nd},encode:function(){return nu},name:function(){return nl}});var K=r(95462),J=r(59805),Y=r(74659),G=r(86454);(c=x||(x={})).Mainnet="solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",c.Devnet="solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",c.Deprecated_Mainnet="solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",c.Deprecated_Devnet="solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K",(l=T||(T={})).signTransaction="solana_signTransaction",l.signMessage="solana_signMessage",l.signAndSendTransaction="solana_signAndSendTransaction",l.signAndSendAllTransactions="solana_signAndSendAllTransactions",l.signAllTransactions="solana_signAllTransactions";let Q={Mainnet:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",Devnet:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",Deprecated_Mainnet:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ",Deprecated_Devnet:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"};var Z=r(43887),X=r(64024),ee=r(55445),et=r.n(ee),er=r(40537);class ei{}class es extends ei{constructor(e){super()}}let en=er.FIVE_SECONDS,eo="heartbeat_pulse";class ea extends es{constructor(e){super(e),this.events=new ee.EventEmitter,this.interval=en,this.interval=e?.interval||en}static async init(e){let t=new ea(e);return await t.init(),t}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),(0,er.toMiliseconds)(this.interval))}pulse(){this.events.emit(eo)}}let ec=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,el=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,eh=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function eu(e,t){if("__proto__"===e||"constructor"===e&&t&&"object"==typeof t&&"prototype"in t){console.warn(`[destr] Dropping "${e}" key to prevent prototype pollution.`);return}return t}function ed(e,t={}){if("string"!=typeof e)return e;if('"'===e[0]&&'"'===e[e.length-1]&&-1===e.indexOf("\\"))return e.slice(1,-1);let r=e.trim();if(r.length<=9)switch(r.toLowerCase()){case"true":return!0;case"false":return!1;case"undefined":return;case"null":return null;case"nan":return Number.NaN;case"infinity":return Number.POSITIVE_INFINITY;case"-infinity":return Number.NEGATIVE_INFINITY}if(!eh.test(e)){if(t.strict)throw SyntaxError("[destr] Invalid JSON");return e}try{if(ec.test(e)||el.test(e)){if(t.strict)throw Error("[destr] Possible prototype pollution");return JSON.parse(e,eu)}return JSON.parse(e)}catch(r){if(t.strict)throw r;return e}}var ep=r(82957).Buffer;function ef(e,...t){try{var r;return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}}function eg(e){if(function(e){let t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){let t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return eg(e.toJSON());throw Error("[unstorage] Cannot stringify value!")}let em="base64:";function ey(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function eb(e){return(e=ey(e))?e+":":""}let ew=()=>{let e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function ev(e,t,r){return e.watch?e.watch((e,i)=>t(e,r+i)):()=>{}}async function eE(e){"function"==typeof e.dispose&&await ef(e.dispose)}function eI(e){return new Promise((t,r)=>{e.oncomplete=e.onsuccess=()=>t(e.result),e.onabort=e.onerror=()=>r(e.error)})}function e_(e,t){let r;let i=()=>{if(r)return r;let i=indexedDB.open(e);return i.onupgradeneeded=()=>i.result.createObjectStore(t),(r=eI(i)).then(e=>{e.onclose=()=>r=void 0},()=>{}),r};return(e,r)=>i().then(i=>r(i.transaction(t,e).objectStore(t)))}function eC(){return i||(i=e_("keyval-store","keyval")),i}function eS(e,t=eC()){return t("readonly",t=>eI(t.get(e)))}function eN(e,t,r=eC()){return r("readwrite",r=>(r.put(t,e),eI(r.transaction)))}function eA(e,t=eC()){return t("readwrite",t=>(t.delete(e),eI(t.transaction)))}function eO(e=eC()){return e("readwrite",e=>(e.clear(),eI(e.transaction)))}function eM(e=eC()){return e("readonly",e=>{var t;if(e.getAllKeys)return eI(e.getAllKeys());let r=[];return(t=e=>r.push(e.key),e.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},eI(e.transaction)).then(()=>r)})}var eP=r(80577),ex=(e={})=>{let t;let r=e.base&&e.base.length>0?`${e.base}:`:"",i=e=>r+e;return e.dbName&&e.storeName&&(t=e_(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await eS(i(e),t)>"u"),getItem:async e=>await eS(i(e),t)??null,setItem:(e,r)=>eN(i(e),r,t),removeItem:e=>eA(i(e),t),getKeys:()=>eM(t),clear:()=>eO(t)}};class eT{constructor(){this.indexedDb=function(e={}){let t={mounts:{"":e.driver||ew()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(let r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},i=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),s=(e,r)=>{if(t.watching)for(let i of(r=ey(r),t.watchListeners))i(e,r)},n=async()=>{if(!t.watching)for(let e in t.watching=!0,t.mounts)t.unwatch[e]=await ev(t.mounts[e],s,e)},o=async()=>{if(t.watching){for(let e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},a=(e,t,i)=>{let s=new Map,n=e=>{let t=s.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},s.set(e.base,t)),t};for(let i of e){let e="string"==typeof i,s=ey(e?i:i.key),o=e?void 0:i.value,a=e||!i.options?t:{...t,...i.options},c=r(s);n(c).items.push({key:s,value:o,relativeKey:c.relativeKey,options:a})}return Promise.all([...s.values()].map(e=>i(e))).then(e=>e.flat())},c={hasItem(e,t={}){let{relativeKey:i,driver:s}=r(e=ey(e));return ef(s.hasItem,i,t)},getItem(e,t={}){let{relativeKey:i,driver:s}=r(e=ey(e));return ef(s.getItem,i,t).then(e=>ed(e))},getItems:(e,t={})=>a(e,t,e=>e.driver.getItems?ef(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:function(...e){return ey(e.join(":"))}(e.base,t.key),value:ed(t.value)}))):Promise.all(e.items.map(t=>ef(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:ed(e)}))))),getItemRaw(e,t={}){let{relativeKey:i,driver:s}=r(e=ey(e));return s.getItemRaw?ef(s.getItemRaw,i,t):ef(s.getItem,i,t).then(e=>{var t;return"string"==typeof e&&e.startsWith(em)?(t=e.slice(em.length),globalThis.Buffer?ep.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))):e})},async setItem(e,t,i={}){if(void 0===t)return c.removeItem(e);let{relativeKey:n,driver:o}=r(e=ey(e));o.setItem&&(await ef(o.setItem,n,eg(t),i),o.watch||s("update",e))},async setItems(e,t){await a(e,t,async e=>{if(e.driver.setItems)return ef(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:eg(e.value),options:e.options})),t);e.driver.setItem&&await Promise.all(e.items.map(t=>ef(e.driver.setItem,t.relativeKey,eg(t.value),t.options)))})},async setItemRaw(e,t,i={}){if(void 0===t)return c.removeItem(e,i);let{relativeKey:n,driver:o}=r(e=ey(e));if(o.setItemRaw)await ef(o.setItemRaw,n,t,i);else{if(!o.setItem)return;await ef(o.setItem,n,"string"==typeof t?t:em+(globalThis.Buffer?ep.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))),i)}o.watch||s("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t});let{relativeKey:i,driver:n}=r(e=ey(e));n.removeItem&&(await ef(n.removeItem,i,t),(t.removeMeta||t.removeMata)&&await ef(n.removeItem,i+"$",t),n.watch||s("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t});let{relativeKey:i,driver:s}=r(e=ey(e)),n=Object.create(null);if(s.getMeta&&Object.assign(n,await ef(s.getMeta,i,t)),!t.nativeOnly){let e=await ef(s.getItem,i+"$",t).then(e=>ed(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(n,e))}return n},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){let r=i(e=eb(e),!0),s=[],n=[],o=!0;for(let e of r){for(let r of(e.driver.flags?.maxDepth||(o=!1),await ef(e.driver.getKeys,e.relativeBase,t))){let t=e.mountpoint+ey(r);s.some(e=>t.startsWith(e))||n.push(t)}s=[e.mountpoint,...s.filter(t=>!t.startsWith(e.mountpoint))]}let a=void 0!==t.maxDepth&&!o;return n.filter(r=>{var i;return(!a||function(e,t){if(void 0===t)return!0;let r=0,i=e.indexOf(":");for(;i>-1;)r++,i=e.indexOf(":",i+1);return r<=t}(r,t.maxDepth))&&((i=e)?r.startsWith(i)&&"$"!==r[r.length-1]:"$"!==r[r.length-1])})},async clear(e,t={}){e=eb(e),await Promise.all(i(e,!1).map(async e=>e.driver.clear?ef(e.driver.clear,e.relativeBase,t):e.driver.removeItem?Promise.all((await e.driver.getKeys(e.relativeBase||"",t)).map(r=>e.driver.removeItem(r,t))):void 0))},async dispose(){await Promise.all(Object.values(t.mounts).map(e=>eE(e)))},watch:async e=>(await n(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&await o()}),async unwatch(){t.watchListeners=[],await o()},mount(e,r){if((e=eb(e))&&t.mounts[e])throw Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(ev(r,s,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),c},async unmount(e,r=!0){(e=eb(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&await eE(t.mounts[e]),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])},getMount(e=""){let t=r(e=ey(e)+":");return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>i(e=ey(e),t.parents).map(e=>({driver:e.driver,base:e.mountpoint})),keys:(e,t={})=>c.getKeys(e,t),get:(e,t={})=>c.getItem(e,t),set:(e,t,r={})=>c.setItem(e,t,r),has:(e,t={})=>c.hasItem(e,t),del:(e,t={})=>c.removeItem(e,t),remove:(e,t={})=>c.removeItem(e,t)};return c}({driver:ex({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){let t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,(0,eP.u)(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var eD="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof r.g?r.g:"u">typeof self?self:{},eR={exports:{}};function ek(e){var t;return[e[0],(0,eP.D)(null!=(t=e[1])?t:"")]}!function(){function e(){}e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){let e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),"u">typeof eD&&eD.localStorage?eR.exports=eD.localStorage:"u">typeof window&&window.localStorage?eR.exports=window.localStorage:eR.exports=new e}();class ej{constructor(){this.localStorage=eR.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(ek)}async getItem(e){let t=this.localStorage.getItem(e);if(null!==t)return(0,eP.D)(t)}async setItem(e,t){this.localStorage.setItem(e,(0,eP.u)(t))}async removeItem(e){this.localStorage.removeItem(e)}}let eL=async(e,t,r)=>{let i="wc_storage_version",s=await t.getItem(i);if(s&&s>=1){r(t);return}let n=await e.getKeys();if(!n.length){r(t);return}let o=[];for(;n.length;){let r=n.shift();if(!r)continue;let i=r.toLowerCase();if(i.includes("wc@")||i.includes("walletconnect")||i.includes("wc_")||i.includes("wallet_connect")){let i=await e.getItem(r);await t.setItem(r,i),o.push(r)}}await t.setItem(i,1),r(t),eU(e,o)},eU=async(e,t)=>{t.length&&t.forEach(async t=>{await e.removeItem(t)})};class ez{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};let e=new ej;this.storage=e;try{let t=new eT;eL(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{let t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}}var e$=r(15133),eq=Object.defineProperty,eB=(e,t,r)=>t in e?eq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eW=(e,t,r)=>eB(e,"symbol"!=typeof t?t+"":t,r);class eH extends ei{constructor(e){super(),this.opts=e,eW(this,"protocol","wc"),eW(this,"version",2)}}var eF=Object.defineProperty,eV=(e,t,r)=>t in e?eF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,eK=(e,t,r)=>eV(e,"symbol"!=typeof t?t+"":t,r);class eJ extends ei{constructor(e,t){super(),this.core=e,this.logger=t,eK(this,"records",new Map)}}class eY{constructor(e,t){this.logger=e,this.core=t}}class eG extends ei{constructor(e,t){super(),this.relayer=e,this.logger=t}}class eQ extends ei{constructor(e){super()}}class eZ{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class eX extends ei{constructor(e,t){super(),this.relayer=e,this.logger=t}}class e0 extends ei{constructor(e,t){super(),this.core=e,this.logger=t}}class e1{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class e2{constructor(e,t){this.projectId=e,this.logger=t}}class e3{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}function e5(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function e4(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}let e8="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0,e6=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);function e9(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),e5(e),e}class e7{clone(){return this._cloneInto()}}function te(e=32){if(e8&&"function"==typeof e8.getRandomValues)return e8.getRandomValues(new Uint8Array(e));if(e8&&"function"==typeof e8.randomBytes)return e8.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}class tt extends e7{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=e6(this.buffer)}update(e){e4(this);let{view:t,buffer:r,blockLen:i}=this,s=(e=e9(e)).length;for(let n=0;n<s;){let o=Math.min(i-this.pos,s-n);if(o===i){let t=e6(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){e4(this),function(e,t){e5(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),a=Number(r&n),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let o=e6(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=a/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=n,i%t&&e.buffer.set(r),e}}let tr=BigInt(4294967296-1),ti=BigInt(32),ts={split:function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:o}=function(e,t=!1){return t?{h:Number(e&tr),l:Number(e>>ti&tr)}:{h:0|Number(e>>ti&tr),l:0|Number(e&tr)}}(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]},shrSH:(e,t,r)=>e>>>r,shrSL:(e,t,r)=>e<<32-r|t>>>r,rotrSH:(e,t,r)=>e>>>r|t<<32-r,rotrSL:(e,t,r)=>e<<32-r|t>>>r,rotrBH:(e,t,r)=>e<<64-r|t>>>r-32,rotrBL:(e,t,r)=>e>>>r-32|t<<64-r,add:function(e,t,r,i){let s=(t>>>0)+(i>>>0);return{h:e+r+(s/4294967296|0)|0,l:0|s}},add3L:(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),add3H:(e,t,r,i)=>t+r+i+(e/4294967296|0)|0,add4L:(e,t,r,i)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0),add4H:(e,t,r,i,s)=>t+r+i+s+(e/4294967296|0)|0,add5H:(e,t,r,i,s,n)=>t+r+i+s+n+(e/4294967296|0)|0,add5L:(e,t,r,i,s)=>(e>>>0)+(t>>>0)+(r>>>0)+(i>>>0)+(s>>>0)},[tn,to]=ts.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),ta=new Uint32Array(80),tc=new Uint32Array(80);class tl extends tt{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:t,Bh:r,Bl:i,Ch:s,Cl:n,Dh:o,Dl:a,Eh:c,El:l,Fh:h,Fl:u,Gh:d,Gl:p,Hh:f,Hl:g}=this;return[e,t,r,i,s,n,o,a,c,l,h,u,d,p,f,g]}set(e,t,r,i,s,n,o,a,c,l,h,u,d,p,f,g){this.Ah=0|e,this.Al=0|t,this.Bh=0|r,this.Bl=0|i,this.Ch=0|s,this.Cl=0|n,this.Dh=0|o,this.Dl=0|a,this.Eh=0|c,this.El=0|l,this.Fh=0|h,this.Fl=0|u,this.Gh=0|d,this.Gl=0|p,this.Hh=0|f,this.Hl=0|g}process(e,t){for(let r=0;r<16;r++,t+=4)ta[r]=e.getUint32(t),tc[r]=e.getUint32(t+=4);for(let e=16;e<80;e++){let t=0|ta[e-15],r=0|tc[e-15],i=ts.rotrSH(t,r,1)^ts.rotrSH(t,r,8)^ts.shrSH(t,r,7),s=ts.rotrSL(t,r,1)^ts.rotrSL(t,r,8)^ts.shrSL(t,r,7),n=0|ta[e-2],o=0|tc[e-2],a=ts.rotrSH(n,o,19)^ts.rotrBH(n,o,61)^ts.shrSH(n,o,6),c=ts.rotrSL(n,o,19)^ts.rotrBL(n,o,61)^ts.shrSL(n,o,6),l=ts.add4L(s,c,tc[e-7],tc[e-16]),h=ts.add4H(l,i,a,ta[e-7],ta[e-16]);ta[e]=0|h,tc[e]=0|l}let{Ah:r,Al:i,Bh:s,Bl:n,Ch:o,Cl:a,Dh:c,Dl:l,Eh:h,El:u,Fh:d,Fl:p,Gh:f,Gl:g,Hh:m,Hl:y}=this;for(let e=0;e<80;e++){let t=ts.rotrSH(h,u,14)^ts.rotrSH(h,u,18)^ts.rotrBH(h,u,41),b=ts.rotrSL(h,u,14)^ts.rotrSL(h,u,18)^ts.rotrBL(h,u,41),w=h&d^~h&f,v=u&p^~u&g,E=ts.add5L(y,b,v,to[e],tc[e]),I=ts.add5H(E,m,t,w,tn[e],ta[e]),_=0|E,C=ts.rotrSH(r,i,28)^ts.rotrBH(r,i,34)^ts.rotrBH(r,i,39),S=ts.rotrSL(r,i,28)^ts.rotrBL(r,i,34)^ts.rotrBL(r,i,39),N=r&s^r&o^s&o,A=i&n^i&a^n&a;m=0|f,y=0|g,f=0|d,g=0|p,d=0|h,p=0|u,({h:h,l:u}=ts.add(0|c,0|l,0|I,0|_)),c=0|o,l=0|a,o=0|s,a=0|n,s=0|r,n=0|i;let O=ts.add3L(_,S,A);r=ts.add3H(O,I,C,N),i=0|O}({h:r,l:i}=ts.add(0|this.Ah,0|this.Al,0|r,0|i)),({h:s,l:n}=ts.add(0|this.Bh,0|this.Bl,0|s,0|n)),({h:o,l:a}=ts.add(0|this.Ch,0|this.Cl,0|o,0|a)),({h:c,l:l}=ts.add(0|this.Dh,0|this.Dl,0|c,0|l)),({h:h,l:u}=ts.add(0|this.Eh,0|this.El,0|h,0|u)),({h:d,l:p}=ts.add(0|this.Fh,0|this.Fl,0|d,0|p)),({h:f,l:g}=ts.add(0|this.Gh,0|this.Gl,0|f,0|g)),({h:m,l:y}=ts.add(0|this.Hh,0|this.Hl,0|m,0|y)),this.set(r,i,s,n,o,a,c,l,h,u,d,p,f,g,m,y)}roundClean(){ta.fill(0),tc.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}let th=function(e){let t=t=>e().update(e9(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}(()=>new tl),tu=BigInt(0),td=BigInt(1),tp=BigInt(2);function tf(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function tg(e){if(!tf(e))throw Error("Uint8Array expected")}function tm(e,t){if("boolean"!=typeof t)throw Error(e+" boolean expected, got "+t)}let ty=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function tb(e){tg(e);let t="";for(let r=0;r<e.length;r++)t+=ty[e[r]];return t}function tw(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?tu:BigInt("0x"+e)}let tv={_0:48,_9:57,A:65,F:70,a:97,f:102};function tE(e){return e>=tv._0&&e<=tv._9?e-tv._0:e>=tv.A&&e<=tv.F?e-(tv.A-10):e>=tv.a&&e<=tv.f?e-(tv.a-10):void 0}function tI(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=tE(e.charCodeAt(s)),n=tE(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i}function t_(e){return tg(e),tw(tb(Uint8Array.from(e).reverse()))}function tC(e,t){return tI(e.toString(16).padStart(2*t,"0"))}function tS(e,t){return tC(e,t).reverse()}function tN(e,t,r){let i;if("string"==typeof t)try{i=tI(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(tf(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}function tA(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];tg(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}let tO=e=>"bigint"==typeof e&&tu<=e;function tM(e,t,r,i){if(!(tO(t)&&tO(r)&&tO(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let tP=e=>(tp<<BigInt(e-1))-td,tx={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||tf(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)};function tT(e,t,r={}){let i=(t,r,i)=>{let s=tx[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(i&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0);return e}function tD(e){let t=new WeakMap;return(r,...i)=>{let s=t.get(r);if(void 0!==s)return s;let n=e(r,...i);return t.set(r,n),n}}let tR=BigInt(0),tk=BigInt(1),tj=BigInt(2),tL=BigInt(3),tU=BigInt(4),tz=BigInt(5),t$=BigInt(8);function tq(e,t){let r=e%t;return r>=tR?r:t+r}function tB(e,t,r){let i=e;for(;t-- >tR;)i*=i,i%=r;return i}function tW(e,t){if(e===tR)throw Error("invert: expected non-zero number");if(t<=tR)throw Error("invert: expected positive modulus, got "+t);let r=tq(e,t),i=t,s=tR,n=tk;for(;r!==tR;){let e=i/r,t=i%r,o=s-n*e;i=r,r=t,s=n,n=o}if(i!==tk)throw Error("invert: does not exist");return tq(s,t)}let tH=(e,t)=>(tq(e,t)&tk)===tk,tF=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function tV(e,t){let r=void 0!==t?t:e.toString(2).length;return{nBitLength:r,nByteLength:Math.ceil(r/8)}}function tK(e,t,r=!1,i={}){let s;if(e<=tR)throw Error("invalid field: expected ORDER > 0, got "+e);let{nBitLength:n,nByteLength:o}=tV(e,t);if(o>2048)throw Error("invalid field: expected ORDER of <= 2048 bytes");let a=Object.freeze({ORDER:e,isLE:r,BITS:n,BYTES:o,MASK:tP(n),ZERO:tR,ONE:tk,create:t=>tq(t,e),isValid:t=>{if("bigint"!=typeof t)throw Error("invalid field element: expected bigint, got "+typeof t);return tR<=t&&t<e},is0:e=>e===tR,isOdd:e=>(e&tk)===tk,neg:t=>tq(-t,e),eql:(e,t)=>e===t,sqr:t=>tq(t*t,e),add:(t,r)=>tq(t+r,e),sub:(t,r)=>tq(t-r,e),mul:(t,r)=>tq(t*r,e),pow:(e,t)=>(function(e,t,r){if(r<tR)throw Error("invalid exponent, negatives unsupported");if(r===tR)return e.ONE;if(r===tk)return t;let i=e.ONE,s=t;for(;r>tR;)r&tk&&(i=e.mul(i,s)),s=e.sqr(s),r>>=tk;return i})(a,e,t),div:(t,r)=>tq(t*tW(r,e),e),sqrN:e=>e*e,addN:(e,t)=>e+t,subN:(e,t)=>e-t,mulN:(e,t)=>e*t,inv:t=>tW(t,e),sqrt:i.sqrt||(t=>(s||(s=function(e){if(e%tU===tL){let t=(e+tk)/tU;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}if(e%t$===tz){let t=(e-tz)/t$;return function(e,r){let i=e.mul(r,tj),s=e.pow(i,t),n=e.mul(r,s),o=e.mul(e.mul(n,tj),s),a=e.mul(n,e.sub(o,e.ONE));if(!e.eql(e.sqr(a),r))throw Error("Cannot find square root");return a}}return function(e){let t,r,i;let s=(e-tk)/tj;for(t=e-tk,r=0;t%tj===tR;t/=tj,r++);for(i=tj;i<e&&function(e,t,r){if(t<tR)throw Error("invalid exponent, negatives unsupported");if(r<=tR)throw Error("invalid modulus");if(r===tk)return tR;let i=tk;for(;t>tR;)t&tk&&(i=i*e%r),e=e*e%r,t>>=tk;return i}(i,s,e)!==e-tk;i++)if(i>1e3)throw Error("Cannot find square root: likely non-prime P");if(1===r){let t=(e+tk)/tU;return function(e,r){let i=e.pow(r,t);if(!e.eql(e.sqr(i),r))throw Error("Cannot find square root");return i}}let n=(t+tk)/tj;return function(e,o){if(e.pow(o,s)===e.neg(e.ONE))throw Error("Cannot find square root");let a=r,c=e.pow(e.mul(e.ONE,i),t),l=e.pow(o,n),h=e.pow(o,t);for(;!e.eql(h,e.ONE);){if(e.eql(h,e.ZERO))return e.ZERO;let t=1;for(let r=e.sqr(h);t<a&&!e.eql(r,e.ONE);t++)r=e.sqr(r);let r=e.pow(c,tk<<BigInt(a-t-1));c=e.sqr(r),l=e.mul(l,r),h=e.mul(h,c),a=t}return l}}(e)}(e)),s(a,t))),invertBatch:e=>(function(e,t){let r=Array(t.length),i=t.reduce((t,i,s)=>e.is0(i)?t:(r[s]=t,e.mul(t,i)),e.ONE),s=e.inv(i);return t.reduceRight((t,i,s)=>e.is0(i)?t:(r[s]=e.mul(t,r[s]),e.mul(t,i)),s),r})(a,e),cmov:(e,t,r)=>r?t:e,toBytes:e=>r?tS(e,o):tC(e,o),fromBytes:e=>{if(e.length!==o)throw Error("Field.fromBytes: expected "+o+" bytes, got "+e.length);return r?t_(e):tw(tb(e))}});return Object.freeze(a)}let tJ=BigInt(0),tY=BigInt(1);function tG(e,t){let r=t.negate();return e?r:t}function tQ(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw Error("invalid window size, expected [1.."+t+"], got W="+e)}function tZ(e,t){return tQ(e,t),{windows:Math.ceil(t/e)+1,windowSize:2**(e-1)}}let tX=new WeakMap,t0=new WeakMap;function t1(e){return t0.get(e)||1}let t2=BigInt(0),t3=BigInt(1),t5=BigInt(2),t4=BigInt(8),t8={zip215:!0};BigInt(0),BigInt(1);let t6=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),t9=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);let t7=BigInt(1),re=BigInt(2);BigInt(3);let rt=BigInt(5),rr=BigInt(8),ri=tK(t6,void 0,!0),rs=function(e){var t;let r=function(e){let t=(tT(e.Fp,tF.reduce((e,t)=>(e[t]="function",e),{ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"})),tT(e,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...tV(e.n,e.nBitLength),...e,p:e.Fp.ORDER}));return tT(e,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}(e),{Fp:i,n:s,prehash:n,hash:o,randomBytes:a,nByteLength:c,h:l}=r,h=t5<<BigInt(8*c)-t3,u=i.create,d=tK(r.n,r.nBitLength),p=r.uvRatio||((e,t)=>{try{return{isValid:!0,value:i.sqrt(e*i.inv(t))}}catch{return{isValid:!1,value:t2}}}),f=r.adjustScalarBytes||(e=>e),g=r.domain||((e,t,r)=>{if(tm("phflag",r),t.length||r)throw Error("Contexts/pre-hash are not supported");return e});function m(e,t){tM("coordinate "+e,t,t2,h)}function y(e){if(!(e instanceof v))throw Error("ExtendedPoint expected")}let b=tD((e,t)=>{let{ex:r,ey:s,ez:n}=e,o=e.is0();null==t&&(t=o?t4:i.inv(n));let a=u(r*t),c=u(s*t),l=u(n*t);if(o)return{x:t2,y:t3};if(l!==t3)throw Error("invZ was invalid");return{x:a,y:c}}),w=tD(e=>{let{a:t,d:i}=r;if(e.is0())throw Error("bad point: ZERO");let{ex:s,ey:n,ez:o,et:a}=e,c=u(s*s),l=u(n*n),h=u(o*o),d=u(h*h),p=u(c*t);if(u(h*u(p+l))!==u(d+u(i*u(c*l))))throw Error("bad point: equation left != right (1)");if(u(s*n)!==u(o*a))throw Error("bad point: equation left != right (2)");return!0});class v{constructor(e,t,r,i){this.ex=e,this.ey=t,this.ez=r,this.et=i,m("x",e),m("y",t),m("z",r),m("t",i),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(e){if(e instanceof v)throw Error("extended point not allowed");let{x:t,y:r}=e||{};return m("x",t),m("y",r),new v(t,r,t3,u(t*r))}static normalizeZ(e){let t=i.invertBatch(e.map(e=>e.ez));return e.map((e,r)=>e.toAffine(t[r])).map(v.fromAffine)}static msm(e,t){return function(e,t,r,i){if(function(e,t){if(!Array.isArray(e))throw Error("array expected");e.forEach((e,r)=>{if(!(e instanceof t))throw Error("invalid point at index "+r)})}(r,e),function(e,t){if(!Array.isArray(e))throw Error("array of scalars expected");e.forEach((e,r)=>{if(!t.isValid(e))throw Error("invalid scalar at index "+r)})}(i,t),r.length!==i.length)throw Error("arrays of points and scalars must have equal length");let s=e.ZERO,n=function(e){let t;for(t=0;e>tu;e>>=td,t+=1);return t}(BigInt(r.length)),o=n>12?n-3:n>4?n-2:n?2:1,a=(1<<o)-1,c=Array(a+1).fill(s),l=Math.floor((t.BITS-1)/o)*o,h=s;for(let e=l;e>=0;e-=o){c.fill(s);for(let t=0;t<i.length;t++){let s=Number(i[t]>>BigInt(e)&BigInt(a));c[s]=c[s].add(r[t])}let t=s;for(let e=c.length-1,r=s;e>0;e--)r=r.add(c[e]),t=t.add(r);if(h=h.add(t),0!==e)for(let e=0;e<o;e++)h=h.double()}return h}(v,d,e,t)}_setWindowSize(e){_.setWindowSize(this,e)}assertValidity(){w(this)}equals(e){y(e);let{ex:t,ey:r,ez:i}=this,{ex:s,ey:n,ez:o}=e,a=u(t*o),c=u(s*i),l=u(r*o),h=u(n*i);return a===c&&l===h}is0(){return this.equals(v.ZERO)}negate(){return new v(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:e}=r,{ex:t,ey:i,ez:s}=this,n=u(t*t),o=u(i*i),a=u(t5*u(s*s)),c=u(e*n),l=t+i,h=u(u(l*l)-n-o),d=c+o,p=d-a,f=c-o,g=u(h*p),m=u(d*f),y=u(h*f);return new v(g,m,u(p*d),y)}add(e){y(e);let{a:t,d:i}=r,{ex:s,ey:n,ez:o,et:a}=this,{ex:c,ey:l,ez:h,et:d}=e;if(t===BigInt(-1)){let e=u((n-s)*(l+c)),t=u((n+s)*(l-c)),r=u(t-e);if(r===t2)return this.double();let i=u(o*t5*d),p=u(a*t5*h),f=p+i,g=t+e,m=p-i,y=u(f*r),b=u(g*m),w=u(f*m);return new v(y,b,u(r*g),w)}let p=u(s*c),f=u(n*l),g=u(a*i*d),m=u(o*h),b=u((s+n)*(c+l)-p-f),w=m-g,E=m+g,I=u(f-t*p),_=u(b*w),C=u(E*I),S=u(b*I);return new v(_,C,u(w*E),S)}subtract(e){return this.add(e.negate())}wNAF(e){return _.wNAFCached(this,e,v.normalizeZ)}multiply(e){tM("scalar",e,t3,s);let{p:t,f:r}=this.wNAF(e);return v.normalizeZ([t,r])[0]}multiplyUnsafe(e,t=v.ZERO){return tM("scalar",e,t2,s),e===t2?I:this.is0()||e===t3?this:_.wNAFCachedUnsafe(this,e,v.normalizeZ,t)}isSmallOrder(){return this.multiplyUnsafe(l).is0()}isTorsionFree(){return _.unsafeLadder(this,s).is0()}toAffine(e){return b(this,e)}clearCofactor(){let{h:e}=r;return e===t3?this:this.multiplyUnsafe(e)}static fromHex(e,t=!1){let{d:s,a:n}=r,o=i.BYTES;e=tN("pointHex",e,o),tm("zip215",t);let a=e.slice(),c=e[o-1];a[o-1]=-129&c;let l=t_(a);tM("pointHex.y",l,t2,t?h:i.ORDER);let d=u(l*l),{isValid:f,value:g}=p(u(d-t3),u(s*d-n));if(!f)throw Error("Point.fromHex: invalid y coordinate");let m=(g&t3)===t3,y=(128&c)!=0;if(!t&&g===t2&&y)throw Error("Point.fromHex: x=0 and x_0=1");return y!==m&&(g=u(-g)),v.fromAffine({x:g,y:l})}static fromPrivateKey(e){return C(e).point}toRawBytes(){let{x:e,y:t}=this.toAffine(),r=tS(t,i.BYTES);return r[r.length-1]|=e&t3?128:0,r}toHex(){return tb(this.toRawBytes())}}v.BASE=new v(r.Gx,r.Gy,t3,u(r.Gx*r.Gy)),v.ZERO=new v(t2,t3,t3,t2);let{BASE:E,ZERO:I}=v,_=(t=8*c,{constTimeNegate:tG,hasPrecomputes:e=>1!==t1(e),unsafeLadder(e,t,r=v.ZERO){let i=e;for(;t>tJ;)t&tY&&(r=r.add(i)),i=i.double(),t>>=tY;return r},precomputeWindow(e,r){let{windows:i,windowSize:s}=tZ(r,t),n=[],o=e,a=o;for(let e=0;e<i;e++){a=o,n.push(a);for(let e=1;e<s;e++)a=a.add(o),n.push(a);o=a.double()}return n},wNAF(e,r,i){let{windows:s,windowSize:n}=tZ(e,t),o=v.ZERO,a=v.BASE,c=BigInt(2**e-1),l=2**e,h=BigInt(e);for(let e=0;e<s;e++){let t=e*n,s=Number(i&c);i>>=h,s>n&&(s-=l,i+=tY);let u=t+Math.abs(s)-1,d=e%2!=0,p=s<0;0===s?a=a.add(tG(d,r[t])):o=o.add(tG(p,r[u]))}return{p:o,f:a}},wNAFUnsafe(e,r,i,s=v.ZERO){let{windows:n,windowSize:o}=tZ(e,t),a=BigInt(2**e-1),c=2**e,l=BigInt(e);for(let e=0;e<n;e++){let t=e*o;if(i===tJ)break;let n=Number(i&a);if(i>>=l,n>o&&(n-=c,i+=tY),0===n)continue;let h=r[t+Math.abs(n)-1];n<0&&(h=h.negate()),s=s.add(h)}return s},getPrecomputes(e,t,r){let i=tX.get(t);return i||(i=this.precomputeWindow(t,e),1!==e&&tX.set(t,r(i))),i},wNAFCached(e,t,r){let i=t1(e);return this.wNAF(i,this.getPrecomputes(i,e,r),t)},wNAFCachedUnsafe(e,t,r,i){let s=t1(e);return 1===s?this.unsafeLadder(e,t,i):this.wNAFUnsafe(s,this.getPrecomputes(s,e,r),t,i)},setWindowSize(e,r){tQ(r,t),t0.set(e,r),tX.delete(e)}});function C(e){let t=i.BYTES;e=tN("private key",e,t);let r=tN("hashed private key",o(e),2*t),n=f(r.slice(0,t)),a=r.slice(t,2*t),c=tq(t_(n),s),l=E.multiply(c),h=l.toRawBytes();return{head:n,prefix:a,scalar:c,point:l,pointBytes:h}}function S(e=new Uint8Array,...t){return tq(t_(o(g(tA(...t),tN("context",e),!!n))),s)}return E._setWindowSize(8),{CURVE:r,getPublicKey:function(e){return C(e).pointBytes},sign:function(e,t,r={}){e=tN("message",e),n&&(e=n(e));let{prefix:o,scalar:a,pointBytes:c}=C(t),l=S(r.context,o,e),h=E.multiply(l).toRawBytes(),u=tq(l+S(r.context,h,c,e)*a,s);return tM("signature.s",u,t2,s),tN("result",tA(h,tS(u,i.BYTES)),2*i.BYTES)},verify:function(e,t,r,s=t8){let o,a,c;let{context:l,zip215:h}=s,u=i.BYTES;e=tN("signature",e,2*u),t=tN("message",t),r=tN("publicKey",r,u),void 0!==h&&tm("zip215",h),n&&(t=n(t));let d=t_(e.slice(u,2*u));try{o=v.fromHex(r,h),a=v.fromHex(e.slice(0,u),h),c=E.multiplyUnsafe(d)}catch{return!1}if(!h&&o.isSmallOrder())return!1;let p=S(l,a.toRawBytes(),o.toRawBytes(),t);return a.add(o.multiplyUnsafe(p)).subtract(c).clearCofactor().equals(v.ZERO)},ExtendedPoint:v,utils:{getExtendedPublicKey:C,randomPrivateKey:()=>a(i.BYTES),precompute:(e=8,t=v.BASE)=>(t._setWindowSize(e),t.multiply(BigInt(3)),t)}}}({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:ri,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:rr,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:th,randomBytes:te,adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},uvRatio:function(e,t){let r=tq(t*t*t,t6),i=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%t6*e%t6,o=tB(n,re,t6)*n%t6,a=tB(o,t7,t6)*e%t6,c=tB(a,rt,t6)*a%t6,l=tB(c,t,t6)*c%t6,h=tB(l,r,t6)*l%t6,u=tB(h,i,t6)*h%t6,d=tB(u,s,t6)*u%t6,p=tB(d,s,t6)*u%t6,f=tB(p,t,t6)*c%t6;return{pow_p_5_8:tB(f,re,t6)*e%t6,b2:n}}(e*tq(r*r*t,t6)).pow_p_5_8,s=tq(e*r*i,t6),n=tq(t*s*s,t6),o=s,a=tq(s*t9,t6),c=n===e,l=n===tq(-e,t6),h=n===tq(-e*t9,t6);return c&&(s=o),(l||h)&&(s=a),tH(s,t6)&&(s=tq(-s,t6)),{isValid:c||l,value:s}}}),rn="base64url",ro="utf8",ra="utf8",rc="base58btc";function rl(e){return null!=globalThis.Buffer?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e}function rh(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?rl(globalThis.Buffer.allocUnsafe(e)):new Uint8Array(e)}function ru(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=rh(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return rl(r)}var rd=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===c;)i++,t++;for(var n=(e.length-t)*l+1>>>0,o=new Uint8Array(n);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=n-1;(0!==h||u<s)&&-1!==d;d--,u++)h+=a*o[d]>>>0,o[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===o[p];)p++;for(var f=new Uint8Array(i+(n-p)),g=i;p!==n;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*h+1>>>0,l=new Uint8Array(o);s!==n;){for(var u=t[s],d=0,p=o-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*l[p]>>>0,l[p]=u%a>>>0,u=u/a>>>0;if(0!==u)throw Error("Non-zero carry");i=d,s++}for(var f=o-i;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw Error(`Non-${t} character`)}}};let rp=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},rf=e=>new TextEncoder().encode(e),rg=e=>new TextDecoder().decode(e);class rm{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ry{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return rw(this,e)}}class rb{constructor(e){this.decoders=e}or(e){return rw(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let rw=(e,t)=>new rb({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class rv{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new rm(e,t,r),this.decoder=new ry(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let rE=({name:e,prefix:t,encode:r,decode:i})=>new rv(e,t,r,i),rI=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=rd(r,t);return rE({prefix:e,name:t,encode:i,decode:e=>rp(s(e))})},r_=(e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);c=c<<r|n,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},rC=(e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n},rS=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>rE({prefix:t,name:e,encode:e=>rC(e,i,r),decode:t=>r_(t,i,r,e)});var rN=Object.freeze({__proto__:null,identity:rE({prefix:"\0",name:"identity",encode:e=>rg(e),decode:e=>rf(e)})}),rA=Object.freeze({__proto__:null,base2:rS({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),rO=Object.freeze({__proto__:null,base8:rS({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),rM=Object.freeze({__proto__:null,base10:rI({prefix:"9",name:"base10",alphabet:"0123456789"})}),rP=Object.freeze({__proto__:null,base16:rS({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:rS({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let rx=rS({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),rT=rS({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),rD=rS({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),rR=rS({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rk=rS({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),rj=rS({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});var rL=Object.freeze({__proto__:null,base32:rx,base32upper:rT,base32pad:rD,base32padupper:rR,base32hex:rk,base32hexupper:rj,base32hexpad:rS({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:rS({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:rS({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),rU=Object.freeze({__proto__:null,base36:rI({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:rI({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),rz=Object.freeze({__proto__:null,base58btc:rI({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:rI({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let r$=rS({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});var rq=Object.freeze({__proto__:null,base64:r$,base64pad:rS({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:rS({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:rS({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let rB=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),rW=rB.reduce((e,t,r)=>(e[r]=t,e),[]),rH=rB.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var rF=Object.freeze({__proto__:null,base256emoji:rE({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=rW[t],"")},decode:function(e){let t=[];for(let r of e){let e=rH[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function rV(e,t){var r,i=0,t=t||0,s=0,n=t,o=e.length;do{if(n>=o)throw rV.bytes=0,RangeError("Could not decode varint");r=e[n++],i+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128);return rV.bytes=n-t,i}var rK=function e(t,r,i){r=r||[],i=i||0;for(var s=i;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-s+1,r};let rJ=(e,t,r=0)=>(rK(e,t,r),t),rY=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,rG=(e,t)=>{let r=t.byteLength,i=rY(e),s=i+rY(r),n=new Uint8Array(s+r);return rJ(e,n,0),rJ(r,n,i),n.set(t,s),new rQ(e,r,t,n)};class rQ{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let rZ=({name:e,code:t,encode:r})=>new rX(e,t,r);class rX{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?rG(this.code,t):t.then(e=>rG(this.code,e))}throw Error("Unknown type, must be binary type")}}let r0=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var r1=Object.freeze({__proto__:null,sha256:rZ({name:"sha2-256",code:18,encode:r0("SHA-256")}),sha512:rZ({name:"sha2-512",code:19,encode:r0("SHA-512")})}),r2=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:rp,digest:e=>rG(0,rp(e))}});new TextEncoder,new TextDecoder;let r3={...rN,...rA,...rO,...rM,...rP,...rL,...rU,...rz,...rq,...rF};function r5(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...r1,...r2});let r4=r5("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),r8=r5("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=rh((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),r6={utf8:r4,"utf-8":r4,hex:r3.base16,latin1:r8,ascii:r8,binary:r8,...r3};function r9(e,t="utf8"){let r=r6[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function r7(e,t="utf8"){let r=r6[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?rl(globalThis.Buffer.from(e,"utf-8")):r.decoder.decode(`${r.prefix}${e}`)}function ie(e){return(0,eP.D)(r9(r7(e,rn),ro))}function it(e){return r9(r7((0,eP.u)(e),ro),rn)}function ir(e){return["did","key","z"+r9(ru([r7("K36",rc),e]),rc)].join(":")}function ii(e){let t=e.split("."),r=ie(t[0]);return{header:r,payload:ie(t[1]),signature:r7(t[2],rn),data:r7(t.slice(0,2).join("."),ra)}}function is(e=te(32)){let t=rs.getPublicKey(e);return{secretKey:ru([e,t]),publicKey:t}}async function io(e,t,r,i,s=(0,er.fromMiliseconds)(Date.now())){var n,o;let a={alg:"EdDSA",typ:"JWT"},c={iss:ir(i.publicKey),sub:e,aud:t,iat:s,exp:s+r},l=r7([it((n={header:a,payload:c}).header),it(n.payload)].join("."),ra);return[it((o={header:a,payload:c,signature:rs.sign(l,i.secretKey.slice(0,32))}).header),it(o.payload),r9(o.signature,rn)].join(".")}var ia=r(25566),ic=function(e,t,r){if(r||2==arguments.length)for(var i,s=0,n=t.length;s<n;s++)!i&&s in t||(i||(i=Array.prototype.slice.call(t,0,s)),i[s]=t[s]);return e.concat(i||Array.prototype.slice.call(t))},il=function(e,t,r){this.name=e,this.version=t,this.os=r,this.type="browser"},ih=function(e){this.version=e,this.type="node",this.name="node",this.os=ia.platform},iu=function(e,t,r,i){this.name=e,this.version=t,this.os=r,this.bot=i,this.type="bot-device"},id=function(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null},ip=function(){this.type="react-native",this.name="react-native",this.version=null,this.os=null},ig=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,im=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]],iy=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function ib(e){return e?iw(e):"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product?new ip:"undefined"!=typeof navigator?iw(navigator.userAgent):void 0!==ia&&ia.version?new ih(ia.version.slice(1)):null}function iw(e){var t=""!==e&&im.reduce(function(t,r){var i=r[0],s=r[1];if(t)return t;var n=s.exec(e);return!!n&&[i,n]},!1);if(!t)return null;var r=t[0],i=t[1];if("searchbot"===r)return new id;var s=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);s?s.length<3&&(s=ic(ic([],s,!0),function(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}(3-s.length),!0)):s=[];var n=s.join("."),o=function(e){for(var t=0,r=iy.length;t<r;t++){var i=iy[t],s=i[0];if(i[1].exec(e))return s}return null}(e),a=ig.exec(e);return a&&a[1]?new iu(r,n,o,a[1]):new il(r,n,o)}var iv=r(76454),iE=r(3897);let iI="2.23.2",i_={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${iI}`};class iC extends Error{constructor(e,t={}){let r=t.cause instanceof iC?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof iC&&t.cause.docsPath||t.docsPath,s=i_.getDocsUrl?.({...t,docsPath:i});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...r?[`Details: ${r}`]:[],...i_.version?[`Version: ${i_.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=iI}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,r):r?null:t}(this,e)}}function iS(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}class iN extends iC{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function iA(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;let i=e.replace("0x","");if(i.length>2*r)throw new iN({size:Math.ceil(i.length/2),targetSize:r,type:"hex"});return`0x${i["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new iN({size:e.length,targetSize:r,type:"bytes"});let i=new Uint8Array(r);for(let s=0;s<r;s++){let n="right"===t;i[n?s:r-s-1]=e[n?s:e.length-s-1]}return i}(e,{dir:t,size:r})}class iO extends iC{constructor({max:e,min:t,signed:r,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${8*i}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class iM extends iC{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function iP(e){return iS(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function ix(e,{size:t}){if(iP(e)>t)throw new iM({givenSize:iP(e),maxSize:t})}function iT(e,t={}){let{signed:r}=t;t.size&&ix(e,{size:t.size});let i=BigInt(e);if(!r)return i;let s=(e.length-2)/2;return i<=(1n<<8n*BigInt(s)-1n)-1n?i:i-BigInt(`0x${"f".padStart(2*s,"f")}`)-1n}let iD=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function iR(e,t={}){return"number"==typeof e||"bigint"==typeof e?ij(e,t):"string"==typeof e?function(e,t={}){return ik(iL.encode(e),t)}(e,t):"boolean"==typeof e?function(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?(ix(r,{size:t.size}),iA(r,{size:t.size})):r}(e,t):ik(e,t)}function ik(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=iD[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(ix(i,{size:t.size}),iA(i,{dir:"right",size:t.size})):i}function ij(e,t={}){let r;let{signed:i,size:s}=t,n=BigInt(e);s?r=i?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let o="bigint"==typeof r&&i?-r-1n:0;if(r&&n>r||n<o){let t="bigint"==typeof e?"n":"";throw new iO({max:r?`${r}${t}`:void 0,min:`${o}${t}`,signed:i,size:s,value:`${e}${t}`})}let a=`0x${(i&&n<0?(1n<<BigInt(8*s))+BigInt(n):n).toString(16)}`;return s?iA(a,{size:s}):a}let iL=new TextEncoder,iU=new TextEncoder,iz={zero:48,nine:57,A:65,F:70,a:97,f:102};function i$(e){return e>=iz.zero&&e<=iz.nine?e-iz.zero:e>=iz.A&&e<=iz.F?e-(iz.A-10):e>=iz.a&&e<=iz.f?e-(iz.a-10):void 0}function iq(e,t={}){let r=e;t.size&&(ix(r,{size:t.size}),r=iA(r,{dir:"right",size:t.size}));let i=r.slice(2);i.length%2&&(i=`0${i}`);let s=i.length/2,n=new Uint8Array(s);for(let e=0,t=0;e<s;e++){let r=i$(i.charCodeAt(t++)),s=i$(i.charCodeAt(t++));if(void 0===r||void 0===s)throw new iC(`Invalid byte sequence ("${i[t-2]}${i[t-1]}" in "${i}").`);n[e]=16*r+s}return n}function iB(e,t={}){let r=iU.encode(e);return"number"==typeof t.size?(ix(r,{size:t.size}),iA(r,{dir:"right",size:t.size})):r}var iW=r(85689);let iH=BigInt(4294967296-1),iF=BigInt(32),iV=(e,t,r)=>e<<r|t>>>32-r,iK=(e,t,r)=>t<<r|e>>>32-r,iJ=(e,t,r)=>t<<r-32|e>>>64-r,iY=(e,t,r)=>e<<r-32|t>>>64-r;var iG=r(38043);let iQ=[],iZ=[],iX=[],i0=BigInt(0),i1=BigInt(1),i2=BigInt(2),i3=BigInt(7),i5=BigInt(256),i4=BigInt(113);for(let e=0,t=i1,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],iQ.push(2*(5*i+r)),iZ.push((e+1)*(e+2)/2%64);let s=i0;for(let e=0;e<7;e++)(t=(t<<i1^(t>>i3)*i4)%i5)&i2&&(s^=i1<<(i1<<BigInt(e))-i1);iX.push(s)}let[i8,i6]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:o}=function(e,t=!1){return t?{h:Number(e&iH),l:Number(e>>iF&iH)}:{h:0|Number(e>>iF&iH),l:0|Number(e&iH)}}(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]}(iX,!0),i9=(e,t,r)=>r>32?iJ(e,t,r):iV(e,t,r),i7=(e,t,r)=>r>32?iY(e,t,r):iK(e,t,r);class se extends iG.kb{constructor(e,t,r,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,iW.k8)(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,iG.Jq)(this.state)}keccak(){iG.iA||(0,iG.l1)(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],o=r[s+1],a=i9(n,o,1)^r[i],c=i7(n,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=iZ[r],n=i9(t,s,i),o=i7(t,s,i),a=iQ[r];t=e[a],s=e[a+1],e[a]=n,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=i8[i],e[1]^=i6[i]}r.fill(0)}(this.state32,this.rounds),iG.iA||(0,iG.l1)(this.state32),this.posOut=0,this.pos=0}update(e){(0,iW.$h)(this);let{blockLen:t,state:r}=this,i=(e=(0,iG.O0)(e)).length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,iW.$h)(this,!1),(0,iW.gk)(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,iW.k8)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,iW.eB)(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new se(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}let st=(0,iG.hE)(()=>new se(136,1,32));function sr(e,t){let r=st(iS(e,{strict:!1})?function(e,t={}){return"number"==typeof e||"bigint"==typeof e?iq(ij(e,t)):"boolean"==typeof e?function(e,t={}){let r=new Uint8Array(1);return(r[0]=Number(e),"number"==typeof t.size)?(ix(r,{size:t.size}),iA(r,{size:t.size})):r}(e,t):iS(e)?iq(e,t):iB(e,t)}(e):e);return"bytes"===(t||"hex")?r:iR(r)}class si extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let ss=new si(8192);async function sn({hash:e,signature:t}){let i=iS(e)?e:iR(e),{secp256k1:s}=await r.e(2851).then(r.bind(r,72851)),n=(()=>{if("object"==typeof t&&"r"in t&&"s"in t){let{r:e,s:r,v:i,yParity:n}=t,o=so(Number(n??i));return new s.Signature(iT(e),iT(r)).addRecoveryBit(o)}let e=iS(t)?t:iR(t),r=so(function(e,t={}){return Number(iT(e,t))}(`0x${e.slice(130)}`));return s.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(r)})().recoverPublicKey(i.substring(2)).toHex(!1);return`0x${n}`}function so(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw Error("Invalid yParityOrV value")}async function sa({hash:e,signature:t}){return function(e){let t=sr(`0x${e.substring(4)}`).substring(26);return function(e,t){if(ss.has(`${e}.undefined`))return ss.get(`${e}.undefined`);let r=e.substring(2).toLowerCase(),i=sr(iB(r),"bytes"),s=(t?r.substring(`${t}0x`.length):r).split("");for(let e=0;e<40;e+=2)i[e>>1]>>4>=8&&s[e]&&(s[e]=s[e].toUpperCase()),(15&i[e>>1])>=8&&s[e+1]&&(s[e+1]=s[e+1].toUpperCase());let n=`0x${s.join("")}`;return ss.set(`${e}.${t}`,n),n}(`0x${t}`)}(await sn({hash:e,signature:t}))}function sc(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function sl(e,t){t||(t=e.reduce((e,t)=>e+t.length,0));let r=sc(t),i=0;for(let t of e)r.set(t,i),i+=t.length;return r}var sh=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===c;)i++,t++;for(var n=(e.length-t)*l+1>>>0,o=new Uint8Array(n);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=n-1;(0!==h||u<s)&&-1!==d;d--,u++)h+=a*o[d]>>>0,o[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===o[p];)p++;for(var f=new Uint8Array(i+(n-p)),g=i;p!==n;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*h+1>>>0,l=new Uint8Array(o);s!==n;){for(var u=t[s],d=0,p=o-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*l[p]>>>0,l[p]=u%a>>>0,u=u/a>>>0;if(0!==u)throw Error("Non-zero carry");i=d,s++}for(var f=o-i;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw Error(`Non-${t} character`)}}};new Uint8Array(0);let su=(e,t)=>{if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0},sd=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},sp=e=>new TextEncoder().encode(e),sf=e=>new TextDecoder().decode(e);class sg{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class sm{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return sb(this,e)}}class sy{constructor(e){this.decoders=e}or(e){return sb(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let sb=(e,t)=>new sy({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class sw{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new sg(e,t,r),this.decoder=new sm(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let sv=({name:e,prefix:t,encode:r,decode:i})=>new sw(e,t,r,i),sE=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=sh(r,t);return sv({prefix:e,name:t,encode:i,decode:e=>sd(s(e))})},sI=(e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);c=c<<r|n,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},s_=(e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n},sC=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>sv({prefix:t,name:e,encode:e=>s_(e,i,r),decode:t=>sI(t,i,r,e)}),sS=sv({prefix:"\0",name:"identity",encode:e=>sf(e),decode:e=>sp(e)}),sN=sC({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),sA=sC({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),sO=sE({prefix:"9",name:"base10",alphabet:"0123456789"}),sM=sC({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),sP=sC({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),sx=sC({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),sT=sC({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),sD=sC({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),sR=sC({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),sk=sC({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),sj=sC({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sL=sC({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),sU=sC({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),sz=sC({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),s$=sE({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),sq=sE({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),sB=sE({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),sW=sE({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),sH=sC({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sF=sC({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),sV=sC({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),sK=sC({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),sJ=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),sY=sJ.reduce((e,t,r)=>(e[r]=t,e),[]),sG=sJ.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]),sQ=sv({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=sY[t],"")},decode:function(e){let t=[];for(let r of e){let e=sG[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}});var sZ=function e(t,r,i){r=r||[];for(var s=i=i||0;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-s+1,r},sX=function e(t,r){var i,s=0,r=r||0,n=0,o=r,a=t.length;do{if(o>=a)throw e.bytes=0,RangeError("Could not decode varint");i=t[o++],s+=n<28?(127&i)<<n:(127&i)*Math.pow(2,n),n+=7}while(i>=128);return e.bytes=o-r,s};let s0=(e,t=0)=>[sX(e,t),sX.bytes],s1=(e,t,r=0)=>(sZ(e,t,r),t),s2=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,s3=(e,t)=>{let r=t.byteLength,i=s2(e),s=i+s2(r),n=new Uint8Array(s+r);return s1(e,n,0),s1(r,n,i),n.set(t,s),new s8(e,r,t,n)},s5=e=>{let t=sd(e),[r,i]=s0(t),[s,n]=s0(t.subarray(i)),o=t.subarray(i+n);if(o.byteLength!==s)throw Error("Incorrect length");return new s8(r,s,o,t)},s4=(e,t)=>e===t||e.code===t.code&&e.size===t.size&&su(e.bytes,t.bytes);class s8{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let s6=({name:e,code:t,encode:r})=>new s9(e,t,r);class s9{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?s3(this.code,t):t.then(e=>s3(this.code,e))}throw Error("Unknown type, must be binary type")}}let s7=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),ne=s6({name:"sha2-256",code:18,encode:s7("SHA-256")}),nt=s6({name:"sha2-512",code:19,encode:s7("SHA-512")}),nr={code:0,name:"identity",encode:sd,digest:e=>s3(0,sd(e))},ni="raw",ns=85,nn=e=>sd(e),no=e=>sd(e),na=new TextEncoder,nc=new TextDecoder,nl="json",nh=512,nu=e=>na.encode(JSON.stringify(e)),nd=e=>JSON.parse(nc.decode(e));class np{constructor(e,t,r,i){this.code=t,this.version=e,this.multihash=r,this.bytes=i,this.byteOffset=i.byteOffset,this.byteLength=i.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:nI,byteLength:nI,code:nE,version:nE,multihash:nE,bytes:nE,_baseCache:nI,asCID:nI})}toV0(){if(0===this.version)return this;{let{code:e,multihash:t}=this;if(e!==ny)throw Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==nb)throw Error("Cannot convert non sha2-256 multihash CID to CIDv0");return np.createV0(t)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,r=s3(e,t);return np.createV1(this.code,r)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(e){return e&&this.code===e.code&&this.version===e.version&&s4(this.multihash,e.multihash)}toString(e){let{bytes:t,version:r,_baseCache:i}=this;return 0===r?ng(t,i,e||sB.encoder):nm(t,i,e||sx.encoder)}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(e){return n_(/^0\.0/,nC),!!(e&&(e[nv]||e.asCID===e))}get toBaseEncodedString(){throw Error("Deprecated, use .toString()")}get codec(){throw Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw Error('"multibaseName" property is deprecated')}get prefix(){throw Error('"prefix" property is deprecated')}static asCID(e){if(e instanceof np)return e;if(null!=e&&e.asCID===e){let{version:t,code:r,multihash:i,bytes:s}=e;return new np(t,r,i,s||nw(t,r,i.bytes))}if(null==e||!0!==e[nv])return null;{let{version:t,multihash:r,code:i}=e,s=s5(r);return np.create(t,i,s)}}static create(e,t,r){if("number"!=typeof t)throw Error("String codecs are no longer supported");switch(e){case 0:if(t===ny)return new np(e,t,r,r.bytes);throw Error(`Version 0 CID must use dag-pb (code: ${ny}) block encoding`);case 1:{let i=nw(e,t,r.bytes);return new np(e,t,r,i)}default:throw Error("Invalid version")}}static createV0(e){return np.create(0,ny,e)}static createV1(e,t){return np.create(1,e,t)}static decode(e){let[t,r]=np.decodeFirst(e);if(r.length)throw Error("Incorrect length");return t}static decodeFirst(e){let t=np.inspectBytes(e),r=t.size-t.multihashSize,i=sd(e.subarray(r,r+t.multihashSize));if(i.byteLength!==t.multihashSize)throw Error("Incorrect length");let s=i.subarray(t.multihashSize-t.digestSize),n=new s8(t.multihashCode,t.digestSize,s,i);return[0===t.version?np.createV0(n):np.createV1(t.codec,n),e.subarray(t.size)]}static inspectBytes(e){let t=0,r=()=>{let[r,i]=s0(e.subarray(t));return t+=i,r},i=r(),s=ny;if(18===i?(i=0,t=0):1===i&&(s=r()),0!==i&&1!==i)throw RangeError(`Invalid CID version ${i}`);let n=t,o=r(),a=r(),c=t+a;return{version:i,codec:s,multihashCode:o,digestSize:a,multihashSize:c-n,size:c}}static parse(e,t){let[r,i]=nf(e,t),s=np.decode(i);return s._baseCache.set(r,e),s}}let nf=(e,t)=>{switch(e[0]){case"Q":return[sB.prefix,(t||sB).decode(`${sB.prefix}${e}`)];case sB.prefix:return[sB.prefix,(t||sB).decode(e)];case sx.prefix:return[sx.prefix,(t||sx).decode(e)];default:if(null==t)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}},ng=(e,t,r)=>{let{prefix:i}=r;if(i!==sB.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let s=t.get(i);if(null!=s)return s;{let s=r.encode(e).slice(1);return t.set(i,s),s}},nm=(e,t,r)=>{let{prefix:i}=r,s=t.get(i);if(null!=s)return s;{let s=r.encode(e);return t.set(i,s),s}},ny=112,nb=18,nw=(e,t,r)=>{let i=s2(e),s=i+s2(t),n=new Uint8Array(s+r.byteLength);return s1(e,n,0),s1(t,n,i),n.set(r,s),n},nv=Symbol.for("@ipld/js-cid/CID"),nE={writable:!1,configurable:!1,enumerable:!0},nI={writable:!1,enumerable:!1,configurable:!1},n_=(e,t)=>{if(e.test("0.0.0-dev"))console.warn(t);else throw Error(t)},nC=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`,nS={...D,...R,...k,...j,...L,...U,...z,...$,...q,...B};function nN(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...W,...H});let nA=nN("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),nO=nN("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=sc((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),nM={utf8:nA,"utf-8":nA,hex:nS.base16,latin1:nO,ascii:nO,binary:nO,...nS};function nP(e,t="utf8"){let r=nM[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function nx(e,t="utf8"){let r=nM[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}var nT=r(61984);let nD={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var nR=r(25566),nk=r(82957).Buffer;function nj(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function nL(e,t){return e.includes(":")?[e]:t.chains||[]}let nU={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function nz(){return"u">typeof nR&&"u">typeof nR.versions&&"u">typeof nR.versions.node}function n$(){return!(0,iv.getDocument)()&&!!(0,iv.getNavigator)()&&"ReactNative"===navigator.product}function nq(){return!nz()&&!!(0,iv.getNavigator)()&&!!(0,iv.getDocument)()}function nB(){return n$()?nU.reactNative:nz()?nU.node:nq()?nU.browser:nU.unknown}function nW(){var e;try{return n$()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Application)?null==(e=r.g.Application)?void 0:e.applicationId:void 0}catch{return}}function nH(){return(0,iE.D)()||{name:"",description:"",url:"",icons:[""]}}function nF(e,t,i){let s=function(){if(nB()===nU.reactNative&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)){let{OS:e,Version:t}=r.g.Platform;return[e,t].join("-")}let e=ib();if(null===e)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),n=function(){var e;let t=nB();return t===nU.browser?[t,(null==(e=(0,iv.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),["js",i].join("-"),s,n].join("/")}function nV(e,t){return e.filter(e=>t.includes(e)).length===e.length}function nK(e){return Object.fromEntries(e.entries())}function nJ(e){return new Map(Object.entries(e))}function nY(e=er.FIVE_MINUTES,t){let r,i,s,n;let o=(0,er.toMiliseconds)(e||er.FIVE_MINUTES);return{resolve:e=>{s&&r&&(clearTimeout(s),r(e),n=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,a)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(t);n=Promise.reject(e),a(e)},o),r=e,i=a})}}function nG(e,t,r){return new Promise(async(i,s)=>{let n=setTimeout(()=>s(Error(r)),t);try{let t=await e;i(t)}catch(e){s(e)}clearTimeout(n)})}function nQ(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function nZ(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function nX(e,t){return(0,er.fromMiliseconds)((t||Date.now())+(0,er.toMiliseconds)(e))}function n0(e){return Date.now()>=(0,er.toMiliseconds)(e)}function n1(e,t){return`${e}${t?`:${t}`:""}`}function n2(e=[],t=[]){return[...new Set([...e,...t])]}async function n3({id:e,topic:t,wcDeepLink:i}){var s;try{if(!i)return;let n="string"==typeof i?JSON.parse(i):i,o=n?.href;if("string"!=typeof o)return;let a=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let r=nk.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else s=`${s}/wc?${i}`;return s}(o,e,t),c=nB();if(c===nU.browser){let e;if(!(null!=(s=(0,iv.getDocument)())&&s.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}e="_self",function(){try{return window.self!==window.top}catch{return!1}}()?e="_top":("u">typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||a.startsWith("https://")||a.startsWith("http://"))&&(e="_blank"),window.open(a,e,"noreferrer noopener")}else c===nU.reactNative&&"u">typeof(null==r.g?void 0:r.g.Linking)&&await r.g.Linking.openURL(a)}catch(e){console.error(e)}}async function n5(e,t){let r="";try{if(nq()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function n4(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function n8(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function n6(){return"u">typeof nR&&"true"===nR.env.IS_VITEST}function n9(e){return nk.from(e,"base64").toString("utf-8")}function n7(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function oe(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function ot(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");n7(e.outputLen),n7(e.blockLen)}function or(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function oi(e,t){oe(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let os=BigInt(4294967296-1),on=BigInt(32),oo=(e,t,r)=>e<<r|t>>>32-r,oa=(e,t,r)=>t<<r|e>>>32-r,oc=(e,t,r)=>t<<r-32|e>>>64-r,ol=(e,t,r)=>e<<r-32|t>>>64-r,oh="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function ou(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function od(e,t){return e<<32-t|e>>>t}let op=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function of(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}}function og(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),oe(e),e}class om{clone(){return this._cloneInto()}}function oy(e){let t=t=>e().update(og(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function ob(e=32){if(oh&&"function"==typeof oh.getRandomValues)return oh.getRandomValues(new Uint8Array(e));if(oh&&"function"==typeof oh.randomBytes)return oh.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let ow=[],ov=[],oE=[],oI=BigInt(0),o_=BigInt(1),oC=BigInt(2),oS=BigInt(7),oN=BigInt(256),oA=BigInt(113);for(let e=0,t=o_,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],ow.push(2*(5*i+r)),ov.push((e+1)*(e+2)/2%64);let s=oI;for(let e=0;e<7;e++)(t=(t<<o_^(t>>oS)*oA)%oN)&oC&&(s^=o_<<(o_<<BigInt(e))-o_);oE.push(s)}let[oO,oM]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:o}=function(e,t=!1){return t?{h:Number(e&os),l:Number(e>>on&os)}:{h:0|Number(e>>on&os),l:0|Number(e&os)}}(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]}(oE,!0),oP=(e,t,r)=>r>32?oc(e,t,r):oo(e,t,r),ox=(e,t,r)=>r>32?ol(e,t,r):oa(e,t,r);class oT extends om{constructor(e,t,r,i=!1,s=24){var n;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,n7(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=new Uint32Array((n=this.state).buffer,n.byteOffset,Math.floor(n.byteLength/4))}keccak(){op||of(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],o=r[s+1],a=oP(n,o,1)^r[i],c=ox(n,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=ov[r],n=oP(t,s,i),o=ox(t,s,i),a=ow[r];t=e[a],s=e[a+1],e[a]=n,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=oO[i],e[1]^=oM[i]}r.fill(0)}(this.state32,this.rounds),op||of(this.state32),this.posOut=0,this.pos=0}update(e){or(this);let{blockLen:t,state:r}=this,i=(e=og(e)).length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){or(this,!1),oe(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return n7(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(oi(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new oT(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}let oD=oy(()=>new oT(136,1,32));function oR(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+nk.from(oD(r)).toString("hex")}async function ok(e,t,r,i,s,n){switch(r.t){case"eip191":return await oj(e,t,r.s);case"eip1271":return await oL(e,t,r.s,i,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function oj(e,t,r){return(await sa({hash:oR(t),signature:r})).toLowerCase()===e.toLowerCase()}async function oL(e,t,r,i,s,n){let o=nj(i);if(!o.namespace||!o.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let o="0x1626ba7e",a=r.substring(2),c=oR(t).substring(2),l=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:o+c+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+a},"latest"]})}),{result:h}=await l.json();return!!h&&h.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}var oU=Object.defineProperty,oz=Object.defineProperties,o$=Object.getOwnPropertyDescriptors,oq=Object.getOwnPropertySymbols,oB=Object.prototype.hasOwnProperty,oW=Object.prototype.propertyIsEnumerable,oH=(e,t,r)=>t in e?oU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,oF=(e,t)=>{for(var r in t||(t={}))oB.call(t,r)&&oH(e,r,t[r]);if(oq)for(var r of oq(t))oW.call(t,r)&&oH(e,r,t[r]);return e},oV=(e,t)=>oz(e,o$(t));let oK=e=>e?.split(":"),oJ=e=>{let t=e&&oK(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]},oY=e=>{let t=e&&oK(e);if(t)return t[2]+":"+t[3]},oG=e=>{let t=e&&oK(e);if(t)return t.pop()};async function oQ(e){let{cacao:t,projectId:r}=e,{s:i,p:s}=t,n=oZ(s,s.iss),o=oG(s.iss);return await ok(o,n,i,oY(s.iss),r)}let oZ=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=oG(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${oJ(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,h=e.exp?`Expiration Time: ${e.exp}`:void 0,u=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,f=o5(e.resources);return f&&(s=function(e="",t){oX(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],s=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let n={};r.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let o=Object.keys(n).map(t=>(s++,`(${s}) '${t}': '${n[t].join("', '")}' for '${e}'.`));i.push(o.join(", ").replace(".,","."))});let n=i.join(" "),o=`${r}${n}`;return`${e?e+" ":""}${o}`}(s,o1(f))),[r,i,"",s,"",n,o,a,c,l,h,u,d,p].filter(e=>null!=e).join(`
`)};function oX(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function o0(e){return oX(e),`urn:recap:${nk.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function o1(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(nk.from(t,"base64").toString("utf-8")));return oX(r),r}function o2(e){var t;let r=o1(e);oX(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function o3(e){let t=o1(e);oX(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function o5(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}function o4(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function o8(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function o6(e,...t){if(!o8(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function o9(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function o7(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}let ae=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),at=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw Error("Non little-endian hardware is not supported");function ar(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(o8(e))e=an(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function ai(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function as(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),a=Number(r&n),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)}function an(e){return Uint8Array.from(e)}function ao(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let aa=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),ac=aa("expand 16-byte k"),al=aa("expand 32-byte k"),ah=ae(ac),au=ae(al);function ad(e,t){return e<<t|e>>>32-t}function ap(e){return e.byteOffset%4==0}let af=4294967296-1,ag=new Uint32Array,am=(e,t)=>255&e[t++]|(255&e[t++])<<8;class ay{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,o6(e=ar(e),32);let t=am(e,0),r=am(e,2),i=am(e,4),s=am(e,6),n=am(e,8),o=am(e,10),a=am(e,12),c=am(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|o<<2)&8191,this.r[7]=(o>>>11|a<<5)&8065,this.r[8]=(a>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=am(e,16+2*t)}process(e,t,r=!1){let{h:i,r:s}=this,n=s[0],o=s[1],a=s[2],c=s[3],l=s[4],h=s[5],u=s[6],d=s[7],p=s[8],f=s[9],g=am(e,t+0),m=am(e,t+2),y=am(e,t+4),b=am(e,t+6),w=am(e,t+8),v=am(e,t+10),E=am(e,t+12),I=am(e,t+14),_=i[0]+(8191&g),C=i[1]+((g>>>13|m<<3)&8191),S=i[2]+((m>>>10|y<<6)&8191),N=i[3]+((y>>>7|b<<9)&8191),A=i[4]+((b>>>4|w<<12)&8191),O=i[5]+(w>>>1&8191),M=i[6]+((w>>>14|v<<2)&8191),P=i[7]+((v>>>11|E<<5)&8191),x=i[8]+((E>>>8|I<<8)&8191),T=i[9]+(I>>>5|(r?0:2048)),D=0,R=0+_*n+5*f*C+5*p*S+5*d*N+5*u*A;D=R>>>13,R&=8191,R+=5*h*O+5*l*M+5*c*P+5*a*x+5*o*T,D+=R>>>13,R&=8191;let k=D+_*o+C*n+5*f*S+5*p*N+5*d*A;D=k>>>13,k&=8191,k+=5*u*O+5*h*M+5*l*P+5*c*x+5*a*T,D+=k>>>13,k&=8191;let j=D+_*a+C*o+S*n+5*f*N+5*p*A;D=j>>>13,j&=8191,j+=5*d*O+5*u*M+5*h*P+5*l*x+5*c*T,D+=j>>>13,j&=8191;let L=D+_*c+C*a+S*o+N*n+5*f*A;D=L>>>13,L&=8191,L+=5*p*O+5*d*M+5*u*P+5*h*x+5*l*T,D+=L>>>13,L&=8191;let U=D+_*l+C*c+S*a+N*o+A*n;D=U>>>13,U&=8191,U+=5*f*O+5*p*M+5*d*P+5*u*x+5*h*T,D+=U>>>13,U&=8191;let z=D+_*h+C*l+S*c+N*a+A*o;D=z>>>13,z&=8191,z+=O*n+5*f*M+5*p*P+5*d*x+5*u*T,D+=z>>>13,z&=8191;let $=D+_*u+C*h+S*l+N*c+A*a;D=$>>>13,$&=8191,$+=O*o+M*n+5*f*P+5*p*x+5*d*T,D+=$>>>13,$&=8191;let q=D+_*d+C*u+S*h+N*l+A*c;D=q>>>13,q&=8191,q+=O*a+M*o+P*n+5*f*x+5*p*T,D+=q>>>13,q&=8191;let B=D+_*p+C*d+S*u+N*h+A*l;D=B>>>13,B&=8191,B+=O*c+M*a+P*o+x*n+5*f*T,D+=B>>>13,B&=8191;let W=D+_*f+C*p+S*d+N*u+A*h;D=W>>>13,W&=8191,W+=O*l+M*c+P*a+x*o+T*n,D+=W>>>13,W&=8191,R=8191&(D=(D=(D<<2)+D|0)+R|0),D>>>=13,k+=D,i[0]=R,i[1]=k,i[2]=j,i[3]=L,i[4]=U,i[5]=z,i[6]=$,i[7]=q,i[8]=B,i[9]=W}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let s=(1^i)-1;for(let e=0;e<10;e++)r[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let r=1;r<8;r++)n=(e[r]+t[r]|0)+(n>>>16)|0,e[r]=65535&n;ao(r)}update(e){o9(this);let{buffer:t,blockLen:r}=this,i=(e=ar(e)).length;for(let s=0;s<i;){let n=Math.min(r-this.pos,i-s);if(n===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){ao(this.h,this.r,this.buffer,this.pad)}digestInto(e){o9(this),function(e,t){o6(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=r[t]>>>0,e[s++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let ab=function(e){let t=(t,r)=>e(r).update(ar(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new ay(e)),aw=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:s,counterRight:n,rounds:o}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return o4(s),o4(o),o7(n),o7(r),(t,a,c,l,h=0)=>{o6(t),o6(a),o6(c);let u=c.length;if(void 0===l&&(l=new Uint8Array(u)),o6(l),o4(h),h<0||h>=af)throw Error("arx: counter overflow");if(l.length<u)throw Error(`arx: output (${l.length}) is shorter than data (${u})`);let d=[],p=t.length,f,g;if(32===p)d.push(f=an(t)),g=au;else if(16===p&&r)(f=new Uint8Array(32)).set(t),f.set(t,16),g=ah,d.push(f);else throw Error(`arx: invalid 32-byte key, got length=${p}`);ap(a)||d.push(a=an(a));let m=ae(f);if(i){if(24!==a.length)throw Error("arx: extended nonce must be 24 bytes");i(g,m,ae(a.subarray(0,16)),m),a=a.subarray(16)}let y=16-s;if(y!==a.length)throw Error(`arx: nonce must be ${y} or 16 bytes`);if(12!==y){let e=new Uint8Array(12);e.set(a,n?0:12-a.length),a=e,d.push(a)}return function(e,t,r,i,s,n,o,a){let c=s.length,l=new Uint8Array(64),h=ae(l),u=ap(s)&&ap(n),d=u?ae(s):ag,p=u?ae(n):ag;for(let f=0;f<c;o++){if(e(t,r,i,h,o,a),o>=af)throw Error("arx: counter overflow");let g=Math.min(64,c-f);if(u&&64===g){let e=f/4;if(f%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)p[r=e+t]=d[r]^h[t];f+=64;continue}for(let e=0,t;e<g;e++)n[t=f+e]=s[t]^l[e];f+=g}}(e,g,m,ae(a),c,l,h,o),ao(...d),l}}(function(e,t,r,i,s,n=20){let o=e[0],a=e[1],c=e[2],l=e[3],h=t[0],u=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],y=t[7],b=r[0],w=r[1],v=r[2],E=o,I=a,_=c,C=l,S=h,N=u,A=d,O=p,M=f,P=g,x=m,T=y,D=s,R=b,k=w,j=v;for(let e=0;e<n;e+=2)M=M+(D=ad(D^(E=E+S|0),16))|0,E=E+(S=ad(S^M,12))|0,M=M+(D=ad(D^E,8))|0,S=ad(S^M,7),P=P+(R=ad(R^(I=I+N|0),16))|0,I=I+(N=ad(N^P,12))|0,P=P+(R=ad(R^I,8))|0,N=ad(N^P,7),x=x+(k=ad(k^(_=_+A|0),16))|0,_=_+(A=ad(A^x,12))|0,x=x+(k=ad(k^_,8))|0,A=ad(A^x,7),T=T+(j=ad(j^(C=C+O|0),16))|0,C=C+(O=ad(O^T,12))|0,T=T+(j=ad(j^C,8))|0,O=ad(O^T,7),x=x+(j=ad(j^(E=E+N|0),16))|0,E=E+(N=ad(N^x,12))|0,x=x+(j=ad(j^E,8))|0,N=ad(N^x,7),T=T+(D=ad(D^(I=I+A|0),16))|0,I=I+(A=ad(A^T,12))|0,T=T+(D=ad(D^I,8))|0,A=ad(A^T,7),M=M+(R=ad(R^(_=_+O|0),16))|0,_=_+(O=ad(O^M,12))|0,M=M+(R=ad(R^_,8))|0,O=ad(O^M,7),P=P+(k=ad(k^(C=C+S|0),16))|0,C=C+(S=ad(S^P,12))|0,P=P+(k=ad(k^C,8))|0,S=ad(S^P,7);let L=0;i[L++]=o+E|0,i[L++]=a+I|0,i[L++]=c+_|0,i[L++]=l+C|0,i[L++]=h+S|0,i[L++]=u+N|0,i[L++]=d+A|0,i[L++]=p+O|0,i[L++]=f+M|0,i[L++]=g+P|0,i[L++]=m+x|0,i[L++]=y+T|0,i[L++]=s+D|0,i[L++]=b+R|0,i[L++]=w+k|0,i[L++]=v+j|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),av=new Uint8Array(16),aE=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(av.subarray(r))},aI=new Uint8Array(32);function a_(e,t,r,i,s){let n=e(t,r,aI),o=ab.create(n);s&&aE(o,s),aE(o,i);let a=new Uint8Array(16),c=at(a);as(c,0,BigInt(s?s.length:0),!0),as(c,8,BigInt(i.length),!0),o.update(a);let l=o.digest();return ao(n,a),l}let aC=((e,t)=>{function r(i,...s){if(o6(i),void 0!==e.nonceLength){let t=s[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?o6(t):o6(t,e.nonceLength)}let n=e.tagLength;n&&void 0!==s[1]&&o6(s[1]);let o=t(i,...s),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");o6(t)}},c=!1;return{encrypt(e,t){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,o6(e),a(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(o6(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return a(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e,t,r)=>({encrypt(i,s){let n=i.length;(s=ai(n+16,s,!1)).set(i);let o=s.subarray(0,-16);aw(e,t,o,o,1);let a=a_(aw,e,t,o,r);return s.set(a,n),ao(a),s},decrypt(i,s){s=ai(i.length-16,s,!1);let n=i.subarray(0,-16),o=i.subarray(-16),a=a_(aw,e,t,n,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(o,a))throw Error("invalid tag");return s.set(i.subarray(0,-16)),aw(e,t,s,s,1),ao(a),s}}));class aS extends om{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,ot(e);let r=og(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return or(this),this.iHash.update(e),this}digestInto(e){or(this),oe(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:n,outputLen:o}=this;return e.finished=i,e.destroyed=s,e.blockLen=n,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let aN=(e,t,r)=>new aS(e,t).update(r).digest();aN.create=(e,t)=>new aS(e,t);let aA=new Uint8Array([0]),aO=new Uint8Array,aM=(e,t,r,i,s)=>{var n;return function(e,t,r,i=32){if(ot(e),n7(i),i>255*e.outputLen)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(i/e.outputLen);void 0===r&&(r=aO);let n=new Uint8Array(s*e.outputLen),o=aN.create(e,t),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let t=0;t<s;t++)aA[0]=t+1,a.update(0===t?aO:c).update(r).update(aA).digestInto(c),n.set(c,e.outputLen*t),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),aA.fill(0),n.slice(0,i)}(e,(n=r,ot(e),void 0===n&&(n=new Uint8Array(e.outputLen)),aN(e,og(n),og(t))),i,s)};class aP extends om{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ou(this.buffer)}update(e){or(this);let{view:t,buffer:r,blockLen:i}=this,s=(e=og(e)).length;for(let n=0;n<s;){let o=Math.min(i-this.pos,s-n);if(o===i){let t=ou(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){or(this),oi(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),a=Number(r&n),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let o=ou(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=a/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=n,i%t&&e.buffer.set(r),e}}let ax=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),aT=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),aD=new Uint32Array(64);class aR extends aP{constructor(){super(64,32,8,!1),this.A=0|aT[0],this.B=0|aT[1],this.C=0|aT[2],this.D=0|aT[3],this.E=0|aT[4],this.F=0|aT[5],this.G=0|aT[6],this.H=0|aT[7]}get(){let{A:e,B:t,C:r,D:i,E:s,F:n,G:o,H:a}=this;return[e,t,r,i,s,n,o,a]}set(e,t,r,i,s,n,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|n,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)aD[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=aD[e-15],r=aD[e-2],i=od(t,7)^od(t,18)^t>>>3,s=od(r,17)^od(r,19)^r>>>10;aD[e]=s+aD[e-7]+i+aD[e-16]|0}let{A:r,B:i,C:s,D:n,E:o,F:a,G:c,H:l}=this;for(let e=0;e<64;e++){var h,u,d,p;let t=l+(od(o,6)^od(o,11)^od(o,25))+((h=o)&a^~h&c)+ax[e]+aD[e]|0,f=(od(r,2)^od(r,13)^od(r,22))+((u=r)&(d=i)^u&(p=s)^d&p)|0;l=c,c=a,a=o,o=n+t|0,n=s,s=i,i=r,r=t+f|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,i,s,n,o,a,c,l)}roundClean(){aD.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let ak=oy(()=>new aR),aj=BigInt(0);function aL(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function aU(e){if(!aL(e))throw Error("Uint8Array expected")}let az=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),a$={_0:48,_9:57,A:65,F:70,a:97,f:102};function aq(e){return e>=a$._0&&e<=a$._9?e-a$._0:e>=a$.A&&e<=a$.F?e-(a$.A-10):e>=a$.a&&e<=a$.f?e-(a$.a-10):void 0}function aB(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=aq(e.charCodeAt(s)),n=aq(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i}function aW(e){return aU(e),function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?aj:BigInt("0x"+e)}(function(e){aU(e);let t="";for(let r=0;r<e.length;r++)t+=az[e[r]];return t}(Uint8Array.from(e).reverse()))}function aH(e,t,r){let i;if("string"==typeof t)try{i=aB(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(aL(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}let aF=e=>"bigint"==typeof e&&aj<=e;function aV(e,t,r,i){if(!(aF(t)&&aF(r)&&aF(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let aK={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||aL(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)},aJ=BigInt(0),aY=BigInt(1);function aG(e,t){let r=e%t;return r>=aJ?r:t+r}function aQ(e,t,r){let i=e;for(;t-- >aJ;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);let aZ=BigInt(0),aX=BigInt(1),a0=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let a1=BigInt(1),a2=BigInt(2),a3=BigInt(3),a5=BigInt(5);BigInt(8);let a4=function(e){let t=(function(e,t,r={}){let i=(t,r,i)=>{let s=aK[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(i&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0)}(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})),{P:r}=t,i=e=>aG(e,r),s=t.montgomeryBits,n=Math.ceil(s/8),o=t.nByteLength,a=t.adjustScalarBytes||(e=>e),c=t.powPminus2||(e=>(function(e,t,r){if(t<aJ)throw Error("invalid exponent, negatives unsupported");if(r<=aJ)throw Error("invalid modulus");if(r===aY)return aJ;let i=aY;for(;t>aJ;)t&aY&&(i=i*e%r),e=e*e%r,t>>=aY;return i})(e,r-BigInt(2),r));function l(e,t,r){let s=i(e*(t-r));return[t=i(t-s),r=i(r+s)]}let h=(t.a-BigInt(2))/BigInt(4);function u(e){var t;return aB(i(e).toString(16).padStart(2*n,"0")).reverse()}function d(e,t){let d=function(e,t){aV("u",e,aZ,r),aV("scalar",t,aZ,r);let n=aX,o=aZ,a=e,u=aX,d=aZ,p;for(let r=BigInt(s-1);r>=aZ;r--){let s=t>>r&aX;d^=s,n=(p=l(d,n,a))[0],a=p[1],o=(p=l(d,o,u))[0],u=p[1],d=s;let c=n+o,f=i(c*c),g=n-o,m=i(g*g),y=f-m,b=a+u,w=i((a-u)*c),v=i(b*g),E=w+v,I=w-v;a=i(E*E),u=i(e*i(I*I)),n=i(f*m),o=i(y*(f+i(h*y)))}return n=(p=l(d,n,a))[0],a=p[1],o=(p=l(d,o,u))[0],u=p[1],i(n*c(o))}(function(e){let t=aH("u coordinate",e,n);return 32===o&&(t[31]&=127),aW(t)}(t),function(e){let t=aH("scalar",e),r=t.length;if(r!==n&&r!==o)throw Error("invalid scalar, expected "+n+" or "+o+" bytes, got "+r);return aW(a(t))}(e));if(d===aZ)throw Error("invalid private or public key received");return u(d)}let p=u(t.Gu);function f(e){return d(e,p)}return{scalarMult:d,scalarMultBase:f,getSharedSecret:(e,t)=>d(e,t),getPublicKey:e=>f(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:p}}({P:a0,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let{pow_p_5_8:t,b2:r}=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%a0*e%a0,o=aQ(n,a2,a0)*n%a0,a=aQ(o,a1,a0)*e%a0,c=aQ(a,a5,a0)*a%a0,l=aQ(c,t,a0)*c%a0,h=aQ(l,r,a0)*l%a0,u=aQ(h,i,a0)*h%a0,d=aQ(u,s,a0)*u%a0,p=aQ(d,s,a0)*u%a0,f=aQ(p,t,a0)*c%a0;return{pow_p_5_8:aQ(f,a2,a0)*e%a0,b2:n}}(e);return aG(aQ(t,a3,a0)*r,a0)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:ob}),a8="base10",a6="base16",a9="base64pad",a7="base64url",ce="utf8";function ct(){return nx(ob(32),a6)}function cr(e){return nx(ak(nP(e,a6)),a6)}function ci(e){return nx(ak(nP(e,ce)),a6)}function cs(e){return Number(nx(e,a8))}function cn(e){let{encoding:t=a9}=e;if(2===cs(e.type))return nx(sl([e.type,e.sealed]),t);if(1===cs(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return nx(sl([e.type,e.senderPublicKey,e.iv,e.sealed]),t)}return nx(sl([e.type,e.iv,e.sealed]),t)}function co(e){let{encoded:t,encoding:r=a9}=e,i=nP(t,r),s=i.slice(0,1);if(1===cs(s)){let e=i.slice(1,33),t=i.slice(33,45);return{type:s,sealed:i.slice(45),iv:t,senderPublicKey:e}}if(2===cs(s))return{type:s,sealed:i.slice(1),iv:ob(12)};let n=i.slice(1,13);return{type:s,sealed:i.slice(13),iv:n}}function ca(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function cc(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function cl(e){return e?.relay||{protocol:"irn"}}function ch(e){let t=nD[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}function cu(e){var t;if(!e.includes("wc:")){let t=n9(e);null!=t&&t.includes("wc:")&&(e=t)}let r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,r),n=e.substring(r+1,i).split("@"),o=new URLSearchParams("u">typeof i?e.substring(i):""),a={};o.forEach((e,t)=>{a[t]=e});let c="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:a.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let s=t.replace(i,""),n=e[t];r[s]=n}}),r}(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function cd(e){let t=new URLSearchParams,r=function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay);Object.keys(r).sort().forEach(e=>{t.set(e,r[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));let i=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${i}`}function cp(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}function cf(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function cg(e){return e.includes(":")}function cm(e){return cg(e)?e.split(":")[0]:e}function cy(e,t){let r=function(e){let t={};return e?.forEach(e=>{var r;let[i,s]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[],methods:[]}),t[i].accounts.push(e),null==(r=t[i].chains)||r.push(`${i}:${s}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,i]of Object.entries(r))i.methods?i.methods=n2(i.methods,e):i.methods=e,i.events=["chainChanged","accountsChanged"];return r}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let cb={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},cw={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function cv(e,t){let{message:r,code:i}=cw[e];return{message:t?`${r} ${t}`:r,code:i}}function cE(e,t){let{message:r,code:i}=cb[e];return{message:t?`${r} ${t}`:r,code:i}}function cI(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function c_(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function cC(e){return typeof e>"u"}function cS(e,t){return!!(t&&cC(e))||"string"==typeof e&&!!e.trim().length}function cN(e,t){return!!(t&&cC(e))||"number"==typeof e&&!isNaN(e)}function cA(e){return!!(cS(e,!1)&&e.includes(":"))&&2===e.split(":").length}function cO(e){let t=!0;return cI(e)?e.length&&(t=e.every(e=>cS(e,!1))):t=!1,t}function cM(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let s;if(r)return;let n=(i=`${t}, namespace`,s=null,cO(e?.methods)?cO(e?.events)||(s=cE("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):s=cE("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),s);n&&(r=n)}),r}function cP(e,t){let r=null;if(e&&c_(e)){let i;let s=cM(e,t);s&&(r=s);let n=(i=null,Object.values(e).forEach(e=>{var r,s;let n;if(i)return;let o=(r=e?.accounts,s=`${t} namespace`,n=null,cI(r)?r.forEach(e=>{n||function(e){if(cS(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&cA(e)}}return!1}(e)||(n=cE("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=cE("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);o&&(i=o)}),i);n&&(r=n)}else r=cv("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function cx(e){return cS(e.protocol,!0)}function cT(e){return"u">typeof e}function cD(e,t){return!(!cA(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...cf(e.accounts))}),t})(e).includes(t))}function cR(e,t,r){let i=null,s=function(e){let t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:null==(i=e[r].chains)||i.forEach(i=>{t[i]={methods:e[r].methods,events:e[r].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{let i=cf(e[r].accounts);i?.forEach(i=>{t[i]={accounts:e[r].accounts.filter(e=>e.includes(`${i}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),o=Object.keys(s),a=Object.keys(n),c=ck(Object.keys(e)),l=ck(Object.keys(t)),h=c.filter(e=>!l.includes(e));return h.length&&(i=cv("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${h.toString()}
      Received: ${Object.keys(t).toString()}`)),nV(o,a)||(i=cv("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||i)return;let s=cf(t[e].accounts);s.includes(e)||(i=cv("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),o.forEach(e=>{i||(nV(s[e].methods,n[e].methods)?nV(s[e].events,n[e].events)||(i=cv("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):i=cv("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),i}function ck(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function cj(){let e=nB();return new Promise(t=>{switch(e){case nU.browser:t(nq()&&navigator?.onLine);break;case nU.reactNative:t(cL());break;case nU.node:default:t(!0)}})}async function cL(){if(n$()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo){let e=await (null==r.g?void 0:r.g.NetInfo.fetch());return e?.isConnected}return!0}let cU={};class cz{static get(e){return cU[e]}static set(e,t){cU[e]=t}static delete(e){delete cU[e]}}var c$=r(38979),cq=r(5276);let cB=()=>"u">typeof WebSocket||"u">typeof r.g&&"u">typeof r.g.WebSocket||"u">typeof window&&"u">typeof window.WebSocket||"u">typeof self&&"u">typeof self.WebSocket,cW=e=>e.split("?")[0],cH="u">typeof WebSocket?WebSocket:"u">typeof r.g&&"u">typeof r.g.WebSocket?r.g.WebSocket:"u">typeof window&&"u">typeof window.WebSocket?window.WebSocket:"u">typeof self&&"u">typeof self.WebSocket?self.WebSocket:r(16854);class cF{constructor(e){if(this.url=e,this.events=new ee.EventEmitter,this.registering=!1,!(0,cq.isWsUrl)(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return"u">typeof this.socket}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(Error("Connection already closed"));return}this.socket.onclose=t=>{this.onClose(t),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send((0,eP.u)(e))}catch(t){this.onError(e.id,t)}}register(e=this.url){if(!(0,cq.isWsUrl)(e))throw Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){let e=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=e||this.events.listenerCount("open")>=e)&&this.events.setMaxListeners(e+1),new Promise((e,t)=>{this.events.once("register_error",e=>{this.resetMaxListeners(),t(e)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return t(Error("WebSocket connection is missing or invalid"));e(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,r)=>{let i=(0,cq.isReactNative)()?void 0:{rejectUnauthorized:!(0,cq.isLocalhostUrl)(e)},s=new cH(e,[],i);cB()?s.onerror=e=>{r(this.emitError(e.error))}:s.on("error",e=>{r(this.emitError(e))}),s.onopen=()=>{this.onOpen(s),t(s)}})}onOpen(e){e.onmessage=e=>this.onPayload(e),e.onclose=e=>this.onClose(e),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;let t="string"==typeof e.data?(0,eP.D)(e.data):e.data;this.events.emit("payload",t)}onError(e,t){let r=this.parseError(t),i=r.message||r.toString(),s=(0,cq.formatJsonRpcError)(e,i);this.events.emit("payload",s)}parseError(e,t=this.url){return(0,cq.parseConnectionError)(e,cW(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>10&&this.events.setMaxListeners(10)}emitError(e){let t=this.parseError(Error(e?.message||`WebSocket connection failed for host: ${cW(this.url)}`));return this.events.emit("register_error",t),t}}var cV=r(15586),cK=r.n(cV);let cJ="core",cY=`wc@2:${cJ}:`,cG={logger:"error"},cQ={database:":memory:"},cZ="client_ed25519_seed",cX=er.ONE_DAY,c0=er.SIX_HOURS,c1="wss://relay.walletconnect.org",c2={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},c3={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},c5="2.19.0",c4={link_mode:"link_mode",relay:"relay"},c8="WALLETCONNECT_LINK_MODE_APPS",c6={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},c9=1e3*er.FIVE_SECONDS,c7={wc_pairingDelete:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:er.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:er.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:er.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:er.ONE_DAY,prompt:!1,tag:0},res:{ttl:er.ONE_DAY,prompt:!1,tag:0}}},le={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},lt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},li="https://verify.walletconnect.org",ls=`${li}/v3`,ln=["https://verify.walletconnect.com",li],lo={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal"},la={no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_listener_not_found:"proposal_listener_not_found"},lc={session_approve_started:"session_approve_started",session_namespaces_validation_success:"session_namespaces_validation_success",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},ll={no_internet_connection:"no_internet_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},lh={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},lu={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var ld=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===c;)i++,t++;for(var n=(e.length-t)*l+1>>>0,o=new Uint8Array(n);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=n-1;(0!==h||u<s)&&-1!==d;d--,u++)h+=a*o[d]>>>0,o[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===o[p];)p++;for(var f=new Uint8Array(i+(n-p)),g=i;p!==n;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*h+1>>>0,l=new Uint8Array(o);s!==n;){for(var u=t[s],d=0,p=o-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*l[p]>>>0,l[p]=u%a>>>0,u=u/a>>>0;if(0!==u)throw Error("Non-zero carry");i=d,s++}for(var f=o-i;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw Error(`Non-${t} character`)}}};let lp=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},lf=e=>new TextEncoder().encode(e),lg=e=>new TextDecoder().decode(e);class lm{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class ly{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return lw(this,e)}}class lb{constructor(e){this.decoders=e}or(e){return lw(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let lw=(e,t)=>new lb({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class lv{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new lm(e,t,r),this.decoder=new ly(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let lE=({name:e,prefix:t,encode:r,decode:i})=>new lv(e,t,r,i),lI=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=ld(r,t);return lE({prefix:e,name:t,encode:i,decode:e=>lp(s(e))})},l_=(e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);c=c<<r|n,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},lC=(e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n},lS=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>lE({prefix:t,name:e,encode:e=>lC(e,i,r),decode:t=>l_(t,i,r,e)});var lN=Object.freeze({__proto__:null,identity:lE({prefix:"\0",name:"identity",encode:e=>lg(e),decode:e=>lf(e)})}),lA=Object.freeze({__proto__:null,base2:lS({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),lO=Object.freeze({__proto__:null,base8:lS({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),lM=Object.freeze({__proto__:null,base10:lI({prefix:"9",name:"base10",alphabet:"0123456789"})}),lP=Object.freeze({__proto__:null,base16:lS({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:lS({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let lx=lS({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),lT=lS({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lD=lS({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),lR=lS({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),lk=lS({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),lj=lS({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});var lL=Object.freeze({__proto__:null,base32:lx,base32upper:lT,base32pad:lD,base32padupper:lR,base32hex:lk,base32hexupper:lj,base32hexpad:lS({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:lS({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:lS({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),lU=Object.freeze({__proto__:null,base36:lI({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:lI({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),lz=Object.freeze({__proto__:null,base58btc:lI({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:lI({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let l$=lS({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});var lq=Object.freeze({__proto__:null,base64:l$,base64pad:lS({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:lS({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:lS({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let lB=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),lW=lB.reduce((e,t,r)=>(e[r]=t,e),[]),lH=lB.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var lF=Object.freeze({__proto__:null,base256emoji:lE({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=lW[t],"")},decode:function(e){let t=[];for(let r of e){let e=lH[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function lV(e,t){var r,i=0,t=t||0,s=0,n=t,o=e.length;do{if(n>=o)throw lV.bytes=0,RangeError("Could not decode varint");r=e[n++],i+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128);return lV.bytes=n-t,i}var lK=function e(t,r,i){r=r||[],i=i||0;for(var s=i;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-s+1,r};let lJ=(e,t,r=0)=>(lK(e,t,r),t),lY=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,lG=(e,t)=>{let r=t.byteLength,i=lY(e),s=i+lY(r),n=new Uint8Array(s+r);return lJ(e,n,0),lJ(r,n,i),n.set(t,s),new lQ(e,r,t,n)};class lQ{constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let lZ=({name:e,code:t,encode:r})=>new lX(e,t,r);class lX{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?lG(this.code,t):t.then(e=>lG(this.code,e))}throw Error("Unknown type, must be binary type")}}let l0=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var l1=Object.freeze({__proto__:null,sha256:lZ({name:"sha2-256",code:18,encode:l0("SHA-256")}),sha512:lZ({name:"sha2-512",code:19,encode:l0("SHA-512")})}),l2=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:lp,digest:e=>lG(0,lp(e))}});new TextEncoder,new TextDecoder;let l3={...lN,...lA,...lO,...lM,...lP,...lL,...lU,...lz,...lq,...lF};function l5(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...l1,...l2});let l4=l5("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),l8=l5("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),l6={utf8:l4,"utf-8":l4,hex:l3.base16,latin1:l8,ascii:l8,binary:l8,...l3};var l9=Object.defineProperty,l7=(e,t,r)=>t in e?l9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,he=(e,t,r)=>l7(e,"symbol"!=typeof t?t+"":t,r);class ht{constructor(e,t){this.core=e,this.logger=t,he(this,"keychain",new Map),he(this,"name","keychain"),he(this,"version","0.3"),he(this,"initialized",!1),he(this,"storagePrefix",cY),he(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),he(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),he(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),he(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=cv("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),he(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,e$.Ep)(t,this.name)}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,nK(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?nJ(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}}var hr=Object.defineProperty,hi=(e,t,r)=>t in e?hr(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hs=(e,t,r)=>hi(e,"symbol"!=typeof t?t+"":t,r);class hn{constructor(e,t,r){this.core=e,this.logger=t,hs(this,"name","crypto"),hs(this,"keychain"),hs(this,"randomSessionIdentifier",ct()),hs(this,"initialized",!1),hs(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),hs(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),hs(this,"getClientId",async()=>(this.isInitialized(),ir(is(await this.getClientSeed()).publicKey))),hs(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=a4.utils.randomPrivateKey(),t=a4.getPublicKey(e);return{privateKey:nx(e,a6),publicKey:nx(t,a6)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),hs(this,"signJWT",async e=>{this.isInitialized();let t=is(await this.getClientSeed()),r=this.randomSessionIdentifier;return await io(r,e,cX,t)}),hs(this,"generateSharedKey",(e,t,r)=>{var i;this.isInitialized();let s=(i=this.getPrivateKey(e),nx(aM(ak,a4.getSharedSecret(nP(i,a6),nP(t,a6)),void 0,void 0,32),a6));return this.setSymKey(s,r)}),hs(this,"setSymKey",async(e,t)=>{this.isInitialized();let r=t||cr(e);return await this.keychain.set(r,e),r}),hs(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),hs(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),hs(this,"encode",async(e,t,r)=>{this.isInitialized();let i=ca(r),s=(0,eP.u)(t);if(2===i.type)return function(e,t){let r=nP("2",a8),i=ob(12);return cn({type:r,sealed:nP(e,ce),iv:i,encoding:t})}(s,r?.encoding);if(cc(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let n=this.getSymKey(e),{type:o,senderPublicKey:a}=i;return function(e){var t;let r=(t="u">typeof e.type?e.type:0,nP(`${t}`,a8));if(1===cs(r)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let i="u">typeof e.senderPublicKey?nP(e.senderPublicKey,a6):void 0,s="u">typeof e.iv?nP(e.iv,a6):ob(12);return cn({type:r,sealed:aC(nP(e.symKey,a6),s).encrypt(nP(e.message,ce)),iv:s,senderPublicKey:i,encoding:e.encoding})}({type:o,symKey:n,message:s,senderPublicKey:a,encoding:r?.encoding})}),hs(this,"decode",async(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=co({encoded:e,encoding:t?.encoding});return ca({type:cs(r.type),senderPublicKey:"u">typeof r.senderPublicKey?nx(r.senderPublicKey,a6):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(2===i.type){let e=function(e,t){let{sealed:r}=co({encoded:e,encoding:t});return nx(r,ce)}(t,r?.encoding);return(0,eP.D)(e)}if(cc(i)){let t=i.receiverPublicKey,r=i.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),s=function(e){let t=nP(e.symKey,a6),{sealed:r,iv:i}=co(e),s=aC(t,i).decrypt(r);if(null===s)throw Error("Failed to decrypt");return nx(s,ce)}({symKey:i,encoded:t,encoding:r?.encoding});return(0,eP.D)(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),hs(this,"getPayloadType",(e,t=a9)=>cs(co({encoded:e,encoding:t}).type)),hs(this,"getPayloadSenderPublicKey",(e,t=a9)=>{let r=co({encoded:e,encoding:t});return r.senderPublicKey?nx(r.senderPublicKey,a6):void 0}),this.core=e,this.logger=(0,e$.Ep)(t,this.name),this.keychain=r||new ht(this.core,this.logger)}get context(){return(0,e$.Fd)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(cZ)}catch{e=ct(),await this.keychain.set(cZ,e)}return function(e,t="utf8"){let r=l6[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}}var ho=Object.defineProperty,ha=(e,t,r)=>t in e?ho(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hc=(e,t,r)=>ha(e,"symbol"!=typeof t?t+"":t,r);class hl extends eY{constructor(e,t){super(e,t),this.logger=e,this.core=t,hc(this,"messages",new Map),hc(this,"name","messages"),hc(this,"version","0.3"),hc(this,"initialized",!1),hc(this,"storagePrefix",cY),hc(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),hc(this,"set",async(e,t)=>{this.isInitialized();let r=ci(t),i=this.messages.get(e);return typeof i>"u"&&(i={}),"u">typeof i[r]||(i[r]=t,this.messages.set(e,i),await this.persist()),r}),hc(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),hc(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[ci(t)])),hc(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),await this.persist()}),this.logger=(0,e$.Ep)(e,this.name),this.core=t}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,nK(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?nJ(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}}var hh=Object.defineProperty,hu=Object.defineProperties,hd=Object.getOwnPropertyDescriptors,hp=Object.getOwnPropertySymbols,hf=Object.prototype.hasOwnProperty,hg=Object.prototype.propertyIsEnumerable,hm=(e,t,r)=>t in e?hh(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hy=(e,t)=>{for(var r in t||(t={}))hf.call(t,r)&&hm(e,r,t[r]);if(hp)for(var r of hp(t))hg.call(t,r)&&hm(e,r,t[r]);return e},hb=(e,t)=>hu(e,hd(t)),hw=(e,t,r)=>hm(e,"symbol"!=typeof t?t+"":t,r);class hv extends eG{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,hw(this,"events",new ee.EventEmitter),hw(this,"name","publisher"),hw(this,"queue",new Map),hw(this,"publishTimeout",(0,er.toMiliseconds)(er.ONE_MINUTE)),hw(this,"initialPublishTimeout",(0,er.toMiliseconds)(15*er.ONE_SECOND)),hw(this,"needsTransportRestart",!1),hw(this,"publish",async(e,t,r)=>{var i;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let s=r?.ttl||c0,n=cl(r),o=r?.prompt||!1,a=r?.tag||0,c=r?.id||(0,cq.getBigIntRpcId)().toString(),l={topic:e,message:t,opts:{ttl:s,relay:n,prompt:o,tag:a,id:c,attestation:r?.attestation,tvf:r?.tvf}},h=`Failed to publish payload, please try again. id:${c} tag:${a}`;try{let i=new Promise(async i=>{let n=({id:e})=>{l.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(c2.publish,n),i(l))};this.relayer.events.on(c2.publish,n);let h=nG(new Promise((i,n)=>{this.rpcPublish({topic:e,message:t,ttl:s,prompt:o,tag:a,id:c,attestation:r?.attestation,tvf:r?.tvf}).then(i).catch(e=>{this.logger.warn(e,e?.message),n(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${a}`);try{await h,this.events.removeListener(c2.publish,n)}catch(e){this.queue.set(c,hb(hy({},l),{attempt:1})),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:r}}),await nG(i,this.publishTimeout,h)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(i=r?.internal)&&i.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}}),hw(this,"on",(e,t)=>{this.events.on(e,t)}),hw(this,"once",(e,t)=>{this.events.once(e,t)}),hw(this,"off",(e,t)=>{this.events.off(e,t)}),hw(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,e$.Ep)(t,this.name),this.registerEventListeners()}get context(){return(0,e$.Fd)(this.logger)}async rpcPublish(e){var t,r,i,s;let{topic:n,message:o,ttl:a=c0,prompt:c,tag:l,id:h,attestation:u,tvf:d}=e,p={method:ch(cl().protocol).publish,params:hy({topic:n,message:o,ttl:a,prompt:c,tag:l,attestation:u},d),id:h};cC(null==(t=p.params)?void 0:t.prompt)&&(null==(r=p.params)||delete r.prompt),cC(null==(i=p.params)?void 0:i.tag)&&(null==(s=p.params)||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});let f=await this.relayer.request(p);return this.relayer.events.emit(c2.publish,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{let r=e.attempt+1;this.queue.set(t,hb(hy({},e),{attempt:r}));let{topic:i,message:s,opts:n,attestation:o}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(hb(hy({},e),{topic:i,message:s,ttl:n.ttl,prompt:n.prompt,tag:n.tag,id:n.id,attestation:o,tvf:n.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(eo,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(c2.connection_stalled);return}this.checkQueue()}),this.relayer.on(c2.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var hE=Object.defineProperty,hI=(e,t,r)=>t in e?hE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h_=(e,t,r)=>hI(e,"symbol"!=typeof t?t+"":t,r);class hC{constructor(){h_(this,"map",new Map),h_(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),h_(this,"get",e=>this.map.get(e)||[]),h_(this,"exists",(e,t)=>this.get(e).includes(t)),h_(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),h_(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var hS=Object.defineProperty,hN=Object.defineProperties,hA=Object.getOwnPropertyDescriptors,hO=Object.getOwnPropertySymbols,hM=Object.prototype.hasOwnProperty,hP=Object.prototype.propertyIsEnumerable,hx=(e,t,r)=>t in e?hS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hT=(e,t)=>{for(var r in t||(t={}))hM.call(t,r)&&hx(e,r,t[r]);if(hO)for(var r of hO(t))hP.call(t,r)&&hx(e,r,t[r]);return e},hD=(e,t)=>hN(e,hA(t)),hR=(e,t,r)=>hx(e,"symbol"!=typeof t?t+"":t,r);class hk extends eX{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,hR(this,"subscriptions",new Map),hR(this,"topicMap",new hC),hR(this,"events",new ee.EventEmitter),hR(this,"name","subscription"),hR(this,"version","0.3"),hR(this,"pending",new Map),hR(this,"cached",[]),hR(this,"initialized",!1),hR(this,"pendingSubscriptionWatchLabel","pending_sub_watch_label"),hR(this,"pollingInterval",20),hR(this,"storagePrefix",cY),hR(this,"subscribeTimeout",(0,er.toMiliseconds)(er.ONE_MINUTE)),hR(this,"initialSubscribeTimeout",(0,er.toMiliseconds)(15*er.ONE_SECOND)),hR(this,"clientId"),hR(this,"batchSubscribeTopicsLimit",500),hR(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),hR(this,"subscribe",async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let r=cl(t),i={topic:e,relay:r,transportType:t?.transportType};this.pending.set(e,i);let s=await this.rpcSubscribe(e,r,t);return"string"==typeof s&&(this.onSubscribe(s,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),hR(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),hR(this,"isSubscribed",async e=>{if(this.topics.includes(e))return!0;let t=`${this.pendingSubscriptionWatchLabel}_${e}`;return await new Promise((r,i)=>{let s=new er.Watch;s.start(t);let n=setInterval(()=>{(!this.pending.has(e)&&this.topics.includes(e)||this.cached.some(t=>t.topic===e))&&(clearInterval(n),s.stop(t),r(!0)),s.elapsed(t)>=c9&&(clearInterval(n),s.stop(t),i(Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)}),hR(this,"on",(e,t)=>{this.events.on(e,t)}),hR(this,"once",(e,t)=>{this.events.once(e,t)}),hR(this,"off",(e,t)=>{this.events.off(e,t)}),hR(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),hR(this,"start",async()=>{await this.onConnect()}),hR(this,"stop",async()=>{await this.onDisconnect()}),hR(this,"restart",async()=>{await this.restore(),await this.onRestart()}),hR(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),hR(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(eo,async()=>{await this.checkPending()}),this.events.on(c6.created,async e=>{let t=c6.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(c6.deleted,async e=>{let t=c6.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,e$.Ep)(t,this.name),this.clientId=""}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=cl(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let s=cE("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i;r&&r?.transportType!==c4.relay||await this.restartToComplete({topic:e,id:e,relay:t});let s={method:ch(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n=null==(i=r?.internal)?void 0:i.throwOnFailedPublish;try{let t=await this.getSubscriptionId(e);if(r?.transportType===c4.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},(0,er.toMiliseconds)(er.ONE_SECOND)),t;let i=new Promise(async t=>{let r=i=>{i.topic===e&&(this.events.removeListener(c6.created,r),t(i.id))};this.events.on(c6.created,r);try{let i=await nG(new Promise((e,t)=>{this.relayer.request(s).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(c6.created,r),t(i)}catch{}}),o=await nG(i,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!o&&n)throw Error(`Subscribing to ${e} failed, please try again`);return o?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(c2.connection_stalled),n)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:ch(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await nG(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(c2.connection_stalled)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r={method:ch(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{t=await await nG(new Promise((e,t)=>{this.relayer.request(r).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(c2.connection_stalled)}return t}rpcUnsubscribe(e,t,r){let i={method:ch(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,hD(hT({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,hT({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,hT({},t)),this.topicMap.set(t.topic,e),this.events.emit(c6.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=cv("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(c6.deleted,hD(hT({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(c6.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(c6.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:e}=cv("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>hD(hT({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await (t=(0,er.toMiliseconds)(er.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return ci(e+await this.getClientId())}}var hj=Object.defineProperty,hL=Object.getOwnPropertySymbols,hU=Object.prototype.hasOwnProperty,hz=Object.prototype.propertyIsEnumerable,h$=(e,t,r)=>t in e?hj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hq=(e,t)=>{for(var r in t||(t={}))hU.call(t,r)&&h$(e,r,t[r]);if(hL)for(var r of hL(t))hz.call(t,r)&&h$(e,r,t[r]);return e},hB=(e,t,r)=>h$(e,"symbol"!=typeof t?t+"":t,r);class hW extends eQ{constructor(e){super(e),hB(this,"protocol","wc"),hB(this,"version",2),hB(this,"core"),hB(this,"logger"),hB(this,"events",new ee.EventEmitter),hB(this,"provider"),hB(this,"messages"),hB(this,"subscriber"),hB(this,"publisher"),hB(this,"name","relayer"),hB(this,"transportExplicitlyClosed",!1),hB(this,"initialized",!1),hB(this,"connectionAttemptInProgress",!1),hB(this,"relayUrl"),hB(this,"projectId"),hB(this,"packageName"),hB(this,"bundleId"),hB(this,"hasExperiencedNetworkDisruption",!1),hB(this,"pingTimeout"),hB(this,"heartBeatTimeout",(0,er.toMiliseconds)(er.THIRTY_SECONDS+er.FIVE_SECONDS)),hB(this,"reconnectTimeout"),hB(this,"connectPromise"),hB(this,"reconnectInProgress",!1),hB(this,"requestsInFlight",[]),hB(this,"connectTimeout",(0,er.toMiliseconds)(15*er.ONE_SECOND)),hB(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||(0,cq.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let s=`${i}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(s);let n=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==s),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}}),hB(this,"resetPingTimeout",()=>{if(nz())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)||r.terminate()},this.heartBeatTimeout)}catch(e){this.logger.warn(e,e?.message)}}),hB(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),hB(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(c2.connect)}),hB(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),hB(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(c2.error,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),hB(this,"registerProviderListeners",()=>{this.provider.on(c3.payload,this.onPayloadHandler),this.provider.on(c3.connect,this.onConnectHandler),this.provider.on(c3.disconnect,this.onDisconnectHandler),this.provider.on(c3.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?(0,e$.Ep)(e.logger,this.name):(0,e$.gw)((0,e$.jI)({level:e.logger||"error"})),this.messages=new hl(this.logger,e.core),this.subscriber=new hk(this,this.logger),this.publisher=new hv(this,this.logger),this.relayUrl=e?.relayUrl||c1,this.projectId=e.projectId,n$()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="android"?this.packageName=nW():n$()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="ios"&&(this.bundleId=nW()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return(0,e$.Fd)(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0||void 0!==this.connectPromise}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:c4.relay})}async subscribe(e,t){var r,i,s;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let n=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),o=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",a,c=t=>{t.topic===e&&(this.subscriber.off(c6.created,c),a())};return await Promise.all([new Promise(e=>{a=e,this.subscriber.on(c6.created,c)}),new Promise(async(r,i)=>{o=await this.subscriber.subscribe(e,hq({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&i(e)})||o,r()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await nG(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await cj())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=nX(er.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(c2.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(c3.disconnect,r),await nG(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(c3.disconnect,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(c3.disconnect,r),await this.subscriber.start().then(e).catch(t).finally(()=>{this.provider.off(c3.disconnect,r)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,er.toMiliseconds)(1*t))),t++}}startPingTimeout(){var e,t,r,i,s;if(nz())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(s=null==(i=null==(r=this.provider)?void 0:r.connection)?void 0:i.socket)||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new c$.r(new cF(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:o,bundleId:a,packageName:c}){let l=r.split("?"),h=nF(e,t,i),u=function(e,t){let r=new URLSearchParams(e);for(let e of Object.keys(t).sort())if(t.hasOwnProperty(e)){let i=t[e];void 0!==i&&r.set(e,i)}return r.toString()}(l[1]||"",{auth:s,ua:h,projectId:n,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0});return l[0]+"?"+u}({sdkVersion:c5,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){let{topic:t,message:r}=e;await this.messages.set(t,r)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.warn(`Ignoring message for non-subscribed topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,cq.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:n}=t.data,o={topic:r,message:i,publishedAt:s,transportType:c4.relay,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(hq({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else(0,cq.isJsonRpcResponse)(e)&&this.events.emit(c2.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(c2.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){let t=(0,cq.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(c3.payload,this.onPayloadHandler),this.provider.off(c3.connect,this.onConnectHandler),this.provider.off(c3.disconnect,this.onDisconnectHandler),this.provider.off(c3.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await cj();!function(e){switch(nB()){case nU.browser:!n$()&&nq()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)));break;case nU.reactNative:n$()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo&&r.g?.NetInfo.addEventListener(t=>e(t?.isConnected));case nU.node:}}(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(c2.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,er.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),this.connected||await this.connect()}}var hH=Object.defineProperty,hF=Object.getOwnPropertySymbols,hV=Object.prototype.hasOwnProperty,hK=Object.prototype.propertyIsEnumerable,hJ=(e,t,r)=>t in e?hH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,hY=(e,t)=>{for(var r in t||(t={}))hV.call(t,r)&&hJ(e,r,t[r]);if(hF)for(var r of hF(t))hK.call(t,r)&&hJ(e,r,t[r]);return e},hG=(e,t,r)=>hJ(e,"symbol"!=typeof t?t+"":t,r);class hQ extends eZ{constructor(e,t,r,i=cY,s){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,hG(this,"map",new Map),hG(this,"version","0.3"),hG(this,"cached",[]),hG(this,"initialized",!1),hG(this,"getKey"),hG(this,"storagePrefix",cY),hG(this,"recentlyDeleted",[]),hG(this,"recentlyDeletedLimit",200),hG(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!cC(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),hG(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),hG(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),hG(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>cK()(t[r],e[r]))):this.values)),hG(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=hY(hY({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),hG(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,e$.Ep)(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=cv("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=cv("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=cv("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}}var hZ=Object.defineProperty,hX=(e,t,r)=>t in e?hZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h0=(e,t,r)=>hX(e,"symbol"!=typeof t?t+"":t,r);class h1{constructor(e,t){this.core=e,this.logger=t,h0(this,"name","pairing"),h0(this,"version","0.3"),h0(this,"events",new(et())),h0(this,"pairings"),h0(this,"initialized",!1),h0(this,"storagePrefix",cY),h0(this,"ignoredPayloadTypes",[1]),h0(this,"registeredMethods",[]),h0(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),h0(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),h0(this,"create",async e=>{this.isInitialized();let t=ct(),r=await this.core.crypto.setSymKey(t),i=nX(er.FIVE_MINUTES),s={protocol:"irn"},n={topic:r,expiry:i,relay:s,active:!1,methods:e?.methods},o=cd({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:s,expiryTimestamp:i,methods:e?.methods});return this.events.emit(le.create,n),this.core.expirer.set(r,i),await this.pairings.set(r,n),await this.core.relayer.subscribe(r,{transportType:e?.transportType}),{topic:r,uri:o}}),h0(this,"pair",async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[lo.pairing_started]}});this.isValidPair(e,r);let{topic:i,symKey:s,relay:n,expiryTimestamp:o,methods:a}=cu(e.uri);if(r.props.properties.topic=i,r.addTrace(lo.pairing_uri_validation_success),r.addTrace(lo.pairing_uri_not_expired),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace(lo.existing_pairing),t.active)throw r.setError(la.active_pairing_already_exists),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace(lo.pairing_not_expired)}let c=o||nX(er.FIVE_MINUTES),l={topic:i,relay:n,expiry:c,active:!1,methods:a};this.core.expirer.set(i,c),await this.pairings.set(i,l),r.addTrace(lo.store_new_pairing),e.activatePairing&&await this.activate({topic:i}),this.events.emit(le.create,l),r.addTrace(lo.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(s,i),r.addTrace(lo.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError(la.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:n})}catch(e){throw r.setError(la.subscribe_pairing_topic_failure),e}return r.addTrace(lo.subscribe_pairing_topic_success),l}),h0(this,"activate",async({topic:e})=>{this.isInitialized();let t=nX(er.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),h0(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:s}=nY();this.events.once(n1("pairing_ping",e),({error:e})=>{e?s(e):i()}),await r()}}),h0(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),h0(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),h0(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),h0(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",cE("USER_DISCONNECTED")),await this.deletePairing(t))}),h0(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:s}=e,n=this.core.crypto.keychain.get(t);return cd({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:r,expiryTimestamp:i,methods:s})}),h0(this,"sendRequest",async(e,t,r)=>{let i=(0,cq.formatJsonRpcRequest)(t,r),s=await this.core.crypto.encode(e,i),n=c7[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,s,n),i.id}),h0(this,"sendResult",async(e,t,r)=>{let i=(0,cq.formatJsonRpcResult)(e,r),s=await this.core.crypto.encode(t,i),n=c7[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,s,n),await this.core.history.resolve(i)}),h0(this,"sendError",async(e,t,r)=>{let i=(0,cq.formatJsonRpcError)(e,r),s=await this.core.crypto.encode(t,i),n=(await this.core.history.get(t,e)).request.method,o=c7[n]?c7[n].res:c7.unregistered_method.res;await this.core.relayer.publish(t,s,o),await this.core.history.resolve(i)}),h0(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,cE("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),h0(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>n0(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),h0(this,"onRelayEventRequest",e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return this.onPairingPingRequest(t,r);case"wc_pairingDelete":return this.onPairingDeleteRequest(t,r);default:return this.onUnknownRpcMethodRequest(t,r)}}),h0(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)}),h0(this,"onPairingPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit(le.ping,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),h0(this,"onPairingPingResponse",(e,t)=>{let{id:r}=t;setTimeout(()=>{(0,cq.isJsonRpcResult)(t)?this.events.emit(n1("pairing_ping",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(n1("pairing_ping",r),{error:t.error})},500)}),h0(this,"onPairingDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(le.delete,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),h0(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=cE("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),h0(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(cE("WC_METHOD_UNSUPPORTED",e))}),h0(this,"isValidPair",(e,t)=>{var r;if(!cT(e)){let{message:r}=cv("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(la.malformed_pairing_uri),Error(r)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(cS(e,!1)){if(t(e))return!0;let r=n9(e);return t(r)}}catch{}return!1}(e.uri)){let{message:r}=cv("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(la.malformed_pairing_uri),Error(r)}let i=cu(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=cv("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(la.malformed_pairing_uri),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=cv("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(la.malformed_pairing_uri),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,er.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError(la.pairing_expired);let{message:e}=cv("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),h0(this,"isValidPing",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),h0(this,"isValidDisconnect",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),h0(this,"isValidPairingTopic",async e=>{if(!cS(e,!1)){let{message:t}=cv("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=cv("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(n0(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=cv("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=(0,e$.Ep)(t,this.name),this.pairings=new hQ(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,e$.Fd)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(c2.message,async e=>{let{topic:t,message:r,transportType:i}=e;if(!this.pairings.keys.includes(t)||i===c4.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))return;let s=await this.core.crypto.decode(t,r);try{(0,cq.isJsonRpcRequest)(s)?(this.core.history.set(t,s),this.onRelayEventRequest({topic:t,payload:s})):(0,cq.isJsonRpcResponse)(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:t,payload:s}),this.core.history.delete(t,s.id))}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(lr.expired,async e=>{let{topic:t}=nZ(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(le.expire,{topic:t}))})}}var h2=Object.defineProperty,h3=(e,t,r)=>t in e?h2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h5=(e,t,r)=>h3(e,"symbol"!=typeof t?t+"":t,r);class h4 extends eJ{constructor(e,t){super(e,t),this.core=e,this.logger=t,h5(this,"records",new Map),h5(this,"events",new ee.EventEmitter),h5(this,"name","history"),h5(this,"version","0.3"),h5(this,"cached",[]),h5(this,"initialized",!1),h5(this,"storagePrefix",cY),h5(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),h5(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:nX(er.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(lt.created,i)}),h5(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,cq.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(lt.updated,t))}),h5(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),h5(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic!==e||"u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(lt.deleted,r))}),this.persist()}),h5(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),h5(this,"on",(e,t)=>{this.events.on(e,t)}),h5(this,"once",(e,t)=>{this.events.once(e,t)}),h5(this,"off",(e,t)=>{this.events.off(e,t)}),h5(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,e$.Ep)(t,this.name)}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:(0,cq.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=cv("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(lt.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=cv("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(lt.created,e=>{let t=lt.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(lt.updated,e=>{let t=lt.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(lt.deleted,e=>{let t=lt.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(eo,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,er.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(lt.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}}var h8=Object.defineProperty,h6=(e,t,r)=>t in e?h8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,h9=(e,t,r)=>h6(e,"symbol"!=typeof t?t+"":t,r);class h7 extends e0{constructor(e,t){super(e,t),this.core=e,this.logger=t,h9(this,"expirations",new Map),h9(this,"events",new ee.EventEmitter),h9(this,"name","expirer"),h9(this,"version","0.3"),h9(this,"cached",[]),h9(this,"initialized",!1),h9(this,"storagePrefix",cY),h9(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),h9(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),h9(this,"set",(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(lr.created,{target:r,expiration:i})}),h9(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),h9(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(lr.deleted,{target:t,expiration:r})}}),h9(this,"on",(e,t)=>{this.events.on(e,t)}),h9(this,"once",(e,t)=>{this.events.once(e,t)}),h9(this,"off",(e,t)=>{this.events.off(e,t)}),h9(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,e$.Ep)(t,this.name)}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return nQ("topic",e);if("number"==typeof e)return nQ("id",e);let{message:t}=cv("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(lr.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=cv("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=cv("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,er.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(lr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(eo,()=>this.checkExpirations()),this.events.on(lr.created,e=>{let t=lr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(lr.expired,e=>{let t=lr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(lr.deleted,e=>{let t=lr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}}var ue=Object.defineProperty,ut=(e,t,r)=>t in e?ue(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ur=(e,t,r)=>ut(e,"symbol"!=typeof t?t+"":t,r);class ui extends e1{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,ur(this,"name","verify-api"),ur(this,"abortController"),ur(this,"isDevEnv"),ur(this,"verifyUrlV3",ls),ur(this,"storagePrefix",cY),ur(this,"version",2),ur(this,"publicKey"),ur(this,"fetchPromise"),ur(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,er.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),ur(this,"register",async e=>{if(!nq()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,iv.getDocument)(),t=this.startAbortTimer(5*er.ONE_SECOND),i=await new Promise((i,n)=>{let o=()=>{window.removeEventListener("message",c),e.body.removeChild(a),n("attestation aborted")};this.abortController.signal.addEventListener("abort",o);let a=e.createElement("iframe");a.src=s,a.style.display="none",a.addEventListener("error",o,{signal:this.abortController.signal});let c=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if(ii(n.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",o),window.removeEventListener("message",c),i(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",i),i}catch(e){this.logger.warn(e)}return""}),ur(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t){this.logger.debug("resolve: attestationId is empty, skipping");return}if(t){if(ii(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e){if(!e.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return e}}if(!r)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,s)}),ur(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*er.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0}),ur(this,"getVerifyUrl",e=>{let t=e||li;return ln.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${li}`),t=li),t}),ur(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(er.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),ur(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),ur(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),ur(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),ur(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),ur(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),ur(this,"validateAttestation",(e,t)=>{let r=function(e,t){let[r,i,s]=e.split("."),n=nk.from(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t.length%4;return r>0&&(t+="=".repeat(4-r)),t}(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let o=n.slice(0,32).toString("hex"),a=n.slice(32,64).toString("hex"),c=ak(`${r}.${i}`),l=new nT.ec("p256").keyFromPublic({x:nk.from(t.x,"base64").toString("hex"),y:nk.from(t.y,"base64").toString("hex")},"hex"),h=nx(c,a6);if(!l.verify(h,{r:o,s:a}))throw Error("Invalid signature");return ii(e).payload}(e,t.publicKey),i={hasExpired:(0,er.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}}),this.logger=(0,e$.Ep)(t,this.name),this.abortController=new AbortController,this.isDevEnv=n6(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,e$.Fd)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,er.toMiliseconds)(e))}}var us=Object.defineProperty,un=(e,t,r)=>t in e?us(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uo=(e,t,r)=>un(e,"symbol"!=typeof t?t+"":t,r);class ua extends e2{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,uo(this,"context","echo"),uo(this,"registerDeviceToken",async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:s})})}),this.logger=(0,e$.Ep)(t,this.context)}}var uc=Object.defineProperty,ul=Object.getOwnPropertySymbols,uh=Object.prototype.hasOwnProperty,uu=Object.prototype.propertyIsEnumerable,ud=(e,t,r)=>t in e?uc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,up=(e,t)=>{for(var r in t||(t={}))uh.call(t,r)&&ud(e,r,t[r]);if(ul)for(var r of ul(t))uu.call(t,r)&&ud(e,r,t[r]);return e},uf=(e,t,r)=>ud(e,"symbol"!=typeof t?t+"":t,r);class ug extends e3{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,uf(this,"context","event-client"),uf(this,"storagePrefix",cY),uf(this,"storageVersion",.1),uf(this,"events",new Map),uf(this,"shouldPersist",!1),uf(this,"init",async()=>{if(!n6())try{let e={eventId:n8(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:nF(this.core.relayer.protocol,this.core.relayer.version,c5)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),uf(this,"createEvent",e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:s}}=e,n=n8(),o=this.core.projectId||"",a=up({eventId:n,timestamp:Date.now(),props:{event:t,type:r,properties:{topic:i,trace:s}},bundleId:o,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,a),this.shouldPersist=!0),a}),uf(this,"getEvent",e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return up(up({},i),this.setMethods(i.eventId))}),uf(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),uf(this,"setEventListeners",()=>{this.core.heartbeat.on(eo,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,er.fromMiliseconds)(Date.now())-(0,er.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),uf(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),uf(this,"addTrace",(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),uf(this,"setError",(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),uf(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),uf(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,up(up({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),uf(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),uf(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${c5}${t}`,{method:"POST",body:JSON.stringify(e)})}),uf(this,"getAppDomain",()=>nH().url),this.logger=(0,e$.Ep)(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var um=Object.defineProperty,uy=Object.getOwnPropertySymbols,ub=Object.prototype.hasOwnProperty,uw=Object.prototype.propertyIsEnumerable,uv=(e,t,r)=>t in e?um(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uE=(e,t)=>{for(var r in t||(t={}))ub.call(t,r)&&uv(e,r,t[r]);if(uy)for(var r of uy(t))uw.call(t,r)&&uv(e,r,t[r]);return e},uI=(e,t,r)=>uv(e,"symbol"!=typeof t?t+"":t,r);class u_ extends eH{constructor(e){var t;super(e),uI(this,"protocol","wc"),uI(this,"version",2),uI(this,"name",cJ),uI(this,"relayUrl"),uI(this,"projectId"),uI(this,"customStoragePrefix"),uI(this,"events",new ee.EventEmitter),uI(this,"logger"),uI(this,"heartbeat"),uI(this,"relayer"),uI(this,"crypto"),uI(this,"storage"),uI(this,"history"),uI(this,"expirer"),uI(this,"pairing"),uI(this,"verify"),uI(this,"echoClient"),uI(this,"linkModeSupportedApps"),uI(this,"eventClient"),uI(this,"initialized",!1),uI(this,"logChunkController"),uI(this,"on",(e,t)=>this.events.on(e,t)),uI(this,"once",(e,t)=>this.events.once(e,t)),uI(this,"off",(e,t)=>this.events.off(e,t)),uI(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),uI(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:c4.link_mode};this.relayer.onLinkMessageEvent(i,{sessionExists:r})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||c1,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let r=(0,e$.jI)({level:"string"==typeof e?.logger&&e.logger?e.logger:cG.logger,name:cJ}),{logger:i,chunkLoggerController:s}=(0,e$.Rt)({opts:r,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,e$.Ep)(i,this.name),this.heartbeat=new ea,this.crypto=new hn(this,this.logger,e?.keychain),this.history=new h4(this,this.logger),this.expirer=new h7(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new ez(uE(uE({},cQ),e?.storageOptions)),this.relayer=new hW({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new h1(this,this.logger),this.verify=new ui(this,this.logger,this.storage),this.echoClient=new ua(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new ug(this,this.logger,e?.telemetryEnabled)}static async init(e){let t=new u_(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return(0,e$.Fd)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(c8,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(c8)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}var uC=Object.defineProperty,uS=(e,t,r)=>t in e?uC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uN=(e,t,r)=>uS(e,"symbol"!=typeof t?t+"":t,r);class uA{constructor(e){this.opts=e,uN(this,"protocol","wc"),uN(this,"version",2)}}class uO{constructor(e){this.client=e}}let uM="client",uP=`wc@2:${uM}:`,ux={name:uM,logger:"error"},uT="WALLETCONNECT_DEEPLINK_CHOICE",uD="Proposal expired",uR=er.SEVEN_DAYS,uk={wc_sessionPropose:{req:{ttl:er.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1104},res:{ttl:er.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1106},res:{ttl:er.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:er.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:er.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1112},res:{ttl:er.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1114},res:{ttl:er.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:er.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:er.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1119}}},uj={min:er.FIVE_MINUTES,max:er.SEVEN_DAYS},uL={idle:"IDLE",active:"ACTIVE"},uU={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},uz=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],u$="wc@1.5:auth:",uq=`${u$}:PUB_KEY`;var uB=Object.defineProperty,uW=Object.defineProperties,uH=Object.getOwnPropertyDescriptors,uF=Object.getOwnPropertySymbols,uV=Object.prototype.hasOwnProperty,uK=Object.prototype.propertyIsEnumerable,uJ=(e,t,r)=>t in e?uB(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uY=(e,t)=>{for(var r in t||(t={}))uV.call(t,r)&&uJ(e,r,t[r]);if(uF)for(var r of uF(t))uK.call(t,r)&&uJ(e,r,t[r]);return e},uG=(e,t)=>uW(e,uH(t)),uQ=(e,t,r)=>uJ(e,"symbol"!=typeof t?t+"":t,r);class uZ extends uO{constructor(e){super(e),uQ(this,"name","engine"),uQ(this,"events",new(et())),uQ(this,"initialized",!1),uQ(this,"requestQueue",{state:uL.idle,queue:[]}),uQ(this,"sessionRequestQueue",{state:uL.idle,queue:[]}),uQ(this,"requestQueueDelay",er.ONE_SECOND),uQ(this,"expectedPairingMethodMap",new Map),uQ(this,"recentlyDeletedMap",new Map),uQ(this,"recentlyDeletedLimit",200),uQ(this,"relayMessageCache",[]),uQ(this,"pendingSessions",new Map),uQ(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(uk)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,er.toMiliseconds)(this.requestQueueDelay)))}),uQ(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=uG(uY({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,relays:o}=t,a=r,c,l=!1;try{if(a){let e=this.client.core.pairing.pairings.get(a);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),l=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${a}) failed`),e}if(!a||!l){let{topic:e,uri:t}=await this.client.core.pairing.create();a=e,c=t}if(!a){let{message:e}=cv("NO_MATCHING_KEY",`connect() pairing topic: ${a}`);throw Error(e)}let h=await this.client.core.crypto.generateKeyPair(),u=uk.wc_sessionPropose.req.ttl||er.FIVE_MINUTES,d=nX(u),p=uG(uY({requiredNamespaces:i,optionalNamespaces:s,relays:o??[{protocol:"irn"}],proposer:{publicKey:h,metadata:this.client.metadata},expiryTimestamp:d,pairingTopic:a},n&&{sessionProperties:n}),{id:(0,cq.payloadId)()}),f=n1("session_connect",p.id),{reject:g,resolve:m,done:y}=nY(u,uD),b=({id:e})=>{e===p.id&&(this.client.events.off("proposal_expire",b),this.pendingSessions.delete(p.id),this.events.emit(f,{error:{message:uD,code:0}}))};return this.client.events.on("proposal_expire",b),this.events.once(f,({error:e,session:t})=>{this.client.events.off("proposal_expire",b),e?g(e):t&&m(t)}),await this.sendRequest({topic:a,method:"wc_sessionPropose",params:p,throwOnFailedPublish:!0,clientRpcId:p.id}),await this.setProposal(p.id,p),{uri:c,approval:y}}),uQ(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),uQ(this,"approve",async e=>{var t,r,i;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[lc.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError(ll.no_internet_connection),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError(ll.proposal_not_found),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError(ll.session_approve_namespace_validation_failure),e}let{id:n,relayProtocol:o,namespaces:a,sessionProperties:c,sessionConfig:l}=e,h=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:u,proposer:d,requiredNamespaces:p,optionalNamespaces:f}=h,g=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:u});g||(g=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:lc.session_approve_started,properties:{topic:u,trace:[lc.session_approve_started,lc.session_namespaces_validation_success]}}));let m=await this.client.core.crypto.generateKeyPair(),y=d.publicKey,b=await this.client.core.crypto.generateSharedKey(m,y),w=uY(uY({relay:{protocol:o??"irn"},namespaces:a,controller:{publicKey:m,metadata:this.client.metadata},expiry:nX(uR)},c&&{sessionProperties:c}),l&&{sessionConfig:l}),v=c4.relay;g.addTrace(lc.subscribing_session_topic);try{await this.client.core.relayer.subscribe(b,{transportType:v})}catch(e){throw g.setError(ll.subscribe_session_topic_failure),e}g.addTrace(lc.subscribe_session_topic_success);let E=uG(uY({},w),{topic:b,requiredNamespaces:p,optionalNamespaces:f,pairingTopic:u,acknowledged:!1,self:w.controller,peer:{publicKey:d.publicKey,metadata:d.metadata},controller:m,transportType:c4.relay});await this.client.session.set(b,E),g.addTrace(lc.store_session);try{g.addTrace(lc.publishing_session_settle),await this.sendRequest({topic:b,method:"wc_sessionSettle",params:w,throwOnFailedPublish:!0}).catch(e=>{throw g?.setError(ll.session_settle_publish_failure),e}),g.addTrace(lc.session_settle_publish_success),g.addTrace(lc.publishing_session_approve),await this.sendResult({id:n,topic:u,result:{relay:{protocol:o??"irn"},responderPublicKey:m},throwOnFailedPublish:!0}).catch(e=>{throw g?.setError(ll.session_approve_publish_failure),e}),g.addTrace(lc.session_approve_publish_success)}catch(e){throw this.client.logger.error(e),this.client.session.delete(b,cE("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(b),e}return this.client.core.eventClient.deleteEvent({eventId:g.eventId}),await this.client.core.pairing.updateMetadata({topic:u,metadata:d.metadata}),await this.client.proposal.delete(n,cE("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:u}),await this.setExpiry(b,nX(uR)),{topic:b,acknowledged:()=>Promise.resolve(this.client.session.get(b))}}),uQ(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&(await this.sendError({id:r,topic:t,error:i,rpcOpts:uk.wc_sessionPropose.reject}),await this.client.proposal.delete(r,cE("USER_DISCONNECTED")))}),uQ(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:s,reject:n}=nY(),o=(0,cq.payloadId)(),a=(0,cq.getBigIntRpcId)().toString(),c=this.client.session.get(t).namespaces;return this.events.once(n1("session_update",o),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),n(e)}),{acknowledged:i}}),uQ(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=(0,cq.payloadId)(),{done:i,resolve:s,reject:n}=nY();return this.events.once(n1("session_extend",r),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,nX(uR)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:i}}),uQ(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:s=uk.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(i);n?.transportType===c4.relay&&await this.confirmOnlineStateOrThrow();let o=(0,cq.payloadId)(),a=(0,cq.getBigIntRpcId)().toString(),{done:c,resolve:l,reject:h}=nY(s,"Request expired. Please try again.");this.events.once(n1("session_request",o),({error:e,result:t})=>{e?h(e):l(t)});let u="wc_sessionRequest",d=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);if(d)return await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:u,params:{request:uG(uY({},r),{expiryTimestamp:nX(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:d}).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),await c();let p={request:uG(uY({},r),{expiryTimestamp:nX(s)}),chainId:t},f=this.shouldSetTVF(u,p);return await Promise.all([new Promise(async e=>{await this.sendRequest(uY({clientRpcId:o,relayRpcId:a,topic:i,method:u,params:p,expiry:s,throwOnFailedPublish:!0},f&&{tvf:this.getTVFParams(o,p)})).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await n5(this.client.core.storage,uT);await n3({id:o,topic:i,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),uQ(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:r}=e,{id:i}=r,s=this.client.session.get(t);s.transportType===c4.relay&&await this.confirmOnlineStateOrThrow();let n=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);(0,cq.isJsonRpcResult)(r)?await this.sendResult({id:i,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:n}):(0,cq.isJsonRpcError)(r)&&await this.sendError({id:i,topic:t,error:r.error,appLink:n}),this.cleanupAfterResponse(e)}),uQ(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,cq.payloadId)(),r=(0,cq.getBigIntRpcId)().toString(),{done:i,resolve:s,reject:n}=nY();this.events.once(n1("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),uQ(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,s=(0,cq.getBigIntRpcId)().toString(),n=(0,cq.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:n})}),uQ(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:cE("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=cv("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),uQ(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),s=Object.keys(r),n=!0;return!!nV(s,i)&&(i.forEach(t=>{let{accounts:i,methods:s,events:o}=e.namespaces[t],a=cf(i),c=r[t];nV(nL(t,c),a)&&nV(c.methods,s)&&nV(c.events,o)||(n=!1)}),n)})(t,e)))),uQ(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),uQ(this,"authenticate",async(e,t)=>{var r,i,s;let n;this.isInitialized(),this.isValidAuthenticate(e);let o=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),a=o?c4.link_mode:c4.relay;a===c4.relay&&await this.confirmOnlineStateOrThrow();let{chains:c,statement:l="",uri:h,domain:u,nonce:d,type:p,exp:f,nbf:g,methods:m=[],expiry:y}=e,b=[...e.resources||[]],{topic:w,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:v}});let E=await this.client.core.crypto.generateKeyPair(),I=cr(E);if(await Promise.all([this.client.auth.authKeys.set(uq,{responseTopic:I,publicKey:E}),this.client.auth.pairingTopics.set(I,{topic:I,pairingTopic:w})]),await this.client.core.relayer.subscribe(I,{transportType:a}),this.client.logger.info(`sending request to new pairing topic: ${w}`),m.length>0){let{namespace:e}=nj(c[0]),t=o0(function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[r]})))}(t,r,i)}}}(e,"request",m));o5(b)&&(i=t,s=b.pop(),t=o0(function(e,t){oX(e),oX(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),i={att:{}};return r.forEach(r=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[r])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,o;i.att[r]=oV(oF({},i.att[r]),{[s]:(null==(n=e.att[r])?void 0:n[s])||(null==(o=t.att[r])?void 0:o[s])})})}),i}(o1(i),o1(s)))),b.push(t)}let _=y&&y>uk.wc_sessionAuthenticate.req.ttl?y:uk.wc_sessionAuthenticate.req.ttl,C={authPayload:{type:p??"caip122",chains:c,statement:l,aud:h,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:g,resources:b},requester:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:nX(_)},S={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:c,methods:[...new Set(["personal_sign",...m])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:nX(uk.wc_sessionPropose.req.ttl),id:(0,cq.payloadId)()},{done:N,resolve:A,reject:O}=nY(_,"Request expired"),M=(0,cq.payloadId)(),P=n1("session_connect",S.id),x=n1("session_request",M),T=async({error:e,session:t})=>{this.events.off(x,D),e?O(e):t&&A({session:t})},D=async e=>{var r,i,s;let n;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),e.error){let t=cE("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(P,T),O(e.error.message))}await this.deleteProposal(S.id),this.events.off(P,T);let{cacaos:o,responder:c}=e.result,l=[],h=[];for(let e of o){await oQ({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),O(cE("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=o5(t.resources),i=[oY(t.iss)],s=oG(t.iss);if(r){let e=o2(r),t=o3(r);l.push(...e),i.push(...t)}for(let e of i)h.push(`${e}:${s}`)}let u=await this.client.core.crypto.generateSharedKey(E,c.publicKey);l.length>0&&(n={topic:u,acknowledged:!0,self:{publicKey:E,metadata:this.client.metadata},peer:c,controller:c.publicKey,expiry:nX(uR),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:cy([...new Set(l)],[...new Set(h)]),transportType:a},await this.client.core.relayer.subscribe(u,{transportType:a}),await this.client.session.set(u,n),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:c.metadata}),n=this.client.session.get(u)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=c.metadata.redirect)&&i.linkMode&&null!=(s=c.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),this.client.session.update(u,{transportType:c4.link_mode})),A({auths:o,session:n})};this.events.once(P,T),this.events.once(x,D);try{if(o){let e=(0,cq.formatJsonRpcRequest)("wc_sessionAuthenticate",C,M);this.client.core.history.set(w,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:a7});n=cp(t,w,r)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:C,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:S,expiry:uk.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(e){throw this.events.off(P,T),this.events.off(x,D),e}return await this.setProposal(S.id,S),await this.setAuthRequest(M,{request:uG(uY({},C),{verifyContext:{}}),pairingTopic:w,transportType:a}),{uri:n??v,response:N}}),uQ(this,"approveSessionAuthenticate",async e=>{let t;let{id:r,auths:i}=e,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[lh.authenticated_session_approve_started]}});try{this.isInitialized()}catch(e){throw s.setError(lu.no_internet_connection),e}let n=this.getPendingAuthRequest(r);if(!n)throw s.setError(lu.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${r}`);let o=n.transportType||c4.relay;o===c4.relay&&await this.confirmOnlineStateOrThrow();let a=n.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=cr(a),h={type:1,receiverPublicKey:a,senderPublicKey:c},u=[],d=[];for(let e of i){if(!await oQ({cacao:e,projectId:this.client.core.projectId})){s.setError(lu.invalid_cacao);let e=cE("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:l,error:e,encodeOpts:h}),Error(e.message)}s.addTrace(lh.cacaos_verified);let{p:t}=e,i=o5(t.resources),n=[oY(t.iss)],o=oG(t.iss);if(i){let e=o2(i),t=o3(i);u.push(...e),n.push(...t)}for(let e of n)d.push(`${e}:${o}`)}let p=await this.client.core.crypto.generateSharedKey(c,a);if(s.addTrace(lh.create_authenticated_session_topic),u?.length>0){t={topic:p,acknowledged:!0,self:{publicKey:c,metadata:this.client.metadata},peer:{publicKey:a,metadata:n.requester.metadata},controller:a,expiry:nX(uR),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:cy([...new Set(u)],[...new Set(d)]),transportType:o},s.addTrace(lh.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:o})}catch(e){throw s.setError(lu.subscribe_authenticated_session_topic_failure),e}s.addTrace(lh.subscribe_authenticated_session_topic_success),await this.client.session.set(p,t),s.addTrace(lh.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace(lh.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:r,result:{cacaos:i,responder:{publicKey:c,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,o)})}catch(e){throw s.setError(lu.authenticated_session_approve_publish_failure),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}}),uQ(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===c4.relay&&await this.confirmOnlineStateOrThrow();let s=i.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),o=cr(s);await this.sendError({id:t,topic:o,error:r,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:uk.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,cE("USER_DISCONNECTED"))}),uQ(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:r}=e;return oZ(t,r)}),uQ(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),uQ(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,s;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(s=r.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),uQ(this,"deleteSession",async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:s=!0,id:n=0}=e,{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,cE("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(uT).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,cE("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=uL.idle),s&&this.client.events.emit("session_delete",{id:n,topic:r})}),uQ(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError(ll.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,cE("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),uQ(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=uL.idle,this.client.events.emit("session_request_expire",{id:e}))}),uQ(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),uQ(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),uQ(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,nX(uk.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),uQ(this,"setAuthRequest",async(e,t)=>{let{request:r,pairingTopic:i,transportType:s=c4.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:s})}),uQ(this,"setPendingSessionRequest",async e=>{let{id:t,topic:r,params:i,verifyContext:s}=e,n=i.request.expiryTimestamp||nX(uk.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:s})}),uQ(this,"sendRequest",async e=>{let t,i;let{topic:s,method:n,params:o,expiry:a,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:h,appLink:u,tvf:d}=e,p=(0,cq.formatJsonRpcRequest)(n,o,l),f=!!u;try{let e=f?a7:a9;t=await this.client.core.crypto.encode(s,p,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(uz.includes(n)){let e=ci(JSON.stringify(p)),r=ci(t);i=await this.client.core.verify.register({id:r,decryptedId:e})}let g=uk[n].req;if(g.attestation=i,a&&(g.ttl=a),c&&(g.id=c),this.client.core.history.set(s,p),f){let e=cp(u,s,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=uk[n].req;a&&(e.ttl=a),c&&(e.id=c),e.tvf=uG(uY({},d),{correlationId:p.id}),h?(e.internal=uG(uY({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,t,e)):this.client.core.relayer.publish(s,t,e).catch(e=>this.client.logger.error(e))}return p.id}),uQ(this,"sendResult",async e=>{let t,i,s;let{id:n,topic:o,result:a,throwOnFailedPublish:c,encodeOpts:l,appLink:h}=e,u=(0,cq.formatJsonRpcResult)(n,a),d=h&&"u">typeof(null==r.g?void 0:r.g.Linking);try{let e=d?a7:a9;t=await this.client.core.crypto.encode(o,u,uG(uY({},l||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${o} failed`),e}try{let e=(i=await this.client.core.history.get(o,n)).request;try{this.shouldSetTVF(e.method,e.params)&&(s=this.getTVFParams(n,e.params,a))}catch(e){this.client.logger.warn("sendResult() -> getTVFParams() failed",e)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${o}, ${n}) failed`),e}if(d){let e=cp(h,o,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=uk[i.request.method].res;e.tvf=uG(uY({},s),{correlationId:n}),c?(e.internal=uG(uY({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,t,e)):this.client.core.relayer.publish(o,t,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(u)}),uQ(this,"sendError",async e=>{let t,i;let{id:s,topic:n,error:o,encodeOpts:a,rpcOpts:c,appLink:l}=e,h=(0,cq.formatJsonRpcError)(s,o),u=l&&"u">typeof(null==r.g?void 0:r.g.Linking);try{let e=u?a7:a9;t=await this.client.core.crypto.encode(n,h,uG(uY({},a||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{i=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(u){let e=cp(l,n,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=i.request.method,r=c||uk[e].res;this.client.core.relayer.publish(n,t,r)}await this.client.core.history.resolve(h)}),uQ(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;n0(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{n0(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),uQ(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),uQ(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===uL.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=uL.active;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=uL.idle}),uQ(this,"processRequest",async e=>{let{topic:t,payload:r,attestation:i,transportType:s,encryptedId:n}=e,o=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:o}))switch(o){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${o}`)}}),uQ(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r,transportType:i}=e,s=(await this.client.core.history.get(t,r.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${s}`)}}),uQ(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:r}=cv("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)}),uQ(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),uQ(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:r,attestation:i,encryptedId:s}=e,{params:n,id:o}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(la.proposal_listener_not_found)),this.isValidConnect(uY({},r.params));let a=n.expiryTimestamp||nX(uk.wc_sessionPropose.req.ttl),c=uY({id:o,pairingTopic:t,expiryTimestamp:a},n);await this.setProposal(o,c);let l=await this.getVerifyContext({attestationId:i,hash:ci(JSON.stringify(r)),encryptedId:s,metadata:c.proposer.metadata});e?.addTrace(lo.emit_session_proposal),this.client.events.emit("session_proposal",{id:o,params:c,verifyContext:l})}catch(e){await this.sendError({id:o,topic:t,error:e,rpcOpts:uk.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),uQ(this,"onSessionProposeResponse",async(e,t,r)=>{let{id:i}=t;if((0,cq.isJsonRpcResult)(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let o=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});let a=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});let c=await this.client.core.crypto.generateSharedKey(o,a);this.pendingSessions.set(i,{sessionTopic:c,pairingTopic:e,proposalId:i,publicKey:o});let l=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if((0,cq.isJsonRpcError)(t)){await this.client.proposal.delete(i,cE("USER_DISCONNECTED"));let e=n1("session_connect",i);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),uQ(this,"onSessionSettleRequest",async(e,t)=>{let{id:r,params:i}=t;try{this.isValidSessionSettleRequest(i);let{relay:r,controller:s,expiry:n,namespaces:o,sessionProperties:a,sessionConfig:c}=t.params,l=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!l)return this.client.logger.error(`Pending session not found for topic ${e}`);let h=this.client.proposal.get(l.proposalId),u=uG(uY(uY({topic:e,relay:r,expiry:n,namespaces:o,acknowledged:!0,pairingTopic:l.pairingTopic,requiredNamespaces:h.requiredNamespaces,optionalNamespaces:h.optionalNamespaces,controller:s.publicKey,self:{publicKey:l.publicKey,metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},a&&{sessionProperties:a}),c&&{sessionConfig:c}),{transportType:c4.relay});await this.client.session.set(u.topic,u),await this.setExpiry(u.topic,u.expiry),await this.client.core.pairing.updateMetadata({topic:l.pairingTopic,metadata:u.peer.metadata}),this.client.events.emit("session_connect",{session:u}),this.events.emit(n1("session_connect",l.proposalId),{session:u}),this.pendingSessions.delete(l.proposalId),this.deleteProposal(l.proposalId,!1),this.cleanupDuplicatePairings(u),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uQ(this,"onSessionSettleResponse",async(e,t)=>{let{id:r}=t;(0,cq.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(n1("session_approve",r),{})):(0,cq.isJsonRpcError)(t)&&(await this.client.session.delete(e,cE("USER_DISCONNECTED")),this.events.emit(n1("session_approve",r),{error:t.error}))}),uQ(this,"onSessionUpdateRequest",async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,s=cz.get(t);if(s&&this.isRequestOutOfSync(s,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:cE("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(uY({topic:e},r));try{cz.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw cz.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),uQ(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),uQ(this,"onSessionUpdateResponse",(e,t)=>{let{id:r}=t,i=n1("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,cq.isJsonRpcResult)(t)?this.events.emit(n1("session_update",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(n1("session_update",r),{error:t.error})}),uQ(this,"onSessionExtendRequest",async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,nX(uR)),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uQ(this,"onSessionExtendResponse",(e,t)=>{let{id:r}=t,i=n1("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,cq.isJsonRpcResult)(t)?this.events.emit(n1("session_extend",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(n1("session_extend",r),{error:t.error})}),uQ(this,"onSessionPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uQ(this,"onSessionPingResponse",(e,t)=>{let{id:r}=t,i=n1("session_ping",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);setTimeout(()=>{(0,cq.isJsonRpcResult)(t)?this.events.emit(n1("session_ping",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(n1("session_ping",r),{error:t.error})},500)}),uQ(this,"onSessionDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(c2.publish,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:cE("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),uQ(this,"onSessionRequest",async e=>{var t,r,i;let{topic:s,payload:n,attestation:o,encryptedId:a,transportType:c}=e,{id:l,params:h}=n;try{await this.isValidRequest(uY({topic:s},h));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:o,hash:ci(JSON.stringify((0,cq.formatJsonRpcRequest)("wc_sessionRequest",h,l))),encryptedId:a,metadata:e.peer.metadata,transportType:c}),u={id:l,topic:s,params:h,verifyContext:n};await this.setPendingSessionRequest(u),c===c4.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(u):(this.addSessionRequestToSessionRequestQueue(u),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:s,error:e}),this.client.logger.error(e)}}),uQ(this,"onSessionRequestResponse",(e,t)=>{let{id:r}=t,i=n1("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,cq.isJsonRpcResult)(t)?this.events.emit(n1("session_request",r),{result:t.result}):(0,cq.isJsonRpcError)(t)&&this.events.emit(n1("session_request",r),{error:t.error})}),uQ(this,"onSessionEventRequest",async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,s=cz.get(t);if(s&&this.isRequestOutOfSync(s,r)){this.client.logger.info(`Discarding out of sync request - ${r}`);return}this.isValidEmit(uY({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),cz.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),uQ(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,cq.isJsonRpcResult)(t)?this.events.emit(n1("session_request",r),{result:t.result}):(0,cq.isJsonRpcError)(t)&&this.events.emit(n1("session_request",r),{error:t.error})}),uQ(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:r,payload:i,attestation:s,encryptedId:n,transportType:o}=e;try{let{requester:e,authPayload:a,expiryTimestamp:c}=i.params,l=await this.getVerifyContext({attestationId:s,hash:ci(JSON.stringify(i)),encryptedId:n,metadata:e.metadata,transportType:o}),h={requester:e,pairingTopic:r,id:i.id,authPayload:a,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(i.id,{request:h,pairingTopic:r,transportType:o}),o===c4.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:l})}catch(n){this.client.logger.error(n);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(i.params.requester.metadata,o);await this.sendError({id:i.id,topic:r,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:uk.wc_sessionAuthenticate.autoReject,appLink:s})}}),uQ(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),uQ(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=uL.idle,this.processSessionRequestQueue()},(0,er.toMiliseconds)(this.requestQueueDelay))}),uQ(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=n1("session_request",e.request.id);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);this.events.emit(n1("session_request",e.request.id),{error:t})})}),uQ(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===uL.active){this.client.logger.info("session request queue is already active.");return}let e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=uL.active,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),uQ(this,"emitSessionRequest",e=>{this.client.events.emit("session_request",e)}),uQ(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,cq.formatJsonRpcRequest)("wc_sessionPropose",{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties},t.id)})}),uQ(this,"isValidConnect",async e=>{let t;if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,relays:o}=e;if(cC(r)||await this.isValidPairingTopic(r),t=!1,o?o&&cI(o)&&o.length&&o.forEach(e=>{t=cx(e)}):t=!0,!t){let{message:e}=cv("MISSING_OR_INVALID",`connect() relays: ${o}`);throw Error(e)}cC(i)||0===c_(i)||this.validateNamespaces(i,"requiredNamespaces"),cC(s)||0===c_(s)||this.validateNamespaces(s,"optionalNamespaces"),cC(n)||this.validateSessionProps(n,"sessionProperties")}),uQ(this,"validateNamespaces",(e,t)=>{let r=function(e,t,r){let i=null;if(e&&c_(e)){let s;let n=cM(e,t);n&&(i=n);let o=(s=null,Object.entries(e).forEach(([e,i])=>{var n,o;let a;if(s)return;let c=(n=nL(e,i),o=`${t} ${r}`,a=null,cI(n)&&n.length?n.forEach(e=>{a||cA(e)||(a=cE("UNSUPPORTED_CHAINS",`${o}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):cA(e)||(a=cE("UNSUPPORTED_CHAINS",`${o}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),a);c&&(s=c)}),s);o&&(i=o)}else i=cv("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)}),uQ(this,"isValidApprove",async e=>{if(!cT(e))throw Error(cv("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:s}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let n=this.client.proposal.get(t),o=cP(r,"approve()");if(o)throw Error(o.message);let a=cR(n.requiredNamespaces,r,"approve()");if(a)throw Error(a.message);if(!cS(i,!0)){let{message:e}=cv("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}cC(s)||this.validateSessionProps(s,"sessionProperties")}),uQ(this,"isValidReject",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!cN(r.code,!1)||!r.message||!cS(r.message,!1)){let{message:e}=cv("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}}),uQ(this,"isValidSessionSettleRequest",e=>{let t;if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:s,expiry:n}=e;if(!cx(r)){let{message:e}=cv("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let o=(t=null,cS(i?.publicKey,!1)||(t=cv("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(o)throw Error(o.message);let a=cP(s,"onSessionSettleRequest()");if(a)throw Error(a.message);if(n0(n)){let{message:e}=cv("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),uQ(this,"isValidUpdate",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),s=cP(r,"update()");if(s)throw Error(s.message);let n=cR(i.requiredNamespaces,r,"update()");if(n)throw Error(n.message)}),uQ(this,"isValidExtend",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),uQ(this,"isValidRequest",async e=>{var t;if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:r,request:i,chainId:s,expiry:n}=e;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!cD(o,s)){let{message:e}=cv("MISSING_OR_INVALID",`request() chainId: ${s}`);throw Error(e)}if(cC(i)||!cS(i.method,!1)){let{message:e}=cv("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!(cS(t=i.method,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{cf(e.accounts).includes(t)&&r.push(...e.methods)}),r})(o,s).includes(t))){let{message:e}=cv("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(n&&(!cN(n,!1)||!(n<=uj.max)||!(n>=uj.min))){let{message:e}=cv("MISSING_OR_INVALID",`request() expiry: ${n}. Expiry must be a number (in seconds) between ${uj.min} and ${uj.max}`);throw Error(e)}}),uQ(this,"isValidRespond",async e=>{var t;if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(cC(i)||cC(i.result)&&cC(i.error)||!cN(i.id,!1)||!cS(i.jsonrpc,!1)){let{message:e}=cv("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}}),uQ(this,"isValidPing",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),uQ(this,"isValidEmit",async e=>{var t;if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:r,event:i,chainId:s}=e;await this.isValidSessionTopic(r);let{namespaces:n}=this.client.session.get(r);if(!cD(n,s)){let{message:e}=cv("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw Error(e)}if(cC(i)||!cS(i.name,!1)){let{message:e}=cv("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}if(!(cS(t=i.name,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{cf(e.accounts).includes(t)&&r.push(...e.events)}),r})(n,s).includes(t))){let{message:e}=cv("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),uQ(this,"isValidDisconnect",async e=>{if(!cT(e)){let{message:t}=cv("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),uQ(this,"isValidAuthenticate",e=>{let{chains:t,uri:r,domain:i,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!cS(r,!1))throw Error("uri is required parameter");if(!cS(i,!1))throw Error("domain is required parameter");if(!cS(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>nj(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=nj(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),uQ(this,"getVerifyContext",async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:s,transportType:n}=e,o={verified:{verifyUrl:s.verifyUrl||li,validation:"UNKNOWN",origin:s.url||""}};try{if(n===c4.link_mode){let e=this.getAppLinkIfEnabled(s,n);return o.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",o}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:s.verifyUrl});e&&(o.verified.origin=e.origin,o.verified.isScam=e.isScam,o.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(o)}`),o}),uQ(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach(e=>{if(!cS(e,!1)){let{message:r}=cv("MISSING_OR_INVALID",`${t} must be in Record<string, string> format. Received: ${JSON.stringify(e)}`);throw Error(r)}})}),uQ(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),uQ(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),uQ(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=cv("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}}),uQ(this,"isLinkModeEnabled",(e,t)=>{var i,s,n,o,a,c,l,h,u;return!!e&&t===c4.link_mode&&(null==(s=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:s.linkMode)===!0&&(null==(o=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:o.universal)!==void 0&&(null==(c=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:c.universal)!==""&&(null==(l=e?.redirect)?void 0:l.universal)!==void 0&&(null==(h=e?.redirect)?void 0:h.universal)!==""&&(null==(u=e?.redirect)?void 0:u.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==r.g?void 0:r.g.Linking)}),uQ(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),uQ(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=n4(e,"topic")||"",r=decodeURIComponent(n4(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:c4.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})}),uQ(this,"registerLinkModeListeners",async()=>{var e;if(n6()||n$()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==r.g?void 0:r.g.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),uQ(this,"shouldSetTVF",(e,t)=>{if(!t||"wc_sessionRequest"!==e)return!1;let{request:r}=t;return Object.keys(uU).includes(r.method)}),uQ(this,"getTVFParams",(e,t,r)=>{var i,s;try{let n=t.request.method,o=this.extractTxHashesFromResult(n,r);return uG(uY({correlationId:e,rpcMethods:[n],chainId:t.chainId},this.isValidContractData(t.request.params)&&{contractAddresses:[null==(s=null==(i=t.request.params)?void 0:i[0])?void 0:s.to]}),{txHashes:o})}catch(e){this.client.logger.warn("Error getting TVF params",e)}return{}}),uQ(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;let i=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2==0}catch{}return!1}),uQ(this,"extractTxHashesFromResult",(e,t)=>{try{let r=uU[e];if("string"==typeof t)return[t];let i=t[r.key];if(cI(i))return i;if("string"==typeof i)return[i]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}isInitialized(){if(!this.initialized){let{message:e}=cv("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(c2.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(uq)?this.client.auth.authKeys.get(uq):{responseTopic:void 0,publicKey:void 0},o=await this.client.core.crypto.decode(t,r,{receiverPublicKey:n,encoding:s===c4.link_mode?a7:a9});try{(0,cq.isJsonRpcRequest)(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o,attestation:i,transportType:s,encryptedId:ci(r)})):(0,cq.isJsonRpcResponse)(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o,transportType:s}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o,transportType:s})}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(lr.expired,async e=>{let{topic:t,id:r}=nZ(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,cv("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,cv("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(le.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(le.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!cS(e,!1)){let{message:t}=cv("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=cv("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(n0(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=cv("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!cS(e,!1)){let{message:t}=cv("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=cv("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(n0(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=cv("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=cv("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(cS(e,!1)){let{message:t}=cv("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=cv("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=cv("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=cv("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(n0(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=cv("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class uX extends hQ{constructor(e,t){super(e,t,"proposal",uP),this.core=e,this.logger=t}}class u0 extends hQ{constructor(e,t){super(e,t,"session",uP),this.core=e,this.logger=t}}class u1 extends hQ{constructor(e,t){super(e,t,"request",uP,e=>e.id),this.core=e,this.logger=t}}class u2 extends hQ{constructor(e,t){super(e,t,"authKeys",u$,()=>uq),this.core=e,this.logger=t}}class u3 extends hQ{constructor(e,t){super(e,t,"pairingTopics",u$),this.core=e,this.logger=t}}class u5 extends hQ{constructor(e,t){super(e,t,"requests",u$,e=>e.id),this.core=e,this.logger=t}}var u4=Object.defineProperty,u8=(e,t,r)=>t in e?u4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,u6=(e,t,r)=>u8(e,"symbol"!=typeof t?t+"":t,r);class u9{constructor(e,t){this.core=e,this.logger=t,u6(this,"authKeys"),u6(this,"pairingTopics"),u6(this,"requests"),this.authKeys=new u2(this.core,this.logger),this.pairingTopics=new u3(this.core,this.logger),this.requests=new u5(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var u7=Object.defineProperty,de=(e,t,r)=>t in e?u7(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,dt=(e,t,r)=>de(e,"symbol"!=typeof t?t+"":t,r);class dr extends uA{constructor(e){super(e),dt(this,"protocol","wc"),dt(this,"version",2),dt(this,"name",ux.name),dt(this,"metadata"),dt(this,"core"),dt(this,"logger"),dt(this,"events",new ee.EventEmitter),dt(this,"engine"),dt(this,"session"),dt(this,"proposal"),dt(this,"pendingRequest"),dt(this,"auth"),dt(this,"signConfig"),dt(this,"on",(e,t)=>this.events.on(e,t)),dt(this,"once",(e,t)=>this.events.once(e,t)),dt(this,"off",(e,t)=>this.events.off(e,t)),dt(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),dt(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),dt(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),dt(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),dt(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||ux.name,this.metadata=e?.metadata||nH(),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,e$.gw)((0,e$.jI)({level:e?.logger||ux.logger}));this.core=e?.core||new u_(e),this.logger=(0,e$.Ep)(t,this.name),this.session=new u0(this.core,this.logger),this.proposal=new uX(this.core,this.logger),this.pendingRequest=new u1(this.core,this.logger),this.engine=new uZ(this),this.auth=new u9(this.core,this.logger)}static async init(e){let t=new dr(e);return await t.initialize(),t}get context(){return(0,e$.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},(0,er.toMiliseconds)(er.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var di=r(5071);let ds="error",dn="wc@2:universal_provider:",da="https://rpc.walletconnect.org/v1/",dc="generic",dl=`${da}bundler`,dh="default_chain_changed";var du="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof r.g?r.g:"u">typeof self?self:{},dd=function(e,t){return e===t||e!=e&&t!=t},dp=function(e,t){for(var r=e.length;r--;)if(dd(e[r][0],t))return r;return -1},df=Array.prototype.splice;function dg(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}dg.prototype.clear=function(){this.__data__=[],this.size=0},dg.prototype.delete=function(e){var t=this.__data__,r=dp(t,e);return!(r<0)&&(r==t.length-1?t.pop():df.call(t,r,1),--this.size,!0)},dg.prototype.get=function(e){var t=this.__data__,r=dp(t,e);return r<0?void 0:t[r][1]},dg.prototype.has=function(e){return dp(this.__data__,e)>-1},dg.prototype.set=function(e,t){var r=this.__data__,i=dp(r,e);return i<0?(++this.size,r.push([e,t])):r[i][1]=t,this};var dm="object"==typeof du&&du&&du.Object===Object&&du,dy="object"==typeof self&&self&&self.Object===Object&&self,db=dm||dy||Function("return this")(),dw=db.Symbol,dv=Object.prototype,dE=dv.hasOwnProperty,dI=dv.toString,d_=dw?dw.toStringTag:void 0,dC=Object.prototype.toString,dS=function(e){var t=dE.call(e,d_),r=e[d_];try{e[d_]=void 0;var i=!0}catch{}var s=dI.call(e);return i&&(t?e[d_]=r:delete e[d_]),s},dN=dw?dw.toStringTag:void 0,dA=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":dN&&dN in Object(e)?dS(e):dC.call(e)},dO=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},dM=function(e){if(!dO(e))return!1;var t=dA(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},dP=db["__core-js_shared__"],dx=(h=/[^.]+$/.exec(dP&&dP.keys&&dP.keys.IE_PROTO||""))?"Symbol(src)_1."+h:"",dT=Function.prototype.toString,dD=function(e){if(null!=e){try{return dT.call(e)}catch{}try{return e+""}catch{}}return""},dR=/^\[object .+?Constructor\]$/,dk=Object.prototype,dj=Function.prototype.toString,dL=dk.hasOwnProperty,dU=RegExp("^"+dj.call(dL).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),dz=function(e,t){var r,i=e?.[t];return dO(r=i)&&(!dx||!(dx in r))&&(dM(r)?dU:dR).test(dD(r))?i:void 0},d$=dz(db,"Map"),dq=dz(Object,"create"),dB=Object.prototype.hasOwnProperty,dW=Object.prototype.hasOwnProperty;function dH(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}dH.prototype.clear=function(){this.__data__=dq?dq(null):{},this.size=0},dH.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},dH.prototype.get=function(e){var t=this.__data__;if(dq){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return dB.call(t,e)?t[e]:void 0},dH.prototype.has=function(e){var t=this.__data__;return dq?void 0!==t[e]:dW.call(t,e)},dH.prototype.set=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=dq&&void 0===t?"__lodash_hash_undefined__":t,this};var dF=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},dV=function(e,t){var r=e.__data__;return dF(t)?r["string"==typeof t?"string":"hash"]:r.map};function dK(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var i=e[t];this.set(i[0],i[1])}}function dJ(e){var t=this.__data__=new dg(e);this.size=t.size}dK.prototype.clear=function(){this.size=0,this.__data__={hash:new dH,map:new(d$||dg),string:new dH}},dK.prototype.delete=function(e){var t=dV(this,e).delete(e);return this.size-=t?1:0,t},dK.prototype.get=function(e){return dV(this,e).get(e)},dK.prototype.has=function(e){return dV(this,e).has(e)},dK.prototype.set=function(e,t){var r=dV(this,e),i=r.size;return r.set(e,t),this.size+=r.size==i?0:1,this},dJ.prototype.clear=function(){this.__data__=new dg,this.size=0},dJ.prototype.delete=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r},dJ.prototype.get=function(e){return this.__data__.get(e)},dJ.prototype.has=function(e){return this.__data__.has(e)},dJ.prototype.set=function(e,t){var r=this.__data__;if(r instanceof dg){var i=r.__data__;if(!d$||i.length<199)return i.push([e,t]),this.size=++r.size,this;r=this.__data__=new dK(i)}return r.set(e,t),this.size=r.size,this};var dY=function(){try{var e=dz(Object,"defineProperty");return e({},"",{}),e}catch{}}(),dG=function(e,t,r){"__proto__"==t&&dY?dY(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},dQ=function(e,t,r){(void 0===r||dd(e[t],r))&&(void 0!==r||t in e)||dG(e,t,r)},dZ={exports:{}};g=(f=(p=(d=(u=dZ.exports)&&!u.nodeType&&u)&&dZ&&!dZ.nodeType&&dZ)&&p.exports===d?db.Buffer:void 0)?f.allocUnsafe:void 0,dZ.exports=function(e,t){if(t)return e.slice();var r=e.length,i=g?g(r):new e.constructor(r);return e.copy(i),i};var dX=db.Uint8Array,d0=function(e){var t=new e.constructor(e.byteLength);return new dX(t).set(new dX(e)),t},d1=Object.create,d2=function(){function e(){}return function(t){if(!dO(t))return{};if(d1)return d1(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),d3=(m=Object.getPrototypeOf,y=Object,function(e){return m(y(e))}),d5=Object.prototype,d4=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||d5)},d8=function(e){return null!=e&&"object"==typeof e},d6=function(e){return d8(e)&&"[object Arguments]"==dA(e)},d9=Object.prototype,d7=d9.hasOwnProperty,pe=d9.propertyIsEnumerable,pt=d6(function(){return arguments}())?d6:function(e){return d8(e)&&d7.call(e,"callee")&&!pe.call(e,"callee")},pr=Array.isArray,pi=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},ps=function(e){return null!=e&&pi(e.length)&&!dM(e)},pn={exports:{}};I=(E=(v=(w=(b=pn.exports)&&!b.nodeType&&b)&&pn&&!pn.nodeType&&pn)&&v.exports===w?db.Buffer:void 0)?E.isBuffer:void 0,pn.exports=I||function(){return!1};var po=Object.prototype,pa=Function.prototype.toString,pc=po.hasOwnProperty,pl=pa.call(Object),ph={};ph["[object Float32Array]"]=ph["[object Float64Array]"]=ph["[object Int8Array]"]=ph["[object Int16Array]"]=ph["[object Int32Array]"]=ph["[object Uint8Array]"]=ph["[object Uint8ClampedArray]"]=ph["[object Uint16Array]"]=ph["[object Uint32Array]"]=!0,ph["[object Arguments]"]=ph["[object Array]"]=ph["[object ArrayBuffer]"]=ph["[object Boolean]"]=ph["[object DataView]"]=ph["[object Date]"]=ph["[object Error]"]=ph["[object Function]"]=ph["[object Map]"]=ph["[object Number]"]=ph["[object Object]"]=ph["[object RegExp]"]=ph["[object Set]"]=ph["[object String]"]=ph["[object WeakMap]"]=!1;var pu={exports:{}};N=(S=(C=(_=pu.exports)&&!_.nodeType&&_)&&pu&&!pu.nodeType&&pu)&&S.exports===C&&dm.process,A=function(){try{return S&&S.require&&S.require("util").types||N&&N.binding&&N.binding("util")}catch{}}(),pu.exports=A;var pd=pu.exports,pp=pd&&pd.isTypedArray,pf=pp?function(e){return pp(e)}:function(e){return d8(e)&&pi(e.length)&&!!ph[dA(e)]},pg=function(e,t){if(!("constructor"===t&&"function"==typeof e[t])&&"__proto__"!=t)return e[t]},pm=Object.prototype.hasOwnProperty,py=function(e,t,r){var i=e[t];pm.call(e,t)&&dd(i,r)&&(void 0!==r||t in e)||dG(e,t,r)},pb=/^(?:0|[1-9]\d*)$/,pw=function(e,t){var r=typeof e;return!!(t=t??9007199254740991)&&("number"==r||"symbol"!=r&&pb.test(e))&&e>-1&&e%1==0&&e<t},pv=function(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i},pE=pn.exports,pI=Object.prototype.hasOwnProperty,p_=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t},pC=Object.prototype.hasOwnProperty,pS=function(e,t){var r=pr(e),i=!r&&pt(e),s=!r&&!i&&pE(e),n=!r&&!i&&!s&&pf(e),o=r||i||s||n,a=o?pv(e.length,String):[],c=a.length;for(var l in e)(t||pI.call(e,l))&&!(o&&("length"==l||s&&("offset"==l||"parent"==l)||n&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||pw(l,c)))&&a.push(l);return a},pN=function(e){if(!dO(e))return p_(e);var t=d4(e),r=[];for(var i in e)"constructor"==i&&(t||!pC.call(e,i))||r.push(i);return r},pA=function(e){return ps(e)?pS(e,!0):pN(e)},pO=function(e,t,r,i){var s=!r;r||(r={});for(var n=-1,o=t.length;++n<o;){var a=t[n],c=i?i(r[a],e[a],a,r,e):void 0;void 0===c&&(c=e[a]),s?dG(r,a,c):py(r,a,c)}return r},pM=dZ.exports,pP=function(e,t){var r=t?d0(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)},px=function(e,t){var r=-1,i=e.length;for(t||(t=Array(i));++r<i;)t[r]=e[r];return t},pT=pn.exports,pD=function(e){if(!d8(e)||"[object Object]"!=dA(e))return!1;var t=d3(e);if(null===t)return!0;var r=pc.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&pa.call(r)==pl},pR=function(e,t,r){for(var i=-1,s=Object(e),n=r(e),o=n.length;o--;){var a=n[++i];if(!1===t(s[a],a,s))break}return e},pk=function(e,t,r,i,s,n,o){var a=pg(e,r),c=pg(t,r),l=o.get(c);if(l){dQ(e,r,l);return}var h=n?n(a,c,r+"",e,t,o):void 0,u=void 0===h;if(u){var d=pr(c),p=!d&&pT(c),f=!d&&!p&&pf(c);h=c,d||p||f?pr(a)?h=a:d8(a)&&ps(a)?h=px(a):p?(u=!1,h=pM(c,!0)):f?(u=!1,h=pP(c,!0)):h=[]:pD(c)||pt(c)?(h=a,pt(a)?h=pO(a,pA(a)):(!dO(a)||dM(a))&&(h="function"!=typeof c.constructor||d4(c)?{}:d2(d3(c)))):u=!1}u&&(o.set(c,h),s(h,c,i,n,o),o.delete(c)),dQ(e,r,h)},pj=function(e){return e},pL=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},pU=Math.max,pz=dY?function(e,t){return dY(e,"toString",{configurable:!0,enumerable:!1,value:function(){return t},writable:!0})}:pj,p$=Date.now,pq=(O=0,M=0,function(){var e=p$(),t=16-(e-M);if(M=e,t>0){if(++O>=800)return arguments[0]}else O=0;return pz.apply(void 0,arguments)}),pB=function(e,t,r){if(!dO(r))return!1;var i=typeof t;return("number"==i?!!(ps(r)&&pw(t,r.length)):"string"==i&&t in r)&&dd(r[t],e)},pW=function e(t,r,i,s,n){t!==r&&pR(r,function(o,a){if(n||(n=new dJ),dO(o))pk(t,r,a,i,e,s,n);else{var c=s?s(pg(t,a),o,a+"",t,r,n):void 0;void 0===c&&(c=o),dQ(t,a,c)}},pA)},pH=(P=function(e,t,r){pW(e,t,r)},n=function(e,t){var r=-1,i=t.length,s=i>1?t[i-1]:void 0,n=i>2?t[2]:void 0;for(s=P.length>3&&"function"==typeof s?(i--,s):void 0,n&&pB(t[0],t[1],n)&&(s=i<3?void 0:s,i=1),e=Object(e);++r<i;){var o=t[r];o&&P(e,o,r,s)}return e},pq((a=pU(void 0===(a=o)?n.length-1:a,0),function(){for(var e=arguments,t=-1,r=pU(e.length-a,0),i=Array(r);++t<r;)i[t]=e[a+t];t=-1;for(var s=Array(a+1);++t<a;)s[t]=e[t];return s[a]=pj(i),pL(n,this,s)}),n+"")),pF=Object.defineProperty,pV=Object.defineProperties,pK=Object.getOwnPropertyDescriptors,pJ=Object.getOwnPropertySymbols,pY=Object.prototype.hasOwnProperty,pG=Object.prototype.propertyIsEnumerable,pQ=(e,t,r)=>t in e?pF(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,pZ=(e,t)=>{for(var r in t||(t={}))pY.call(t,r)&&pQ(e,r,t[r]);if(pJ)for(var r of pJ(t))pG.call(t,r)&&pQ(e,r,t[r]);return e},pX=(e,t)=>pV(e,pK(t));function p0(e,t,r){var i;let s=nj(e);return(null==(i=t.rpcMap)?void 0:i[s.reference])||`${da}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function p1(e){return e.includes(":")?e.split(":")[1]:e}function p2(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function p3(e={},t={}){return pH(p5(e),p5(t))}function p5(e){var t,r,i,s;let n={};if(!c_(e))return n;for(let[o,a]of Object.entries(e)){let e=cg(o)?[o]:a.chains,c=a.methods||[],l=a.events||[],h=a.rpcMap||{},u=cm(o);n[u]=pX(pZ(pZ({},n[u]),a),{chains:n2(e,null==(t=n[u])?void 0:t.chains),methods:n2(c,null==(r=n[u])?void 0:r.methods),events:n2(l,null==(i=n[u])?void 0:i.events),rpcMap:pZ(pZ({},h),null==(s=n[u])?void 0:s.rpcMap)})}return n}function p4(e){return e.includes(":")?e.split(":")[2]:e}function p8(e){let t={};for(let[r,i]of Object.entries(e)){let e=i.methods||[],s=i.events||[],n=i.accounts||[],o=cg(r)?[r]:i.chains?i.chains:p2(i.accounts);t[r]={chains:o,methods:e,events:s,accounts:n}}return t}function p6(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let p9={},p7=e=>p9[e],fe=(e,t)=>{p9[e]=t};var ft=Object.defineProperty,fr=(e,t,r)=>t in e?ft(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fi=(e,t,r)=>fr(e,"symbol"!=typeof t?t+"":t,r);class fs{constructor(e){fi(this,"name","polkadot"),fi(this,"client"),fi(this,"httpProviders"),fi(this,"events"),fi(this,"namespace"),fi(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=p1(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fn=Object.defineProperty,fo=Object.defineProperties,fa=Object.getOwnPropertyDescriptors,fc=Object.getOwnPropertySymbols,fl=Object.prototype.hasOwnProperty,fh=Object.prototype.propertyIsEnumerable,fu=(e,t,r)=>t in e?fn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fd=(e,t)=>{for(var r in t||(t={}))fl.call(t,r)&&fu(e,r,t[r]);if(fc)for(var r of fc(t))fh.call(t,r)&&fu(e,r,t[r]);return e},fp=(e,t)=>fo(e,fa(t)),ff=(e,t,r)=>fu(e,"symbol"!=typeof t?t+"":t,r);class fg{constructor(e){ff(this,"name","eip155"),ff(this,"client"),ff(this,"chainId"),ff(this,"namespace"),ff(this,"httpProviders"),ff(this,"events"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(dh,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||p0(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.k(r,p7("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(p1(t));e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",s=parseInt(i=i.startsWith("0x")?i:`0x${i}`,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${s}`);else throw Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i;let s=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0];if(!s)throw Error("Missing address parameter in `wallet_getCapabilities` request");let n=this.client.session.get(e.topic),o=(null==(i=n?.sessionProperties)?void 0:i.capabilities)||{};if(null!=o&&o[s])return o?.[s];let a=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:fp(fd({},n.sessionProperties||{}),{capabilities:fp(fd({},o||{}),{[s]:a})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return a}async getCallStatus(e){var t,r;let i=this.client.session.get(e.topic),s=null==(t=i.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let n=null==(r=i.sessionProperties)?void 0:r.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,cq.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!s.ok)throw Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${dl}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var fm=Object.defineProperty,fy=(e,t,r)=>t in e?fm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fb=(e,t,r)=>fy(e,"symbol"!=typeof t?t+"":t,r);class fw{constructor(e){fb(this,"name","solana"),fb(this,"client"),fb(this,"httpProviders"),fb(this,"events"),fb(this,"namespace"),fb(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=p1(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fv=Object.defineProperty,fE=(e,t,r)=>t in e?fv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fI=(e,t,r)=>fE(e,"symbol"!=typeof t?t+"":t,r);class f_{constructor(e){fI(this,"name","cosmos"),fI(this,"client"),fI(this,"httpProviders"),fI(this,"events"),fI(this,"namespace"),fI(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=p1(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fC=Object.defineProperty,fS=(e,t,r)=>t in e?fC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fN=(e,t,r)=>fS(e,"symbol"!=typeof t?t+"":t,r);class fA{constructor(e){fN(this,"name","algorand"),fN(this,"client"),fN(this,"httpProviders"),fN(this,"events"),fN(this,"namespace"),fN(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){let r=t||p0(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(dh,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fO=Object.defineProperty,fM=(e,t,r)=>t in e?fO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fP=(e,t,r)=>fM(e,"symbol"!=typeof t?t+"":t,r);class fx{constructor(e){fP(this,"name","cip34"),fP(this,"client"),fP(this,"httpProviders"),fP(this,"events"),fP(this,"namespace"),fP(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let r=this.getCardanoRPCUrl(t),i=p1(t);e[i]=this.createHttpProvider(i,r)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||this.getCardanoRPCUrl(e);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fT=Object.defineProperty,fD=(e,t,r)=>t in e?fT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fR=(e,t,r)=>fD(e,"symbol"!=typeof t?t+"":t,r);class fk{constructor(e){fR(this,"name","elrond"),fR(this,"client"),fR(this,"httpProviders"),fR(this,"events"),fR(this,"namespace"),fR(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=p1(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fj=Object.defineProperty,fL=(e,t,r)=>t in e?fj(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fU=(e,t,r)=>fL(e,"symbol"!=typeof t?t+"":t,r);class fz{constructor(e){fU(this,"name","multiversx"),fU(this,"client"),fU(this,"httpProviders"),fU(this,"events"),fU(this,"namespace"),fU(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=p1(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var f$=Object.defineProperty,fq=(e,t,r)=>t in e?f$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fB=(e,t,r)=>fq(e,"symbol"!=typeof t?t+"":t,r);class fW{constructor(e){fB(this,"name","near"),fB(this,"client"),fB(this,"httpProviders"),fB(this,"events"),fB(this,"namespace"),fB(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let r=t||p0(`${this.name}:${e}`,this.namespace);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(dh,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace);return typeof r>"u"?void 0:new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fH=Object.defineProperty,fF=(e,t,r)=>t in e?fH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fV=(e,t,r)=>fF(e,"symbol"!=typeof t?t+"":t,r);class fK{constructor(e){fV(this,"name","tezos"),fV(this,"client"),fV(this,"httpProviders"),fV(this,"events"),fV(this,"namespace"),fV(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let r=t||p0(`${this.name}:${e}`,this.namespace);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(dh,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace);return typeof r>"u"?void 0:new c$.r(new di.Z(r))}}var fJ=Object.defineProperty,fY=(e,t,r)=>t in e?fJ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fG=(e,t,r)=>fY(e,"symbol"!=typeof t?t+"":t,r);class fQ{constructor(e){fG(this,"name",dc),fG(this,"client"),fG(this,"httpProviders"),fG(this,"events"),fG(this,"namespace"),fG(this,"chainId"),this.namespace=e.namespace,this.events=p7("events"),this.client=p7("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(dh,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{let t=nj(e);r[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),r}getHttpProvider(e){let t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||p0(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,p7("disableProviderPing")))}}var fZ=Object.defineProperty,fX=Object.defineProperties,f0=Object.getOwnPropertyDescriptors,f1=Object.getOwnPropertySymbols,f2=Object.prototype.hasOwnProperty,f3=Object.prototype.propertyIsEnumerable,f5=(e,t,r)=>t in e?fZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,f4=(e,t)=>{for(var r in t||(t={}))f2.call(t,r)&&f5(e,r,t[r]);if(f1)for(var r of f1(t))f3.call(t,r)&&f5(e,r,t[r]);return e},f8=(e,t)=>fX(e,f0(t)),f6=(e,t,r)=>f5(e,"symbol"!=typeof t?t+"":t,r);class f9{constructor(e){f6(this,"client"),f6(this,"namespaces"),f6(this,"optionalNamespaces"),f6(this,"sessionProperties"),f6(this,"events",new(et())),f6(this,"rpcProviders",{}),f6(this,"session"),f6(this,"providerOpts"),f6(this,"logger"),f6(this,"uri"),f6(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,e$.gw)((0,e$.jI)({level:e?.logger||ds})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new f9(e);return await t.initialize(),t}async request(e,t,r){let[i,s]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(i).request({request:f4({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let s=new Date().getTime();this.request(e,r,i).then(e=>t(null,(0,cq.formatJsonRpcResult)(s,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:cE("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let s=await i();if(this.session=s.session,this.session){let e=p8(this.session.namespaces);this.namespaces=p3(this.namespaces,e),this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await r();this.session=i;let s=p8(i.namespaces);return this.namespaces=p3(this.namespaces,s),this.persist("namespaces",this.namespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e),s=this.getProvider(r);s.name===dc?s.setDefaultChain(`${r}:${i}`,t):s.setDefaultChain(i,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(cI(t)){for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){let e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await dr.init({core:this.providerOpts.core,logger:this.providerOpts.logger||ds,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>cm(e)))];fe("client",this.client),fe("events",this.events),fe("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];let i=[];return r.forEach(e=>{let r=t.namespaces[e].accounts;i.push(...r)}),i}(e,this.session),r=p2(t),i=f8(f4({},p3(this.namespaces,this.optionalNamespaces)[e]),{accounts:t,chains:r});switch(e){case"eip155":this.rpcProviders[e]=new fg({namespace:i});break;case"algorand":this.rpcProviders[e]=new fA({namespace:i});break;case"solana":this.rpcProviders[e]=new fw({namespace:i});break;case"cosmos":this.rpcProviders[e]=new f_({namespace:i});break;case"polkadot":this.rpcProviders[e]=new fs({namespace:i});break;case"cip34":this.rpcProviders[e]=new fx({namespace:i});break;case"elrond":this.rpcProviders[e]=new fk({namespace:i});break;case"multiversx":this.rpcProviders[e]=new fz({namespace:i});break;case"near":this.rpcProviders[e]=new fW({namespace:i});break;case"tezos":this.rpcProviders[e]=new fK({namespace:i});break;default:this.rpcProviders[dc]?this.rpcProviders[dc].updateNamespace(i):this.rpcProviders[dc]=new fQ({namespace:i})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{let{params:t}=e,{event:r}=t;if("accountsChanged"===r.name){let e=r.data;e&&cI(e)&&this.events.emit("accountsChanged",e.map(p4))}else if("chainChanged"===r.name){let e=t.chainId,r=t.event.data,i=cm(e),s=p6(e)!==p6(r)?`${i}:${p6(r)}`:e;this.onChainChanged(s)}else this.events.emit(r.name,r.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r;let{namespaces:i}=t,s=null==(r=this.client)?void 0:r.session.get(e);this.session=f8(f4({},s),{namespaces:i}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",f8(f4({},cE("USER_DISCONNECTED")),{data:e.topic}))}),this.on(dh,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[dc]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t,optionalNamespaces:r,sessionProperties:i}=e;t&&Object.keys(t).length&&(this.namespaces=t),r&&Object.keys(r).length&&(this.optionalNamespaces=r),this.sessionProperties=i,this.persist("namespaces",t),this.persist("optionalNamespaces",r)}validateChain(e){let[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>cm(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];let i=cm(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){if(!this.namespaces)return;let[r,i]=this.validateChain(e);i&&(t||this.getProvider(r).setDefaultChain(i),this.namespaces[r]?this.namespaces[r].defaultChain=i:this.namespaces[`${r}:${i}`]?this.namespaces[`${r}:${i}`].defaultChain=i:this.namespaces[`${r}:${i}`]={defaultChain:i},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",i))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${dn}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${dn}/${e}`)}}var f7=r(54173),ge=r(93046),gt=r(53357),gr=r(48415),gi=r(82957).Buffer;function gs(e,...t){try{var r;return(r=e(...t))&&"function"==typeof r.then?r:Promise.resolve(r)}catch(e){return Promise.reject(e)}}function gn(e){if(function(e){let t=typeof e;return null===e||"object"!==t&&"function"!==t}(e))return String(e);if(function(e){let t=Object.getPrototypeOf(e);return!t||t.isPrototypeOf(Object)}(e)||Array.isArray(e))return JSON.stringify(e);if("function"==typeof e.toJSON)return gn(e.toJSON());throw Error("[unstorage] Cannot stringify value!")}let go="base64:";function ga(e){return e&&e.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function gc(e){return(e=ga(e))?e+":":""}let gl=()=>{let e=new Map;return{name:"memory",getInstance:()=>e,hasItem:t=>e.has(t),getItem:t=>e.get(t)??null,getItemRaw:t=>e.get(t)??null,setItem(t,r){e.set(t,r)},setItemRaw(t,r){e.set(t,r)},removeItem(t){e.delete(t)},getKeys:()=>[...e.keys()],clear(){e.clear()},dispose(){e.clear()}}};function gh(e,t,r){return e.watch?e.watch((e,i)=>t(e,r+i)):()=>{}}async function gu(e){"function"==typeof e.dispose&&await gs(e.dispose)}var gd=(e={})=>{let t;let r=e.base&&e.base.length>0?`${e.base}:`:"",i=e=>r+e;return e.dbName&&e.storeName&&(t=e_(e.dbName,e.storeName)),{name:"idb-keyval",options:e,hasItem:async e=>!(typeof await eS(i(e),t)>"u"),getItem:async e=>await eS(i(e),t)??null,setItem:(e,r)=>eN(i(e),r,t),removeItem:e=>eA(i(e),t),getKeys:()=>eM(t),clear:()=>eO(t)}};class gp{constructor(){this.indexedDb=function(e={}){let t={mounts:{"":e.driver||gl()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=e=>{for(let r of t.mountpoints)if(e.startsWith(r))return{base:r,relativeKey:e.slice(r.length),driver:t.mounts[r]};return{base:"",relativeKey:e,driver:t.mounts[""]}},i=(e,r)=>t.mountpoints.filter(t=>t.startsWith(e)||r&&e.startsWith(t)).map(r=>({relativeBase:e.length>r.length?e.slice(r.length):void 0,mountpoint:r,driver:t.mounts[r]})),s=(e,r)=>{if(t.watching)for(let i of(r=ga(r),t.watchListeners))i(e,r)},n=async()=>{if(!t.watching)for(let e in t.watching=!0,t.mounts)t.unwatch[e]=await gh(t.mounts[e],s,e)},o=async()=>{if(t.watching){for(let e in t.unwatch)await t.unwatch[e]();t.unwatch={},t.watching=!1}},a=(e,t,i)=>{let s=new Map,n=e=>{let t=s.get(e.base);return t||(t={driver:e.driver,base:e.base,items:[]},s.set(e.base,t)),t};for(let i of e){let e="string"==typeof i,s=ga(e?i:i.key),o=e?void 0:i.value,a=e||!i.options?t:{...t,...i.options},c=r(s);n(c).items.push({key:s,value:o,relativeKey:c.relativeKey,options:a})}return Promise.all([...s.values()].map(e=>i(e))).then(e=>e.flat())},c={hasItem(e,t={}){let{relativeKey:i,driver:s}=r(e=ga(e));return gs(s.hasItem,i,t)},getItem(e,t={}){let{relativeKey:i,driver:s}=r(e=ga(e));return gs(s.getItem,i,t).then(e=>ed(e))},getItems:(e,t={})=>a(e,t,e=>e.driver.getItems?gs(e.driver.getItems,e.items.map(e=>({key:e.relativeKey,options:e.options})),t).then(t=>t.map(t=>({key:function(...e){return ga(e.join(":"))}(e.base,t.key),value:ed(t.value)}))):Promise.all(e.items.map(t=>gs(e.driver.getItem,t.relativeKey,t.options).then(e=>({key:t.key,value:ed(e)}))))),getItemRaw(e,t={}){let{relativeKey:i,driver:s}=r(e=ga(e));return s.getItemRaw?gs(s.getItemRaw,i,t):gs(s.getItem,i,t).then(e=>{var t;return"string"==typeof e&&e.startsWith(go)?(t=e.slice(go.length),globalThis.Buffer?gi.from(t,"base64"):Uint8Array.from(globalThis.atob(t),e=>e.codePointAt(0))):e})},async setItem(e,t,i={}){if(void 0===t)return c.removeItem(e);let{relativeKey:n,driver:o}=r(e=ga(e));o.setItem&&(await gs(o.setItem,n,gn(t),i),o.watch||s("update",e))},async setItems(e,t){await a(e,t,async e=>{if(e.driver.setItems)return gs(e.driver.setItems,e.items.map(e=>({key:e.relativeKey,value:gn(e.value),options:e.options})),t);e.driver.setItem&&await Promise.all(e.items.map(t=>gs(e.driver.setItem,t.relativeKey,gn(t.value),t.options)))})},async setItemRaw(e,t,i={}){if(void 0===t)return c.removeItem(e,i);let{relativeKey:n,driver:o}=r(e=ga(e));if(o.setItemRaw)await gs(o.setItemRaw,n,t,i);else{if(!o.setItem)return;await gs(o.setItem,n,"string"==typeof t?t:go+(globalThis.Buffer?gi.from(t).toString("base64"):globalThis.btoa(String.fromCodePoint(...t))),i)}o.watch||s("update",e)},async removeItem(e,t={}){"boolean"==typeof t&&(t={removeMeta:t});let{relativeKey:i,driver:n}=r(e=ga(e));n.removeItem&&(await gs(n.removeItem,i,t),(t.removeMeta||t.removeMata)&&await gs(n.removeItem,i+"$",t),n.watch||s("remove",e))},async getMeta(e,t={}){"boolean"==typeof t&&(t={nativeOnly:t});let{relativeKey:i,driver:s}=r(e=ga(e)),n=Object.create(null);if(s.getMeta&&Object.assign(n,await gs(s.getMeta,i,t)),!t.nativeOnly){let e=await gs(s.getItem,i+"$",t).then(e=>ed(e));e&&"object"==typeof e&&("string"==typeof e.atime&&(e.atime=new Date(e.atime)),"string"==typeof e.mtime&&(e.mtime=new Date(e.mtime)),Object.assign(n,e))}return n},setMeta(e,t,r={}){return this.setItem(e+"$",t,r)},removeMeta(e,t={}){return this.removeItem(e+"$",t)},async getKeys(e,t={}){let r=i(e=gc(e),!0),s=[],n=[],o=!0;for(let e of r){for(let r of(e.driver.flags?.maxDepth||(o=!1),await gs(e.driver.getKeys,e.relativeBase,t))){let t=e.mountpoint+ga(r);s.some(e=>t.startsWith(e))||n.push(t)}s=[e.mountpoint,...s.filter(t=>!t.startsWith(e.mountpoint))]}let a=void 0!==t.maxDepth&&!o;return n.filter(r=>{var i;return(!a||function(e,t){if(void 0===t)return!0;let r=0,i=e.indexOf(":");for(;i>-1;)r++,i=e.indexOf(":",i+1);return r<=t}(r,t.maxDepth))&&((i=e)?r.startsWith(i)&&"$"!==r[r.length-1]:"$"!==r[r.length-1])})},async clear(e,t={}){e=gc(e),await Promise.all(i(e,!1).map(async e=>e.driver.clear?gs(e.driver.clear,e.relativeBase,t):e.driver.removeItem?Promise.all((await e.driver.getKeys(e.relativeBase||"",t)).map(r=>e.driver.removeItem(r,t))):void 0))},async dispose(){await Promise.all(Object.values(t.mounts).map(e=>gu(e)))},watch:async e=>(await n(),t.watchListeners.push(e),async()=>{t.watchListeners=t.watchListeners.filter(t=>t!==e),0===t.watchListeners.length&&await o()}),async unwatch(){t.watchListeners=[],await o()},mount(e,r){if((e=gc(e))&&t.mounts[e])throw Error(`already mounted at ${e}`);return e&&(t.mountpoints.push(e),t.mountpoints.sort((e,t)=>t.length-e.length)),t.mounts[e]=r,t.watching&&Promise.resolve(gh(r,s,e)).then(r=>{t.unwatch[e]=r}).catch(console.error),c},async unmount(e,r=!0){(e=gc(e))&&t.mounts[e]&&(t.watching&&e in t.unwatch&&(t.unwatch[e]?.(),delete t.unwatch[e]),r&&await gu(t.mounts[e]),t.mountpoints=t.mountpoints.filter(t=>t!==e),delete t.mounts[e])},getMount(e=""){let t=r(e=ga(e)+":");return{driver:t.driver,base:t.base}},getMounts:(e="",t={})=>i(e=ga(e),t.parents).map(e=>({driver:e.driver,base:e.mountpoint})),keys:(e,t={})=>c.getKeys(e,t),get:(e,t={})=>c.getItem(e,t),set:(e,t,r={})=>c.setItem(e,t,r),has:(e,t={})=>c.hasItem(e,t),del:(e,t={})=>c.removeItem(e,t),remove:(e,t={})=>c.removeItem(e,t)};return c}({driver:gd({dbName:"WALLET_CONNECT_V2_INDEXED_DB",storeName:"keyvaluestorage"})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){let t=await this.indexedDb.getItem(e);if(null!==t)return t}async setItem(e,t){await this.indexedDb.setItem(e,(0,eP.u)(t))}async removeItem(e){await this.indexedDb.removeItem(e)}}var gf="u">typeof globalThis?globalThis:"u">typeof window?window:"u">typeof r.g?r.g:"u">typeof self?self:{},gg={exports:{}};function gm(e){var t;return[e[0],(0,eP.D)(null!=(t=e[1])?t:"")]}!function(){function e(){}e.prototype.getItem=function(e){return this.hasOwnProperty(e)?String(this[e]):null},e.prototype.setItem=function(e,t){this[e]=String(t)},e.prototype.removeItem=function(e){delete this[e]},e.prototype.clear=function(){let e=this;Object.keys(e).forEach(function(t){e[t]=void 0,delete e[t]})},e.prototype.key=function(e){return e=e||0,Object.keys(this)[e]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),"u">typeof gf&&gf.localStorage?gg.exports=gf.localStorage:"u">typeof window&&window.localStorage?gg.exports=window.localStorage:gg.exports=new e}();class gy{constructor(){this.localStorage=gg.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(gm)}async getItem(e){let t=this.localStorage.getItem(e);if(null!==t)return(0,eP.D)(t)}async setItem(e,t){this.localStorage.setItem(e,(0,eP.u)(t))}async removeItem(e){this.localStorage.removeItem(e)}}let gb=async(e,t,r)=>{let i="wc_storage_version",s=await t.getItem(i);if(s&&s>=1){r(t);return}let n=await e.getKeys();if(!n.length){r(t);return}let o=[];for(;n.length;){let r=n.shift();if(!r)continue;let i=r.toLowerCase();if(i.includes("wc@")||i.includes("walletconnect")||i.includes("wc_")||i.includes("wallet_connect")){let i=await e.getItem(r);await t.setItem(r,i),o.push(r)}}await t.setItem(i,1),r(t),gw(e,o)},gw=async(e,t)=>{t.length&&t.forEach(async t=>{await e.removeItem(t)})};class gv{constructor(){this.initialized=!1,this.setInitialized=e=>{this.storage=e,this.initialized=!0};let e=new gy;this.storage=e;try{let t=new gp;gb(e,t,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,t){return await this.initialize(),this.storage.setItem(e,t)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{let t=setInterval(()=>{this.initialized&&(clearInterval(t),e())},20)})}}var gE=Object.defineProperty,gI=(e,t,r)=>t in e?gE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g_=(e,t,r)=>gI(e,"symbol"!=typeof t?t+"":t,r);class gC extends ei{constructor(e){super(),this.opts=e,g_(this,"protocol","wc"),g_(this,"version",2)}}var gS=Object.defineProperty,gN=(e,t,r)=>t in e?gS(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,gA=(e,t,r)=>gN(e,"symbol"!=typeof t?t+"":t,r);class gO extends ei{constructor(e,t){super(),this.core=e,this.logger=t,gA(this,"records",new Map)}}class gM{constructor(e,t){this.logger=e,this.core=t}}class gP extends ei{constructor(e,t){super(),this.relayer=e,this.logger=t}}class gx extends ei{constructor(e){super()}}class gT{constructor(e,t,r,i){this.core=e,this.logger=t,this.name=r}}class gD extends ei{constructor(e,t){super(),this.relayer=e,this.logger=t}}class gR extends ei{constructor(e,t){super(),this.core=e,this.logger=t}}class gk{constructor(e,t,r){this.core=e,this.logger=t,this.store=r}}class gj{constructor(e,t){this.projectId=e,this.logger=t}}class gL{constructor(e,t,r){this.core=e,this.logger=t,this.telemetryEnabled=r}}var gU=Object.defineProperty,gz=(e,t,r)=>t in e?gU(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,g$=(e,t,r)=>gz(e,"symbol"!=typeof t?t+"":t,r);class gq{constructor(e){this.opts=e,g$(this,"protocol","wc"),g$(this,"version",2)}}class gB{constructor(e){this.client=e}}let gW="2.23.2",gH={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${gW}`};class gF extends Error{constructor(e,t={}){let r=t.cause instanceof gF?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof gF&&t.cause.docsPath||t.docsPath,s=gH.getDocsUrl?.({...t,docsPath:i});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...r?[`Details: ${r}`]:[],...gH.version?[`Version: ${gH.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=gW}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,r):r?null:t}(this,e)}}function gV(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}class gK extends gF{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function gJ(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;let i=e.replace("0x","");if(i.length>2*r)throw new gK({size:Math.ceil(i.length/2),targetSize:r,type:"hex"});return`0x${i["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new gK({size:e.length,targetSize:r,type:"bytes"});let i=new Uint8Array(r);for(let s=0;s<r;s++){let n="right"===t;i[n?s:r-s-1]=e[n?s:e.length-s-1]}return i}(e,{dir:t,size:r})}class gY extends gF{constructor({max:e,min:t,signed:r,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${8*i}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class gG extends gF{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}function gQ(e){return gV(e,{strict:!1})?Math.ceil((e.length-2)/2):e.length}function gZ(e,{size:t}){if(gQ(e)>t)throw new gG({givenSize:gQ(e),maxSize:t})}function gX(e,t={}){let{signed:r}=t;t.size&&gZ(e,{size:t.size});let i=BigInt(e);if(!r)return i;let s=(e.length-2)/2;return i<=(1n<<8n*BigInt(s)-1n)-1n?i:i-BigInt(`0x${"f".padStart(2*s,"f")}`)-1n}let g0=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function g1(e,t={}){return"number"==typeof e||"bigint"==typeof e?g3(e,t):"string"==typeof e?function(e,t={}){return g2(g5.encode(e),t)}(e,t):"boolean"==typeof e?function(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?(gZ(r,{size:t.size}),gJ(r,{size:t.size})):r}(e,t):g2(e,t)}function g2(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=g0[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(gZ(i,{size:t.size}),gJ(i,{dir:"right",size:t.size})):i}function g3(e,t={}){let r;let{signed:i,size:s}=t,n=BigInt(e);s?r=i?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let o="bigint"==typeof r&&i?-r-1n:0;if(r&&n>r||n<o){let t="bigint"==typeof e?"n":"";throw new gY({max:r?`${r}${t}`:void 0,min:`${o}${t}`,signed:i,size:s,value:`${e}${t}`})}let a=`0x${(i&&n<0?(1n<<BigInt(8*s))+BigInt(n):n).toString(16)}`;return s?gJ(a,{size:s}):a}let g5=new TextEncoder,g4=new TextEncoder,g8={zero:48,nine:57,A:65,F:70,a:97,f:102};function g6(e){return e>=g8.zero&&e<=g8.nine?e-g8.zero:e>=g8.A&&e<=g8.F?e-(g8.A-10):e>=g8.a&&e<=g8.f?e-(g8.a-10):void 0}function g9(e,t={}){let r=e;t.size&&(gZ(r,{size:t.size}),r=gJ(r,{dir:"right",size:t.size}));let i=r.slice(2);i.length%2&&(i=`0${i}`);let s=i.length/2,n=new Uint8Array(s);for(let e=0,t=0;e<s;e++){let r=g6(i.charCodeAt(t++)),s=g6(i.charCodeAt(t++));if(void 0===r||void 0===s)throw new gF(`Invalid byte sequence ("${i[t-2]}${i[t-1]}" in "${i}").`);n[e]=16*r+s}return n}function g7(e,t={}){let r=g4.encode(e);return"number"==typeof t.size?(gZ(r,{size:t.size}),gJ(r,{dir:"right",size:t.size})):r}var me=r(36789);let mt=BigInt(4294967296-1),mr=BigInt(32),mi=(e,t,r)=>e<<r|t>>>32-r,ms=(e,t,r)=>t<<r|e>>>32-r,mn=(e,t,r)=>t<<r-32|e>>>64-r,mo=(e,t,r)=>e<<r-32|t>>>64-r;var ma=r(48466);let mc=[],ml=[],mh=[],mu=BigInt(0),md=BigInt(1),mp=BigInt(2),mf=BigInt(7),mg=BigInt(256),mm=BigInt(113);for(let e=0,t=md,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],mc.push(2*(5*i+r)),ml.push((e+1)*(e+2)/2%64);let s=mu;for(let e=0;e<7;e++)(t=(t<<md^(t>>mf)*mm)%mg)&mp&&(s^=md<<(md<<BigInt(e))-md);mh.push(s)}let[my,mb]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:o}=function(e,t=!1){return t?{h:Number(e&mt),l:Number(e>>mr&mt)}:{h:0|Number(e>>mr&mt),l:0|Number(e&mt)}}(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]}(mh,!0),mw=(e,t,r)=>r>32?mn(e,t,r):mi(e,t,r),mv=(e,t,r)=>r>32?mo(e,t,r):ms(e,t,r);class mE extends ma.kb{constructor(e,t,r,i=!1,s=24){if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,(0,me.k8)(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=(0,ma.Jq)(this.state)}keccak(){ma.iA||(0,ma.l1)(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],o=r[s+1],a=mw(n,o,1)^r[i],c=mv(n,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=ml[r],n=mw(t,s,i),o=mv(t,s,i),a=mc[r];t=e[a],s=e[a+1],e[a]=n,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=my[i],e[1]^=mb[i]}r.fill(0)}(this.state32,this.rounds),ma.iA||(0,ma.l1)(this.state32),this.posOut=0,this.pos=0}update(e){(0,me.$h)(this);let{blockLen:t,state:r}=this,i=(e=(0,ma.O0)(e)).length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){(0,me.$h)(this,!1),(0,me.gk)(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return(0,me.k8)(e),this.xofInto(new Uint8Array(e))}digestInto(e){if((0,me.eB)(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new mE(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}let mI=(0,ma.hE)(()=>new mE(136,1,32));function m_(e,t){let r=mI(gV(e,{strict:!1})?function(e,t={}){return"number"==typeof e||"bigint"==typeof e?g9(g3(e,t)):"boolean"==typeof e?function(e,t={}){let r=new Uint8Array(1);return(r[0]=Number(e),"number"==typeof t.size)?(gZ(r,{size:t.size}),gJ(r,{size:t.size})):r}(e,t):gV(e)?g9(e,t):g7(e,t)}(e):e);return"bytes"===(t||"hex")?r:g1(r)}class mC extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let mS=new mC(8192);async function mN({hash:e,signature:t}){let i=gV(e)?e:g1(e),{secp256k1:s}=await r.e(7024).then(r.bind(r,97024)),n=(()=>{if("object"==typeof t&&"r"in t&&"s"in t){let{r:e,s:r,v:i,yParity:n}=t,o=mA(Number(n??i));return new s.Signature(gX(e),gX(r)).addRecoveryBit(o)}let e=gV(t)?t:g1(t),r=mA(function(e,t={}){return Number(gX(e,t))}(`0x${e.slice(130)}`));return s.Signature.fromCompact(e.substring(2,130)).addRecoveryBit(r)})().recoverPublicKey(i.substring(2)).toHex(!1);return`0x${n}`}function mA(e){if(0===e||1===e)return e;if(27===e)return 0;if(28===e)return 1;throw Error("Invalid yParityOrV value")}async function mO({hash:e,signature:t}){return function(e){let t=m_(`0x${e.substring(4)}`).substring(26);return function(e,t){if(mS.has(`${e}.undefined`))return mS.get(`${e}.undefined`);let r=e.substring(2).toLowerCase(),i=m_(g7(r),"bytes"),s=(t?r.substring(`${t}0x`.length):r).split("");for(let e=0;e<40;e+=2)i[e>>1]>>4>=8&&s[e]&&(s[e]=s[e].toUpperCase()),(15&i[e>>1])>=8&&s[e+1]&&(s[e+1]=s[e+1].toUpperCase());let n=`0x${s.join("")}`;return mS.set(`${e}.${t}`,n),n}(`0x${t}`)}(await mN({hash:e,signature:t}))}var mM=function(e){if(e.length>=255)throw TypeError("Alphabet too long");let t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let r=0;r<e.length;r++){let i=e.charAt(r),s=i.charCodeAt(0);if(255!==t[s])throw TypeError(i+" is ambiguous");t[s]=r}let r=e.length,i=e.charAt(0),s=Math.log(r)/Math.log(256),n=Math.log(256)/Math.log(r);function o(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;let n=0,o=0,a=0;for(;e[n]===i;)o++,n++;let c=(e.length-n)*s+1>>>0,l=new Uint8Array(c);for(;n<e.length;){let i=e.charCodeAt(n);if(i>255)return;let s=t[i];if(255===s)return;let o=0;for(let e=c-1;(0!==s||o<a)&&-1!==e;e--,o++)s+=r*l[e]>>>0,l[e]=s%256>>>0,s=s/256>>>0;if(0!==s)throw Error("Non-zero carry");a=o,n++}let h=c-a;for(;h!==c&&0===l[h];)h++;let u=new Uint8Array(o+(c-h)),d=o;for(;h!==c;)u[d++]=l[h++];return u}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";let s=0,o=0,a=0,c=t.length;for(;a!==c&&0===t[a];)a++,s++;let l=(c-a)*n+1>>>0,h=new Uint8Array(l);for(;a!==c;){let e=t[a],i=0;for(let t=l-1;(0!==e||i<o)&&-1!==t;t--,i++)e+=256*h[t]>>>0,h[t]=e%r>>>0,e=e/r>>>0;if(0!==e)throw Error("Non-zero carry");o=i,a++}let u=l-o;for(;u!==l&&0===h[u];)u++;let d=i.repeat(s);for(;u<l;++u)d+=e.charAt(h[u]);return d},decodeUnsafe:o,decode:function(e){let t=o(e);if(t)return t;throw Error("Non-base"+r+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"),mP=r(25566),mx=r(82957).Buffer;function mT(e){let[t,r]=e.split(":");return{namespace:t,reference:r}}function mD(e,t){return e.includes(":")?[e]:t.chains||[]}let mR={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};function mk(){return"u">typeof mP&&"u">typeof mP.versions&&"u">typeof mP.versions.node}function mj(){return!(0,iv.getDocument)()&&!!(0,iv.getNavigator)()&&"ReactNative"===navigator.product}function mL(){return!mk()&&!!(0,iv.getNavigator)()&&!!(0,iv.getDocument)()}function mU(){return mj()?mR.reactNative:mk()?mR.node:mL()?mR.browser:mR.unknown}function mz(){var e;try{return mj()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Application)?null==(e=r.g.Application)?void 0:e.applicationId:void 0}catch{return}}function m$(){return(0,iE.D)()||{name:"",description:"",url:"",icons:[""]}}function mq(e,t,i){let s=function(){if(mU()===mR.reactNative&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)){let{OS:e,Version:t}=r.g.Platform;return[e,t].join("-")}let e=ib();if(null===e)return"unknown";let t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return"browser"===e.type?[t,e.name,e.version].join("-"):[t,e.version].join("-")}(),n=function(){var e;let t=mU();return t===mR.browser?[t,(null==(e=(0,iv.getLocation)())?void 0:e.host)||"unknown"].join(":"):t}();return[[e,t].join("-"),["js",i].join("-"),s,n].join("/")}function mB(e,t){return e.filter(e=>t.includes(e)).length===e.length}function mW(e){return Object.fromEntries(e.entries())}function mH(e){return new Map(Object.entries(e))}function mF(e=er.FIVE_MINUTES,t){let r,i,s,n;let o=(0,er.toMiliseconds)(e||er.FIVE_MINUTES);return{resolve:e=>{s&&r&&(clearTimeout(s),r(e),n=Promise.resolve(e))},reject:e=>{s&&i&&(clearTimeout(s),i(e))},done:()=>new Promise((e,a)=>{if(n)return e(n);s=setTimeout(()=>{let e=Error(t);n=Promise.reject(e),a(e)},o),r=e,i=a})}}function mV(e,t,r){return new Promise(async(i,s)=>{let n=setTimeout(()=>s(Error(r)),t);try{let t=await e;i(t)}catch(e){s(e)}clearTimeout(n)})}function mK(e,t){if("string"==typeof t&&t.startsWith(`${e}:`))return t;if("topic"===e.toLowerCase()){if("string"!=typeof t)throw Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}if("id"===e.toLowerCase()){if("number"!=typeof t)throw Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw Error(`Unknown expirer target type: ${e}`)}function mJ(e){let[t,r]=e.split(":"),i={id:void 0,topic:void 0};if("topic"===t&&"string"==typeof r)i.topic=r;else if("id"===t&&Number.isInteger(Number(r)))i.id=Number(r);else throw Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return i}function mY(e,t){return(0,er.fromMiliseconds)((t||Date.now())+(0,er.toMiliseconds)(e))}function mG(e){return Date.now()>=(0,er.toMiliseconds)(e)}function mQ(e,t){return`${e}${t?`:${t}`:""}`}function mZ(e=[],t=[]){return[...new Set([...e,...t])]}async function mX({id:e,topic:t,wcDeepLink:i}){var s;try{if(!i)return;let n="string"==typeof i?JSON.parse(i):i,o=n?.href;if("string"!=typeof o)return;let a=function(e,t,r){let i=`requestId=${t}&sessionTopic=${r}`;e.endsWith("/")&&(e=e.slice(0,-1));let s=`${e}`;if(e.startsWith("https://t.me")){let t=e.includes("?")?"&startapp=":"?startapp=";s=`${s}${t}${function(e,t=!1){let r=mx.from(e).toString("base64");return t?r.replace(/[=]/g,""):r}(i,!0)}`}else s=`${s}/wc?${i}`;return s}(o,e,t),c=mU();if(c===mR.browser){let e;if(!(null!=(s=(0,iv.getDocument)())&&s.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}e="_self",function(){try{return window.self!==window.top}catch{return!1}}()?e="_top":("u">typeof window&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)||a.startsWith("https://")||a.startsWith("http://"))&&(e="_blank"),window.open(a,e,"noreferrer noopener")}else c===mR.reactNative&&"u">typeof(null==r.g?void 0:r.g.Linking)&&await r.g.Linking.openURL(a)}catch(e){console.error(e)}}async function m0(e,t){let r="";try{if(mL()&&(r=localStorage.getItem(t)))return r;r=await e.getItem(t)}catch(e){console.error(e)}return r}function m1(e,t){if(!e.includes(t))return null;let r=e.split(/([&,?,=])/),i=r.indexOf(t);return r[i+2]}function m2(){return"u">typeof crypto&&null!=crypto&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,e=>{let t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})}function m3(){return"u">typeof mP&&"true"===mP.env.IS_VITEST}function m5(e){return mx.from(e,"base64").toString("utf-8")}function m4(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function m8(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function m6(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");m4(e.outputLen),m4(e.blockLen)}function m9(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function m7(e,t){m8(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}let ye=BigInt(4294967296-1),yt=BigInt(32),yr=(e,t,r)=>e<<r|t>>>32-r,yi=(e,t,r)=>t<<r|e>>>32-r,ys=(e,t,r)=>t<<r-32|e>>>64-r,yn=(e,t,r)=>e<<r-32|t>>>64-r,yo="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;function ya(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function yc(e,t){return e<<32-t|e>>>t}let yl=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function yh(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}}function yu(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),m8(e),e}class yd{clone(){return this._cloneInto()}}function yp(e){let t=t=>e().update(yu(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function yf(e=32){if(yo&&"function"==typeof yo.getRandomValues)return yo.getRandomValues(new Uint8Array(e));if(yo&&"function"==typeof yo.randomBytes)return yo.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}let yg=[],ym=[],yy=[],yb=BigInt(0),yw=BigInt(1),yv=BigInt(2),yE=BigInt(7),yI=BigInt(256),y_=BigInt(113);for(let e=0,t=yw,r=1,i=0;e<24;e++){[r,i]=[i,(2*r+3*i)%5],yg.push(2*(5*i+r)),ym.push((e+1)*(e+2)/2%64);let s=yb;for(let e=0;e<7;e++)(t=(t<<yw^(t>>yE)*y_)%yI)&yv&&(s^=yw<<(yw<<BigInt(e))-yw);yy.push(s)}let[yC,yS]=function(e,t=!1){let r=new Uint32Array(e.length),i=new Uint32Array(e.length);for(let s=0;s<e.length;s++){let{h:n,l:o}=function(e,t=!1){return t?{h:Number(e&ye),l:Number(e>>yt&ye)}:{h:0|Number(e>>yt&ye),l:0|Number(e&ye)}}(e[s],t);[r[s],i[s]]=[n,o]}return[r,i]}(yy,!0),yN=(e,t,r)=>r>32?ys(e,t,r):yr(e,t,r),yA=(e,t,r)=>r>32?yn(e,t,r):yi(e,t,r);class yO extends yd{constructor(e,t,r,i=!1,s=24){var n;if(super(),this.blockLen=e,this.suffix=t,this.outputLen=r,this.enableXOF=i,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,m4(r),0>=this.blockLen||this.blockLen>=200)throw Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=new Uint32Array((n=this.state).buffer,n.byteOffset,Math.floor(n.byteLength/4))}keccak(){yl||yh(this.state32),function(e,t=24){let r=new Uint32Array(10);for(let i=24-t;i<24;i++){for(let t=0;t<10;t++)r[t]=e[t]^e[t+10]^e[t+20]^e[t+30]^e[t+40];for(let t=0;t<10;t+=2){let i=(t+8)%10,s=(t+2)%10,n=r[s],o=r[s+1],a=yN(n,o,1)^r[i],c=yA(n,o,1)^r[i+1];for(let r=0;r<50;r+=10)e[t+r]^=a,e[t+r+1]^=c}let t=e[2],s=e[3];for(let r=0;r<24;r++){let i=ym[r],n=yN(t,s,i),o=yA(t,s,i),a=yg[r];t=e[a],s=e[a+1],e[a]=n,e[a+1]=o}for(let t=0;t<50;t+=10){for(let i=0;i<10;i++)r[i]=e[t+i];for(let i=0;i<10;i++)e[t+i]^=~r[(i+2)%10]&r[(i+4)%10]}e[0]^=yC[i],e[1]^=yS[i]}r.fill(0)}(this.state32,this.rounds),yl||yh(this.state32),this.posOut=0,this.pos=0}update(e){m9(this);let{blockLen:t,state:r}=this,i=(e=yu(e)).length;for(let s=0;s<i;){let n=Math.min(t-this.pos,i-s);for(let t=0;t<n;t++)r[this.pos++]^=e[s++];this.pos===t&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;let{state:e,suffix:t,pos:r,blockLen:i}=this;e[r]^=t,(128&t)!=0&&r===i-1&&this.keccak(),e[i-1]^=128,this.keccak()}writeInto(e){m9(this,!1),m8(e),this.finish();let t=this.state,{blockLen:r}=this;for(let i=0,s=e.length;i<s;){this.posOut>=r&&this.keccak();let n=Math.min(r-this.posOut,s-i);e.set(t.subarray(this.posOut,this.posOut+n),i),this.posOut+=n,i+=n}return e}xofInto(e){if(!this.enableXOF)throw Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return m4(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(m7(e,this),this.finished)throw Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){let{blockLen:t,suffix:r,outputLen:i,rounds:s,enableXOF:n}=this;return e||(e=new yO(t,r,i,n,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=r,e.outputLen=i,e.enableXOF=n,e.destroyed=this.destroyed,e}}let yM=yp(()=>new yO(136,1,32));function yP(e){let t=`Ethereum Signed Message:
${e.length}`,r=new TextEncoder().encode(t+e);return"0x"+mx.from(yM(r)).toString("hex")}async function yx(e,t,r,i,s,n){switch(r.t){case"eip191":return await yT(e,t,r.s);case"eip1271":return await yD(e,t,r.s,i,s,n);default:throw Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}async function yT(e,t,r){return(await mO({hash:yP(t),signature:r})).toLowerCase()===e.toLowerCase()}async function yD(e,t,r,i,s,n){let o=mT(i);if(!o.namespace||!o.reference)throw Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{let o="0x1626ba7e",a=r.substring(2),c=yP(t).substring(2),l=await fetch(`${n||"https://rpc.walletconnect.org/v1"}/?chainId=${i}&projectId=${s}`,{method:"POST",body:JSON.stringify({id:Date.now()+Math.floor(1e3*Math.random()),jsonrpc:"2.0",method:"eth_call",params:[{to:e,data:o+c+"00000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000041"+a},"latest"]})}),{result:h}=await l.json();return!!h&&h.slice(0,o.length).toLowerCase()===o.toLowerCase()}catch(e){return console.error("isValidEip1271Signature: ",e),!1}}var yR=Object.defineProperty,yk=Object.defineProperties,yj=Object.getOwnPropertyDescriptors,yL=Object.getOwnPropertySymbols,yU=Object.prototype.hasOwnProperty,yz=Object.prototype.propertyIsEnumerable,y$=(e,t,r)=>t in e?yR(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yq=(e,t)=>{for(var r in t||(t={}))yU.call(t,r)&&y$(e,r,t[r]);if(yL)for(var r of yL(t))yz.call(t,r)&&y$(e,r,t[r]);return e},yB=(e,t)=>yk(e,yj(t));let yW=e=>e?.split(":"),yH=e=>{let t=e&&yW(e);if(t)return e.includes("did:pkh:")?t[3]:t[1]},yF=e=>{let t=e&&yW(e);if(t)return t[2]+":"+t[3]},yV=e=>{let t=e&&yW(e);if(t)return t.pop()};async function yK(e){let{cacao:t,projectId:r}=e,{s:i,p:s}=t,n=yJ(s,s.iss),o=yV(s.iss);return await yx(o,n,i,yF(s.iss),r)}let yJ=(e,t)=>{let r=`${e.domain} wants you to sign in with your Ethereum account:`,i=yV(t);if(!e.aud&&!e.uri)throw Error("Either `aud` or `uri` is required to construct the message");let s=e.statement||void 0,n=`URI: ${e.aud||e.uri}`,o=`Version: ${e.version}`,a=`Chain ID: ${yH(t)}`,c=`Nonce: ${e.nonce}`,l=`Issued At: ${e.iat}`,h=e.exp?`Expiration Time: ${e.exp}`:void 0,u=e.nbf?`Not Before: ${e.nbf}`:void 0,d=e.requestId?`Request ID: ${e.requestId}`:void 0,p=e.resources?`Resources:${e.resources.map(e=>`
- ${e}`).join("")}`:void 0,f=y0(e.resources);return f&&(s=function(e="",t){yY(t);let r="I further authorize the stated URI to perform the following actions on my behalf: ";if(e.includes(r))return e;let i=[],s=0;Object.keys(t.att).forEach(e=>{let r=Object.keys(t.att[e]).map(e=>({ability:e.split("/")[0],action:e.split("/")[1]}));r.sort((e,t)=>e.action.localeCompare(t.action));let n={};r.forEach(e=>{n[e.ability]||(n[e.ability]=[]),n[e.ability].push(e.action)});let o=Object.keys(n).map(t=>(s++,`(${s}) '${t}': '${n[t].join("', '")}' for '${e}'.`));i.push(o.join(", ").replace(".,","."))});let n=i.join(" "),o=`${r}${n}`;return`${e?e+" ":""}${o}`}(s,yQ(f))),[r,i,"",s,"",n,o,a,c,l,h,u,d,p].filter(e=>null!=e).join(`
`)};function yY(e){if(!e)throw Error("No recap provided, value is undefined");if(!e.att)throw Error("No `att` property found");let t=Object.keys(e.att);if(!(null!=t&&t.length))throw Error("No resources found in `att` property");t.forEach(t=>{let r=e.att[t];if(Array.isArray(r)||"object"!=typeof r)throw Error(`Resource must be an object: ${t}`);if(!Object.keys(r).length)throw Error(`Resource object is empty: ${t}`);Object.keys(r).forEach(e=>{let t=r[e];if(!Array.isArray(t))throw Error(`Ability limits ${e} must be an array of objects, found: ${t}`);if(!t.length)throw Error(`Value of ${e} is empty array, must be an array with objects`);t.forEach(t=>{if("object"!=typeof t)throw Error(`Ability limits (${e}) must be an array of objects, found: ${t}`)})})})}function yG(e){return yY(e),`urn:recap:${mx.from(JSON.stringify(e)).toString("base64").replace(/=/g,"")}`}function yQ(e){var t;let r=(t=e.replace("urn:recap:",""),JSON.parse(mx.from(t,"base64").toString("utf-8")));return yY(r),r}function yZ(e){var t;let r=yQ(e);yY(r);let i=null==(t=r.att)?void 0:t.eip155;return i?Object.keys(i).map(e=>e.split("/")[1]):[]}function yX(e){let t=yQ(e);yY(t);let r=[];return Object.values(t.att).forEach(e=>{Object.values(e).forEach(e=>{var t;null!=(t=e?.[0])&&t.chains&&r.push(e[0].chains)})}),[...new Set(r.flat())]}function y0(e){if(!e)return;let t=e?.[e.length-1];return t&&t.includes("urn:recap:")?t:void 0}function y1(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function y2(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function y3(e,...t){if(!y2(e))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function y5(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function y4(e){if("boolean"!=typeof e)throw Error(`boolean expected, not ${e}`)}let y8=e=>new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4)),y6=e=>new DataView(e.buffer,e.byteOffset,e.byteLength);if(68!==new Uint8Array(new Uint32Array([287454020]).buffer)[0])throw Error("Non little-endian hardware is not supported");function y9(e){if("string"==typeof e)e=function(e){if("string"!=typeof e)throw Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}(e);else if(y2(e))e=bt(e);else throw Error("Uint8Array expected, got "+typeof e);return e}function y7(e,t,r=!0){if(void 0===t)return new Uint8Array(e);if(t.length!==e)throw Error("invalid output length, expected "+e+", got: "+t.length);if(r&&t.byteOffset%4!=0)throw Error("invalid output, must be aligned");return t}function be(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),a=Number(r&n),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)}function bt(e){return Uint8Array.from(e)}function br(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}let bi=e=>Uint8Array.from(e.split("").map(e=>e.charCodeAt(0))),bs=bi("expand 16-byte k"),bn=bi("expand 32-byte k"),bo=y8(bs),ba=y8(bn);function bc(e,t){return e<<t|e>>>32-t}function bl(e){return e.byteOffset%4==0}let bh=4294967296-1,bu=new Uint32Array,bd=(e,t)=>255&e[t++]|(255&e[t++])<<8;class bp{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,y3(e=y9(e),32);let t=bd(e,0),r=bd(e,2),i=bd(e,4),s=bd(e,6),n=bd(e,8),o=bd(e,10),a=bd(e,12),c=bd(e,14);this.r[0]=8191&t,this.r[1]=(t>>>13|r<<3)&8191,this.r[2]=(r>>>10|i<<6)&7939,this.r[3]=(i>>>7|s<<9)&8191,this.r[4]=(s>>>4|n<<12)&255,this.r[5]=n>>>1&8190,this.r[6]=(n>>>14|o<<2)&8191,this.r[7]=(o>>>11|a<<5)&8065,this.r[8]=(a>>>8|c<<8)&8191,this.r[9]=c>>>5&127;for(let t=0;t<8;t++)this.pad[t]=bd(e,16+2*t)}process(e,t,r=!1){let{h:i,r:s}=this,n=s[0],o=s[1],a=s[2],c=s[3],l=s[4],h=s[5],u=s[6],d=s[7],p=s[8],f=s[9],g=bd(e,t+0),m=bd(e,t+2),y=bd(e,t+4),b=bd(e,t+6),w=bd(e,t+8),v=bd(e,t+10),E=bd(e,t+12),I=bd(e,t+14),_=i[0]+(8191&g),C=i[1]+((g>>>13|m<<3)&8191),S=i[2]+((m>>>10|y<<6)&8191),N=i[3]+((y>>>7|b<<9)&8191),A=i[4]+((b>>>4|w<<12)&8191),O=i[5]+(w>>>1&8191),M=i[6]+((w>>>14|v<<2)&8191),P=i[7]+((v>>>11|E<<5)&8191),x=i[8]+((E>>>8|I<<8)&8191),T=i[9]+(I>>>5|(r?0:2048)),D=0,R=0+_*n+5*f*C+5*p*S+5*d*N+5*u*A;D=R>>>13,R&=8191,R+=5*h*O+5*l*M+5*c*P+5*a*x+5*o*T,D+=R>>>13,R&=8191;let k=D+_*o+C*n+5*f*S+5*p*N+5*d*A;D=k>>>13,k&=8191,k+=5*u*O+5*h*M+5*l*P+5*c*x+5*a*T,D+=k>>>13,k&=8191;let j=D+_*a+C*o+S*n+5*f*N+5*p*A;D=j>>>13,j&=8191,j+=5*d*O+5*u*M+5*h*P+5*l*x+5*c*T,D+=j>>>13,j&=8191;let L=D+_*c+C*a+S*o+N*n+5*f*A;D=L>>>13,L&=8191,L+=5*p*O+5*d*M+5*u*P+5*h*x+5*l*T,D+=L>>>13,L&=8191;let U=D+_*l+C*c+S*a+N*o+A*n;D=U>>>13,U&=8191,U+=5*f*O+5*p*M+5*d*P+5*u*x+5*h*T,D+=U>>>13,U&=8191;let z=D+_*h+C*l+S*c+N*a+A*o;D=z>>>13,z&=8191,z+=O*n+5*f*M+5*p*P+5*d*x+5*u*T,D+=z>>>13,z&=8191;let $=D+_*u+C*h+S*l+N*c+A*a;D=$>>>13,$&=8191,$+=O*o+M*n+5*f*P+5*p*x+5*d*T,D+=$>>>13,$&=8191;let q=D+_*d+C*u+S*h+N*l+A*c;D=q>>>13,q&=8191,q+=O*a+M*o+P*n+5*f*x+5*p*T,D+=q>>>13,q&=8191;let B=D+_*p+C*d+S*u+N*h+A*l;D=B>>>13,B&=8191,B+=O*c+M*a+P*o+x*n+5*f*T,D+=B>>>13,B&=8191;let W=D+_*f+C*p+S*d+N*u+A*h;D=W>>>13,W&=8191,W+=O*l+M*c+P*a+x*o+T*n,D+=W>>>13,W&=8191,R=8191&(D=(D=(D<<2)+D|0)+R|0),D>>>=13,k+=D,i[0]=R,i[1]=k,i[2]=j,i[3]=L,i[4]=U,i[5]=z,i[6]=$,i[7]=q,i[8]=B,i[9]=W}finalize(){let{h:e,pad:t}=this,r=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let t=2;t<10;t++)e[t]+=i,i=e[t]>>>13,e[t]&=8191;e[0]+=5*i,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,r[0]=e[0]+5,i=r[0]>>>13,r[0]&=8191;for(let t=1;t<10;t++)r[t]=e[t]+i,i=r[t]>>>13,r[t]&=8191;r[9]-=8192;let s=(1^i)-1;for(let e=0;e<10;e++)r[e]&=s;s=~s;for(let t=0;t<10;t++)e[t]=e[t]&s|r[t];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let n=e[0]+t[0];e[0]=65535&n;for(let r=1;r<8;r++)n=(e[r]+t[r]|0)+(n>>>16)|0,e[r]=65535&n;br(r)}update(e){y5(this);let{buffer:t,blockLen:r}=this,i=(e=y9(e)).length;for(let s=0;s<i;){let n=Math.min(r-this.pos,i-s);if(n===r){for(;r<=i-s;s+=r)this.process(e,s);continue}t.set(e.subarray(s,s+n),this.pos),this.pos+=n,s+=n,this.pos===r&&(this.process(t,0,!1),this.pos=0)}return this}destroy(){br(this.h,this.r,this.buffer,this.pad)}digestInto(e){y5(this),function(e,t){y3(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}(e,this),this.finished=!0;let{buffer:t,h:r}=this,{pos:i}=this;if(i){for(t[i++]=1;i<16;i++)t[i]=0;this.process(t,0,!0)}this.finalize();let s=0;for(let t=0;t<8;t++)e[s++]=r[t]>>>0,e[s++]=r[t]>>>8;return e}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}}let bf=function(e){let t=(t,r)=>e(r).update(y9(t)).digest(),r=e(new Uint8Array(32));return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=t=>e(t),t}(e=>new bp(e)),bg=function(e,t){let{allowShortKeys:r,extendNonceFn:i,counterLength:s,counterRight:n,rounds:o}=function(e,t){if(null==t||"object"!=typeof t)throw Error("options must be defined");return Object.assign(e,t)}({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if("function"!=typeof e)throw Error("core must be a function");return y1(s),y1(o),y4(n),y4(r),(t,a,c,l,h=0)=>{y3(t),y3(a),y3(c);let u=c.length;if(void 0===l&&(l=new Uint8Array(u)),y3(l),y1(h),h<0||h>=bh)throw Error("arx: counter overflow");if(l.length<u)throw Error(`arx: output (${l.length}) is shorter than data (${u})`);let d=[],p=t.length,f,g;if(32===p)d.push(f=bt(t)),g=ba;else if(16===p&&r)(f=new Uint8Array(32)).set(t),f.set(t,16),g=bo,d.push(f);else throw Error(`arx: invalid 32-byte key, got length=${p}`);bl(a)||d.push(a=bt(a));let m=y8(f);if(i){if(24!==a.length)throw Error("arx: extended nonce must be 24 bytes");i(g,m,y8(a.subarray(0,16)),m),a=a.subarray(16)}let y=16-s;if(y!==a.length)throw Error(`arx: nonce must be ${y} or 16 bytes`);if(12!==y){let e=new Uint8Array(12);e.set(a,n?0:12-a.length),a=e,d.push(a)}return function(e,t,r,i,s,n,o,a){let c=s.length,l=new Uint8Array(64),h=y8(l),u=bl(s)&&bl(n),d=u?y8(s):bu,p=u?y8(n):bu;for(let f=0;f<c;o++){if(e(t,r,i,h,o,a),o>=bh)throw Error("arx: counter overflow");let g=Math.min(64,c-f);if(u&&64===g){let e=f/4;if(f%4!=0)throw Error("arx: invalid block position");for(let t=0,r;t<16;t++)p[r=e+t]=d[r]^h[t];f+=64;continue}for(let e=0,t;e<g;e++)n[t=f+e]=s[t]^l[e];f+=g}}(e,g,m,y8(a),c,l,h,o),br(...d),l}}(function(e,t,r,i,s,n=20){let o=e[0],a=e[1],c=e[2],l=e[3],h=t[0],u=t[1],d=t[2],p=t[3],f=t[4],g=t[5],m=t[6],y=t[7],b=r[0],w=r[1],v=r[2],E=o,I=a,_=c,C=l,S=h,N=u,A=d,O=p,M=f,P=g,x=m,T=y,D=s,R=b,k=w,j=v;for(let e=0;e<n;e+=2)M=M+(D=bc(D^(E=E+S|0),16))|0,E=E+(S=bc(S^M,12))|0,M=M+(D=bc(D^E,8))|0,S=bc(S^M,7),P=P+(R=bc(R^(I=I+N|0),16))|0,I=I+(N=bc(N^P,12))|0,P=P+(R=bc(R^I,8))|0,N=bc(N^P,7),x=x+(k=bc(k^(_=_+A|0),16))|0,_=_+(A=bc(A^x,12))|0,x=x+(k=bc(k^_,8))|0,A=bc(A^x,7),T=T+(j=bc(j^(C=C+O|0),16))|0,C=C+(O=bc(O^T,12))|0,T=T+(j=bc(j^C,8))|0,O=bc(O^T,7),x=x+(j=bc(j^(E=E+N|0),16))|0,E=E+(N=bc(N^x,12))|0,x=x+(j=bc(j^E,8))|0,N=bc(N^x,7),T=T+(D=bc(D^(I=I+A|0),16))|0,I=I+(A=bc(A^T,12))|0,T=T+(D=bc(D^I,8))|0,A=bc(A^T,7),M=M+(R=bc(R^(_=_+O|0),16))|0,_=_+(O=bc(O^M,12))|0,M=M+(R=bc(R^_,8))|0,O=bc(O^M,7),P=P+(k=bc(k^(C=C+S|0),16))|0,C=C+(S=bc(S^P,12))|0,P=P+(k=bc(k^C,8))|0,S=bc(S^P,7);let L=0;i[L++]=o+E|0,i[L++]=a+I|0,i[L++]=c+_|0,i[L++]=l+C|0,i[L++]=h+S|0,i[L++]=u+N|0,i[L++]=d+A|0,i[L++]=p+O|0,i[L++]=f+M|0,i[L++]=g+P|0,i[L++]=m+x|0,i[L++]=y+T|0,i[L++]=s+D|0,i[L++]=b+R|0,i[L++]=w+k|0,i[L++]=v+j|0},{counterRight:!1,counterLength:4,allowShortKeys:!1}),bm=new Uint8Array(16),by=(e,t)=>{e.update(t);let r=t.length%16;r&&e.update(bm.subarray(r))},bb=new Uint8Array(32);function bw(e,t,r,i,s){let n=e(t,r,bb),o=bf.create(n);s&&by(o,s),by(o,i);let a=new Uint8Array(16),c=y6(a);be(c,0,BigInt(s?s.length:0),!0),be(c,8,BigInt(i.length),!0),o.update(a);let l=o.digest();return br(n,a),l}let bv=((e,t)=>{function r(i,...s){if(y3(i),void 0!==e.nonceLength){let t=s[0];if(!t)throw Error("nonce / iv required");e.varSizeNonce?y3(t):y3(t,e.nonceLength)}let n=e.tagLength;n&&void 0!==s[1]&&y3(s[1]);let o=t(i,...s),a=(e,t)=>{if(void 0!==t){if(2!==e)throw Error("cipher output not supported");y3(t)}},c=!1;return{encrypt(e,t){if(c)throw Error("cannot encrypt() twice with same key + nonce");return c=!0,y3(e),a(o.encrypt.length,t),o.encrypt(e,t)},decrypt(e,t){if(y3(e),n&&e.length<n)throw Error("invalid ciphertext length: smaller than tagLength="+n);return a(o.decrypt.length,t),o.decrypt(e,t)}}}return Object.assign(r,e),r})({blockSize:64,nonceLength:12,tagLength:16},(e,t,r)=>({encrypt(i,s){let n=i.length;(s=y7(n+16,s,!1)).set(i);let o=s.subarray(0,-16);bg(e,t,o,o,1);let a=bw(bg,e,t,o,r);return s.set(a,n),br(a),s},decrypt(i,s){s=y7(i.length-16,s,!1);let n=i.subarray(0,-16),o=i.subarray(-16),a=bw(bg,e,t,n,r);if(!function(e,t){if(e.length!==t.length)return!1;let r=0;for(let i=0;i<e.length;i++)r|=e[i]^t[i];return 0===r}(o,a))throw Error("invalid tag");return s.set(i.subarray(0,-16)),bg(e,t,s,s,1),br(a),s}}));class bE extends yd{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,m6(e);let r=yu(t);if(this.iHash=e.create(),"function"!=typeof this.iHash.update)throw Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,s=new Uint8Array(i);s.set(r.length>i?e.create().update(r).digest():r);for(let e=0;e<s.length;e++)s[e]^=54;this.iHash.update(s),this.oHash=e.create();for(let e=0;e<s.length;e++)s[e]^=106;this.oHash.update(s),s.fill(0)}update(e){return m9(this),this.iHash.update(e),this}digestInto(e){m9(this),m8(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:r,finished:i,destroyed:s,blockLen:n,outputLen:o}=this;return e.finished=i,e.destroyed=s,e.blockLen=n,e.outputLen=o,e.oHash=t._cloneInto(e.oHash),e.iHash=r._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}let bI=(e,t,r)=>new bE(e,t).update(r).digest();bI.create=(e,t)=>new bE(e,t);let b_=new Uint8Array([0]),bC=new Uint8Array,bS=(e,t,r,i,s)=>{var n;return function(e,t,r,i=32){if(m6(e),m4(i),i>255*e.outputLen)throw Error("Length should be <= 255*HashLen");let s=Math.ceil(i/e.outputLen);void 0===r&&(r=bC);let n=new Uint8Array(s*e.outputLen),o=bI.create(e,t),a=o._cloneInto(),c=new Uint8Array(o.outputLen);for(let t=0;t<s;t++)b_[0]=t+1,a.update(0===t?bC:c).update(r).update(b_).digestInto(c),n.set(c,e.outputLen*t),o._cloneInto(a);return o.destroy(),a.destroy(),c.fill(0),b_.fill(0),n.slice(0,i)}(e,(n=r,m6(e),void 0===n&&(n=new Uint8Array(e.outputLen)),bI(e,yu(n),yu(t))),i,s)};class bN extends yd{constructor(e,t,r,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=r,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ya(this.buffer)}update(e){m9(this);let{view:t,buffer:r,blockLen:i}=this,s=(e=yu(e)).length;for(let n=0;n<s;){let o=Math.min(i-this.pos,s-n);if(o===i){let t=ya(e);for(;i<=s-n;n+=i)this.process(t,n);continue}r.set(e.subarray(n,n+o),this.pos),this.pos+=o,n+=o,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){m9(this),m7(e,this),this.finished=!0;let{buffer:t,view:r,blockLen:i,isLE:s}=this,{pos:n}=this;t[n++]=128,this.buffer.subarray(n).fill(0),this.padOffset>i-n&&(this.process(r,0),n=0);for(let e=n;e<i;e++)t[e]=0;(function(e,t,r,i){if("function"==typeof e.setBigUint64)return e.setBigUint64(t,r,i);let s=BigInt(32),n=BigInt(4294967295),o=Number(r>>s&n),a=Number(r&n),c=i?4:0,l=i?0:4;e.setUint32(t+c,o,i),e.setUint32(t+l,a,i)})(r,i-8,BigInt(8*this.length),s),this.process(r,0);let o=ya(e),a=this.outputLen;if(a%4)throw Error("_sha2: outputLen should be aligned to 32bit");let c=a/4,l=this.get();if(c>l.length)throw Error("_sha2: outputLen bigger than state");for(let e=0;e<c;e++)o.setUint32(4*e,l[e],s)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let r=e.slice(0,t);return this.destroy(),r}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:r,length:i,finished:s,destroyed:n,pos:o}=this;return e.length=i,e.pos=o,e.finished=s,e.destroyed=n,i%t&&e.buffer.set(r),e}}let bA=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),bO=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),bM=new Uint32Array(64);class bP extends bN{constructor(){super(64,32,8,!1),this.A=0|bO[0],this.B=0|bO[1],this.C=0|bO[2],this.D=0|bO[3],this.E=0|bO[4],this.F=0|bO[5],this.G=0|bO[6],this.H=0|bO[7]}get(){let{A:e,B:t,C:r,D:i,E:s,F:n,G:o,H:a}=this;return[e,t,r,i,s,n,o,a]}set(e,t,r,i,s,n,o,a){this.A=0|e,this.B=0|t,this.C=0|r,this.D=0|i,this.E=0|s,this.F=0|n,this.G=0|o,this.H=0|a}process(e,t){for(let r=0;r<16;r++,t+=4)bM[r]=e.getUint32(t,!1);for(let e=16;e<64;e++){let t=bM[e-15],r=bM[e-2],i=yc(t,7)^yc(t,18)^t>>>3,s=yc(r,17)^yc(r,19)^r>>>10;bM[e]=s+bM[e-7]+i+bM[e-16]|0}let{A:r,B:i,C:s,D:n,E:o,F:a,G:c,H:l}=this;for(let e=0;e<64;e++){var h,u,d,p;let t=l+(yc(o,6)^yc(o,11)^yc(o,25))+((h=o)&a^~h&c)+bA[e]+bM[e]|0,f=(yc(r,2)^yc(r,13)^yc(r,22))+((u=r)&(d=i)^u&(p=s)^d&p)|0;l=c,c=a,a=o,o=n+t|0,n=s,s=i,i=r,r=t+f|0}r=r+this.A|0,i=i+this.B|0,s=s+this.C|0,n=n+this.D|0,o=o+this.E|0,a=a+this.F|0,c=c+this.G|0,l=l+this.H|0,this.set(r,i,s,n,o,a,c,l)}roundClean(){bM.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}let bx=yp(()=>new bP),bT=BigInt(0);function bD(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name}function bR(e){if(!bD(e))throw Error("Uint8Array expected")}let bk=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0")),bj={_0:48,_9:57,A:65,F:70,a:97,f:102};function bL(e){return e>=bj._0&&e<=bj._9?e-bj._0:e>=bj.A&&e<=bj.F?e-(bj.A-10):e>=bj.a&&e<=bj.f?e-(bj.a-10):void 0}function bU(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);let t=e.length,r=t/2;if(t%2)throw Error("hex string expected, got unpadded hex of length "+t);let i=new Uint8Array(r);for(let t=0,s=0;t<r;t++,s+=2){let r=bL(e.charCodeAt(s)),n=bL(e.charCodeAt(s+1));if(void 0===r||void 0===n)throw Error('hex string expected, got non-hex character "'+(e[s]+e[s+1])+'" at index '+s);i[t]=16*r+n}return i}function bz(e){return bR(e),function(e){if("string"!=typeof e)throw Error("hex string expected, got "+typeof e);return""===e?bT:BigInt("0x"+e)}(function(e){bR(e);let t="";for(let r=0;r<e.length;r++)t+=bk[e[r]];return t}(Uint8Array.from(e).reverse()))}function b$(e,t,r){let i;if("string"==typeof t)try{i=bU(t)}catch(t){throw Error(e+" must be hex string or Uint8Array, cause: "+t)}else if(bD(t))i=Uint8Array.from(t);else throw Error(e+" must be hex string or Uint8Array");let s=i.length;if("number"==typeof r&&s!==r)throw Error(e+" of length "+r+" expected, got "+s);return i}let bq=e=>"bigint"==typeof e&&bT<=e;function bB(e,t,r,i){if(!(bq(t)&&bq(r)&&bq(i))||!(r<=t)||!(t<i))throw Error("expected valid "+e+": "+r+" <= n < "+i+", got "+t)}let bW={bigint:e=>"bigint"==typeof e,function:e=>"function"==typeof e,boolean:e=>"boolean"==typeof e,string:e=>"string"==typeof e,stringOrUint8Array:e=>"string"==typeof e||bD(e),isSafeInteger:e=>Number.isSafeInteger(e),array:e=>Array.isArray(e),field:(e,t)=>t.Fp.isValid(e),hash:e=>"function"==typeof e&&Number.isSafeInteger(e.outputLen)},bH=BigInt(0),bF=BigInt(1);function bV(e,t){let r=e%t;return r>=bH?r:t+r}function bK(e,t,r){let i=e;for(;t-- >bH;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);let bJ=BigInt(0),bY=BigInt(1),bG=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);let bQ=BigInt(1),bZ=BigInt(2),bX=BigInt(3),b0=BigInt(5);BigInt(8);let b1=function(e){let t=(function(e,t,r={}){let i=(t,r,i)=>{let s=bW[r];if("function"!=typeof s)throw Error("invalid validator function");let n=e[t];if(!(i&&void 0===n)&&!s(n,e))throw Error("param "+String(t)+" is invalid. Expected "+r+", got "+n)};for(let[e,r]of Object.entries(t))i(e,r,!1);for(let[e,t]of Object.entries(r))i(e,t,!0)}(e,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...e})),{P:r}=t,i=e=>bV(e,r),s=t.montgomeryBits,n=Math.ceil(s/8),o=t.nByteLength,a=t.adjustScalarBytes||(e=>e),c=t.powPminus2||(e=>(function(e,t,r){if(t<bH)throw Error("invalid exponent, negatives unsupported");if(r<=bH)throw Error("invalid modulus");if(r===bF)return bH;let i=bF;for(;t>bH;)t&bF&&(i=i*e%r),e=e*e%r,t>>=bF;return i})(e,r-BigInt(2),r));function l(e,t,r){let s=i(e*(t-r));return[t=i(t-s),r=i(r+s)]}let h=(t.a-BigInt(2))/BigInt(4);function u(e){var t;return bU(i(e).toString(16).padStart(2*n,"0")).reverse()}function d(e,t){let d=function(e,t){bB("u",e,bJ,r),bB("scalar",t,bJ,r);let n=bY,o=bJ,a=e,u=bY,d=bJ,p;for(let r=BigInt(s-1);r>=bJ;r--){let s=t>>r&bY;d^=s,n=(p=l(d,n,a))[0],a=p[1],o=(p=l(d,o,u))[0],u=p[1],d=s;let c=n+o,f=i(c*c),g=n-o,m=i(g*g),y=f-m,b=a+u,w=i((a-u)*c),v=i(b*g),E=w+v,I=w-v;a=i(E*E),u=i(e*i(I*I)),n=i(f*m),o=i(y*(f+i(h*y)))}return n=(p=l(d,n,a))[0],a=p[1],o=(p=l(d,o,u))[0],u=p[1],i(n*c(o))}(function(e){let t=b$("u coordinate",e,n);return 32===o&&(t[31]&=127),bz(t)}(t),function(e){let t=b$("scalar",e),r=t.length;if(r!==n&&r!==o)throw Error("invalid scalar, expected "+n+" or "+o+" bytes, got "+r);return bz(a(t))}(e));if(d===bJ)throw Error("invalid private or public key received");return u(d)}let p=u(t.Gu);function f(e){return d(e,p)}return{scalarMult:d,scalarMultBase:f,getSharedSecret:(e,t)=>d(e,t),getPublicKey:e=>f(e),utils:{randomPrivateKey:()=>t.randomBytes(t.nByteLength)},GuBytes:p}}({P:bG,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:e=>{let{pow_p_5_8:t,b2:r}=function(e){let t=BigInt(10),r=BigInt(20),i=BigInt(40),s=BigInt(80),n=e*e%bG*e%bG,o=bK(n,bZ,bG)*n%bG,a=bK(o,bQ,bG)*e%bG,c=bK(a,b0,bG)*a%bG,l=bK(c,t,bG)*c%bG,h=bK(l,r,bG)*l%bG,u=bK(h,i,bG)*h%bG,d=bK(u,s,bG)*u%bG,p=bK(d,s,bG)*u%bG,f=bK(p,t,bG)*c%bG;return{pow_p_5_8:bK(f,bZ,bG)*e%bG,b2:n}}(e);return bV(bK(t,bX,bG)*r,bG)},adjustScalarBytes:function(e){return e[0]&=248,e[31]&=127,e[31]|=64,e},randomBytes:yf}),b2="base10",b3="base16",b5="base64pad",b4="base64url",b8="utf8";function b6(){return nx(yf(32),b3)}function b9(e){return nx(bx(nP(e,b3)),b3)}function b7(e){return nx(bx(nP(e,b8)),b3)}function we(e){return Number(nx(e,b2))}function wt(e){let{encoding:t=b5}=e;if(2===we(e.type))return nx(sl([e.type,e.sealed]),t);if(1===we(e.type)){if(typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");return nx(sl([e.type,e.senderPublicKey,e.iv,e.sealed]),t)}return nx(sl([e.type,e.iv,e.sealed]),t)}function wr(e){let{encoded:t,encoding:r=b5}=e,i=nP(t,r),s=i.slice(0,1);if(1===we(s)){let e=i.slice(1,33),t=i.slice(33,45);return{type:s,sealed:i.slice(45),iv:t,senderPublicKey:e}}if(2===we(s))return{type:s,sealed:i.slice(1),iv:yf(12)};let n=i.slice(1,13);return{type:s,sealed:i.slice(13),iv:n}}function wi(e){let t=e?.type||0;if(1===t){if(typeof e?.senderPublicKey>"u")throw Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function ws(e){return 1===e.type&&"string"==typeof e.senderPublicKey&&"string"==typeof e.receiverPublicKey}function wn(e){return e?.relay||{protocol:"irn"}}function wo(e){let t=nD[e];if(typeof t>"u")throw Error(`Relay Protocol not supported: ${e}`);return t}function wa(e){var t;if(!e.includes("wc:")){let t=m5(e);null!=t&&t.includes("wc:")&&(e=t)}let r=(e=(e=e.includes("wc://")?e.replace("wc://",""):e).includes("wc:")?e.replace("wc:",""):e).indexOf(":"),i=-1!==e.indexOf("?")?e.indexOf("?"):void 0,s=e.substring(0,r),n=e.substring(r+1,i).split("@"),o=new URLSearchParams("u">typeof i?e.substring(i):""),a={};o.forEach((e,t)=>{a[t]=e});let c="string"==typeof a.methods?a.methods.split(","):void 0;return{protocol:s,topic:(t=n[0]).startsWith("//")?t.substring(2):t,version:parseInt(n[1],10),symKey:a.symKey,relay:function(e,t="-"){let r={},i="relay"+t;return Object.keys(e).forEach(t=>{if(t.startsWith(i)){let s=t.replace(i,""),n=e[t];r[s]=n}}),r}(a),methods:c,expiryTimestamp:a.expiryTimestamp?parseInt(a.expiryTimestamp,10):void 0}}function wc(e){let t=new URLSearchParams,r=function(e,t="-"){let r={};return Object.keys(e).forEach(i=>{e[i]&&(r["relay"+t+i]=e[i])}),r}(e.relay);Object.keys(r).sort().forEach(e=>{t.set(e,r[e])}),t.set("symKey",e.symKey),e.expiryTimestamp&&t.set("expiryTimestamp",e.expiryTimestamp.toString()),e.methods&&t.set("methods",e.methods.join(","));let i=t.toString();return`${e.protocol}:${e.topic}@${e.version}?${i}`}function wl(e,t,r){return`${e}?wc_ev=${r}&topic=${t}`}function wh(e){let t=[];return e.forEach(e=>{let[r,i]=e.split(":");t.push(`${r}:${i}`)}),t}function wu(e){return e.includes(":")}function wd(e){return wu(e)?e.split(":")[0]:e}function wp(e,t){let r=function(e){let t={};return e?.forEach(e=>{var r;let[i,s]=e.split(":");t[i]||(t[i]={accounts:[],chains:[],events:[],methods:[]}),t[i].accounts.push(e),null==(r=t[i].chains)||r.push(`${i}:${s}`)}),t}(t=t.map(e=>e.replace("did:pkh:","")));for(let[t,i]of Object.entries(r))i.methods?i.methods=mZ(i.methods,e):i.methods=e,i.events=["chainChanged","accountsChanged"];return r}Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;let wf={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},wg={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function wm(e,t){let{message:r,code:i}=wg[e];return{message:t?`${r} ${t}`:r,code:i}}function wy(e,t){let{message:r,code:i}=wf[e];return{message:t?`${r} ${t}`:r,code:i}}function wb(e,t){return!!Array.isArray(e)&&(!("u">typeof t)||!e.length||e.every(t))}function ww(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function wv(e){return typeof e>"u"}function wE(e,t){return!!(t&&wv(e))||"string"==typeof e&&!!e.trim().length}function wI(e,t){return!!(t&&wv(e))||"number"==typeof e&&!isNaN(e)}function w_(e){return!!(wE(e,!1)&&e.includes(":"))&&2===e.split(":").length}function wC(e){let t=!0;return wb(e)?e.length&&(t=e.every(e=>wE(e,!1))):t=!1,t}function wS(e,t){let r=null;return Object.values(e).forEach(e=>{var i;let s;if(r)return;let n=(i=`${t}, namespace`,s=null,wC(e?.methods)?wC(e?.events)||(s=wy("UNSUPPORTED_EVENTS",`${i}, events should be an array of strings or empty array for no events`)):s=wy("UNSUPPORTED_METHODS",`${i}, methods should be an array of strings or empty array for no methods`),s);n&&(r=n)}),r}function wN(e,t){let r=null;if(e&&ww(e)){let i;let s=wS(e,t);s&&(r=s);let n=(i=null,Object.values(e).forEach(e=>{var r,s;let n;if(i)return;let o=(r=e?.accounts,s=`${t} namespace`,n=null,wb(r)?r.forEach(e=>{n||function(e){if(wE(e,!1)&&e.includes(":")){let t=e.split(":");if(3===t.length){let e=t[0]+":"+t[1];return!!t[2]&&w_(e)}}return!1}(e)||(n=wy("UNSUPPORTED_ACCOUNTS",`${s}, account ${e} should be a string and conform to "namespace:chainId:address" format`))}):n=wy("UNSUPPORTED_ACCOUNTS",`${s}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),n);o&&(i=o)}),i);n&&(r=n)}else r=wm("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function wA(e){return wE(e.protocol,!0)}function wO(e){return"u">typeof e}function wM(e,t){return!(!w_(t)||!(function(e){let t=[];return Object.values(e).forEach(e=>{t.push(...wh(e.accounts))}),t})(e).includes(t))}function wP(e,t,r){let i=null,s=function(e){let t={};return Object.keys(e).forEach(r=>{var i;r.includes(":")?t[r]=e[r]:null==(i=e[r].chains)||i.forEach(i=>{t[i]={methods:e[r].methods,events:e[r].events}})}),t}(e),n=function(e){let t={};return Object.keys(e).forEach(r=>{if(r.includes(":"))t[r]=e[r];else{let i=wh(e[r].accounts);i?.forEach(i=>{t[i]={accounts:e[r].accounts.filter(e=>e.includes(`${i}:`)),methods:e[r].methods,events:e[r].events}})}}),t}(t),o=Object.keys(s),a=Object.keys(n),c=wx(Object.keys(e)),l=wx(Object.keys(t)),h=c.filter(e=>!l.includes(e));return h.length&&(i=wm("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${h.toString()}
      Received: ${Object.keys(t).toString()}`)),mB(o,a)||(i=wm("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${o.toString()}
      Approved: ${a.toString()}`)),Object.keys(t).forEach(e=>{if(!e.includes(":")||i)return;let s=wh(t[e].accounts);s.includes(e)||(i=wm("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${e}
        Required: ${e}
        Approved: ${s.toString()}`))}),o.forEach(e=>{i||(mB(s[e].methods,n[e].methods)?mB(s[e].events,n[e].events)||(i=wm("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${e}`)):i=wm("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${e}`))}),i}function wx(e){return[...new Set(e.map(e=>e.includes(":")?e.split(":")[0]:e))]}function wT(){let e=mU();return new Promise(t=>{switch(e){case mR.browser:t(mL()&&navigator?.onLine);break;case mR.reactNative:t(wD());break;case mR.node:default:t(!0)}})}async function wD(){if(mj()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo){let e=await (null==r.g?void 0:r.g.NetInfo.fetch());return e?.isConnected}return!0}let wR={};class wk{static get(e){return wR[e]}static set(e,t){wR[e]=t}static delete(e){delete wR[e]}}var wj=r(82957).Buffer;let wL="core",wU=`wc@2:${wL}:`,wz={logger:"error"},w$={database:":memory:"},wq="client_ed25519_seed",wB=er.ONE_DAY,wW=er.SIX_HOURS,wH="wss://relay.walletconnect.org",wF={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",publish:"relayer_publish"},wV={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},wK="2.19.1",wJ={link_mode:"link_mode",relay:"relay"},wY={inbound:"inbound",outbound:"outbound"},wG="WALLETCONNECT_LINK_MODE_APPS",wQ={created:"subscription_created",deleted:"subscription_deleted",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},wZ=(er.FIVE_SECONDS,{wc_pairingDelete:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:er.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:er.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:er.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:er.ONE_DAY,prompt:!1,tag:0},res:{ttl:er.ONE_DAY,prompt:!1,tag:0}}}),wX={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},w0={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},w1={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},w2="https://verify.walletconnect.org",w3=`${w2}/v3`,w5=["https://verify.walletconnect.com",w2],w4={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal"},w8={no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_listener_not_found:"proposal_listener_not_found"},w6={session_approve_started:"session_approve_started",session_namespaces_validation_success:"session_namespaces_validation_success",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},w9={no_internet_connection:"no_internet_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},w7={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},ve={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"};var vt=function(e,t){if(e.length>=255)throw TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var s=0;s<e.length;s++){var n=e.charAt(s),o=n.charCodeAt(0);if(255!==r[o])throw TypeError(n+" is ambiguous");r[o]=s}var a=e.length,c=e.charAt(0),l=Math.log(a)/Math.log(256),h=Math.log(256)/Math.log(a);function u(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;var t=0;if(" "!==e[0]){for(var i=0,s=0;e[t]===c;)i++,t++;for(var n=(e.length-t)*l+1>>>0,o=new Uint8Array(n);e[t];){var h=r[e.charCodeAt(t)];if(255===h)return;for(var u=0,d=n-1;(0!==h||u<s)&&-1!==d;d--,u++)h+=a*o[d]>>>0,o[d]=h%256>>>0,h=h/256>>>0;if(0!==h)throw Error("Non-zero carry");s=u,t++}if(" "!==e[t]){for(var p=n-s;p!==n&&0===o[p];)p++;for(var f=new Uint8Array(i+(n-p)),g=i;p!==n;)f[g++]=o[p++];return f}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";for(var r=0,i=0,s=0,n=t.length;s!==n&&0===t[s];)s++,r++;for(var o=(n-s)*h+1>>>0,l=new Uint8Array(o);s!==n;){for(var u=t[s],d=0,p=o-1;(0!==u||d<i)&&-1!==p;p--,d++)u+=256*l[p]>>>0,l[p]=u%a>>>0,u=u/a>>>0;if(0!==u)throw Error("Non-zero carry");i=d,s++}for(var f=o-i;f!==o&&0===l[f];)f++;for(var g=c.repeat(r);f<o;++f)g+=e.charAt(l[f]);return g},decodeUnsafe:u,decode:function(e){var r=u(e);if(r)return r;throw Error(`Non-${t} character`)}}};let vr=e=>{if(e instanceof Uint8Array&&"Uint8Array"===e.constructor.name)return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw Error("Unknown type, must be binary type")},vi=e=>new TextEncoder().encode(e),vs=e=>new TextDecoder().decode(e);class vn{constructor(e,t,r){this.name=e,this.prefix=t,this.baseEncode=r}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class vo{constructor(e,t,r){if(this.name=e,this.prefix=t,void 0===t.codePointAt(0))throw Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=r}decode(e){if("string"==typeof e){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}throw Error("Can only multibase decode strings")}or(e){return vc(this,e)}}class va{constructor(e){this.decoders=e}or(e){return vc(this,e)}decode(e){let t=e[0],r=this.decoders[t];if(r)return r.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}let vc=(e,t)=>new va({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class vl{constructor(e,t,r,i){this.name=e,this.prefix=t,this.baseEncode=r,this.baseDecode=i,this.encoder=new vn(e,t,r),this.decoder=new vo(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}let vh=({name:e,prefix:t,encode:r,decode:i})=>new vl(e,t,r,i),vu=({prefix:e,name:t,alphabet:r})=>{let{encode:i,decode:s}=vt(r,t);return vh({prefix:e,name:t,encode:i,decode:e=>vr(s(e))})},vd=(e,t,r,i)=>{let s={};for(let e=0;e<t.length;++e)s[t[e]]=e;let n=e.length;for(;"="===e[n-1];)--n;let o=new Uint8Array(n*r/8|0),a=0,c=0,l=0;for(let t=0;t<n;++t){let n=s[e[t]];if(void 0===n)throw SyntaxError(`Non-${i} character`);c=c<<r|n,(a+=r)>=8&&(a-=8,o[l++]=255&c>>a)}if(a>=r||255&c<<8-a)throw SyntaxError("Unexpected end of data");return o},vp=(e,t,r)=>{let i="="===t[t.length-1],s=(1<<r)-1,n="",o=0,a=0;for(let i=0;i<e.length;++i)for(a=a<<8|e[i],o+=8;o>r;)o-=r,n+=t[s&a>>o];if(o&&(n+=t[s&a<<r-o]),i)for(;n.length*r&7;)n+="=";return n},vf=({name:e,prefix:t,bitsPerChar:r,alphabet:i})=>vh({prefix:t,name:e,encode:e=>vp(e,i,r),decode:t=>vd(t,i,r,e)});var vg=Object.freeze({__proto__:null,identity:vh({prefix:"\0",name:"identity",encode:e=>vs(e),decode:e=>vi(e)})}),vm=Object.freeze({__proto__:null,base2:vf({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1})}),vy=Object.freeze({__proto__:null,base8:vf({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3})}),vb=Object.freeze({__proto__:null,base10:vu({prefix:"9",name:"base10",alphabet:"0123456789"})}),vw=Object.freeze({__proto__:null,base16:vf({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),base16upper:vf({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4})});let vv=vf({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),vE=vf({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),vI=vf({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),v_=vf({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),vC=vf({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),vS=vf({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5});var vN=Object.freeze({__proto__:null,base32:vv,base32upper:vE,base32pad:vI,base32padupper:v_,base32hex:vC,base32hexupper:vS,base32hexpad:vf({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),base32hexpadupper:vf({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),base32z:vf({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5})}),vA=Object.freeze({__proto__:null,base36:vu({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),base36upper:vu({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"})}),vO=Object.freeze({__proto__:null,base58btc:vu({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),base58flickr:vu({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"})});let vM=vf({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6});var vP=Object.freeze({__proto__:null,base64:vM,base64pad:vf({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),base64url:vf({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),base64urlpad:vf({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6})});let vx=Array.from("\uD83D\uDE80\uD83E\uDE90\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B\uD83E\uDD19\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81\uD83C\uDF1E\uD83C\uDF88\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74\uD83D\uDC8E\uD83D\uDCB8\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),vT=vx.reduce((e,t,r)=>(e[r]=t,e),[]),vD=vx.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);var vR=Object.freeze({__proto__:null,base256emoji:vh({prefix:"\uD83D\uDE80",name:"base256emoji",encode:function(e){return e.reduce((e,t)=>e+=vT[t],"")},decode:function(e){let t=[];for(let r of e){let e=vD[r.codePointAt(0)];if(void 0===e)throw Error(`Non-base256emoji character: ${r}`);t.push(e)}return new Uint8Array(t)}})});function vk(e,t){var r,i=0,t=t||0,s=0,n=t,o=e.length;do{if(n>=o)throw vk.bytes=0,RangeError("Could not decode varint");r=e[n++],i+=s<28?(127&r)<<s:(127&r)*Math.pow(2,s),s+=7}while(r>=128);return vk.bytes=n-t,i}var vj=function e(t,r,i){r=r||[],i=i||0;for(var s=i;t>=2147483648;)r[i++]=255&t|128,t/=128;for(;-128&t;)r[i++]=255&t|128,t>>>=7;return r[i]=0|t,e.bytes=i-s+1,r};let vL=(e,t,r=0)=>(vj(e,t,r),t),vU=e=>e<128?1:e<16384?2:e<2097152?3:e<268435456?4:e<34359738368?5:e<4398046511104?6:e<562949953421312?7:e<72057594037927940?8:e<0x7fffffffffffffff?9:10,vz=(e,t)=>{let r=t.byteLength,i=vU(e),s=i+vU(r),n=new Uint8Array(s+r);return vL(e,n,0),vL(r,n,i),n.set(t,s),new v$(e,r,t,n)};class v${constructor(e,t,r,i){this.code=e,this.size=t,this.digest=r,this.bytes=i}}let vq=({name:e,code:t,encode:r})=>new vB(e,t,r);class vB{constructor(e,t,r){this.name=e,this.code=t,this.encode=r}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?vz(this.code,t):t.then(e=>vz(this.code,e))}throw Error("Unknown type, must be binary type")}}let vW=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t));var vH=Object.freeze({__proto__:null,sha256:vq({name:"sha2-256",code:18,encode:vW("SHA-256")}),sha512:vq({name:"sha2-512",code:19,encode:vW("SHA-512")})}),vF=Object.freeze({__proto__:null,identity:{code:0,name:"identity",encode:vr,digest:e=>vz(0,vr(e))}});new TextEncoder,new TextDecoder;let vV={...vg,...vm,...vy,...vb,...vw,...vN,...vA,...vO,...vP,...vR};function vK(e,t,r,i){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:i}}}({...vH,...vF});let vJ=vK("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),vY=vK("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{let t=function(e=0){return null!=globalThis.Buffer&&null!=globalThis.Buffer.allocUnsafe?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}((e=e.substring(1)).length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),vG={utf8:vJ,"utf-8":vJ,hex:vV.base16,latin1:vY,ascii:vY,binary:vY,...vV};var vQ=Object.defineProperty,vZ=(e,t,r)=>t in e?vQ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,vX=(e,t,r)=>vZ(e,"symbol"!=typeof t?t+"":t,r);class v0{constructor(e,t){this.core=e,this.logger=t,vX(this,"keychain",new Map),vX(this,"name","keychain"),vX(this,"version","0.3"),vX(this,"initialized",!1),vX(this,"storagePrefix",wU),vX(this,"init",async()=>{if(!this.initialized){let e=await this.getKeyChain();"u">typeof e&&(this.keychain=e),this.initialized=!0}}),vX(this,"has",e=>(this.isInitialized(),this.keychain.has(e))),vX(this,"set",async(e,t)=>{this.isInitialized(),this.keychain.set(e,t),await this.persist()}),vX(this,"get",e=>{this.isInitialized();let t=this.keychain.get(e);if(typeof t>"u"){let{message:t}=wm("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}),vX(this,"del",async e=>{this.isInitialized(),this.keychain.delete(e),await this.persist()}),this.core=e,this.logger=(0,e$.Ep)(t,this.name)}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,mW(e))}async getKeyChain(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?mH(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}}var v1=Object.defineProperty,v2=(e,t,r)=>t in e?v1(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,v3=(e,t,r)=>v2(e,"symbol"!=typeof t?t+"":t,r);class v5{constructor(e,t,r){this.core=e,this.logger=t,v3(this,"name","crypto"),v3(this,"keychain"),v3(this,"randomSessionIdentifier",b6()),v3(this,"initialized",!1),v3(this,"init",async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)}),v3(this,"hasKeys",e=>(this.isInitialized(),this.keychain.has(e))),v3(this,"getClientId",async()=>(this.isInitialized(),ir(is(await this.getClientSeed()).publicKey))),v3(this,"generateKeyPair",()=>{this.isInitialized();let e=function(){let e=b1.utils.randomPrivateKey(),t=b1.getPublicKey(e);return{privateKey:nx(e,b3),publicKey:nx(t,b3)}}();return this.setPrivateKey(e.publicKey,e.privateKey)}),v3(this,"signJWT",async e=>{this.isInitialized();let t=is(await this.getClientSeed()),r=this.randomSessionIdentifier;return await io(r,e,wB,t)}),v3(this,"generateSharedKey",(e,t,r)=>{var i;this.isInitialized();let s=(i=this.getPrivateKey(e),nx(bS(bx,b1.getSharedSecret(nP(i,b3),nP(t,b3)),void 0,void 0,32),b3));return this.setSymKey(s,r)}),v3(this,"setSymKey",async(e,t)=>{this.isInitialized();let r=t||b9(e);return await this.keychain.set(r,e),r}),v3(this,"deleteKeyPair",async e=>{this.isInitialized(),await this.keychain.del(e)}),v3(this,"deleteSymKey",async e=>{this.isInitialized(),await this.keychain.del(e)}),v3(this,"encode",async(e,t,r)=>{this.isInitialized();let i=wi(r),s=(0,eP.u)(t);if(2===i.type)return function(e,t){let r=nP("2",b2),i=yf(12);return wt({type:r,sealed:nP(e,b8),iv:i,encoding:t})}(s,r?.encoding);if(ws(i)){let t=i.senderPublicKey,r=i.receiverPublicKey;e=await this.generateSharedKey(t,r)}let n=this.getSymKey(e),{type:o,senderPublicKey:a}=i;return function(e){var t;let r=(t="u">typeof e.type?e.type:0,nP(`${t}`,b2));if(1===we(r)&&typeof e.senderPublicKey>"u")throw Error("Missing sender public key for type 1 envelope");let i="u">typeof e.senderPublicKey?nP(e.senderPublicKey,b3):void 0,s="u">typeof e.iv?nP(e.iv,b3):yf(12);return wt({type:r,sealed:bv(nP(e.symKey,b3),s).encrypt(nP(e.message,b8)),iv:s,senderPublicKey:i,encoding:e.encoding})}({type:o,symKey:n,message:s,senderPublicKey:a,encoding:r?.encoding})}),v3(this,"decode",async(e,t,r)=>{this.isInitialized();let i=function(e,t){let r=wr({encoded:e,encoding:t?.encoding});return wi({type:we(r.type),senderPublicKey:"u">typeof r.senderPublicKey?nx(r.senderPublicKey,b3):void 0,receiverPublicKey:t?.receiverPublicKey})}(t,r);if(2===i.type){let e=function(e,t){let{sealed:r}=wr({encoded:e,encoding:t});return nx(r,b8)}(t,r?.encoding);return(0,eP.D)(e)}if(ws(i)){let t=i.receiverPublicKey,r=i.senderPublicKey;e=await this.generateSharedKey(t,r)}try{let i=this.getSymKey(e),s=function(e){let t=nP(e.symKey,b3),{sealed:r,iv:i}=wr(e),s=bv(t,i).decrypt(r);if(null===s)throw Error("Failed to decrypt");return nx(s,b8)}({symKey:i,encoded:t,encoding:r?.encoding});return(0,eP.D)(s)}catch(t){this.logger.error(`Failed to decode message from topic: '${e}', clientId: '${await this.getClientId()}'`),this.logger.error(t)}}),v3(this,"getPayloadType",(e,t=b5)=>we(wr({encoded:e,encoding:t}).type)),v3(this,"getPayloadSenderPublicKey",(e,t=b5)=>{let r=wr({encoded:e,encoding:t});return r.senderPublicKey?nx(r.senderPublicKey,b3):void 0}),this.core=e,this.logger=(0,e$.Ep)(t,this.name),this.keychain=r||new v0(this.core,this.logger)}get context(){return(0,e$.Fd)(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(wq)}catch{e=b6(),await this.keychain.set(wq,e)}return function(e,t="utf8"){let r=vG[t];if(!r)throw Error(`Unsupported encoding "${t}"`);return("utf8"===t||"utf-8"===t)&&null!=globalThis.Buffer&&null!=globalThis.Buffer.from?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}}var v4=Object.defineProperty,v8=Object.defineProperties,v6=Object.getOwnPropertyDescriptors,v9=Object.getOwnPropertySymbols,v7=Object.prototype.hasOwnProperty,Ee=Object.prototype.propertyIsEnumerable,Et=(e,t,r)=>t in e?v4(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Er=(e,t)=>{for(var r in t||(t={}))v7.call(t,r)&&Et(e,r,t[r]);if(v9)for(var r of v9(t))Ee.call(t,r)&&Et(e,r,t[r]);return e},Ei=(e,t)=>v8(e,v6(t)),Es=(e,t,r)=>Et(e,"symbol"!=typeof t?t+"":t,r);class En extends gM{constructor(e,t){super(e,t),this.logger=e,this.core=t,Es(this,"messages",new Map),Es(this,"messagesWithoutClientAck",new Map),Es(this,"name","messages"),Es(this,"version","0.3"),Es(this,"initialized",!1),Es(this,"storagePrefix",wU),Es(this,"init",async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let e=await this.getRelayerMessages();"u">typeof e&&(this.messages=e);let t=await this.getRelayerMessagesWithoutClientAck();"u">typeof t&&(this.messagesWithoutClientAck=t),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}finally{this.initialized=!0}}}),Es(this,"set",async(e,t,r)=>{this.isInitialized();let i=b7(t),s=this.messages.get(e);if(typeof s>"u"&&(s={}),"u">typeof s[i])return i;if(s[i]=t,this.messages.set(e,s),r===wY.inbound){let r=this.messagesWithoutClientAck.get(e)||{};this.messagesWithoutClientAck.set(e,Ei(Er({},r),{[i]:t}))}return await this.persist(),i}),Es(this,"get",e=>{this.isInitialized();let t=this.messages.get(e);return typeof t>"u"&&(t={}),t}),Es(this,"getWithoutAck",e=>{this.isInitialized();let t={};for(let r of e){let e=this.messagesWithoutClientAck.get(r)||{};t[r]=Object.values(e)}return t}),Es(this,"has",(e,t)=>(this.isInitialized(),"u">typeof this.get(e)[b7(t)])),Es(this,"ack",async(e,t)=>{this.isInitialized();let r=this.messagesWithoutClientAck.get(e);if(typeof r>"u")return;let i=b7(t);delete r[i],0===Object.keys(r).length?this.messagesWithoutClientAck.delete(e):this.messagesWithoutClientAck.set(e,r),await this.persist()}),Es(this,"del",async e=>{this.isInitialized(),this.messages.delete(e),this.messagesWithoutClientAck.delete(e),await this.persist()}),this.logger=(0,e$.Ep)(e,this.name),this.core=t}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get storageKeyWithoutClientAck(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name+"_withoutClientAck"}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,mW(e))}async setRelayerMessagesWithoutClientAck(e){await this.core.storage.setItem(this.storageKeyWithoutClientAck,mW(e))}async getRelayerMessages(){let e=await this.core.storage.getItem(this.storageKey);return"u">typeof e?mH(e):void 0}async getRelayerMessagesWithoutClientAck(){let e=await this.core.storage.getItem(this.storageKeyWithoutClientAck);return"u">typeof e?mH(e):void 0}async persist(){await this.setRelayerMessages(this.messages),await this.setRelayerMessagesWithoutClientAck(this.messagesWithoutClientAck)}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}}var Eo=Object.defineProperty,Ea=Object.defineProperties,Ec=Object.getOwnPropertyDescriptors,El=Object.getOwnPropertySymbols,Eh=Object.prototype.hasOwnProperty,Eu=Object.prototype.propertyIsEnumerable,Ed=(e,t,r)=>t in e?Eo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ep=(e,t)=>{for(var r in t||(t={}))Eh.call(t,r)&&Ed(e,r,t[r]);if(El)for(var r of El(t))Eu.call(t,r)&&Ed(e,r,t[r]);return e},Ef=(e,t)=>Ea(e,Ec(t)),Eg=(e,t,r)=>Ed(e,"symbol"!=typeof t?t+"":t,r);class Em extends gP{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,Eg(this,"events",new ee.EventEmitter),Eg(this,"name","publisher"),Eg(this,"queue",new Map),Eg(this,"publishTimeout",(0,er.toMiliseconds)(er.ONE_MINUTE)),Eg(this,"initialPublishTimeout",(0,er.toMiliseconds)(15*er.ONE_SECOND)),Eg(this,"needsTransportRestart",!1),Eg(this,"publish",async(e,t,r)=>{var i;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:e,message:t,opts:r}});let s=r?.ttl||wW,n=wn(r),o=r?.prompt||!1,a=r?.tag||0,c=r?.id||(0,cq.getBigIntRpcId)().toString(),l={topic:e,message:t,opts:{ttl:s,relay:n,prompt:o,tag:a,id:c,attestation:r?.attestation,tvf:r?.tvf}},h=`Failed to publish payload, please try again. id:${c} tag:${a}`;try{let i=new Promise(async i=>{let n=({id:e})=>{l.opts.id===e&&(this.removeRequestFromQueue(e),this.relayer.events.removeListener(wF.publish,n),i(l))};this.relayer.events.on(wF.publish,n);let h=mV(new Promise((i,n)=>{this.rpcPublish({topic:e,message:t,ttl:s,prompt:o,tag:a,id:c,attestation:r?.attestation,tvf:r?.tvf}).then(i).catch(e=>{this.logger.warn(e,e?.message),n(e)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${c} tag:${a}`);try{await h,this.events.removeListener(wF.publish,n)}catch(e){this.queue.set(c,Ef(Ep({},l),{attempt:1})),this.logger.warn(e,e?.message)}});this.logger.trace({type:"method",method:"publish",params:{id:c,topic:e,message:t,opts:r}}),await mV(i,this.publishTimeout,h)}catch(e){if(this.logger.debug("Failed to Publish Payload"),this.logger.error(e),null!=(i=r?.internal)&&i.throwOnFailedPublish)throw e}finally{this.queue.delete(c)}}),Eg(this,"on",(e,t)=>{this.events.on(e,t)}),Eg(this,"once",(e,t)=>{this.events.once(e,t)}),Eg(this,"off",(e,t)=>{this.events.off(e,t)}),Eg(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.relayer=e,this.logger=(0,e$.Ep)(t,this.name),this.registerEventListeners()}get context(){return(0,e$.Fd)(this.logger)}async rpcPublish(e){var t,r,i,s;let{topic:n,message:o,ttl:a=wW,prompt:c,tag:l,id:h,attestation:u,tvf:d}=e,p={method:wo(wn().protocol).publish,params:Ep({topic:n,message:o,ttl:a,prompt:c,tag:l,attestation:u},d),id:h};wv(null==(t=p.params)?void 0:t.prompt)&&(null==(r=p.params)||delete r.prompt),wv(null==(i=p.params)?void 0:i.tag)&&(null==(s=p.params)||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:p});let f=await this.relayer.request(p);return this.relayer.events.emit(wF.publish,e),this.logger.debug("Successfully Published Payload"),f}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,t)=>{let r=e.attempt+1;this.queue.set(t,Ef(Ep({},e),{attempt:r}));let{topic:i,message:s,opts:n,attestation:o}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${r}`),await this.rpcPublish(Ef(Ep({},e),{topic:i,message:s,ttl:n.ttl,prompt:n.prompt,tag:n.tag,id:n.id,attestation:o,tvf:n.tvf})),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(eo,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(wF.connection_stalled);return}this.checkQueue()}),this.relayer.on(wF.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}var Ey=Object.defineProperty,Eb=(e,t,r)=>t in e?Ey(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ew=(e,t,r)=>Eb(e,"symbol"!=typeof t?t+"":t,r);class Ev{constructor(){Ew(this,"map",new Map),Ew(this,"set",(e,t)=>{let r=this.get(e);this.exists(e,t)||this.map.set(e,[...r,t])}),Ew(this,"get",e=>this.map.get(e)||[]),Ew(this,"exists",(e,t)=>this.get(e).includes(t)),Ew(this,"delete",(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;let r=this.get(e);if(!this.exists(e,t))return;let i=r.filter(e=>e!==t);if(!i.length){this.map.delete(e);return}this.map.set(e,i)}),Ew(this,"clear",()=>{this.map.clear()})}get topics(){return Array.from(this.map.keys())}}var EE=Object.defineProperty,EI=Object.defineProperties,E_=Object.getOwnPropertyDescriptors,EC=Object.getOwnPropertySymbols,ES=Object.prototype.hasOwnProperty,EN=Object.prototype.propertyIsEnumerable,EA=(e,t,r)=>t in e?EE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,EO=(e,t)=>{for(var r in t||(t={}))ES.call(t,r)&&EA(e,r,t[r]);if(EC)for(var r of EC(t))EN.call(t,r)&&EA(e,r,t[r]);return e},EM=(e,t)=>EI(e,E_(t)),EP=(e,t,r)=>EA(e,"symbol"!=typeof t?t+"":t,r);class Ex extends gD{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,EP(this,"subscriptions",new Map),EP(this,"topicMap",new Ev),EP(this,"events",new ee.EventEmitter),EP(this,"name","subscription"),EP(this,"version","0.3"),EP(this,"pending",new Map),EP(this,"cached",[]),EP(this,"initialized",!1),EP(this,"storagePrefix",wU),EP(this,"subscribeTimeout",(0,er.toMiliseconds)(er.ONE_MINUTE)),EP(this,"initialSubscribeTimeout",(0,er.toMiliseconds)(15*er.ONE_SECOND)),EP(this,"clientId"),EP(this,"batchSubscribeTopicsLimit",500),EP(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),await this.restore()),this.initialized=!0}),EP(this,"subscribe",async(e,t)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}});try{let r=wn(t),i={topic:e,relay:r,transportType:t?.transportType};this.pending.set(e,i);let s=await this.rpcSubscribe(e,r,t);return"string"==typeof s&&(this.onSubscribe(s,i),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:e,opts:t}})),s}catch(e){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(e),e}}),EP(this,"unsubscribe",async(e,t)=>{this.isInitialized(),"u">typeof t?.id?await this.unsubscribeById(e,t.id,t):await this.unsubscribeByTopic(e,t)}),EP(this,"isSubscribed",e=>new Promise(t=>{t(this.topicMap.topics.includes(e))})),EP(this,"isKnownTopic",e=>new Promise(t=>{t(this.topicMap.topics.includes(e)||this.pending.has(e)||this.cached.some(t=>t.topic===e))})),EP(this,"on",(e,t)=>{this.events.on(e,t)}),EP(this,"once",(e,t)=>{this.events.once(e,t)}),EP(this,"off",(e,t)=>{this.events.off(e,t)}),EP(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),EP(this,"start",async()=>{await this.onConnect()}),EP(this,"stop",async()=>{await this.onDisconnect()}),EP(this,"restart",async()=>{await this.restore(),await this.onRestart()}),EP(this,"checkPending",async()=>{if(0===this.pending.size&&(!this.initialized||!this.relayer.connected))return;let e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}),EP(this,"registerEventListeners",()=>{this.relayer.core.heartbeat.on(eo,async()=>{await this.checkPending()}),this.events.on(wQ.created,async e=>{let t=wQ.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(wQ.deleted,async e=>{let t=wQ.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}),this.relayer=e,this.logger=(0,e$.Ep)(t,this.name),this.clientId=""}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}get hasAnyTopics(){return this.topicMap.topics.length>0||this.pending.size>0||this.cached.length>0||this.subscriptions.size>0}hasSubscription(e,t){let r=!1;try{r=this.getSubscription(e).topic===t}catch{}return r}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){let r=this.topicMap.get(e);await Promise.all(r.map(async r=>await this.unsubscribeById(e,r,t)))}async unsubscribeById(e,t,r){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}});try{let i=wn(r);await this.restartToComplete({topic:e,id:t,relay:i}),await this.rpcUnsubscribe(e,t,i);let s=wy("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:r}})}catch(e){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(e),e}}async rpcSubscribe(e,t,r){var i;r&&r?.transportType!==wJ.relay||await this.restartToComplete({topic:e,id:e,relay:t});let s={method:wo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});let n=null==(i=r?.internal)?void 0:i.throwOnFailedPublish;try{let t=await this.getSubscriptionId(e);if(r?.transportType===wJ.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(e=>this.logger.warn(e))},(0,er.toMiliseconds)(er.ONE_SECOND)),t;let i=new Promise(async t=>{let r=i=>{i.topic===e&&(this.events.removeListener(wQ.created,r),t(i.id))};this.events.on(wQ.created,r);try{let i=await mV(new Promise((e,t)=>{this.relayer.request(s).catch(e=>{this.logger.warn(e,e?.message),t(e)}).then(e)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(wQ.created,r),t(i)}catch{}}),o=await mV(i,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!o&&n)throw Error(`Subscribing to ${e} failed, please try again`);return o?t:null}catch(e){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(wF.connection_stalled),n)throw e}return null}async rpcBatchSubscribe(e){if(!e.length)return;let t={method:wo(e[0].relay.protocol).batchSubscribe,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:t});try{await await mV(new Promise(e=>{this.relayer.request(t).catch(e=>this.logger.warn(e)).then(e)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(wF.connection_stalled)}}async rpcBatchFetchMessages(e){let t;if(!e.length)return;let r={method:wo(e[0].relay.protocol).batchFetchMessages,params:{topics:e.map(e=>e.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:r});try{t=await await mV(new Promise((e,t)=>{this.relayer.request(r).catch(e=>{this.logger.warn(e),t(e)}).then(e)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(wF.connection_stalled)}return t}rpcUnsubscribe(e,t,r){let i={method:wo(r.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.request(i)}onSubscribe(e,t){this.setSubscription(e,EM(EO({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(e=>{this.setSubscription(e.id,EO({},e)),this.pending.delete(e.topic)})}async onUnsubscribe(e,t,r){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,r),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t)}addSubscription(e,t){this.subscriptions.set(e,EO({},t)),this.topicMap.set(t.topic,e),this.events.emit(wQ.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});let t=this.subscriptions.get(e);if(!t){let{message:t}=wm("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});let r=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(r.topic,e),this.events.emit(wQ.deleted,EM(EO({},r),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(wQ.sync)}async onRestart(){if(this.cached.length){let e=[...this.cached],t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){let t=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(t)}}this.events.emit(wQ.resubscribed)}async restore(){try{let e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){let{message:e}=wm("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(await Promise.all(e.map(async e=>EM(EO({},e),{id:await this.getSubscriptionId(e.topic)})))))}async batchFetchMessages(e){var t;if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);let r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await (t=(0,er.toMiliseconds)(er.ONE_SECOND),new Promise(e=>setTimeout(e,t))),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}async restartToComplete(e){this.relayer.connected||this.relayer.connecting||(this.cached.push(e),await this.relayer.transportOpen())}async getClientId(){return this.clientId||(this.clientId=await this.relayer.core.crypto.getClientId()),this.clientId}async getSubscriptionId(e){return b7(e+await this.getClientId())}}var ET=Object.defineProperty,ED=Object.getOwnPropertySymbols,ER=Object.prototype.hasOwnProperty,Ek=Object.prototype.propertyIsEnumerable,Ej=(e,t,r)=>t in e?ET(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,EL=(e,t)=>{for(var r in t||(t={}))ER.call(t,r)&&Ej(e,r,t[r]);if(ED)for(var r of ED(t))Ek.call(t,r)&&Ej(e,r,t[r]);return e},EU=(e,t,r)=>Ej(e,"symbol"!=typeof t?t+"":t,r);class Ez extends gx{constructor(e){super(e),EU(this,"protocol","wc"),EU(this,"version",2),EU(this,"core"),EU(this,"logger"),EU(this,"events",new ee.EventEmitter),EU(this,"provider"),EU(this,"messages"),EU(this,"subscriber"),EU(this,"publisher"),EU(this,"name","relayer"),EU(this,"transportExplicitlyClosed",!1),EU(this,"initialized",!1),EU(this,"connectionAttemptInProgress",!1),EU(this,"relayUrl"),EU(this,"projectId"),EU(this,"packageName"),EU(this,"bundleId"),EU(this,"hasExperiencedNetworkDisruption",!1),EU(this,"pingTimeout"),EU(this,"heartBeatTimeout",(0,er.toMiliseconds)(er.THIRTY_SECONDS+er.FIVE_SECONDS)),EU(this,"reconnectTimeout"),EU(this,"connectPromise"),EU(this,"reconnectInProgress",!1),EU(this,"requestsInFlight",[]),EU(this,"connectTimeout",(0,er.toMiliseconds)(15*er.ONE_SECOND)),EU(this,"request",async e=>{var t,r;this.logger.debug("Publishing Request Payload");let i=e.id||(0,cq.getBigIntRpcId)().toString();await this.toEstablishConnection();try{this.logger.trace({id:i,method:e.method,topic:null==(t=e.params)?void 0:t.topic},"relayer.request - publishing...");let s=`${i}:${(null==(r=e.params)?void 0:r.tag)||""}`;this.requestsInFlight.push(s);let n=await this.provider.request(e);return this.requestsInFlight=this.requestsInFlight.filter(e=>e!==s),n}catch(e){throw this.logger.debug(`Failed to Publish Request: ${i}`),e}}),EU(this,"resetPingTimeout",()=>{mk()&&(clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var e,t,r,i;try{this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),null==(i=null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.terminate)||i.call(r)}catch(e){this.logger.warn(e,e?.message)}},this.heartBeatTimeout))}),EU(this,"onPayloadHandler",e=>{this.onProviderPayload(e),this.resetPingTimeout()}),EU(this,"onConnectHandler",()=>{this.logger.warn({},"Relayer connected \uD83D\uDEDC"),this.startPingTimeout(),this.events.emit(wF.connect)}),EU(this,"onDisconnectHandler",()=>{this.logger.warn({},"Relayer disconnected \uD83D\uDED1"),this.requestsInFlight=[],this.onProviderDisconnect()}),EU(this,"onProviderErrorHandler",e=>{this.logger.fatal(`Fatal socket error: ${e.message}`),this.events.emit(wF.error,e),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()}),EU(this,"registerProviderListeners",()=>{this.provider.on(wV.payload,this.onPayloadHandler),this.provider.on(wV.connect,this.onConnectHandler),this.provider.on(wV.disconnect,this.onDisconnectHandler),this.provider.on(wV.error,this.onProviderErrorHandler)}),this.core=e.core,this.logger="u">typeof e.logger&&"string"!=typeof e.logger?(0,e$.Ep)(e.logger,this.name):(0,e$.gw)((0,e$.jI)({level:e.logger||"error"})),this.messages=new En(this.logger,e.core),this.subscriber=new Ex(this,this.logger),this.publisher=new Em(this,this.logger),this.relayUrl=e?.relayUrl||wH,this.projectId=e.projectId,mj()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="android"?this.packageName=mz():mj()&&"u">typeof r.g&&"u">typeof(null==r.g?void 0:r.g.Platform)&&(null==r.g?void 0:r.g.Platform.OS)==="ios"&&(this.bundleId=mz()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.hasAnyTopics)try{await this.transportOpen()}catch(e){this.logger.warn(e,e?.message)}}get context(){return(0,e$.Fd)(this.logger)}get connected(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===1}get connecting(){var e,t,r;return(null==(r=null==(t=null==(e=this.provider)?void 0:e.connection)?void 0:t.socket)?void 0:r.readyState)===0||void 0!==this.connectPromise}async publish(e,t,r){this.isInitialized(),await this.publisher.publish(e,t,r),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now(),transportType:wJ.relay},wY.outbound)}async subscribe(e,t){var r,i,s;this.isInitialized(),null!=t&&t.transportType&&t?.transportType!=="relay"||await this.toEstablishConnection();let n=typeof(null==(r=t?.internal)?void 0:r.throwOnFailedPublish)>"u"||(null==(i=t?.internal)?void 0:i.throwOnFailedPublish),o=(null==(s=this.subscriber.topicMap.get(e))?void 0:s[0])||"",a,c=t=>{t.topic===e&&(this.subscriber.off(wQ.created,c),a())};return await Promise.all([new Promise(e=>{a=e,this.subscriber.on(wQ.created,c)}),new Promise(async(r,i)=>{o=await this.subscriber.subscribe(e,EL({internal:{throwOnFailedPublish:n}},t)).catch(e=>{n&&i(e)})||o,r()})]),o}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await mV(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(!this.subscriber.hasAnyTopics){this.logger.warn("Starting WS connection skipped because the client has no topics to work with.");return}if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(t,r)=>{await this.connect(e).then(t).catch(r).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),this.connectionAttemptInProgress||(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await wT())throw Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if(e?.length===0){this.logger.trace("Batch message events is empty. Ignoring...");return}let t=e.sort((e,t)=>e.publishedAt-t.publishedAt);for(let e of(this.logger.debug(`Batch of ${t.length} message events sorted`),t))try{await this.onMessageEvent(e)}catch(e){this.logger.warn(e,"Error while processing batch message event: "+e?.message)}this.logger.trace(`Batch of ${t.length} message events processed`)}async onLinkMessageEvent(e,t){let{topic:r}=e;if(!t.sessionExists){let e=mY(er.FIVE_MINUTES);await this.core.pairing.pairings.set(r,{topic:r,expiry:e,relay:{protocol:"irn"},active:!1})}this.events.emit(wF.message,e),await this.recordMessageEvent(e,wY.inbound)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let t=1;for(;t<6;){try{if(this.transportExplicitlyClosed)break;this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${t}...`),await this.createProvider(),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(wV.disconnect,r),await mV(new Promise((e,t)=>{this.provider.connect().then(e).catch(t)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(e=>{t(e)}).finally(()=>{this.provider.off(wV.disconnect,r),clearTimeout(this.reconnectTimeout)}),await new Promise(async(e,t)=>{let r=()=>{t(Error("Connection interrupted while trying to subscribe"))};this.provider.once(wV.disconnect,r),await this.subscriber.start().then(e).catch(t).finally(()=>{this.provider.off(wV.disconnect,r)})}),this.hasExperiencedNetworkDisruption=!1,e()})}catch(e){await this.subscriber.stop(),this.logger.warn({},e.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${t}`);break}await new Promise(e=>setTimeout(e,(0,er.toMiliseconds)(1*t))),t++}}startPingTimeout(){var e,t,r,i,s;if(mk())try{null!=(t=null==(e=this.provider)?void 0:e.connection)&&t.socket&&(null==(s=null==(i=null==(r=this.provider)?void 0:r.connection)?void 0:i.socket)||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(e){this.logger.warn(e,e?.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new c$.r(new cF(function({protocol:e,version:t,relayUrl:r,sdkVersion:i,auth:s,projectId:n,useOnCloseEvent:o,bundleId:a,packageName:c}){let l=r.split("?"),h=mq(e,t,i),u=function(e,t){let r=new URLSearchParams(e);for(let e of Object.keys(t).sort())if(t.hasOwnProperty(e)){let i=t[e];void 0!==i&&r.set(e,i)}return r.toString()}(l[1]||"",{auth:s,ua:h,projectId:n,useOnCloseEvent:o||void 0,packageName:c||void 0,bundleId:a||void 0});return l[0]+"?"+u}({sdkVersion:wK,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e,t){let{topic:r,message:i}=e;await this.messages.set(r,i,t)}async shouldIgnoreMessageEvent(e){let{topic:t,message:r}=e;if(!r||0===r.length)return this.logger.warn(`Ignoring invalid/empty message: ${r}`),!0;if(!await this.subscriber.isKnownTopic(t))return this.logger.warn(`Ignoring message for unknown topic ${t}`),!0;let i=this.messages.has(t,r);return i&&this.logger.warn(`Ignoring duplicate message: ${r}`),i}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),(0,cq.isJsonRpcRequest)(e)){if(!e.method.endsWith("_subscription"))return;let t=e.params,{topic:r,message:i,publishedAt:s,attestation:n}=t.data,o={topic:r,message:i,publishedAt:s,transportType:wJ.relay,attestation:n};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(EL({type:"event",event:t.id},o)),this.events.emit(t.id,o),await this.acknowledgePayload(e),await this.onMessageEvent(o)}else(0,cq.isJsonRpcResponse)(e)&&this.events.emit(wF.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(await this.recordMessageEvent(e,wY.inbound),this.events.emit(wF.message,e))}async acknowledgePayload(e){let t=(0,cq.formatJsonRpcResult)(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(wV.payload,this.onPayloadHandler),this.provider.off(wV.connect,this.onConnectHandler),this.provider.off(wV.disconnect,this.onDisconnectHandler),this.provider.off(wV.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await wT();!function(e){switch(mU()){case mR.browser:!mj()&&mL()&&(window.addEventListener("online",()=>e(!0)),window.addEventListener("offline",()=>e(!1)));break;case mR.reactNative:mj()&&"u">typeof r.g&&null!=r.g&&r.g.NetInfo&&r.g?.NetInfo.addEventListener(t=>e(t?.isConnected));case mR.node:}}(async t=>{e!==t&&(e=t,t?await this.transportOpen().catch(e=>this.logger.error(e,e?.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){clearTimeout(this.pingTimeout),this.events.emit(wF.disconnect),this.connectionAttemptInProgress=!1,!this.reconnectInProgress&&(this.reconnectInProgress=!0,await this.subscriber.stop(),this.subscriber.hasAnyTopics&&(this.transportExplicitlyClosed||(this.reconnectTimeout=setTimeout(async()=>{await this.transportOpen().catch(e=>this.logger.error(e,e?.message)),this.reconnectTimeout=void 0,this.reconnectInProgress=!1},(0,er.toMiliseconds)(.1)))))}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),this.connected||await this.connect()}}function E$(){}function Eq(e){if(!e||"object"!=typeof e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&"[object Object]"===Object.prototype.toString.call(e)}function EB(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function EW(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let EH="[object Arguments]",EF="[object Object]";var EV=Object.defineProperty,EK=Object.getOwnPropertySymbols,EJ=Object.prototype.hasOwnProperty,EY=Object.prototype.propertyIsEnumerable,EG=(e,t,r)=>t in e?EV(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,EQ=(e,t)=>{for(var r in t||(t={}))EJ.call(t,r)&&EG(e,r,t[r]);if(EK)for(var r of EK(t))EY.call(t,r)&&EG(e,r,t[r]);return e},EZ=(e,t,r)=>EG(e,"symbol"!=typeof t?t+"":t,r);class EX extends gT{constructor(e,t,r,i=wU,s){super(e,t,r,i),this.core=e,this.logger=t,this.name=r,EZ(this,"map",new Map),EZ(this,"version","0.3"),EZ(this,"cached",[]),EZ(this,"initialized",!1),EZ(this,"getKey"),EZ(this,"storagePrefix",wU),EZ(this,"recentlyDeleted",[]),EZ(this,"recentlyDeletedLimit",200),EZ(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>{var t;this.getKey&&null!==e&&!wv(e)?this.map.set(this.getKey(e),e):(null==(t=e?.proposer)?void 0:t.publicKey)?this.map.set(e.id,e):e?.topic&&this.map.set(e.topic,e)}),this.cached=[],this.initialized=!0)}),EZ(this,"set",async(e,t)=>{this.isInitialized(),this.map.has(e)?await this.update(e,t):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:e,value:t}),this.map.set(e,t),await this.persist())}),EZ(this,"get",e=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:e}),this.getData(e))),EZ(this,"getAll",e=>(this.isInitialized(),e?this.values.filter(t=>Object.keys(e).every(r=>(function e(t,r,i,s,n,o,a){let c=a(t,r,i,s,n,o);if(void 0!==c)return c;if(typeof t==typeof r)switch(typeof t){case"bigint":case"string":case"boolean":case"symbol":case"undefined":case"function":return t===r;case"number":return t===r||Object.is(t,r)}return function t(r,i,s,n){if(Object.is(r,i))return!0;let o=EW(r),a=EW(i);if(o===EH&&(o=EF),a===EH&&(a=EF),o!==a)return!1;switch(o){case"[object String]":return r.toString()===i.toString();case"[object Number]":{let e=r.valueOf(),t=i.valueOf();return e===t||Number.isNaN(e)&&Number.isNaN(t)}case"[object Boolean]":case"[object Date]":case"[object Symbol]":return Object.is(r.valueOf(),i.valueOf());case"[object RegExp]":return r.source===i.source&&r.flags===i.flags;case"[object Function]":return r===i}let c=(s=s??new Map).get(r),l=s.get(i);if(null!=c&&null!=l)return c===i;s.set(r,i),s.set(i,r);try{switch(o){case"[object Map]":if(r.size!==i.size)return!1;for(let[t,o]of r.entries())if(!i.has(t)||!e(o,i.get(t),t,r,i,s,n))return!1;return!0;case"[object Set]":{if(r.size!==i.size)return!1;let t=Array.from(r.values()),o=Array.from(i.values());for(let a=0;a<t.length;a++){let c=t[a],l=o.findIndex(t=>e(c,t,void 0,r,i,s,n));if(-1===l)return!1;o.splice(l,1)}return!0}case"[object Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":case"[object BigUint64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object BigInt64Array]":case"[object Float32Array]":case"[object Float64Array]":if("u">typeof wj&&wj.isBuffer(r)!==wj.isBuffer(i)||r.length!==i.length)return!1;for(let t=0;t<r.length;t++)if(!e(r[t],i[t],t,r,i,s,n))return!1;return!0;case"[object ArrayBuffer]":return r.byteLength===i.byteLength&&t(new Uint8Array(r),new Uint8Array(i),s,n);case"[object DataView]":return r.byteLength===i.byteLength&&r.byteOffset===i.byteOffset&&t(new Uint8Array(r),new Uint8Array(i),s,n);case"[object Error]":return r.name===i.name&&r.message===i.message;case EF:{if(!(t(r.constructor,i.constructor,s,n)||Eq(r)&&Eq(i)))return!1;let o=[...Object.keys(r),...EB(r)],a=[...Object.keys(i),...EB(i)];if(o.length!==a.length)return!1;for(let t=0;t<o.length;t++){let a=o[t],c=r[a];if(!Object.hasOwn(i,a))return!1;let l=i[a];if(!e(c,l,a,r,i,s,n))return!1}return!0}default:return!1}}finally{s.delete(r),s.delete(i)}}(t,r,o,a)})(t[r],e[r],void 0,void 0,void 0,void 0,E$))):this.values)),EZ(this,"update",async(e,t)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:e,update:t});let r=EQ(EQ({},this.getData(e)),t);this.map.set(e,r),await this.persist()}),EZ(this,"delete",async(e,t)=>{this.isInitialized(),this.map.has(e)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:e,reason:t}),this.map.delete(e),this.addToRecentlyDeleted(e),await this.persist())}),this.logger=(0,e$.Ep)(t,this.name),this.storagePrefix=i,this.getKey=s}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){let t=this.map.get(e);if(!t){if(this.recentlyDeleted.includes(e)){let{message:t}=wm("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(t),Error(t)}let{message:t}=wm("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(t),Error(t)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{let e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){let{message:e}=wm("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}}var E0=Object.defineProperty,E1=(e,t,r)=>t in e?E0(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E2=(e,t,r)=>E1(e,"symbol"!=typeof t?t+"":t,r);class E3{constructor(e,t){this.core=e,this.logger=t,E2(this,"name","pairing"),E2(this,"version","0.3"),E2(this,"events",new(et())),E2(this,"pairings"),E2(this,"initialized",!1),E2(this,"storagePrefix",wU),E2(this,"ignoredPayloadTypes",[1]),E2(this,"registeredMethods",[]),E2(this,"init",async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))}),E2(this,"register",({methods:e})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...e])]}),E2(this,"create",async e=>{this.isInitialized();let t=b6(),r=await this.core.crypto.setSymKey(t),i=mY(er.FIVE_MINUTES),s={protocol:"irn"},n={topic:r,expiry:i,relay:s,active:!1,methods:e?.methods},o=wc({protocol:this.core.protocol,version:this.core.version,topic:r,symKey:t,relay:s,expiryTimestamp:i,methods:e?.methods});return this.events.emit(wX.create,n),this.core.expirer.set(r,i),await this.pairings.set(r,n),await this.core.relayer.subscribe(r,{transportType:e?.transportType}),{topic:r,uri:o}}),E2(this,"pair",async e=>{let t;this.isInitialized();let r=this.core.eventClient.createEvent({properties:{topic:e?.uri,trace:[w4.pairing_started]}});this.isValidPair(e,r);let{topic:i,symKey:s,relay:n,expiryTimestamp:o,methods:a}=wa(e.uri);if(r.props.properties.topic=i,r.addTrace(w4.pairing_uri_validation_success),r.addTrace(w4.pairing_uri_not_expired),this.pairings.keys.includes(i)){if(t=this.pairings.get(i),r.addTrace(w4.existing_pairing),t.active)throw r.setError(w8.active_pairing_already_exists),Error(`Pairing already exists: ${i}. Please try again with a new connection URI.`);r.addTrace(w4.pairing_not_expired)}let c=o||mY(er.FIVE_MINUTES),l={topic:i,relay:n,expiry:c,active:!1,methods:a};this.core.expirer.set(i,c),await this.pairings.set(i,l),r.addTrace(w4.store_new_pairing),e.activatePairing&&await this.activate({topic:i}),this.events.emit(wX.create,l),r.addTrace(w4.emit_inactive_pairing),this.core.crypto.keychain.has(i)||await this.core.crypto.setSymKey(s,i),r.addTrace(w4.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{r.setError(w8.no_internet_connection)}try{await this.core.relayer.subscribe(i,{relay:n})}catch(e){throw r.setError(w8.subscribe_pairing_topic_failure),e}return r.addTrace(w4.subscribe_pairing_topic_success),l}),E2(this,"activate",async({topic:e})=>{this.isInitialized();let t=mY(er.FIVE_MINUTES);this.core.expirer.set(e,t),await this.pairings.update(e,{active:!0,expiry:t})}),E2(this,"ping",async e=>{this.isInitialized(),await this.isValidPing(e),this.logger.warn("ping() is deprecated and will be removed in the next major release.");let{topic:t}=e;if(this.pairings.keys.includes(t)){let e=await this.sendRequest(t,"wc_pairingPing",{}),{done:r,resolve:i,reject:s}=mF();this.events.once(mQ("pairing_ping",e),({error:e})=>{e?s(e):i()}),await r()}}),E2(this,"updateExpiry",async({topic:e,expiry:t})=>{this.isInitialized(),await this.pairings.update(e,{expiry:t})}),E2(this,"updateMetadata",async({topic:e,metadata:t})=>{this.isInitialized(),await this.pairings.update(e,{peerMetadata:t})}),E2(this,"getPairings",()=>(this.isInitialized(),this.pairings.values)),E2(this,"disconnect",async e=>{this.isInitialized(),await this.isValidDisconnect(e);let{topic:t}=e;this.pairings.keys.includes(t)&&(await this.sendRequest(t,"wc_pairingDelete",wy("USER_DISCONNECTED")),await this.deletePairing(t))}),E2(this,"formatUriFromPairing",e=>{this.isInitialized();let{topic:t,relay:r,expiry:i,methods:s}=e,n=this.core.crypto.keychain.get(t);return wc({protocol:this.core.protocol,version:this.core.version,topic:t,symKey:n,relay:r,expiryTimestamp:i,methods:s})}),E2(this,"sendRequest",async(e,t,r)=>{let i=(0,cq.formatJsonRpcRequest)(t,r),s=await this.core.crypto.encode(e,i),n=wZ[t].req;return this.core.history.set(e,i),this.core.relayer.publish(e,s,n),i.id}),E2(this,"sendResult",async(e,t,r)=>{let i=(0,cq.formatJsonRpcResult)(e,r),s=await this.core.crypto.encode(t,i),n=wZ[(await this.core.history.get(t,e)).request.method].res;await this.core.relayer.publish(t,s,n),await this.core.history.resolve(i)}),E2(this,"sendError",async(e,t,r)=>{let i=(0,cq.formatJsonRpcError)(e,r),s=await this.core.crypto.encode(t,i),n=(await this.core.history.get(t,e)).request.method,o=wZ[n]?wZ[n].res:wZ.unregistered_method.res;await this.core.relayer.publish(t,s,o),await this.core.history.resolve(i)}),E2(this,"deletePairing",async(e,t)=>{await this.core.relayer.unsubscribe(e),await Promise.all([this.pairings.delete(e,wy("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(e),t?Promise.resolve():this.core.expirer.del(e)])}),E2(this,"cleanup",async()=>{let e=this.pairings.getAll().filter(e=>mG(e.expiry));await Promise.all(e.map(e=>this.deletePairing(e.topic)))}),E2(this,"onRelayEventRequest",async e=>{let{topic:t,payload:r}=e;switch(r.method){case"wc_pairingPing":return await this.onPairingPingRequest(t,r);case"wc_pairingDelete":return await this.onPairingDeleteRequest(t,r);default:return await this.onUnknownRpcMethodRequest(t,r)}}),E2(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r}=e,i=(await this.core.history.get(t,r.id)).request.method;return"wc_pairingPing"===i?this.onPairingPingResponse(t,r):this.onUnknownRpcMethodResponse(i)}),E2(this,"onPairingPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult(r,e,!0),this.events.emit(wX.ping,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),E2(this,"onPairingPingResponse",(e,t)=>{let{id:r}=t;setTimeout(()=>{(0,cq.isJsonRpcResult)(t)?this.events.emit(mQ("pairing_ping",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(mQ("pairing_ping",r),{error:t.error})},500)}),E2(this,"onPairingDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e}),await this.deletePairing(e),this.events.emit(wX.delete,{id:r,topic:e})}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),E2(this,"onUnknownRpcMethodRequest",async(e,t)=>{let{id:r,method:i}=t;try{if(this.registeredMethods.includes(i))return;let t=wy("WC_METHOD_UNSUPPORTED",i);await this.sendError(r,e,t),this.logger.error(t)}catch(t){await this.sendError(r,e,t),this.logger.error(t)}}),E2(this,"onUnknownRpcMethodResponse",e=>{this.registeredMethods.includes(e)||this.logger.error(wy("WC_METHOD_UNSUPPORTED",e))}),E2(this,"isValidPair",(e,t)=>{var r;if(!wO(e)){let{message:r}=wm("MISSING_OR_INVALID",`pair() params: ${e}`);throw t.setError(w8.malformed_pairing_uri),Error(r)}if(!function(e){function t(e){try{return"u">typeof new URL(e)}catch{return!1}}try{if(wE(e,!1)){if(t(e))return!0;let r=m5(e);return t(r)}}catch{}return!1}(e.uri)){let{message:r}=wm("MISSING_OR_INVALID",`pair() uri: ${e.uri}`);throw t.setError(w8.malformed_pairing_uri),Error(r)}let i=wa(e?.uri);if(!(null!=(r=i?.relay)&&r.protocol)){let{message:e}=wm("MISSING_OR_INVALID","pair() uri#relay-protocol");throw t.setError(w8.malformed_pairing_uri),Error(e)}if(!(null!=i&&i.symKey)){let{message:e}=wm("MISSING_OR_INVALID","pair() uri#symKey");throw t.setError(w8.malformed_pairing_uri),Error(e)}if(null!=i&&i.expiryTimestamp&&(0,er.toMiliseconds)(i?.expiryTimestamp)<Date.now()){t.setError(w8.pairing_expired);let{message:e}=wm("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw Error(e)}}),E2(this,"isValidPing",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),E2(this,"isValidDisconnect",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidPairingTopic(t)}),E2(this,"isValidPairingTopic",async e=>{if(!wE(e,!1)){let{message:t}=wm("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.pairings.keys.includes(e)){let{message:t}=wm("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(mG(this.pairings.get(e).expiry)){await this.deletePairing(e);let{message:t}=wm("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}),this.core=e,this.logger=(0,e$.Ep)(t,this.name),this.pairings=new EX(this.core,this.logger,this.name,this.storagePrefix)}get context(){return(0,e$.Fd)(this.logger)}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}registerRelayerEvents(){this.core.relayer.on(wF.message,async e=>{let{topic:t,message:r,transportType:i}=e;if(this.pairings.keys.includes(t)&&i!==wJ.link_mode&&!this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(r)))try{let e=await this.core.crypto.decode(t,r);(0,cq.isJsonRpcRequest)(e)?(this.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e})):(0,cq.isJsonRpcResponse)(e)&&(await this.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e}),this.core.history.delete(t,e.id)),await this.core.relayer.messages.ack(t,r)}catch(e){this.logger.error(e)}})}registerExpirerEvents(){this.core.expirer.on(w1.expired,async e=>{let{topic:t}=mJ(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit(wX.expire,{topic:t}))})}}var E5=Object.defineProperty,E4=(e,t,r)=>t in e?E5(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,E8=(e,t,r)=>E4(e,"symbol"!=typeof t?t+"":t,r);class E6 extends gO{constructor(e,t){super(e,t),this.core=e,this.logger=t,E8(this,"records",new Map),E8(this,"events",new ee.EventEmitter),E8(this,"name","history"),E8(this,"version","0.3"),E8(this,"cached",[]),E8(this,"initialized",!1),E8(this,"storagePrefix",wU),E8(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.records.set(e.id,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),E8(this,"set",(e,t,r)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:e,request:t,chainId:r}),this.records.has(t.id))return;let i={id:t.id,topic:e,request:{method:t.method,params:t.params||null},chainId:r,expiry:mY(er.THIRTY_DAYS)};this.records.set(i.id,i),this.persist(),this.events.emit(w0.created,i)}),E8(this,"resolve",async e=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:e}),!this.records.has(e.id))return;let t=await this.getRecord(e.id);typeof t.response>"u"&&(t.response=(0,cq.isJsonRpcError)(e)?{error:e.error}:{result:e.result},this.records.set(t.id,t),this.persist(),this.events.emit(w0.updated,t))}),E8(this,"get",async(e,t)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:e,id:t}),await this.getRecord(t))),E8(this,"delete",(e,t)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:t}),this.values.forEach(r=>{r.topic!==e||"u">typeof t&&r.id!==t||(this.records.delete(r.id),this.events.emit(w0.deleted,r))}),this.persist()}),E8(this,"exists",async(e,t)=>(this.isInitialized(),!!this.records.has(t)&&(await this.getRecord(t)).topic===e)),E8(this,"on",(e,t)=>{this.events.on(e,t)}),E8(this,"once",(e,t)=>{this.events.once(e,t)}),E8(this,"off",(e,t)=>{this.events.off(e,t)}),E8(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,e$.Ep)(t,this.name)}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let e=[];return this.values.forEach(t=>{if("u">typeof t.response)return;let r={topic:t.topic,request:(0,cq.formatJsonRpcRequest)(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(r)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();let t=this.records.get(e);if(!t){let{message:t}=wm("NO_MATCHING_KEY",`${this.name}: ${e}`);throw Error(t)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(w0.sync)}async restore(){try{let e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){let{message:e}=wm("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(w0.created,e=>{let t=w0.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(w0.updated,e=>{let t=w0.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.events.on(w0.deleted,e=>{let t=w0.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e})}),this.core.heartbeat.on(eo,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(t=>{(0,er.toMiliseconds)(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.records.delete(t.id),this.events.emit(w0.deleted,t,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}}var E9=Object.defineProperty,E7=(e,t,r)=>t in e?E9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ie=(e,t,r)=>E7(e,"symbol"!=typeof t?t+"":t,r);class It extends gR{constructor(e,t){super(e,t),this.core=e,this.logger=t,Ie(this,"expirations",new Map),Ie(this,"events",new ee.EventEmitter),Ie(this,"name","expirer"),Ie(this,"version","0.3"),Ie(this,"cached",[]),Ie(this,"initialized",!1),Ie(this,"storagePrefix",wU),Ie(this,"init",async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(e=>this.expirations.set(e.target,e)),this.cached=[],this.registerEventListeners(),this.initialized=!0)}),Ie(this,"has",e=>{try{let t=this.formatTarget(e);return"u">typeof this.getExpiration(t)}catch{return!1}}),Ie(this,"set",(e,t)=>{this.isInitialized();let r=this.formatTarget(e),i={target:r,expiry:t};this.expirations.set(r,i),this.checkExpiry(r,i),this.events.emit(w1.created,{target:r,expiration:i})}),Ie(this,"get",e=>{this.isInitialized();let t=this.formatTarget(e);return this.getExpiration(t)}),Ie(this,"del",e=>{if(this.isInitialized(),this.has(e)){let t=this.formatTarget(e),r=this.getExpiration(t);this.expirations.delete(t),this.events.emit(w1.deleted,{target:t,expiration:r})}}),Ie(this,"on",(e,t)=>{this.events.on(e,t)}),Ie(this,"once",(e,t)=>{this.events.once(e,t)}),Ie(this,"off",(e,t)=>{this.events.off(e,t)}),Ie(this,"removeListener",(e,t)=>{this.events.removeListener(e,t)}),this.logger=(0,e$.Ep)(t,this.name)}get context(){return(0,e$.Fd)(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if("string"==typeof e)return mK("topic",e);if("number"==typeof e)return mK("id",e);let{message:t}=wm("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(w1.sync)}async restore(){try{let e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){let{message:e}=wm("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(e),Error(e)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){let t=this.expirations.get(e);if(!t){let{message:t}=wm("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(t),Error(t)}return t}checkExpiry(e,t){let{expiry:r}=t;(0,er.toMiliseconds)(r)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(w1.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(eo,()=>this.checkExpirations()),this.events.on(w1.created,e=>{let t=w1.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(w1.expired,e=>{let t=w1.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(w1.deleted,e=>{let t=w1.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}}var Ir=Object.defineProperty,Ii=(e,t,r)=>t in e?Ir(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Is=(e,t,r)=>Ii(e,"symbol"!=typeof t?t+"":t,r);class In extends gk{constructor(e,t,r){super(e,t,r),this.core=e,this.logger=t,this.store=r,Is(this,"name","verify-api"),Is(this,"abortController"),Is(this,"isDevEnv"),Is(this,"verifyUrlV3",w3),Is(this,"storagePrefix",wU),Is(this,"version",2),Is(this,"publicKey"),Is(this,"fetchPromise"),Is(this,"init",async()=>{var e;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&(0,er.toMiliseconds)(null==(e=this.publicKey)?void 0:e.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))}),Is(this,"register",async e=>{if(!mL()||this.isDevEnv)return;let t=window.location.origin,{id:r,decryptedId:i}=e,s=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${t}&id=${r}&decryptedId=${i}`;try{let e=(0,iv.getDocument)(),t=this.startAbortTimer(5*er.ONE_SECOND),i=await new Promise((i,n)=>{let o=()=>{window.removeEventListener("message",c),e.body.removeChild(a),n("attestation aborted")};this.abortController.signal.addEventListener("abort",o);let a=e.createElement("iframe");a.src=s,a.style.display="none",a.addEventListener("error",o,{signal:this.abortController.signal});let c=s=>{if(s.data&&"string"==typeof s.data)try{let n=JSON.parse(s.data);if("verify_attestation"===n.type){if(ii(n.attestation).payload.id!==r)return;clearInterval(t),e.body.removeChild(a),this.abortController.signal.removeEventListener("abort",o),window.removeEventListener("message",c),i(null===n.attestation?"":n.attestation)}}catch(e){this.logger.warn(e)}};e.body.appendChild(a),window.addEventListener("message",c,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",i),i}catch(e){this.logger.warn(e)}return""}),Is(this,"resolve",async e=>{if(this.isDevEnv)return"";let{attestationId:t,hash:r,encryptedId:i}=e;if(""===t){this.logger.debug("resolve: attestationId is empty, skipping");return}if(t){if(ii(t).payload.id!==i)return;let e=await this.isValidJwtAttestation(t);if(e){if(!e.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return e}}if(!r)return;let s=this.getVerifyUrl(e?.verifyUrl);return this.fetchAttestation(r,s)}),Is(this,"fetchAttestation",async(e,t)=>{this.logger.debug(`resolving attestation: ${e} from url: ${t}`);let r=this.startAbortTimer(5*er.ONE_SECOND),i=await fetch(`${t}/attestation/${e}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(r),200===i.status?await i.json():void 0}),Is(this,"getVerifyUrl",e=>{let t=e||w2;return w5.includes(t)||(this.logger.info(`verify url: ${t}, not included in trusted list, assigning default: ${w2}`),t=w2),t}),Is(this,"fetchPublicKey",async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);let e=this.startAbortTimer(er.FIVE_SECONDS),t=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(e),await t.json()}catch(e){this.logger.warn(e)}}),Is(this,"persistPublicKey",async e=>{this.logger.debug("persisting public key to local storage",e),await this.store.setItem(this.storeKey,e),this.publicKey=e}),Is(this,"removePublicKey",async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0}),Is(this,"isValidJwtAttestation",async e=>{let t=await this.getPublicKey();try{if(t)return this.validateAttestation(e,t)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}let r=await this.fetchAndPersistPublicKey();try{if(r)return this.validateAttestation(e,r)}catch(e){this.logger.error(e),this.logger.warn("error validating attestation")}}),Is(this,"getPublicKey",async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey()),Is(this,"fetchAndPersistPublicKey",async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async e=>{let t=await this.fetchPublicKey();t&&(await this.persistPublicKey(t),e(t))});let e=await this.fetchPromise;return this.fetchPromise=void 0,e}),Is(this,"validateAttestation",(e,t)=>{let r=function(e,t){let[r,i,s]=e.split("."),n=mx.from(function(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r=t.length%4;return r>0&&(t+="=".repeat(4-r)),t}(s),"base64");if(64!==n.length)throw Error("Invalid signature length");let o=n.slice(0,32).toString("hex"),a=n.slice(32,64).toString("hex"),c=bx(`${r}.${i}`),l=new nT.ec("p256").keyFromPublic({x:mx.from(t.x,"base64").toString("hex"),y:mx.from(t.y,"base64").toString("hex")},"hex"),h=nx(c,b3);if(!l.verify(h,{r:o,s:a}))throw Error("Invalid signature");return ii(e).payload}(e,t.publicKey),i={hasExpired:(0,er.toMiliseconds)(r.exp)<Date.now(),payload:r};if(i.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),Error("JWT attestation expired");return{origin:i.payload.origin,isScam:i.payload.isScam,isVerified:i.payload.isVerified}}),this.logger=(0,e$.Ep)(t,this.name),this.abortController=new AbortController,this.isDevEnv=m3(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return(0,e$.Fd)(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),(0,er.toMiliseconds)(e))}}var Io=Object.defineProperty,Ia=(e,t,r)=>t in e?Io(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ic=(e,t,r)=>Ia(e,"symbol"!=typeof t?t+"":t,r);class Il extends gj{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,Ic(this,"context","echo"),Ic(this,"registerDeviceToken",async e=>{let{clientId:t,token:r,notificationType:i,enableEncrypted:s=!1}=e,n=`https://echo.walletconnect.com/${this.projectId}/clients`;await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:t,type:i,token:r,always_raw:s})})}),this.logger=(0,e$.Ep)(t,this.context)}}var Ih=Object.defineProperty,Iu=Object.getOwnPropertySymbols,Id=Object.prototype.hasOwnProperty,Ip=Object.prototype.propertyIsEnumerable,If=(e,t,r)=>t in e?Ih(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ig=(e,t)=>{for(var r in t||(t={}))Id.call(t,r)&&If(e,r,t[r]);if(Iu)for(var r of Iu(t))Ip.call(t,r)&&If(e,r,t[r]);return e},Im=(e,t,r)=>If(e,"symbol"!=typeof t?t+"":t,r);class Iy extends gL{constructor(e,t,r=!0){super(e,t,r),this.core=e,this.logger=t,Im(this,"context","event-client"),Im(this,"storagePrefix",wU),Im(this,"storageVersion",.1),Im(this,"events",new Map),Im(this,"shouldPersist",!1),Im(this,"init",async()=>{if(!m3())try{let e={eventId:m2(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:mq(this.core.relayer.protocol,this.core.relayer.version,wK)}}};await this.sendEvent([e])}catch(e){this.logger.warn(e)}}),Im(this,"createEvent",e=>{let{event:t="ERROR",type:r="",properties:{topic:i,trace:s}}=e,n=m2(),o=this.core.projectId||"",a=Ig({eventId:n,timestamp:Date.now(),props:{event:t,type:r,properties:{topic:i,trace:s}},bundleId:o,domain:this.getAppDomain()},this.setMethods(n));return this.telemetryEnabled&&(this.events.set(n,a),this.shouldPersist=!0),a}),Im(this,"getEvent",e=>{let{eventId:t,topic:r}=e;if(t)return this.events.get(t);let i=Array.from(this.events.values()).find(e=>e.props.properties.topic===r);if(i)return Ig(Ig({},i),this.setMethods(i.eventId))}),Im(this,"deleteEvent",e=>{let{eventId:t}=e;this.events.delete(t),this.shouldPersist=!0}),Im(this,"setEventListeners",()=>{this.core.heartbeat.on(eo,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(e=>{(0,er.fromMiliseconds)(Date.now())-(0,er.fromMiliseconds)(e.timestamp)>86400&&(this.events.delete(e.eventId),this.shouldPersist=!0)})})}),Im(this,"setMethods",e=>({addTrace:t=>this.addTrace(e,t),setError:t=>this.setError(e,t)})),Im(this,"addTrace",(e,t)=>{let r=this.events.get(e);r&&(r.props.properties.trace.push(t),this.events.set(e,r),this.shouldPersist=!0)}),Im(this,"setError",(e,t)=>{let r=this.events.get(e);r&&(r.props.type=t,r.timestamp=Date.now(),this.events.set(e,r),this.shouldPersist=!0)}),Im(this,"persist",async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1}),Im(this,"restore",async()=>{try{let e=await this.core.storage.getItem(this.storageKey)||[];if(!e.length)return;e.forEach(e=>{this.events.set(e.eventId,Ig(Ig({},e),this.setMethods(e.eventId)))})}catch(e){this.logger.warn(e)}}),Im(this,"submit",async()=>{if(!this.telemetryEnabled||0===this.events.size)return;let e=[];for(let[t,r]of this.events)r.props.type&&e.push(r);if(0!==e.length)try{if((await this.sendEvent(e)).ok)for(let t of e)this.events.delete(t.eventId),this.shouldPersist=!0}catch(e){this.logger.warn(e)}}),Im(this,"sendEvent",async e=>{let t=this.getAppDomain()?"":"&sp=desktop";return await fetch(`https://pulse.walletconnect.org/batch?projectId=${this.core.projectId}&st=events_sdk&sv=js-${wK}${t}`,{method:"POST",body:JSON.stringify(e)})}),Im(this,"getAppDomain",()=>m$().url),this.logger=(0,e$.Ep)(t,this.context),this.telemetryEnabled=r,r?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}}var Ib=Object.defineProperty,Iw=Object.getOwnPropertySymbols,Iv=Object.prototype.hasOwnProperty,IE=Object.prototype.propertyIsEnumerable,II=(e,t,r)=>t in e?Ib(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I_=(e,t)=>{for(var r in t||(t={}))Iv.call(t,r)&&II(e,r,t[r]);if(Iw)for(var r of Iw(t))IE.call(t,r)&&II(e,r,t[r]);return e},IC=(e,t,r)=>II(e,"symbol"!=typeof t?t+"":t,r);class IS extends gC{constructor(e){var t;super(e),IC(this,"protocol","wc"),IC(this,"version",2),IC(this,"name",wL),IC(this,"relayUrl"),IC(this,"projectId"),IC(this,"customStoragePrefix"),IC(this,"events",new ee.EventEmitter),IC(this,"logger"),IC(this,"heartbeat"),IC(this,"relayer"),IC(this,"crypto"),IC(this,"storage"),IC(this,"history"),IC(this,"expirer"),IC(this,"pairing"),IC(this,"verify"),IC(this,"echoClient"),IC(this,"linkModeSupportedApps"),IC(this,"eventClient"),IC(this,"initialized",!1),IC(this,"logChunkController"),IC(this,"on",(e,t)=>this.events.on(e,t)),IC(this,"once",(e,t)=>this.events.once(e,t)),IC(this,"off",(e,t)=>this.events.off(e,t)),IC(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),IC(this,"dispatchEnvelope",({topic:e,message:t,sessionExists:r})=>{if(!e||!t)return;let i={topic:e,message:t,publishedAt:Date.now(),transportType:wJ.link_mode};this.relayer.onLinkMessageEvent(i,{sessionExists:r})}),this.projectId=e?.projectId,this.relayUrl=e?.relayUrl||wH,this.customStoragePrefix=null!=e&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";let r=(0,e$.jI)({level:"string"==typeof e?.logger&&e.logger?e.logger:wz.logger,name:wL}),{logger:i,chunkLoggerController:s}=(0,e$.Rt)({opts:r,maxSizeInBytes:e?.maxLogBlobSizeInBytes,loggerOverride:e?.logger});this.logChunkController=s,null!=(t=this.logChunkController)&&t.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var e,t;null!=(e=this.logChunkController)&&e.downloadLogsBlobInBrowser&&(null==(t=this.logChunkController)||t.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=(0,e$.Ep)(i,this.name),this.heartbeat=new ea,this.crypto=new v5(this,this.logger,e?.keychain),this.history=new E6(this,this.logger),this.expirer=new It(this,this.logger),this.storage=null!=e&&e.storage?e.storage:new gv(I_(I_({},w$),e?.storageOptions)),this.relayer=new Ez({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new E3(this,this.logger),this.verify=new In(this,this.logger,this.storage),this.echoClient=new Il(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new Iy(this,this.logger,e?.telemetryEnabled)}static async init(e){let t=new IS(e);await t.initialize();let r=await t.crypto.getClientId();return await t.storage.setItem("WALLETCONNECT_CLIENT_ID",r),t}get context(){return(0,e$.Fd)(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return null==(e=this.logChunkController)?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(wG,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(wG)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}let IN="client",IA=`wc@2:${IN}:`,IO={name:IN,logger:"error"},IM="WALLETCONNECT_DEEPLINK_CHOICE",IP="Proposal expired",Ix=er.SEVEN_DAYS,IT={wc_sessionPropose:{req:{ttl:er.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1104},res:{ttl:er.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1106},res:{ttl:er.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:er.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:er.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1112},res:{ttl:er.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:er.ONE_DAY,prompt:!1,tag:1114},res:{ttl:er.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:er.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:er.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:er.FIVE_MINUTES,prompt:!1,tag:1119}}},ID={min:er.FIVE_MINUTES,max:er.SEVEN_DAYS},IR={idle:"IDLE",active:"ACTIVE"},Ik={eth_sendTransaction:{key:""},eth_sendRawTransaction:{key:""},wallet_sendCalls:{key:""},solana_signTransaction:{key:"signature"},solana_signAllTransactions:{key:"transactions"},solana_signAndSendTransaction:{key:"signature"}},Ij=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],IL="wc@1.5:auth:",IU=`${IL}:PUB_KEY`;var Iz=Object.defineProperty,I$=Object.defineProperties,Iq=Object.getOwnPropertyDescriptors,IB=Object.getOwnPropertySymbols,IW=Object.prototype.hasOwnProperty,IH=Object.prototype.propertyIsEnumerable,IF=(e,t,r)=>t in e?Iz(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,IV=(e,t)=>{for(var r in t||(t={}))IW.call(t,r)&&IF(e,r,t[r]);if(IB)for(var r of IB(t))IH.call(t,r)&&IF(e,r,t[r]);return e},IK=(e,t)=>I$(e,Iq(t)),IJ=(e,t,r)=>IF(e,"symbol"!=typeof t?t+"":t,r);class IY extends gB{constructor(e){super(e),IJ(this,"name","engine"),IJ(this,"events",new(et())),IJ(this,"initialized",!1),IJ(this,"requestQueue",{state:IR.idle,queue:[]}),IJ(this,"sessionRequestQueue",{state:IR.idle,queue:[]}),IJ(this,"requestQueueDelay",er.ONE_SECOND),IJ(this,"expectedPairingMethodMap",new Map),IJ(this,"recentlyDeletedMap",new Map),IJ(this,"recentlyDeletedLimit",200),IJ(this,"relayMessageCache",[]),IJ(this,"pendingSessions",new Map),IJ(this,"init",async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(IT)}),this.initialized=!0,setTimeout(async()=>{await this.processPendingMessageEvents(),this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},(0,er.toMiliseconds)(this.requestQueueDelay)))}),IJ(this,"connect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();let t=IK(IV({},e),{requiredNamespaces:e.requiredNamespaces||{},optionalNamespaces:e.optionalNamespaces||{}});await this.isValidConnect(t);let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,scopedProperties:o,relays:a}=t,c=r,l,h=!1;try{if(c){let e=this.client.core.pairing.pairings.get(c);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),h=e.active}}catch(e){throw this.client.logger.error(`connect() -> pairing.get(${c}) failed`),e}if(!c||!h){let{topic:e,uri:t}=await this.client.core.pairing.create();c=e,l=t}if(!c){let{message:e}=wm("NO_MATCHING_KEY",`connect() pairing topic: ${c}`);throw Error(e)}let u=await this.client.core.crypto.generateKeyPair(),d=IT.wc_sessionPropose.req.ttl||er.FIVE_MINUTES,p=mY(d),f=IK(IV(IV({requiredNamespaces:i,optionalNamespaces:s,relays:a??[{protocol:"irn"}],proposer:{publicKey:u,metadata:this.client.metadata},expiryTimestamp:p,pairingTopic:c},n&&{sessionProperties:n}),o&&{scopedProperties:o}),{id:(0,cq.payloadId)()}),g=mQ("session_connect",f.id),{reject:m,resolve:y,done:b}=mF(d,IP),w=({id:e})=>{e===f.id&&(this.client.events.off("proposal_expire",w),this.pendingSessions.delete(f.id),this.events.emit(g,{error:{message:IP,code:0}}))};return this.client.events.on("proposal_expire",w),this.events.once(g,({error:e,session:t})=>{this.client.events.off("proposal_expire",w),e?m(e):t&&y(t)}),await this.sendRequest({topic:c,method:"wc_sessionPropose",params:f,throwOnFailedPublish:!0,clientRpcId:f.id}),await this.setProposal(f.id,f),{uri:l,approval:b}}),IJ(this,"pair",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(e)}catch(e){throw this.client.logger.error("pair() failed"),e}}),IJ(this,"approve",async e=>{var t,r,i;let s=this.client.core.eventClient.createEvent({properties:{topic:null==(t=e?.id)?void 0:t.toString(),trace:[w6.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(e){throw s.setError(w9.no_internet_connection),e}try{await this.isValidProposalId(e?.id)}catch(t){throw this.client.logger.error(`approve() -> proposal.get(${e?.id}) failed`),s.setError(w9.proposal_not_found),t}try{await this.isValidApprove(e)}catch(e){throw this.client.logger.error("approve() -> isValidApprove() failed"),s.setError(w9.session_approve_namespace_validation_failure),e}let{id:n,relayProtocol:o,namespaces:a,sessionProperties:c,scopedProperties:l,sessionConfig:h}=e,u=this.client.proposal.get(n);this.client.core.eventClient.deleteEvent({eventId:s.eventId});let{pairingTopic:d,proposer:p,requiredNamespaces:f,optionalNamespaces:g}=u,m=null==(r=this.client.core.eventClient)?void 0:r.getEvent({topic:d});m||(m=null==(i=this.client.core.eventClient)?void 0:i.createEvent({type:w6.session_approve_started,properties:{topic:d,trace:[w6.session_approve_started,w6.session_namespaces_validation_success]}}));let y=await this.client.core.crypto.generateKeyPair(),b=p.publicKey,w=await this.client.core.crypto.generateSharedKey(y,b),v=IV(IV(IV({relay:{protocol:o??"irn"},namespaces:a,controller:{publicKey:y,metadata:this.client.metadata},expiry:mY(Ix)},c&&{sessionProperties:c}),l&&{scopedProperties:l}),h&&{sessionConfig:h}),E=wJ.relay;m.addTrace(w6.subscribing_session_topic);try{await this.client.core.relayer.subscribe(w,{transportType:E})}catch(e){throw m.setError(w9.subscribe_session_topic_failure),e}m.addTrace(w6.subscribe_session_topic_success);let I=IK(IV({},v),{topic:w,requiredNamespaces:f,optionalNamespaces:g,pairingTopic:d,acknowledged:!1,self:v.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:y,transportType:wJ.relay});await this.client.session.set(w,I),m.addTrace(w6.store_session);try{m.addTrace(w6.publishing_session_settle),await this.sendRequest({topic:w,method:"wc_sessionSettle",params:v,throwOnFailedPublish:!0}).catch(e=>{throw m?.setError(w9.session_settle_publish_failure),e}),m.addTrace(w6.session_settle_publish_success),m.addTrace(w6.publishing_session_approve),await this.sendResult({id:n,topic:d,result:{relay:{protocol:o??"irn"},responderPublicKey:y},throwOnFailedPublish:!0}).catch(e=>{throw m?.setError(w9.session_approve_publish_failure),e}),m.addTrace(w6.session_approve_publish_success)}catch(e){throw this.client.logger.error(e),this.client.session.delete(w,wy("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(w),e}return this.client.core.eventClient.deleteEvent({eventId:m.eventId}),await this.client.core.pairing.updateMetadata({topic:d,metadata:p.metadata}),await this.client.proposal.delete(n,wy("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:d}),await this.setExpiry(w,mY(Ix)),{topic:w,acknowledged:()=>Promise.resolve(this.client.session.get(w))}}),IJ(this,"reject",async e=>{let t;this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(e)}catch(e){throw this.client.logger.error("reject() -> isValidReject() failed"),e}let{id:r,reason:i}=e;try{t=this.client.proposal.get(r).pairingTopic}catch(e){throw this.client.logger.error(`reject() -> proposal.get(${r}) failed`),e}t&&(await this.sendError({id:r,topic:t,error:i,rpcOpts:IT.wc_sessionPropose.reject}),await this.client.proposal.delete(r,wy("USER_DISCONNECTED")))}),IJ(this,"update",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(e)}catch(e){throw this.client.logger.error("update() -> isValidUpdate() failed"),e}let{topic:t,namespaces:r}=e,{done:i,resolve:s,reject:n}=mF(),o=(0,cq.payloadId)(),a=(0,cq.getBigIntRpcId)().toString(),c=this.client.session.get(t).namespaces;return this.events.once(mQ("session_update",o),({error:e})=>{e?n(e):s()}),await this.client.session.update(t,{namespaces:r}),await this.sendRequest({topic:t,method:"wc_sessionUpdate",params:{namespaces:r},throwOnFailedPublish:!0,clientRpcId:o,relayRpcId:a}).catch(e=>{this.client.logger.error(e),this.client.session.update(t,{namespaces:c}),n(e)}),{acknowledged:i}}),IJ(this,"extend",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(e)}catch(e){throw this.client.logger.error("extend() -> isValidExtend() failed"),e}let{topic:t}=e,r=(0,cq.payloadId)(),{done:i,resolve:s,reject:n}=mF();return this.events.once(mQ("session_extend",r),({error:e})=>{e?n(e):s()}),await this.setExpiry(t,mY(Ix)),this.sendRequest({topic:t,method:"wc_sessionExtend",params:{},clientRpcId:r,throwOnFailedPublish:!0}).catch(e=>{n(e)}),{acknowledged:i}}),IJ(this,"request",async e=>{this.isInitialized();try{await this.isValidRequest(e)}catch(e){throw this.client.logger.error("request() -> isValidRequest() failed"),e}let{chainId:t,request:r,topic:i,expiry:s=IT.wc_sessionRequest.req.ttl}=e,n=this.client.session.get(i);n?.transportType===wJ.relay&&await this.confirmOnlineStateOrThrow();let o=(0,cq.payloadId)(),a=(0,cq.getBigIntRpcId)().toString(),{done:c,resolve:l,reject:h}=mF(s,"Request expired. Please try again.");this.events.once(mQ("session_request",o),({error:e,result:t})=>{e?h(e):l(t)});let u="wc_sessionRequest",d=this.getAppLinkIfEnabled(n.peer.metadata,n.transportType);if(d)return await this.sendRequest({clientRpcId:o,relayRpcId:a,topic:i,method:u,params:{request:IK(IV({},r),{expiryTimestamp:mY(s)}),chainId:t},expiry:s,throwOnFailedPublish:!0,appLink:d}).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),await c();let p={request:IK(IV({},r),{expiryTimestamp:mY(s)}),chainId:t},f=this.shouldSetTVF(u,p);return await Promise.all([new Promise(async e=>{await this.sendRequest(IV({clientRpcId:o,relayRpcId:a,topic:i,method:u,params:p,expiry:s,throwOnFailedPublish:!0},f&&{tvf:this.getTVFParams(o,p)})).catch(e=>h(e)),this.client.events.emit("session_request_sent",{topic:i,request:r,chainId:t,id:o}),e()}),new Promise(async e=>{var t;if(!(null!=(t=n.sessionConfig)&&t.disableDeepLink)){let e=await m0(this.client.core.storage,IM);await mX({id:o,topic:i,wcDeepLink:e})}e()}),c()]).then(e=>e[2])}),IJ(this,"respond",async e=>{this.isInitialized(),await this.isValidRespond(e);let{topic:t,response:r}=e,{id:i}=r,s=this.client.session.get(t);s.transportType===wJ.relay&&await this.confirmOnlineStateOrThrow();let n=this.getAppLinkIfEnabled(s.peer.metadata,s.transportType);(0,cq.isJsonRpcResult)(r)?await this.sendResult({id:i,topic:t,result:r.result,throwOnFailedPublish:!0,appLink:n}):(0,cq.isJsonRpcError)(r)&&await this.sendError({id:i,topic:t,error:r.error,appLink:n}),this.cleanupAfterResponse(e)}),IJ(this,"ping",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(e)}catch(e){throw this.client.logger.error("ping() -> isValidPing() failed"),e}let{topic:t}=e;if(this.client.session.keys.includes(t)){let e=(0,cq.payloadId)(),r=(0,cq.getBigIntRpcId)().toString(),{done:i,resolve:s,reject:n}=mF();this.events.once(mQ("session_ping",e),({error:e})=>{e?n(e):s()}),await Promise.all([this.sendRequest({topic:t,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:e,relayRpcId:r}),i()])}else this.client.core.pairing.pairings.keys.includes(t)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:t}))}),IJ(this,"emit",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(e);let{topic:t,event:r,chainId:i}=e,s=(0,cq.getBigIntRpcId)().toString(),n=(0,cq.payloadId)();await this.sendRequest({topic:t,method:"wc_sessionEvent",params:{event:r,chainId:i},throwOnFailedPublish:!0,relayRpcId:s,clientRpcId:n})}),IJ(this,"disconnect",async e=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(e);let{topic:t}=e;if(this.client.session.keys.includes(t))await this.sendRequest({topic:t,method:"wc_sessionDelete",params:wy("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:t,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(t))await this.client.core.pairing.disconnect({topic:t});else{let{message:e}=wm("MISMATCHED_TOPIC",`Session or pairing topic not found: ${t}`);throw Error(e)}}),IJ(this,"find",e=>(this.isInitialized(),this.client.session.getAll().filter(t=>(function(e,t){let{requiredNamespaces:r}=t,i=Object.keys(e.namespaces),s=Object.keys(r),n=!0;return!!mB(s,i)&&(i.forEach(t=>{let{accounts:i,methods:s,events:o}=e.namespaces[t],a=wh(i),c=r[t];mB(mD(t,c),a)&&mB(c.methods,s)&&mB(c.events,o)||(n=!1)}),n)})(t,e)))),IJ(this,"getPendingSessionRequests",()=>this.client.pendingRequest.getAll()),IJ(this,"authenticate",async(e,t)=>{var r,i,s;let n;this.isInitialized(),this.isValidAuthenticate(e);let o=t&&this.client.core.linkModeSupportedApps.includes(t)&&(null==(r=this.client.metadata.redirect)?void 0:r.linkMode),a=o?wJ.link_mode:wJ.relay;a===wJ.relay&&await this.confirmOnlineStateOrThrow();let{chains:c,statement:l="",uri:h,domain:u,nonce:d,type:p,exp:f,nbf:g,methods:m=[],expiry:y}=e,b=[...e.resources||[]],{topic:w,uri:v}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});this.client.logger.info({message:"Generated new pairing",pairing:{topic:w,uri:v}});let E=await this.client.core.crypto.generateKeyPair(),I=b9(E);if(await Promise.all([this.client.auth.authKeys.set(IU,{responseTopic:I,publicKey:E}),this.client.auth.pairingTopics.set(I,{topic:I,pairingTopic:w})]),await this.client.core.relayer.subscribe(I,{transportType:a}),this.client.logger.info(`sending request to new pairing topic: ${w}`),m.length>0){let{namespace:e}=mT(c[0]),t=yG(function(e,t,r,i={}){return r?.sort((e,t)=>e.localeCompare(t)),{att:{[e]:function(e,t,r={}){return Object.assign({},...(t=t?.sort((e,t)=>e.localeCompare(t))).map(t=>({[`${e}/${t}`]:[r]})))}(t,r,i)}}}(e,"request",m));y0(b)&&(i=t,s=b.pop(),t=yG(function(e,t){yY(e),yY(t);let r=Object.keys(e.att).concat(Object.keys(t.att)).sort((e,t)=>e.localeCompare(t)),i={att:{}};return r.forEach(r=>{var s,n;Object.keys((null==(s=e.att)?void 0:s[r])||{}).concat(Object.keys((null==(n=t.att)?void 0:n[r])||{})).sort((e,t)=>e.localeCompare(t)).forEach(s=>{var n,o;i.att[r]=yB(yq({},i.att[r]),{[s]:(null==(n=e.att[r])?void 0:n[s])||(null==(o=t.att[r])?void 0:o[s])})})}),i}(yQ(i),yQ(s)))),b.push(t)}let _=y&&y>IT.wc_sessionAuthenticate.req.ttl?y:IT.wc_sessionAuthenticate.req.ttl,C={authPayload:{type:p??"caip122",chains:c,statement:l,aud:h,domain:u,version:"1",nonce:d,iat:new Date().toISOString(),exp:f,nbf:g,resources:b},requester:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:mY(_)},S={requiredNamespaces:{},optionalNamespaces:{eip155:{chains:c,methods:[...new Set(["personal_sign",...m])],events:["chainChanged","accountsChanged"]}},relays:[{protocol:"irn"}],pairingTopic:w,proposer:{publicKey:E,metadata:this.client.metadata},expiryTimestamp:mY(IT.wc_sessionPropose.req.ttl),id:(0,cq.payloadId)()},{done:N,resolve:A,reject:O}=mF(_,"Request expired"),M=(0,cq.payloadId)(),P=mQ("session_connect",S.id),x=mQ("session_request",M),T=async({error:e,session:t})=>{this.events.off(x,D),e?O(e):t&&A({session:t})},D=async e=>{var r,i,s;let n;if(await this.deletePendingAuthRequest(M,{message:"fulfilled",code:0}),e.error){let t=wy("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return e.error.code===t.code?void 0:(this.events.off(P,T),O(e.error.message))}await this.deleteProposal(S.id),this.events.off(P,T);let{cacaos:o,responder:c}=e.result,l=[],h=[];for(let e of o){await yK({cacao:e,projectId:this.client.core.projectId})||(this.client.logger.error(e,"Signature verification failed"),O(wy("SESSION_SETTLEMENT_FAILED","Signature verification failed")));let{p:t}=e,r=y0(t.resources),i=[yF(t.iss)],s=yV(t.iss);if(r){let e=yZ(r),t=yX(r);l.push(...e),i.push(...t)}for(let e of i)h.push(`${e}:${s}`)}let u=await this.client.core.crypto.generateSharedKey(E,c.publicKey);l.length>0&&(n={topic:u,acknowledged:!0,self:{publicKey:E,metadata:this.client.metadata},peer:c,controller:c.publicKey,expiry:mY(Ix),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:w,namespaces:wp([...new Set(l)],[...new Set(h)]),transportType:a},await this.client.core.relayer.subscribe(u,{transportType:a}),await this.client.session.set(u,n),w&&await this.client.core.pairing.updateMetadata({topic:w,metadata:c.metadata}),n=this.client.session.get(u)),null!=(r=this.client.metadata.redirect)&&r.linkMode&&null!=(i=c.metadata.redirect)&&i.linkMode&&null!=(s=c.metadata.redirect)&&s.universal&&t&&(this.client.core.addLinkModeSupportedApp(c.metadata.redirect.universal),this.client.session.update(u,{transportType:wJ.link_mode})),A({auths:o,session:n})};this.events.once(P,T),this.events.once(x,D);try{if(o){let e=(0,cq.formatJsonRpcRequest)("wc_sessionAuthenticate",C,M);this.client.core.history.set(w,e);let r=await this.client.core.crypto.encode("",e,{type:2,encoding:b4});n=wl(t,w,r)}else await Promise.all([this.sendRequest({topic:w,method:"wc_sessionAuthenticate",params:C,expiry:e.expiry,throwOnFailedPublish:!0,clientRpcId:M}),this.sendRequest({topic:w,method:"wc_sessionPropose",params:S,expiry:IT.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:S.id})])}catch(e){throw this.events.off(P,T),this.events.off(x,D),e}return await this.setProposal(S.id,S),await this.setAuthRequest(M,{request:IK(IV({},C),{verifyContext:{}}),pairingTopic:w,transportType:a}),{uri:n??v,response:N}}),IJ(this,"approveSessionAuthenticate",async e=>{let t;let{id:r,auths:i}=e,s=this.client.core.eventClient.createEvent({properties:{topic:r.toString(),trace:[w7.authenticated_session_approve_started]}});try{this.isInitialized()}catch(e){throw s.setError(ve.no_internet_connection),e}let n=this.getPendingAuthRequest(r);if(!n)throw s.setError(ve.authenticated_session_pending_request_not_found),Error(`Could not find pending auth request with id ${r}`);let o=n.transportType||wJ.relay;o===wJ.relay&&await this.confirmOnlineStateOrThrow();let a=n.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),l=b9(a),h={type:1,receiverPublicKey:a,senderPublicKey:c},u=[],d=[];for(let e of i){if(!await yK({cacao:e,projectId:this.client.core.projectId})){s.setError(ve.invalid_cacao);let e=wy("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:r,topic:l,error:e,encodeOpts:h}),Error(e.message)}s.addTrace(w7.cacaos_verified);let{p:t}=e,i=y0(t.resources),n=[yF(t.iss)],o=yV(t.iss);if(i){let e=yZ(i),t=yX(i);u.push(...e),n.push(...t)}for(let e of n)d.push(`${e}:${o}`)}let p=await this.client.core.crypto.generateSharedKey(c,a);if(s.addTrace(w7.create_authenticated_session_topic),u?.length>0){t={topic:p,acknowledged:!0,self:{publicKey:c,metadata:this.client.metadata},peer:{publicKey:a,metadata:n.requester.metadata},controller:a,expiry:mY(Ix),authentication:i,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:n.pairingTopic,namespaces:wp([...new Set(u)],[...new Set(d)]),transportType:o},s.addTrace(w7.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe(p,{transportType:o})}catch(e){throw s.setError(ve.subscribe_authenticated_session_topic_failure),e}s.addTrace(w7.subscribe_authenticated_session_topic_success),await this.client.session.set(p,t),s.addTrace(w7.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:n.pairingTopic,metadata:n.requester.metadata})}s.addTrace(w7.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:r,result:{cacaos:i,responder:{publicKey:c,metadata:this.client.metadata}},encodeOpts:h,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(n.requester.metadata,o)})}catch(e){throw s.setError(ve.authenticated_session_approve_publish_failure),e}return await this.client.auth.requests.delete(r,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:n.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:t}}),IJ(this,"rejectSessionAuthenticate",async e=>{this.isInitialized();let{id:t,reason:r}=e,i=this.getPendingAuthRequest(t);if(!i)throw Error(`Could not find pending auth request with id ${t}`);i.transportType===wJ.relay&&await this.confirmOnlineStateOrThrow();let s=i.requester.publicKey,n=await this.client.core.crypto.generateKeyPair(),o=b9(s);await this.sendError({id:t,topic:o,error:r,encodeOpts:{type:1,receiverPublicKey:s,senderPublicKey:n},rpcOpts:IT.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(i.requester.metadata,i.transportType)}),await this.client.auth.requests.delete(t,{message:"rejected",code:0}),await this.client.proposal.delete(t,wy("USER_DISCONNECTED"))}),IJ(this,"formatAuthMessage",e=>{this.isInitialized();let{request:t,iss:r}=e;return yJ(t,r)}),IJ(this,"processRelayMessageCache",()=>{setTimeout(async()=>{if(0!==this.relayMessageCache.length)for(;this.relayMessageCache.length>0;)try{let e=this.relayMessageCache.shift();e&&await this.onRelayMessage(e)}catch(e){this.client.logger.error(e)}},50)}),IJ(this,"cleanupDuplicatePairings",async e=>{if(e.pairingTopic)try{let t=this.client.core.pairing.pairings.get(e.pairingTopic),r=this.client.core.pairing.pairings.getAll().filter(r=>{var i,s;return(null==(i=r.peerMetadata)?void 0:i.url)&&(null==(s=r.peerMetadata)?void 0:s.url)===e.peer.metadata.url&&r.topic&&r.topic!==t.topic});if(0===r.length)return;this.client.logger.info(`Cleaning up ${r.length} duplicate pairing(s)`),await Promise.all(r.map(e=>this.client.core.pairing.disconnect({topic:e.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(e){this.client.logger.error(e)}}),IJ(this,"deleteSession",async e=>{var t;let{topic:r,expirerHasDeleted:i=!1,emitEvent:s=!0,id:n=0}=e,{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await this.client.session.delete(r,wy("USER_DISCONNECTED")),this.addToRecentlyDeleted(r,"session"),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),i||this.client.core.expirer.del(r),this.client.core.storage.removeItem(IM).catch(e=>this.client.logger.warn(e)),this.getPendingSessionRequests().forEach(e=>{e.topic===r&&this.deletePendingSessionRequest(e.id,wy("USER_DISCONNECTED"))}),r===(null==(t=this.sessionRequestQueue.queue[0])?void 0:t.topic)&&(this.sessionRequestQueue.state=IR.idle),s&&this.client.events.emit("session_delete",{id:n,topic:r})}),IJ(this,"deleteProposal",async(e,t)=>{if(t)try{let t=this.client.proposal.get(e),r=this.client.core.eventClient.getEvent({topic:t.pairingTopic});r?.setError(w9.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(e,wy("USER_DISCONNECTED")),t?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"proposal")}),IJ(this,"deletePendingSessionRequest",async(e,t,r=!1)=>{await Promise.all([this.client.pendingRequest.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)]),this.addToRecentlyDeleted(e,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(t=>t.id!==e),r&&(this.sessionRequestQueue.state=IR.idle,this.client.events.emit("session_request_expire",{id:e}))}),IJ(this,"deletePendingAuthRequest",async(e,t,r=!1)=>{await Promise.all([this.client.auth.requests.delete(e,t),r?Promise.resolve():this.client.core.expirer.del(e)])}),IJ(this,"setExpiry",async(e,t)=>{this.client.session.keys.includes(e)&&(this.client.core.expirer.set(e,t),await this.client.session.update(e,{expiry:t}))}),IJ(this,"setProposal",async(e,t)=>{this.client.core.expirer.set(e,mY(IT.wc_sessionPropose.req.ttl)),await this.client.proposal.set(e,t)}),IJ(this,"setAuthRequest",async(e,t)=>{let{request:r,pairingTopic:i,transportType:s=wJ.relay}=t;this.client.core.expirer.set(e,r.expiryTimestamp),await this.client.auth.requests.set(e,{authPayload:r.authPayload,requester:r.requester,expiryTimestamp:r.expiryTimestamp,id:e,pairingTopic:i,verifyContext:r.verifyContext,transportType:s})}),IJ(this,"setPendingSessionRequest",async e=>{let{id:t,topic:r,params:i,verifyContext:s}=e,n=i.request.expiryTimestamp||mY(IT.wc_sessionRequest.req.ttl);this.client.core.expirer.set(t,n),await this.client.pendingRequest.set(t,{id:t,topic:r,params:i,verifyContext:s})}),IJ(this,"sendRequest",async e=>{let t,i;let{topic:s,method:n,params:o,expiry:a,relayRpcId:c,clientRpcId:l,throwOnFailedPublish:h,appLink:u,tvf:d}=e,p=(0,cq.formatJsonRpcRequest)(n,o,l),f=!!u;try{let e=f?b4:b5;t=await this.client.core.crypto.encode(s,p,{encoding:e})}catch(e){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${s} failed`),e}if(Ij.includes(n)){let e=b7(JSON.stringify(p)),r=b7(t);i=await this.client.core.verify.register({id:r,decryptedId:e})}let g=IT[n].req;if(g.attestation=i,a&&(g.ttl=a),c&&(g.id=c),this.client.core.history.set(s,p),f){let e=wl(u,s,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=IT[n].req;a&&(e.ttl=a),c&&(e.id=c),e.tvf=IK(IV({},d),{correlationId:p.id}),h?(e.internal=IK(IV({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,t,e)):this.client.core.relayer.publish(s,t,e).catch(e=>this.client.logger.error(e))}return p.id}),IJ(this,"sendResult",async e=>{let t,i,s;let{id:n,topic:o,result:a,throwOnFailedPublish:c,encodeOpts:l,appLink:h}=e,u=(0,cq.formatJsonRpcResult)(n,a),d=h&&"u">typeof(null==r.g?void 0:r.g.Linking);try{let e=d?b4:b5;t=await this.client.core.crypto.encode(o,u,IK(IV({},l||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${o} failed`),e}try{let e=(i=await this.client.core.history.get(o,n)).request;try{this.shouldSetTVF(e.method,e.params)&&(s=this.getTVFParams(n,e.params,a))}catch(e){this.client.logger.warn("sendResult() -> getTVFParams() failed",e)}}catch(e){throw this.client.logger.error(`sendResult() -> history.get(${o}, ${n}) failed`),e}if(d){let e=wl(h,o,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=IT[i.request.method].res;e.tvf=IK(IV({},s),{correlationId:n}),c?(e.internal=IK(IV({},e.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,t,e)):this.client.core.relayer.publish(o,t,e).catch(e=>this.client.logger.error(e))}await this.client.core.history.resolve(u)}),IJ(this,"sendError",async e=>{let t,i;let{id:s,topic:n,error:o,encodeOpts:a,rpcOpts:c,appLink:l}=e,h=(0,cq.formatJsonRpcError)(s,o),u=l&&"u">typeof(null==r.g?void 0:r.g.Linking);try{let e=u?b4:b5;t=await this.client.core.crypto.encode(n,h,IK(IV({},a||{}),{encoding:e}))}catch(e){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),e}try{i=await this.client.core.history.get(n,s)}catch(e){throw this.client.logger.error(`sendError() -> history.get(${n}, ${s}) failed`),e}if(u){let e=wl(l,n,t);await r.g.Linking.openURL(e,this.client.name)}else{let e=i.request.method,r=c||IT[e].res;this.client.core.relayer.publish(n,t,r)}await this.client.core.history.resolve(h)}),IJ(this,"cleanup",async()=>{let e=[],t=[];this.client.session.getAll().forEach(t=>{let r=!1;mG(t.expiry)&&(r=!0),this.client.core.crypto.keychain.has(t.topic)||(r=!0),r&&e.push(t.topic)}),this.client.proposal.getAll().forEach(e=>{mG(e.expiryTimestamp)&&t.push(e.id)}),await Promise.all([...e.map(e=>this.deleteSession({topic:e})),...t.map(e=>this.deleteProposal(e))])}),IJ(this,"onProviderMessageEvent",async e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):await this.onRelayMessage(e)}),IJ(this,"onRelayEventRequest",async e=>{this.requestQueue.queue.push(e),await this.processRequestsQueue()}),IJ(this,"processRequestsQueue",async()=>{if(this.requestQueue.state===IR.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=IR.active;let e=this.requestQueue.queue.shift();if(e)try{await this.processRequest(e)}catch(e){this.client.logger.warn(e)}}this.requestQueue.state=IR.idle}),IJ(this,"processRequest",async e=>{let{topic:t,payload:r,attestation:i,transportType:s,encryptedId:n}=e,o=r.method;if(!this.shouldIgnorePairingRequest({topic:t,requestMethod:o}))switch(o){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:t,payload:r,attestation:i,encryptedId:n});case"wc_sessionSettle":return await this.onSessionSettleRequest(t,r);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(t,r);case"wc_sessionExtend":return await this.onSessionExtendRequest(t,r);case"wc_sessionPing":return await this.onSessionPingRequest(t,r);case"wc_sessionDelete":return await this.onSessionDeleteRequest(t,r);case"wc_sessionRequest":return await this.onSessionRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});case"wc_sessionEvent":return await this.onSessionEventRequest(t,r);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:t,payload:r,attestation:i,encryptedId:n,transportType:s});default:return this.client.logger.info(`Unsupported request method ${o}`)}}),IJ(this,"onRelayEventResponse",async e=>{let{topic:t,payload:r,transportType:i}=e,s=(await this.client.core.history.get(t,r.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(t,r,i);case"wc_sessionSettle":return this.onSessionSettleResponse(t,r);case"wc_sessionUpdate":return this.onSessionUpdateResponse(t,r);case"wc_sessionExtend":return this.onSessionExtendResponse(t,r);case"wc_sessionPing":return this.onSessionPingResponse(t,r);case"wc_sessionRequest":return this.onSessionRequestResponse(t,r);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(t,r);default:return this.client.logger.info(`Unsupported response method ${s}`)}}),IJ(this,"onRelayEventUnknownPayload",e=>{let{topic:t}=e,{message:r}=wm("MISSING_OR_INVALID",`Decoded payload on topic ${t} is not identifiable as a JSON-RPC request or a response.`);throw Error(r)}),IJ(this,"shouldIgnorePairingRequest",e=>{let{topic:t,requestMethod:r}=e,i=this.expectedPairingMethodMap.get(t);return!(!i||i.includes(r))&&!!(i.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)}),IJ(this,"onSessionProposeRequest",async e=>{let{topic:t,payload:r,attestation:i,encryptedId:s}=e,{params:n,id:o}=r;try{let e=this.client.core.eventClient.getEvent({topic:t});0===this.client.events.listenerCount("session_proposal")&&(console.warn("No listener for session_proposal event"),e?.setError(w8.proposal_listener_not_found)),this.isValidConnect(IV({},r.params));let a=n.expiryTimestamp||mY(IT.wc_sessionPropose.req.ttl),c=IV({id:o,pairingTopic:t,expiryTimestamp:a},n);await this.setProposal(o,c);let l=await this.getVerifyContext({attestationId:i,hash:b7(JSON.stringify(r)),encryptedId:s,metadata:c.proposer.metadata});e?.addTrace(w4.emit_session_proposal),this.client.events.emit("session_proposal",{id:o,params:c,verifyContext:l})}catch(e){await this.sendError({id:o,topic:t,error:e,rpcOpts:IT.wc_sessionPropose.autoReject}),this.client.logger.error(e)}}),IJ(this,"onSessionProposeResponse",async(e,t,r)=>{let{id:i}=t;if((0,cq.isJsonRpcResult)(t)){let{result:s}=t;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});let n=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:n});let o=n.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:o});let a=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:a});let c=await this.client.core.crypto.generateSharedKey(o,a);this.pendingSessions.set(i,{sessionTopic:c,pairingTopic:e,proposalId:i,publicKey:o});let l=await this.client.core.relayer.subscribe(c,{transportType:r});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:l}),await this.client.core.pairing.activate({topic:e})}else if((0,cq.isJsonRpcError)(t)){await this.client.proposal.delete(i,wy("USER_DISCONNECTED"));let e=mQ("session_connect",i);if(0===this.events.listenerCount(e))throw Error(`emitting ${e} without any listeners, 954`);this.events.emit(e,{error:t.error})}}),IJ(this,"onSessionSettleRequest",async(e,t)=>{let{id:r,params:i}=t;try{this.isValidSessionSettleRequest(i);let{relay:r,controller:s,expiry:n,namespaces:o,sessionProperties:a,scopedProperties:c,sessionConfig:l}=t.params,h=[...this.pendingSessions.values()].find(t=>t.sessionTopic===e);if(!h)return this.client.logger.error(`Pending session not found for topic ${e}`);let u=this.client.proposal.get(h.proposalId),d=IK(IV(IV(IV({topic:e,relay:r,expiry:n,namespaces:o,acknowledged:!0,pairingTopic:h.pairingTopic,requiredNamespaces:u.requiredNamespaces,optionalNamespaces:u.optionalNamespaces,controller:s.publicKey,self:{publicKey:h.publicKey,metadata:this.client.metadata},peer:{publicKey:s.publicKey,metadata:s.metadata}},a&&{sessionProperties:a}),c&&{scopedProperties:c}),l&&{sessionConfig:l}),{transportType:wJ.relay});await this.client.session.set(d.topic,d),await this.setExpiry(d.topic,d.expiry),await this.client.core.pairing.updateMetadata({topic:h.pairingTopic,metadata:d.peer.metadata}),this.client.events.emit("session_connect",{session:d}),this.events.emit(mQ("session_connect",h.proposalId),{session:d}),this.pendingSessions.delete(h.proposalId),this.deleteProposal(h.proposalId,!1),this.cleanupDuplicatePairings(d),await this.sendResult({id:t.id,topic:e,result:!0,throwOnFailedPublish:!0})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),IJ(this,"onSessionSettleResponse",async(e,t)=>{let{id:r}=t;(0,cq.isJsonRpcResult)(t)?(await this.client.session.update(e,{acknowledged:!0}),this.events.emit(mQ("session_approve",r),{})):(0,cq.isJsonRpcError)(t)&&(await this.client.session.delete(e,wy("USER_DISCONNECTED")),this.events.emit(mQ("session_approve",r),{error:t.error}))}),IJ(this,"onSessionUpdateRequest",async(e,t)=>{let{params:r,id:i}=t;try{let t=`${e}_session_update`,s=wk.get(t);if(s&&this.isRequestOutOfSync(s,i)){this.client.logger.warn(`Discarding out of sync request - ${i}`),this.sendError({id:i,topic:e,error:wy("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(IV({topic:e},r));try{wk.set(t,i),await this.client.session.update(e,{namespaces:r.namespaces}),await this.sendResult({id:i,topic:e,result:!0,throwOnFailedPublish:!0})}catch(e){throw wk.delete(t),e}this.client.events.emit("session_update",{id:i,topic:e,params:r})}catch(t){await this.sendError({id:i,topic:e,error:t}),this.client.logger.error(t)}}),IJ(this,"isRequestOutOfSync",(e,t)=>t.toString().slice(0,-3)<e.toString().slice(0,-3)),IJ(this,"onSessionUpdateResponse",(e,t)=>{let{id:r}=t,i=mQ("session_update",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,cq.isJsonRpcResult)(t)?this.events.emit(mQ("session_update",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(mQ("session_update",r),{error:t.error})}),IJ(this,"onSessionExtendRequest",async(e,t)=>{let{id:r}=t;try{this.isValidExtend({topic:e}),await this.setExpiry(e,mY(Ix)),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),IJ(this,"onSessionExtendResponse",(e,t)=>{let{id:r}=t,i=mQ("session_extend",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,cq.isJsonRpcResult)(t)?this.events.emit(mQ("session_extend",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(mQ("session_extend",r),{error:t.error})}),IJ(this,"onSessionPingRequest",async(e,t)=>{let{id:r}=t;try{this.isValidPing({topic:e}),await this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:r,topic:e})}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),IJ(this,"onSessionPingResponse",(e,t)=>{let{id:r}=t,i=mQ("session_ping",r);setTimeout(()=>{if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners 2176`);(0,cq.isJsonRpcResult)(t)?this.events.emit(mQ("session_ping",r),{}):(0,cq.isJsonRpcError)(t)&&this.events.emit(mQ("session_ping",r),{error:t.error})},500)}),IJ(this,"onSessionDeleteRequest",async(e,t)=>{let{id:r}=t;try{this.isValidDisconnect({topic:e,reason:t.params}),Promise.all([new Promise(t=>{this.client.core.relayer.once(wF.publish,async()=>{t(await this.deleteSession({topic:e,id:r}))})}),this.sendResult({id:r,topic:e,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:e,error:wy("USER_DISCONNECTED")})]).catch(e=>this.client.logger.error(e))}catch(e){this.client.logger.error(e)}}),IJ(this,"onSessionRequest",async e=>{var t,r,i;let{topic:s,payload:n,attestation:o,encryptedId:a,transportType:c}=e,{id:l,params:h}=n;try{await this.isValidRequest(IV({topic:s},h));let e=this.client.session.get(s),n=await this.getVerifyContext({attestationId:o,hash:b7(JSON.stringify((0,cq.formatJsonRpcRequest)("wc_sessionRequest",h,l))),encryptedId:a,metadata:e.peer.metadata,transportType:c}),u={id:l,topic:s,params:h,verifyContext:n};await this.setPendingSessionRequest(u),c===wJ.link_mode&&null!=(t=e.peer.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(null==(r=e.peer.metadata.redirect)?void 0:r.universal),null!=(i=this.client.signConfig)&&i.disableRequestQueue?this.emitSessionRequest(u):(this.addSessionRequestToSessionRequestQueue(u),this.processSessionRequestQueue())}catch(e){await this.sendError({id:l,topic:s,error:e}),this.client.logger.error(e)}}),IJ(this,"onSessionRequestResponse",(e,t)=>{let{id:r}=t,i=mQ("session_request",r);if(0===this.events.listenerCount(i))throw Error(`emitting ${i} without any listeners`);(0,cq.isJsonRpcResult)(t)?this.events.emit(mQ("session_request",r),{result:t.result}):(0,cq.isJsonRpcError)(t)&&this.events.emit(mQ("session_request",r),{error:t.error})}),IJ(this,"onSessionEventRequest",async(e,t)=>{let{id:r,params:i}=t;try{let t=`${e}_session_event_${i.event.name}`,s=wk.get(t);if(s&&this.isRequestOutOfSync(s,r)){this.client.logger.info(`Discarding out of sync request - ${r}`);return}this.isValidEmit(IV({topic:e},i)),this.client.events.emit("session_event",{id:r,topic:e,params:i}),wk.set(t,r)}catch(t){await this.sendError({id:r,topic:e,error:t}),this.client.logger.error(t)}}),IJ(this,"onSessionAuthenticateResponse",(e,t)=>{let{id:r}=t;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:e,payload:t}),(0,cq.isJsonRpcResult)(t)?this.events.emit(mQ("session_request",r),{result:t.result}):(0,cq.isJsonRpcError)(t)&&this.events.emit(mQ("session_request",r),{error:t.error})}),IJ(this,"onSessionAuthenticateRequest",async e=>{var t;let{topic:r,payload:i,attestation:s,encryptedId:n,transportType:o}=e;try{let{requester:e,authPayload:a,expiryTimestamp:c}=i.params,l=await this.getVerifyContext({attestationId:s,hash:b7(JSON.stringify(i)),encryptedId:n,metadata:e.metadata,transportType:o}),h={requester:e,pairingTopic:r,id:i.id,authPayload:a,verifyContext:l,expiryTimestamp:c};await this.setAuthRequest(i.id,{request:h,pairingTopic:r,transportType:o}),o===wJ.link_mode&&null!=(t=e.metadata.redirect)&&t.universal&&this.client.core.addLinkModeSupportedApp(e.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:r,params:i.params,id:i.id,verifyContext:l})}catch(n){this.client.logger.error(n);let e=i.params.requester.publicKey,t=await this.client.core.crypto.generateKeyPair(),s=this.getAppLinkIfEnabled(i.params.requester.metadata,o);await this.sendError({id:i.id,topic:r,error:n,encodeOpts:{type:1,receiverPublicKey:e,senderPublicKey:t},rpcOpts:IT.wc_sessionAuthenticate.autoReject,appLink:s})}}),IJ(this,"addSessionRequestToSessionRequestQueue",e=>{this.sessionRequestQueue.queue.push(e)}),IJ(this,"cleanupAfterResponse",e=>{this.deletePendingSessionRequest(e.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=IR.idle,this.processSessionRequestQueue()},(0,er.toMiliseconds)(this.requestQueueDelay))}),IJ(this,"cleanupPendingSentRequestsForTopic",({topic:e,error:t})=>{let r=this.client.core.history.pending;r.length>0&&r.filter(t=>t.topic===e&&"wc_sessionRequest"===t.request.method).forEach(e=>{let r=mQ("session_request",e.request.id);if(0===this.events.listenerCount(r))throw Error(`emitting ${r} without any listeners`);this.events.emit(mQ("session_request",e.request.id),{error:t})})}),IJ(this,"processSessionRequestQueue",()=>{if(this.sessionRequestQueue.state===IR.active){this.client.logger.info("session request queue is already active.");return}let e=this.sessionRequestQueue.queue[0];if(!e){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=IR.active,this.emitSessionRequest(e)}catch(e){this.client.logger.error(e)}}),IJ(this,"emitSessionRequest",e=>{this.client.events.emit("session_request",e)}),IJ(this,"onPairingCreated",e=>{if(e.methods&&this.expectedPairingMethodMap.set(e.topic,e.methods),e.active)return;let t=this.client.proposal.getAll().find(t=>t.pairingTopic===e.topic);t&&this.onSessionProposeRequest({topic:e.topic,payload:(0,cq.formatJsonRpcRequest)("wc_sessionPropose",IK(IV({},t),{requiredNamespaces:t.requiredNamespaces,optionalNamespaces:t.optionalNamespaces,relays:t.relays,proposer:t.proposer,sessionProperties:t.sessionProperties,scopedProperties:t.scopedProperties}),t.id)})}),IJ(this,"isValidConnect",async e=>{let t;if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(e)}`);throw Error(t)}let{pairingTopic:r,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:n,scopedProperties:o,relays:a}=e;if(wv(r)||await this.isValidPairingTopic(r),t=!1,a?a&&wb(a)&&a.length&&a.forEach(e=>{t=wA(e)}):t=!0,!t){let{message:e}=wm("MISSING_OR_INVALID",`connect() relays: ${a}`);throw Error(e)}if(wv(i)||0===ww(i)||this.validateNamespaces(i,"requiredNamespaces"),wv(s)||0===ww(s)||this.validateNamespaces(s,"optionalNamespaces"),wv(n)||this.validateSessionProps(n,"sessionProperties"),!wv(o)){this.validateSessionProps(o,"scopedProperties");let e=Object.keys(i||{}).concat(Object.keys(s||{}));if(!Object.keys(o).every(t=>e.includes(t)))throw Error(`Scoped properties must be a subset of required/optional namespaces, received: ${JSON.stringify(o)}, required/optional namespaces: ${JSON.stringify(e)}`)}}),IJ(this,"validateNamespaces",(e,t)=>{let r=function(e,t,r){let i=null;if(e&&ww(e)){let s;let n=wS(e,t);n&&(i=n);let o=(s=null,Object.entries(e).forEach(([e,i])=>{var n,o;let a;if(s)return;let c=(n=mD(e,i),o=`${t} ${r}`,a=null,wb(n)&&n.length?n.forEach(e=>{a||w_(e)||(a=wy("UNSUPPORTED_CHAINS",`${o}, chain ${e} should be a string and conform to "namespace:chainId" format`))}):w_(e)||(a=wy("UNSUPPORTED_CHAINS",`${o}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),a);c&&(s=c)}),s);o&&(i=o)}else i=wm("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return i}(e,"connect()",t);if(r)throw Error(r.message)}),IJ(this,"isValidApprove",async e=>{if(!wO(e))throw Error(wm("MISSING_OR_INVALID",`approve() params: ${e}`).message);let{id:t,namespaces:r,relayProtocol:i,sessionProperties:s,scopedProperties:n}=e;this.checkRecentlyDeleted(t),await this.isValidProposalId(t);let o=this.client.proposal.get(t),a=wN(r,"approve()");if(a)throw Error(a.message);let c=wP(o.requiredNamespaces,r,"approve()");if(c)throw Error(c.message);if(!wE(i,!0)){let{message:e}=wm("MISSING_OR_INVALID",`approve() relayProtocol: ${i}`);throw Error(e)}if(wv(s)||this.validateSessionProps(s,"sessionProperties"),!wv(n)){this.validateSessionProps(n,"scopedProperties");let e=new Set(Object.keys(r));if(!Object.keys(n).every(t=>e.has(t)))throw Error(`Scoped properties must be a subset of approved namespaces, received: ${JSON.stringify(n)}, approved namespaces: ${Array.from(e).join(", ")}`)}}),IJ(this,"isValidReject",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`reject() params: ${e}`);throw Error(t)}let{id:t,reason:r}=e;if(this.checkRecentlyDeleted(t),await this.isValidProposalId(t),!r||"object"!=typeof r||!r.code||!wI(r.code,!1)||!r.message||!wE(r.message,!1)){let{message:e}=wm("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(r)}`);throw Error(e)}}),IJ(this,"isValidSessionSettleRequest",e=>{let t;if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${e}`);throw Error(t)}let{relay:r,controller:i,namespaces:s,expiry:n}=e;if(!wA(r)){let{message:e}=wm("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw Error(e)}let o=(t=null,wE(i?.publicKey,!1)||(t=wm("MISSING_OR_INVALID","onSessionSettleRequest() controller public key should be a string")),t);if(o)throw Error(o.message);let a=wN(s,"onSessionSettleRequest()");if(a)throw Error(a.message);if(mG(n)){let{message:e}=wm("EXPIRED","onSessionSettleRequest()");throw Error(e)}}),IJ(this,"isValidUpdate",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`update() params: ${e}`);throw Error(t)}let{topic:t,namespaces:r}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t);let i=this.client.session.get(t),s=wN(r,"update()");if(s)throw Error(s.message);let n=wP(i.requiredNamespaces,r,"update()");if(n)throw Error(n.message)}),IJ(this,"isValidExtend",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`extend() params: ${e}`);throw Error(t)}let{topic:t}=e;this.checkRecentlyDeleted(t),await this.isValidSessionTopic(t)}),IJ(this,"isValidRequest",async e=>{var t;if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`request() params: ${e}`);throw Error(t)}let{topic:r,request:i,chainId:s,expiry:n}=e;this.checkRecentlyDeleted(r),await this.isValidSessionTopic(r);let{namespaces:o}=this.client.session.get(r);if(!wM(o,s)){let{message:e}=wm("MISSING_OR_INVALID",`request() chainId: ${s}`);throw Error(e)}if(wv(i)||!wE(i.method,!1)){let{message:e}=wm("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw Error(e)}if(!(wE(t=i.method,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{wh(e.accounts).includes(t)&&r.push(...e.methods)}),r})(o,s).includes(t))){let{message:e}=wm("MISSING_OR_INVALID",`request() method: ${i.method}`);throw Error(e)}if(n&&(!wI(n,!1)||!(n<=ID.max)||!(n>=ID.min))){let{message:e}=wm("MISSING_OR_INVALID",`request() expiry: ${n}. Expiry must be a number (in seconds) between ${ID.min} and ${ID.max}`);throw Error(e)}}),IJ(this,"isValidRespond",async e=>{var t;if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`respond() params: ${e}`);throw Error(t)}let{topic:r,response:i}=e;try{await this.isValidSessionTopic(r)}catch(r){throw null!=(t=e?.response)&&t.id&&this.cleanupAfterResponse(e),r}if(wv(i)||wv(i.result)&&wv(i.error)||!wI(i.id,!1)||!wE(i.jsonrpc,!1)){let{message:e}=wm("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw Error(e)}}),IJ(this,"isValidPing",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`ping() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),IJ(this,"isValidEmit",async e=>{var t;if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`emit() params: ${e}`);throw Error(t)}let{topic:r,event:i,chainId:s}=e;await this.isValidSessionTopic(r);let{namespaces:n}=this.client.session.get(r);if(!wM(n,s)){let{message:e}=wm("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw Error(e)}if(wv(i)||!wE(i.name,!1)){let{message:e}=wm("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}if(!(wE(t=i.name,!1)&&(function(e,t){let r=[];return Object.values(e).forEach(e=>{wh(e.accounts).includes(t)&&r.push(...e.events)}),r})(n,s).includes(t))){let{message:e}=wm("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw Error(e)}}),IJ(this,"isValidDisconnect",async e=>{if(!wO(e)){let{message:t}=wm("MISSING_OR_INVALID",`disconnect() params: ${e}`);throw Error(t)}let{topic:t}=e;await this.isValidSessionOrPairingTopic(t)}),IJ(this,"isValidAuthenticate",e=>{let{chains:t,uri:r,domain:i,nonce:s}=e;if(!Array.isArray(t)||0===t.length)throw Error("chains is required and must be a non-empty array");if(!wE(r,!1))throw Error("uri is required parameter");if(!wE(i,!1))throw Error("domain is required parameter");if(!wE(s,!1))throw Error("nonce is required parameter");if([...new Set(t.map(e=>mT(e).namespace))].length>1)throw Error("Multi-namespace requests are not supported. Please request single namespace only.");let{namespace:n}=mT(t[0]);if("eip155"!==n)throw Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")}),IJ(this,"getVerifyContext",async e=>{let{attestationId:t,hash:r,encryptedId:i,metadata:s,transportType:n}=e,o={verified:{verifyUrl:s.verifyUrl||w2,validation:"UNKNOWN",origin:s.url||""}};try{if(n===wJ.link_mode){let e=this.getAppLinkIfEnabled(s,n);return o.verified.validation=e&&new URL(e).origin===new URL(s.url).origin?"VALID":"INVALID",o}let e=await this.client.core.verify.resolve({attestationId:t,hash:r,encryptedId:i,verifyUrl:s.verifyUrl});e&&(o.verified.origin=e.origin,o.verified.isScam=e.isScam,o.verified.validation=e.origin===new URL(s.url).origin?"VALID":"INVALID")}catch(e){this.client.logger.warn(e)}return this.client.logger.debug(`Verify context: ${JSON.stringify(o)}`),o}),IJ(this,"validateSessionProps",(e,t)=>{Object.values(e).forEach((r,i)=>{if(null==r){let{message:s}=wm("MISSING_OR_INVALID",`${t} must contain an existing value for each key. Received: ${r} for key ${Object.keys(e)[i]}`);throw Error(s)}})}),IJ(this,"getPendingAuthRequest",e=>{let t=this.client.auth.requests.get(e);return"object"==typeof t?t:void 0}),IJ(this,"addToRecentlyDeleted",(e,t)=>{if(this.recentlyDeletedMap.set(e,t),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let e=0,t=this.recentlyDeletedLimit/2;for(let r of this.recentlyDeletedMap.keys()){if(e++>=t)break;this.recentlyDeletedMap.delete(r)}}}),IJ(this,"checkRecentlyDeleted",e=>{let t=this.recentlyDeletedMap.get(e);if(t){let{message:r}=wm("MISSING_OR_INVALID",`Record was recently deleted - ${t}: ${e}`);throw Error(r)}}),IJ(this,"isLinkModeEnabled",(e,t)=>{var i,s,n,o,a,c,l,h,u;return!!e&&t===wJ.link_mode&&(null==(s=null==(i=this.client.metadata)?void 0:i.redirect)?void 0:s.linkMode)===!0&&(null==(o=null==(n=this.client.metadata)?void 0:n.redirect)?void 0:o.universal)!==void 0&&(null==(c=null==(a=this.client.metadata)?void 0:a.redirect)?void 0:c.universal)!==""&&(null==(l=e?.redirect)?void 0:l.universal)!==void 0&&(null==(h=e?.redirect)?void 0:h.universal)!==""&&(null==(u=e?.redirect)?void 0:u.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(e.redirect.universal)&&"u">typeof(null==r.g?void 0:r.g.Linking)}),IJ(this,"getAppLinkIfEnabled",(e,t)=>{var r;return this.isLinkModeEnabled(e,t)?null==(r=e?.redirect)?void 0:r.universal:void 0}),IJ(this,"handleLinkModeMessage",({url:e})=>{if(!e||!e.includes("wc_ev")||!e.includes("topic"))return;let t=m1(e,"topic")||"",r=decodeURIComponent(m1(e,"wc_ev")||""),i=this.client.session.keys.includes(t);i&&this.client.session.update(t,{transportType:wJ.link_mode}),this.client.core.dispatchEnvelope({topic:t,message:r,sessionExists:i})}),IJ(this,"registerLinkModeListeners",async()=>{var e;if(m3()||mj()&&null!=(e=this.client.metadata.redirect)&&e.linkMode){let e=null==r.g?void 0:r.g.Linking;if("u">typeof e){e.addEventListener("url",this.handleLinkModeMessage,this.client.name);let t=await e.getInitialURL();t&&setTimeout(()=>{this.handleLinkModeMessage({url:t})},50)}}}),IJ(this,"shouldSetTVF",(e,t)=>{if(!t||"wc_sessionRequest"!==e)return!1;let{request:r}=t;return Object.keys(Ik).includes(r.method)}),IJ(this,"getTVFParams",(e,t,r)=>{var i,s;try{let n=t.request.method,o=this.extractTxHashesFromResult(n,r);return IK(IV({correlationId:e,rpcMethods:[n],chainId:t.chainId},this.isValidContractData(t.request.params)&&{contractAddresses:[null==(s=null==(i=t.request.params)?void 0:i[0])?void 0:s.to]}),{txHashes:o})}catch(e){this.client.logger.warn("Error getting TVF params",e)}return{}}),IJ(this,"isValidContractData",e=>{var t;if(!e)return!1;try{let r=e?.data||(null==(t=e?.[0])?void 0:t.data);if(!r.startsWith("0x"))return!1;let i=r.slice(2);return!!/^[0-9a-fA-F]*$/.test(i)&&i.length%2==0}catch{}return!1}),IJ(this,"extractTxHashesFromResult",(e,t)=>{try{let r=Ik[e];if("string"==typeof t)return[t];let i=t[r.key];if(wb(i))return"solana_signAllTransactions"===e?i.map(e=>(function(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);let i=r[0];if(0===i)throw Error("No signatures found");if(r.length<1+64*i)throw Error("Transaction data too short for claimed signature count");if(r.length<100)throw Error("Transaction too short");let s=mx.from(e,"base64").slice(1,65);return mM.encode(s)})(e)):i;if("string"==typeof i)return[i]}catch(e){this.client.logger.warn("Error extracting tx hashes from result",e)}return[]})}async processPendingMessageEvents(){try{let e=this.client.session.keys,t=this.client.core.relayer.messages.getWithoutAck(e);for(let[e,r]of Object.entries(t))for(let t of r)try{await this.onProviderMessageEvent({topic:e,message:t,publishedAt:Date.now()})}catch{this.client.logger.warn(`Error processing pending message event for topic: ${e}, message: ${t}`)}}catch(e){this.client.logger.warn("processPendingMessageEvents failed",e)}}isInitialized(){if(!this.initialized){let{message:e}=wm("NOT_INITIALIZED",this.name);throw Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(wF.message,e=>{this.onProviderMessageEvent(e)})}async onRelayMessage(e){let{topic:t,message:r,attestation:i,transportType:s}=e,{publicKey:n}=this.client.auth.authKeys.keys.includes(IU)?this.client.auth.authKeys.get(IU):{responseTopic:void 0,publicKey:void 0};try{let e=await this.client.core.crypto.decode(t,r,{receiverPublicKey:n,encoding:s===wJ.link_mode?b4:b5});(0,cq.isJsonRpcRequest)(e)?(this.client.core.history.set(t,e),await this.onRelayEventRequest({topic:t,payload:e,attestation:i,transportType:s,encryptedId:b7(r)})):(0,cq.isJsonRpcResponse)(e)?(await this.client.core.history.resolve(e),await this.onRelayEventResponse({topic:t,payload:e,transportType:s}),this.client.core.history.delete(t,e.id)):await this.onRelayEventUnknownPayload({topic:t,payload:e,transportType:s}),await this.client.core.relayer.messages.ack(t,r)}catch(e){this.client.logger.error(e)}}registerExpirerEvents(){this.client.core.expirer.on(w1.expired,async e=>{let{topic:t,id:r}=mJ(e.target);return r&&this.client.pendingRequest.keys.includes(r)?await this.deletePendingSessionRequest(r,wm("EXPIRED"),!0):r&&this.client.auth.requests.keys.includes(r)?await this.deletePendingAuthRequest(r,wm("EXPIRED"),!0):void(t?this.client.session.keys.includes(t)&&(await this.deleteSession({topic:t,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:t})):r&&(await this.deleteProposal(r,!0),this.client.events.emit("proposal_expire",{id:r})))})}registerPairingEvents(){this.client.core.pairing.events.on(wX.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(wX.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!wE(e,!1)){let{message:t}=wm("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){let{message:t}=wm("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw Error(t)}if(mG(this.client.core.pairing.pairings.get(e).expiry)){let{message:t}=wm("EXPIRED",`pairing topic: ${e}`);throw Error(t)}}async isValidSessionTopic(e){if(!wE(e,!1)){let{message:t}=wm("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw Error(t)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){let{message:t}=wm("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw Error(t)}if(mG(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});let{message:t}=wm("EXPIRED",`session topic: ${e}`);throw Error(t)}if(!this.client.core.crypto.keychain.has(e)){let{message:t}=wm("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),Error(t)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(wE(e,!1)){let{message:t}=wm("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw Error(t)}else{let{message:t}=wm("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw Error(t)}}async isValidProposalId(e){if("number"!=typeof e){let{message:t}=wm("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw Error(t)}if(!this.client.proposal.keys.includes(e)){let{message:t}=wm("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw Error(t)}if(mG(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);let{message:t}=wm("EXPIRED",`proposal id: ${e}`);throw Error(t)}}}class IG extends EX{constructor(e,t){super(e,t,"proposal",IA),this.core=e,this.logger=t}}class IQ extends EX{constructor(e,t){super(e,t,"session",IA),this.core=e,this.logger=t}}class IZ extends EX{constructor(e,t){super(e,t,"request",IA,e=>e.id),this.core=e,this.logger=t}}class IX extends EX{constructor(e,t){super(e,t,"authKeys",IL,()=>IU),this.core=e,this.logger=t}}class I0 extends EX{constructor(e,t){super(e,t,"pairingTopics",IL),this.core=e,this.logger=t}}class I1 extends EX{constructor(e,t){super(e,t,"requests",IL,e=>e.id),this.core=e,this.logger=t}}var I2=Object.defineProperty,I3=(e,t,r)=>t in e?I2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I5=(e,t,r)=>I3(e,"symbol"!=typeof t?t+"":t,r);class I4{constructor(e,t){this.core=e,this.logger=t,I5(this,"authKeys"),I5(this,"pairingTopics"),I5(this,"requests"),this.authKeys=new IX(this.core,this.logger),this.pairingTopics=new I0(this.core,this.logger),this.requests=new I1(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}}var I8=Object.defineProperty,I6=(e,t,r)=>t in e?I8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,I9=(e,t,r)=>I6(e,"symbol"!=typeof t?t+"":t,r);class I7 extends gq{constructor(e){super(e),I9(this,"protocol","wc"),I9(this,"version",2),I9(this,"name",IO.name),I9(this,"metadata"),I9(this,"core"),I9(this,"logger"),I9(this,"events",new ee.EventEmitter),I9(this,"engine"),I9(this,"session"),I9(this,"proposal"),I9(this,"pendingRequest"),I9(this,"auth"),I9(this,"signConfig"),I9(this,"on",(e,t)=>this.events.on(e,t)),I9(this,"once",(e,t)=>this.events.once(e,t)),I9(this,"off",(e,t)=>this.events.off(e,t)),I9(this,"removeListener",(e,t)=>this.events.removeListener(e,t)),I9(this,"removeAllListeners",e=>this.events.removeAllListeners(e)),I9(this,"connect",async e=>{try{return await this.engine.connect(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"pair",async e=>{try{return await this.engine.pair(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"approve",async e=>{try{return await this.engine.approve(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"reject",async e=>{try{return await this.engine.reject(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"update",async e=>{try{return await this.engine.update(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"extend",async e=>{try{return await this.engine.extend(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"request",async e=>{try{return await this.engine.request(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"respond",async e=>{try{return await this.engine.respond(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"ping",async e=>{try{return await this.engine.ping(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"emit",async e=>{try{return await this.engine.emit(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"disconnect",async e=>{try{return await this.engine.disconnect(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"find",e=>{try{return this.engine.find(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"getPendingSessionRequests",()=>{try{return this.engine.getPendingSessionRequests()}catch(e){throw this.logger.error(e.message),e}}),I9(this,"authenticate",async(e,t)=>{try{return await this.engine.authenticate(e,t)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"formatAuthMessage",e=>{try{return this.engine.formatAuthMessage(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"approveSessionAuthenticate",async e=>{try{return await this.engine.approveSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),I9(this,"rejectSessionAuthenticate",async e=>{try{return await this.engine.rejectSessionAuthenticate(e)}catch(e){throw this.logger.error(e.message),e}}),this.name=e?.name||IO.name,this.metadata=e?.metadata||m$(),this.signConfig=e?.signConfig;let t="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,e$.gw)((0,e$.jI)({level:e?.logger||IO.logger}));this.core=e?.core||new IS(e),this.logger=(0,e$.Ep)(t,this.name),this.session=new IQ(this.core,this.logger),this.proposal=new IG(this.core,this.logger),this.pendingRequest=new IZ(this.core,this.logger),this.engine=new IY(this),this.auth=new I4(this.core,this.logger)}static async init(e){let t=new I7(e);return await t.initialize(),t}get context(){return(0,e$.Fd)(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},(0,er.toMiliseconds)(er.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}}var _e=r(82957).Buffer;let _t="error",_r="wc@2:universal_provider:",_i="https://rpc.walletconnect.org/v1/",_s="generic",_n=`${_i}bundler`,_o="default_chain_changed";function _a(){}function _c(e){return null==e||"object"!=typeof e&&"function"!=typeof e}function _l(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function _h(e){return"object"==typeof e&&null!==e}function _u(e){return Object.getOwnPropertySymbols(e).filter(t=>Object.prototype.propertyIsEnumerable.call(e,t))}function _d(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":Object.prototype.toString.call(e)}let _p="[object String]",_f="[object Number]",_g="[object Boolean]",_m="[object Arguments]";function _y(e,t,r,i=new Map,s){let n=s?.(e,t,r,i);if(null!=n)return n;if(_c(e))return e;if(i.has(e))return i.get(e);if(Array.isArray(e)){let t=Array(e.length);i.set(e,t);for(let n=0;n<e.length;n++)t[n]=_y(e[n],n,r,i,s);return Object.hasOwn(e,"index")&&(t.index=e.index),Object.hasOwn(e,"input")&&(t.input=e.input),t}if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp){let t=new RegExp(e.source,e.flags);return t.lastIndex=e.lastIndex,t}if(e instanceof Map){let t=new Map;for(let[n,o]of(i.set(e,t),e))t.set(n,_y(o,n,r,i,s));return t}if(e instanceof Set){let t=new Set;for(let n of(i.set(e,t),e))t.add(_y(n,void 0,r,i,s));return t}if("u">typeof _e&&_e.isBuffer(e))return e.subarray();if(_l(e)){let t=new(Object.getPrototypeOf(e)).constructor(e.length);i.set(e,t);for(let n=0;n<e.length;n++)t[n]=_y(e[n],n,r,i,s);return t}if(e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);if(e instanceof DataView){let t=new DataView(e.buffer.slice(0),e.byteOffset,e.byteLength);return i.set(e,t),_b(t,e,r,i,s),t}if("u">typeof File&&e instanceof File){let t=new File([e],e.name,{type:e.type});return i.set(e,t),_b(t,e,r,i,s),t}if(e instanceof Blob){let t=new Blob([e],{type:e.type});return i.set(e,t),_b(t,e,r,i,s),t}if(e instanceof Error){let t=new e.constructor;return i.set(e,t),t.message=e.message,t.name=e.name,t.stack=e.stack,t.cause=e.cause,_b(t,e,r,i,s),t}if("object"==typeof e&&function(e){switch(_d(e)){case _m:case"[object Array]":case"[object ArrayBuffer]":case"[object DataView]":case _g:case"[object Date]":case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Map]":case _f:case"[object Object]":case"[object RegExp]":case"[object Set]":case _p:case"[object Symbol]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return!0;default:return!1}}(e)){let t=Object.create(Object.getPrototypeOf(e));return i.set(e,t),_b(t,e,r,i,s),t}return e}function _b(e,t,r=e,i,s){let n=[...Object.keys(t),..._u(t)];for(let o=0;o<n.length;o++){let a=n[o],c=Object.getOwnPropertyDescriptor(e,a);(null==c||c.writable)&&(e[a]=_y(t[a],a,r,i,s))}}function _w(e){var t;return t=(t,r,i,s)=>{let n=void 0;if(null!=n)return n;if("object"==typeof e)switch(Object.prototype.toString.call(e)){case _f:case _p:case _g:{let t=new e.constructor(e?.valueOf());return _b(t,e),t}case _m:{let t={};return _b(t,e),t.length=e.length,t[Symbol.iterator]=e[Symbol.iterator],t}default:return}},_y(e,void 0,e,new Map,t)}function _v(e){return null!==e&&"object"==typeof e&&"[object Arguments]"===_d(e)}var _E=Object.defineProperty,_I=Object.defineProperties,__=Object.getOwnPropertyDescriptors,_C=Object.getOwnPropertySymbols,_S=Object.prototype.hasOwnProperty,_N=Object.prototype.propertyIsEnumerable,_A=(e,t,r)=>t in e?_E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_O=(e,t)=>{for(var r in t||(t={}))_S.call(t,r)&&_A(e,r,t[r]);if(_C)for(var r of _C(t))_N.call(t,r)&&_A(e,r,t[r]);return e},_M=(e,t)=>_I(e,__(t));function _P(e,t,r){var i;let s=mT(e);return(null==(i=t.rpcMap)?void 0:i[s.reference])||`${_i}?chainId=${s.namespace}:${s.reference}&projectId=${r}`}function _x(e){return e.includes(":")?e.split(":")[1]:e}function _T(e){return e.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function _D(e={},t={}){return function(e,...t){return function(e,...t){let r=t.slice(0,-1),i=t[t.length-1],s=e;for(let e=0;e<r.length;e++)s=function e(t,r,i,s){if(_c(t)&&(t=Object(t)),null==r||"object"!=typeof r)return t;if(s.has(r))return function(e){if(_c(e))return e;if(Array.isArray(e)||_l(e)||e instanceof ArrayBuffer||"u">typeof SharedArrayBuffer&&e instanceof SharedArrayBuffer)return e.slice(0);let t=Object.getPrototypeOf(e),r=t.constructor;if(e instanceof Date||e instanceof Map||e instanceof Set)return new r(e);if(e instanceof RegExp){let t=new r(e);return t.lastIndex=e.lastIndex,t}if(e instanceof DataView)return new r(e.buffer.slice(0));if(e instanceof Error){let t=new r(e.message);return t.stack=e.stack,t.name=e.name,t.cause=e.cause,t}return"u">typeof File&&e instanceof File?new r([e],e.name,{type:e.type,lastModified:e.lastModified}):"object"==typeof e?Object.assign(Object.create(t),e):e}(s.get(r));if(s.set(r,t),Array.isArray(r)){r=r.slice();for(let e=0;e<r.length;e++)r[e]=r[e]??void 0}let n=[...Object.keys(r),..._u(r)];for(let o=0;o<n.length;o++){let a=n[o],c=r[a],l=t[a];if(_v(c)&&(c={...c}),_v(l)&&(l={...l}),"u">typeof _e&&_e.isBuffer(c)&&(c=_w(c)),Array.isArray(c)){if("object"==typeof l&&null!=l){let e=[],t=Reflect.ownKeys(l);for(let r=0;r<t.length;r++){let i=t[r];e[i]=l[i]}l=e}else l=[]}let h=i(l,c,a,t,r,s);null!=h?t[a]=h:Array.isArray(c)||_h(l)&&_h(c)?t[a]=e(l,c,i,s):null==l&&function(e){if("object"!=typeof e||null==e)return!1;if(null===Object.getPrototypeOf(e))return!0;if("[object Object]"!==Object.prototype.toString.call(e)){let t=e[Symbol.toStringTag];return!!(null!=t&&Object.getOwnPropertyDescriptor(e,Symbol.toStringTag)?.writable)&&e.toString()===`[object ${t}]`}let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(c)?t[a]=e({},c,i,s):null==l&&_l(c)?t[a]=_w(c):(void 0===l||void 0!==c)&&(t[a]=c)}return t}(s,r[e],i,new Map);return s}(e,...t,_a)}(_R(e),_R(t))}function _R(e){var t,r,i,s;let n={};if(!ww(e))return n;for(let[o,a]of Object.entries(e)){let e=wu(o)?[o]:a.chains,c=a.methods||[],l=a.events||[],h=a.rpcMap||{},u=wd(o);n[u]=_M(_O(_O({},n[u]),a),{chains:mZ(e,null==(t=n[u])?void 0:t.chains),methods:mZ(c,null==(r=n[u])?void 0:r.methods),events:mZ(l,null==(i=n[u])?void 0:i.events),rpcMap:_O(_O({},h),null==(s=n[u])?void 0:s.rpcMap)})}return n}function _k(e){return e.includes(":")?e.split(":")[2]:e}function _j(e){let t={};for(let[r,i]of Object.entries(e)){let e=i.methods||[],s=i.events||[],n=i.accounts||[],o=wu(r)?[r]:i.chains?i.chains:_T(i.accounts);t[r]={chains:o,methods:e,events:s,accounts:n}}return t}function _L(e){return"number"==typeof e?e:e.includes("0x")?parseInt(e,16):isNaN(Number(e=e.includes(":")?e.split(":")[1]:e))?e:Number(e)}let _U={},_z=e=>_U[e],_$=(e,t)=>{_U[e]=t};var _q=Object.defineProperty,_B=(e,t,r)=>t in e?_q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_W=(e,t,r)=>_B(e,"symbol"!=typeof t?t+"":t,r);class _H{constructor(e){_W(this,"name","polkadot"),_W(this,"client"),_W(this,"httpProviders"),_W(this,"events"),_W(this,"namespace"),_W(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${e}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=_x(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var _F=Object.defineProperty,_V=Object.defineProperties,_K=Object.getOwnPropertyDescriptors,_J=Object.getOwnPropertySymbols,_Y=Object.prototype.hasOwnProperty,_G=Object.prototype.propertyIsEnumerable,_Q=(e,t,r)=>t in e?_F(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_Z=(e,t)=>{for(var r in t||(t={}))_Y.call(t,r)&&_Q(e,r,t[r]);if(_J)for(var r of _J(t))_G.call(t,r)&&_Q(e,r,t[r]);return e},_X=(e,t)=>_V(e,_K(t)),_0=(e,t,r)=>_Q(e,"symbol"!=typeof t?t+"":t,r);class _1{constructor(e){_0(this,"name","eip155"),_0(this,"client"),_0(this,"chainId"),_0(this,"namespace"),_0(this,"httpProviders"),_0(this,"events"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(parseInt(e),t),this.chainId=parseInt(e),this.events.emit(_o,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){let r=t||_P(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.k(r,_z("disableProviderPing")))}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=parseInt(_x(t));e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}getHttpProvider(){let e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,r;let i=e.request.params?null==(t=e.request.params[0])?void 0:t.chainId:"0x0",s=parseInt(i=i.startsWith("0x")?i:`0x${i}`,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:i}]},chainId:null==(r=this.namespace.chains)?void 0:r[0]}),this.setDefaultChain(`${s}`);else throw Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var t,r,i;let s=null==(r=null==(t=e.request)?void 0:t.params)?void 0:r[0];if(!s)throw Error("Missing address parameter in `wallet_getCapabilities` request");let n=this.client.session.get(e.topic),o=(null==(i=n?.sessionProperties)?void 0:i.capabilities)||{};if(null!=o&&o[s])return o?.[s];let a=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:_X(_Z({},n.sessionProperties||{}),{capabilities:_X(_Z({},o||{}),{[s]:a})})})}catch(e){console.warn("Failed to update session with capabilities",e)}return a}async getCallStatus(e){var t,r;let i=this.client.session.get(e.topic),s=null==(t=i.sessionProperties)?void 0:t.bundler_name;if(s){let t=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(t,e)}catch(e){console.warn("Failed to fetch call status from bundler",e,t)}}let n=null==(r=i.sessionProperties)?void 0:r.bundler_url;if(n)try{return await this.getUserOperationReceipt(n,e)}catch(e){console.warn("Failed to fetch call status from custom bundler",e,n)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,t){var r;let i=new URL(e),s=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify((0,cq.formatJsonRpcRequest)("eth_getUserOperationReceipt",[null==(r=t.request.params)?void 0:r[0]]))});if(!s.ok)throw Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,t){return`${_n}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${t}`}}var _2=Object.defineProperty,_3=(e,t,r)=>t in e?_2(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_5=(e,t,r)=>_3(e,"symbol"!=typeof t?t+"":t,r);class _4{constructor(e){_5(this,"name","solana"),_5(this,"client"),_5(this,"httpProviders"),_5(this,"events"),_5(this,"namespace"),_5(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=_x(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var _8=Object.defineProperty,_6=(e,t,r)=>t in e?_8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,_9=(e,t,r)=>_6(e,"symbol"!=typeof t?t+"":t,r);class _7{constructor(e){_9(this,"name","cosmos"),_9(this,"client"),_9(this,"httpProviders"),_9(this,"events"),_9(this,"namespace"),_9(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=_x(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var Ce=Object.defineProperty,Ct=(e,t,r)=>t in e?Ce(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Cr=(e,t,r)=>Ct(e,"symbol"!=typeof t?t+"":t,r);class Ci{constructor(e){Cr(this,"name","algorand"),Cr(this,"client"),Cr(this,"httpProviders"),Cr(this,"events"),Cr(this,"namespace"),Cr(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){let r=t||_P(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.chainId=e,this.events.emit(_o,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);return typeof r>"u"?void 0:new c$.r(new di.Z(r,_z("disableProviderPing")))}}var Cs=Object.defineProperty,Cn=(e,t,r)=>t in e?Cs(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Co=(e,t,r)=>Cn(e,"symbol"!=typeof t?t+"":t,r);class Ca{constructor(e){Co(this,"name","cip34"),Co(this,"client"),Co(this,"httpProviders"),Co(this,"events"),Co(this,"namespace"),Co(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{let r=this.getCardanoRPCUrl(t),i=_x(t);e[i]=this.createHttpProvider(i,r)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){let t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||this.getCardanoRPCUrl(e);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var Cc=Object.defineProperty,Cl=(e,t,r)=>t in e?Cc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ch=(e,t,r)=>Cl(e,"symbol"!=typeof t?t+"":t,r);class Cu{constructor(e){Ch(this,"name","elrond"),Ch(this,"client"),Ch(this,"httpProviders"),Ch(this,"events"),Ch(this,"namespace"),Ch(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=_x(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var Cd=Object.defineProperty,Cp=(e,t,r)=>t in e?Cd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Cf=(e,t,r)=>Cp(e,"symbol"!=typeof t?t+"":t,r);class Cg{constructor(e){Cf(this,"name","multiversx"),Cf(this,"client"),Cf(this,"httpProviders"),Cf(this,"events"),Cf(this,"namespace"),Cf(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;let i=_x(t);e[i]=this.createHttpProvider(i,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var Cm=Object.defineProperty,Cy=(e,t,r)=>t in e?Cm(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Cb=(e,t,r)=>Cy(e,"symbol"!=typeof t?t+"":t,r);class Cw{constructor(e){Cb(this,"name","near"),Cb(this,"client"),Cb(this,"httpProviders"),Cb(this,"events"),Cb(this,"namespace"),Cb(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let r=t||_P(`${this.name}:${e}`,this.namespace);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(_o,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{var r;e[t]=this.createHttpProvider(t,null==(r=this.namespace.rpcMap)?void 0:r[t])}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace);return typeof r>"u"?void 0:new c$.r(new di.Z(r,_z("disableProviderPing")))}}var Cv=Object.defineProperty,CE=(e,t,r)=>t in e?Cv(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,CI=(e,t,r)=>CE(e,"symbol"!=typeof t?t+"":t,r);class C_{constructor(e){CI(this,"name","tezos"),CI(this,"client"),CI(this,"httpProviders"),CI(this,"events"),CI(this,"namespace"),CI(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){let r=t||_P(`${this.name}:${e}`,this.namespace);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,r)}this.events.emit(_o,`${this.name}:${this.chainId}`)}getAccounts(){let e=this.namespace.accounts;return e&&e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2])||[]}createHttpProviders(){let e={};return this.namespace.chains.forEach(t=>{e[t]=this.createHttpProvider(t)}),e}getHttpProvider(){let e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace);return typeof r>"u"?void 0:new c$.r(new di.Z(r))}}var CC=Object.defineProperty,CS=(e,t,r)=>t in e?CC(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,CN=(e,t,r)=>CS(e,"symbol"!=typeof t?t+"":t,r);class CA{constructor(e){CN(this,"name",_s),CN(this,"client"),CN(this,"httpProviders"),CN(this,"events"),CN(this,"namespace"),CN(this,"chainId"),this.namespace=e.namespace,this.events=_z("events"),this.client=_z("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,t){this.httpProviders[e]||this.setHttpProvider(e,t),this.chainId=e,this.events.emit(_o,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;let e=this.namespace.chains[0];if(!e)throw Error("ChainId not found");return e.split(":")[1]}getAccounts(){let e=this.namespace.accounts;return e?[...new Set(e.filter(e=>e.split(":")[1]===this.chainId.toString()).map(e=>e.split(":")[2]))]:[]}createHttpProviders(){var e,t;let r={};return null==(t=null==(e=this.namespace)?void 0:e.accounts)||t.forEach(e=>{let t=mT(e);r[`${t.namespace}:${t.reference}`]=this.createHttpProvider(e)}),r}getHttpProvider(e){let t=this.httpProviders[e];if(typeof t>"u")throw Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){let r=this.createHttpProvider(e,t);r&&(this.httpProviders[e]=r)}createHttpProvider(e,t){let r=t||_P(e,this.namespace,this.client.core.projectId);if(!r)throw Error(`No RPC url provided for chainId: ${e}`);return new c$.r(new di.Z(r,_z("disableProviderPing")))}}var CO=Object.defineProperty,CM=Object.defineProperties,CP=Object.getOwnPropertyDescriptors,Cx=Object.getOwnPropertySymbols,CT=Object.prototype.hasOwnProperty,CD=Object.prototype.propertyIsEnumerable,CR=(e,t,r)=>t in e?CO(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ck=(e,t)=>{for(var r in t||(t={}))CT.call(t,r)&&CR(e,r,t[r]);if(Cx)for(var r of Cx(t))CD.call(t,r)&&CR(e,r,t[r]);return e},Cj=(e,t)=>CM(e,CP(t)),CL=(e,t,r)=>CR(e,"symbol"!=typeof t?t+"":t,r);class CU{constructor(e){CL(this,"client"),CL(this,"namespaces"),CL(this,"optionalNamespaces"),CL(this,"sessionProperties"),CL(this,"scopedProperties"),CL(this,"events",new(et())),CL(this,"rpcProviders",{}),CL(this,"session"),CL(this,"providerOpts"),CL(this,"logger"),CL(this,"uri"),CL(this,"disableProviderPing",!1),this.providerOpts=e,this.logger="u">typeof e?.logger&&"string"!=typeof e?.logger?e.logger:(0,e$.gw)((0,e$.jI)({level:e?.logger||_t})),this.disableProviderPing=e?.disableProviderPing||!1}static async init(e){let t=new CU(e);return await t.initialize(),t}async request(e,t,r){let[i,s]=this.validateChain(t);if(!this.session)throw Error("Please call connect() before request()");return await this.getProvider(i).request({request:Ck({},e),chainId:`${i}:${s}`,topic:this.session.topic,expiry:r})}sendAsync(e,t,r,i){let s=new Date().getTime();this.request(e,r,i).then(e=>t(null,(0,cq.formatJsonRpcResult)(s,e))).catch(e=>t(e,void 0))}async enable(){if(!this.client)throw Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw Error("Please call connect() before enable()");await this.client.disconnect({topic:null==(e=this.session)?void 0:e.topic,reason:wy("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,t){if(!this.client)throw Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();let{uri:r,response:i}=await this.client.authenticate(e,t);r&&(this.uri=r,this.events.emit("display_uri",r));let s=await i();if(this.session=s.session,this.session){let e=_j(this.session.namespaces);this.namespaces=_D(this.namespaces,e),await this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){let{uri:t,approval:r}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties,scopedProperties:this.scopedProperties});t&&(this.uri=t,this.events.emit("display_uri",t));let i=await r();this.session=i;let s=_j(i.namespaces);return this.namespaces=_D(this.namespaces,s),await this.persist("namespaces",this.namespaces),await this.persist("optionalNamespaces",this.optionalNamespaces),this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;let[r,i]=this.validateChain(e),s=this.getProvider(r);s.name===_s?s.setDefaultChain(`${r}:${i}`,t):s.setDefaultChain(i,t)}catch(e){if(!/Please call connect/.test(e.message))throw e}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");let t=this.client.pairing.getAll();if(wb(t)){for(let r of t)e.deletePairings?this.client.core.expirer.set(r.topic,0):await this.client.core.relayer.subscriber.unsubscribe(r.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.logger.warn("abortPairingAttempt is deprecated. This is now a no-op.")}async checkStorage(){this.namespaces=await this.getFromStore("namespaces")||{},this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.session&&this.createProviders()}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){var e,t;if(this.client=this.providerOpts.client||await I7.init({core:this.providerOpts.core,logger:this.providerOpts.logger||_t,relayUrl:this.providerOpts.relayUrl||"wss://relay.walletconnect.org",projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.providerOpts.session)try{this.session=this.client.session.get(this.providerOpts.session.topic)}catch(r){throw this.logger.error("Failed to get session",r),Error(`The provided session: ${null==(t=null==(e=this.providerOpts)?void 0:e.session)?void 0:t.topic} doesn't exist in the Sign client`)}else{let e=this.client.session.getAll();this.session=e[0]}this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw Error("Sign Client not initialized");if(!this.session)throw Error("Session not initialized. Please call connect() before enable()");let e=[...new Set(Object.keys(this.session.namespaces).map(e=>wd(e)))];_$("client",this.client),_$("events",this.events),_$("disableProviderPing",this.disableProviderPing),e.forEach(e=>{if(!this.session)return;let t=function(e,t){let r=Object.keys(t.namespaces).filter(t=>t.includes(e));if(!r.length)return[];let i=[];return r.forEach(e=>{let r=t.namespaces[e].accounts;i.push(...r)}),i}(e,this.session),r=_T(t),i=Cj(Ck({},_D(this.namespaces,this.optionalNamespaces)[e]),{accounts:t,chains:r});switch(e){case"eip155":this.rpcProviders[e]=new _1({namespace:i});break;case"algorand":this.rpcProviders[e]=new Ci({namespace:i});break;case"solana":this.rpcProviders[e]=new _4({namespace:i});break;case"cosmos":this.rpcProviders[e]=new _7({namespace:i});break;case"polkadot":this.rpcProviders[e]=new _H({namespace:i});break;case"cip34":this.rpcProviders[e]=new Ca({namespace:i});break;case"elrond":this.rpcProviders[e]=new Cu({namespace:i});break;case"multiversx":this.rpcProviders[e]=new Cg({namespace:i});break;case"near":this.rpcProviders[e]=new Cw({namespace:i});break;case"tezos":this.rpcProviders[e]=new C_({namespace:i});break;default:this.rpcProviders[_s]?this.rpcProviders[_s].updateNamespace(i):this.rpcProviders[_s]=new CA({namespace:i})}})}registerEventListeners(){if(typeof this.client>"u")throw Error("Sign Client is not initialized");this.client.on("session_ping",e=>{var t;let{topic:r}=e;r===(null==(t=this.session)?void 0:t.topic)&&this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{var t;let{params:r,topic:i}=e;if(i!==(null==(t=this.session)?void 0:t.topic))return;let{event:s}=r;if("accountsChanged"===s.name){let e=s.data;e&&wb(e)&&this.events.emit("accountsChanged",e.map(_k))}else if("chainChanged"===s.name){let e=r.chainId,t=r.event.data,i=wd(e),s=_L(e)!==_L(t)?`${i}:${_L(t)}`:e;this.onChainChanged(s)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var r,i;if(e!==(null==(r=this.session)?void 0:r.topic))return;let{namespaces:s}=t,n=null==(i=this.client)?void 0:i.session.get(e);this.session=Cj(Ck({},n),{namespaces:s}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{var t;e.topic===(null==(t=this.session)?void 0:t.topic)&&(await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Cj(Ck({},wy("USER_DISCONNECTED")),{data:e.topic})))}),this.on(_o,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[_s]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace(null==(t=this.session)?void 0:t.namespaces[e])})}setNamespaces(e){let{namespaces:t,optionalNamespaces:r,sessionProperties:i,scopedProperties:s}=e;t&&Object.keys(t).length&&(this.namespaces=t),r&&Object.keys(r).length&&(this.optionalNamespaces=r),this.sessionProperties=i,this.scopedProperties=s}validateChain(e){let[t,r]=e?.split(":")||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,r];if(t&&!Object.keys(this.namespaces||{}).map(e=>wd(e)).includes(t))throw Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&r)return[t,r];let i=wd(Object.keys(this.namespaces)[0]),s=this.rpcProviders[i].getDefaultChain();return[i,s]}async requestAccounts(){let[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}async onChainChanged(e,t=!1){if(!this.namespaces)return;let[r,i]=this.validateChain(e);i&&(t||this.getProvider(r).setDefaultChain(i),this.namespaces[r]?this.namespaces[r].defaultChain=i:this.namespaces[`${r}:${i}`]?this.namespaces[`${r}:${i}`].defaultChain=i:this.namespaces[`${r}:${i}`]={defaultChain:i},this.events.emit("chainChanged",i),await this.persist("namespaces",this.namespaces))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,await this.deleteFromStore("namespaces"),await this.deleteFromStore("optionalNamespaces"),await this.deleteFromStore("sessionProperties"),this.session=void 0,await this.cleanupPendingPairings({deletePairings:!0}),await this.cleanupStorage()}async persist(e,t){var r;let i=(null==(r=this.session)?void 0:r.topic)||"";await this.client.core.storage.setItem(`${_r}/${e}${i}`,t)}async getFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";return await this.client.core.storage.getItem(`${_r}/${e}${r}`)}async deleteFromStore(e){var t;let r=(null==(t=this.session)?void 0:t.topic)||"";await this.client.core.storage.removeItem(`${_r}/${e}${r}`)}async cleanupStorage(){var e;try{if((null==(e=this.client)?void 0:e.session.length)>0)return;for(let e of(await this.client.core.storage.getKeys()))e.startsWith(_r)&&await this.client.core.storage.removeItem(e)}catch(e){this.logger.warn("Failed to cleanup storage",e)}}}var Cz=r(44649);let C$={validateCaipAddress(e){if(e.split(":")?.length!==3)throw Error("Invalid CAIP Address");return e},parseCaipAddress(e){let t=e.split(":");if(3!==t.length)throw Error(`Invalid CAIP-10 address: ${e}`);let[r,i,s]=t;if(!r||!i||!s)throw Error(`Invalid CAIP-10 address: ${e}`);return{chainNamespace:r,chainId:i,address:s}},parseCaipNetworkId(e){let t=e.split(":");if(2!==t.length)throw Error(`Invalid CAIP-2 network id: ${e}`);let[r,i]=t;if(!r||!i)throw Error(`Invalid CAIP-2 network id: ${e}`);return{chainNamespace:r,chainId:i}}};var Cq=r(68903),CB=r(92144),CW=r(61704),CH=r(68584),CF=r(89512),CV=r(36801),CK=r(33085),CJ=r(55543);let CY={convertEVMChainIdToCoinType(e){if(e>=2147483648)throw Error("Invalid chainId");return(2147483648|e)>>>0}};var CG=r(86777);let CQ=(0,CK.sj)({suggestions:[],loading:!1}),CZ={state:CQ,subscribe:e=>(0,CK.Ld)(CQ,()=>e(CQ)),subscribeKey:(e,t)=>(0,CJ.VW)(CQ,e,t),async resolveName(e){try{return await CW.L.lookupEnsName(e)}catch(e){throw Error(e?.reasons?.[0]?.description||"Error resolving name")}},async isNameRegistered(e){try{return await CW.L.lookupEnsName(e),!0}catch{return!1}},async getSuggestions(e){try{CQ.loading=!0,CQ.suggestions=[];let t=await CW.L.getEnsNameSuggestions(e);return CQ.suggestions=t.suggestions.map(e=>({...e,name:e.name}))||[],CQ.suggestions}catch(e){throw Error(this.parseEnsApiError(e,"Error fetching name suggestions"))}finally{CQ.loading=!1}},async getNamesForAddress(e){try{if(!CB.R.state.activeCaipNetwork)return[];let t=CV.M.getEnsFromCacheForAddress(e);if(t)return t;let r=await CW.L.reverseLookupEnsName({address:e});return CV.M.updateEnsCache({address:e,ens:r,timestamp:Date.now()}),r}catch(e){throw Error(this.parseEnsApiError(e,"Error fetching names for address"))}},async registerName(e){let t=CB.R.state.activeCaipNetwork;if(!t)throw Error("Network not found");let r=CH.N.state.address,i=f7.ConnectorController.getAuthConnector();if(!r||!i)throw Error("Address or auth connector not found");CQ.loading=!0;try{let i=JSON.stringify({name:e,attributes:{},timestamp:Math.floor(Date.now()/1e3)});CG.RouterController.pushTransactionStack({view:"RegisterAccountNameSuccess",goBack:!1,replace:!0,onCancel(){CQ.loading=!1}});let s=await ge.ConnectionController.signMessage(i),n=t.id;if(!n)throw Error("Network not found");let o=CY.convertEVMChainIdToCoinType(Number(n));await CW.L.registerEnsName({coinType:o,address:r,signature:s,message:i}),CH.N.setProfileName(e,t.chainNamespace),CG.RouterController.replace("RegisterAccountNameSuccess")}catch(r){let t=this.parseEnsApiError(r,`Error registering name ${e}`);throw CG.RouterController.replace("RegisterAccountName"),Error(t)}finally{CQ.loading=!1}},validateName:e=>/^[a-zA-Z0-9-]{4,}$/u.test(e),parseEnsApiError:(e,t)=>e?.reasons?.[0]?.description||t};var CX=r(63043),C0=r(96986),C1=r(31929),C2=r(52005),C3=r(72723),C5=r(66909);r(46773),r(54946);var C4=r(70768),C8=r(30795);let C6={UniversalProviderErrors:{UNAUTHORIZED_DOMAIN_NOT_ALLOWED:{message:"Unauthorized: origin not allowed",alertErrorKey:"INVALID_APP_CONFIGURATION"},JWT_VALIDATION_ERROR:{message:"JWT validation error: JWT Token is not yet valid",alertErrorKey:"JWT_TOKEN_NOT_VALID"},INVALID_KEY:{message:"Unauthorized: invalid key",alertErrorKey:"INVALID_PROJECT_ID"}},ALERT_ERRORS:{SWITCH_NETWORK_NOT_FOUND:{shortMessage:"Network Not Found",longMessage:"Network not found - please make sure it is included in 'networks' array in createAppKit function"},INVALID_APP_CONFIGURATION:{shortMessage:"Invalid App Configuration",longMessage:()=>`Origin ${"undefined"!=typeof window?window.origin:"unknown"} not found on Allowlist - update configuration on cloud.reown.com`},SOCIALS_TIMEOUT:{shortMessage:"Invalid App Configuration",longMessage:()=>"There was an issue loading the embedded wallet. Please verify that your domain is allowed at cloud.reown.com"},JWT_TOKEN_NOT_VALID:{shortMessage:"Session Expired",longMessage:"Invalid session found on UniversalProvider - please check your time settings and connect again"},INVALID_PROJECT_ID:{shortMessage:"Invalid App Configuration",longMessage:"Invalid Project ID - update configuration"},PROJECT_ID_NOT_CONFIGURED:{shortMessage:"Project ID Not Configured",longMessage:"Project ID Not Configured - update configuration on cloud.reown.com"}}},C9=(e,t,r)=>JSON.stringify(e,(e,r)=>{let i="bigint"==typeof r?r.toString():r;return"function"==typeof t?t(e,i):i},r),C7="2.45.1",Se={getDocsUrl:({docsBaseUrl:e,docsPath:t="",docsSlug:r})=>t?`${e??"https://viem.sh"}${t}${r?`#${r}`:""}`:void 0,version:`viem@${C7}`};class St extends Error{constructor(e,t={}){let r=t.cause instanceof St?t.cause.details:t.cause?.message?t.cause.message:t.details,i=t.cause instanceof St&&t.cause.docsPath||t.docsPath,s=Se.getDocsUrl?.({...t,docsPath:i});super([e||"An error occurred.","",...t.metaMessages?[...t.metaMessages,""]:[],...s?[`Docs: ${s}`]:[],...r?[`Details: ${r}`]:[],...Se.version?[`Version: ${Se.version}`]:[]].join("\n"),t.cause?{cause:t.cause}:void 0),Object.defineProperty(this,"details",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"docsPath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metaMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shortMessage",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"version",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"BaseError"}),this.details=r,this.docsPath=i,this.metaMessages=t.metaMessages,this.name=t.name??this.name,this.shortMessage=e,this.version=C7}walk(e){return function e(t,r){return r?.(t)?t:t&&"object"==typeof t&&"cause"in t&&void 0!==t.cause?e(t.cause,r):r?null:t}(this,e)}}let Sr=e=>e;class Si extends St{constructor({body:e,cause:t,details:r,headers:i,status:s,url:n}){super("HTTP request failed.",{cause:t,details:r,metaMessages:[s&&`Status: ${s}`,`URL: ${Sr(n)}`,e&&`Request body: ${C9(e)}`].filter(Boolean),name:"HttpRequestError"}),Object.defineProperty(this,"body",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.body=e,this.headers=i,this.status=s,this.url=n}}class Ss extends St{constructor({body:e,error:t,url:r}){super("RPC Request failed.",{cause:t,details:t.message,metaMessages:[`URL: ${Sr(r)}`,`Request body: ${C9(e)}`],name:"RpcRequestError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.code=t.code,this.data=t.data,this.url=r}}class Sn extends St{constructor({body:e,url:t}){super("The request took too long to respond.",{details:"The request timed out.",metaMessages:[`URL: ${Sr(t)}`,`Request body: ${C9(e)}`],name:"TimeoutError"}),Object.defineProperty(this,"url",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.url=t}}class So extends St{constructor(){super("No URL was provided to the Transport. Please provide a valid RPC URL to the Transport.",{docsPath:"/docs/clients/intro",name:"UrlRequiredError"})}}let Sa=new Map,Sc={current:0,take(){return this.current++},reset(){this.current=0}};class Sl extends St{constructor(e,{code:t,docsPath:r,metaMessages:i,name:s,shortMessage:n}){super(n,{cause:e,docsPath:r,metaMessages:i||e?.metaMessages,name:s||"RpcError"}),Object.defineProperty(this,"code",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=s||e.name,this.code=e instanceof Ss?e.code:t??-1}}class Sh extends Sl{constructor(e,t){super(e,t),Object.defineProperty(this,"data",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.data=t.data}}class Su extends Sl{constructor(e){super(e,{code:Su.code,name:"ParseRpcError",shortMessage:"Invalid JSON was received by the server. An error occurred on the server while parsing the JSON text."})}}Object.defineProperty(Su,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32700});class Sd extends Sl{constructor(e){super(e,{code:Sd.code,name:"InvalidRequestRpcError",shortMessage:"JSON is not a valid request object."})}}Object.defineProperty(Sd,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32600});class Sp extends Sl{constructor(e,{method:t}={}){super(e,{code:Sp.code,name:"MethodNotFoundRpcError",shortMessage:`The method${t?` "${t}"`:""} does not exist / is not available.`})}}Object.defineProperty(Sp,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32601});class Sf extends Sl{constructor(e){super(e,{code:Sf.code,name:"InvalidParamsRpcError",shortMessage:"Invalid parameters were provided to the RPC method.\nDouble check you have provided the correct parameters."})}}Object.defineProperty(Sf,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32602});class Sg extends Sl{constructor(e){super(e,{code:Sg.code,name:"InternalRpcError",shortMessage:"An internal error was received."})}}Object.defineProperty(Sg,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32603});class Sm extends Sl{constructor(e){super(e,{code:Sm.code,name:"InvalidInputRpcError",shortMessage:"Missing or invalid parameters.\nDouble check you have provided the correct parameters."})}}Object.defineProperty(Sm,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32e3});class Sy extends Sl{constructor(e){super(e,{code:Sy.code,name:"ResourceNotFoundRpcError",shortMessage:"Requested resource not found."}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"ResourceNotFoundRpcError"})}}Object.defineProperty(Sy,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32001});class Sb extends Sl{constructor(e){super(e,{code:Sb.code,name:"ResourceUnavailableRpcError",shortMessage:"Requested resource not available."})}}Object.defineProperty(Sb,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32002});class Sw extends Sl{constructor(e){super(e,{code:Sw.code,name:"TransactionRejectedRpcError",shortMessage:"Transaction creation failed."})}}Object.defineProperty(Sw,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32003});class Sv extends Sl{constructor(e,{method:t}={}){super(e,{code:Sv.code,name:"MethodNotSupportedRpcError",shortMessage:`Method${t?` "${t}"`:""} is not supported.`})}}Object.defineProperty(Sv,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32004});class SE extends Sl{constructor(e){super(e,{code:SE.code,name:"LimitExceededRpcError",shortMessage:"Request exceeds defined limit."})}}Object.defineProperty(SE,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32005});class SI extends Sl{constructor(e){super(e,{code:SI.code,name:"JsonRpcVersionUnsupportedError",shortMessage:"Version of JSON-RPC protocol is not supported."})}}Object.defineProperty(SI,"code",{enumerable:!0,configurable:!0,writable:!0,value:-32006});class S_ extends Sh{constructor(e){super(e,{code:S_.code,name:"UserRejectedRequestError",shortMessage:"User rejected the request."})}}Object.defineProperty(S_,"code",{enumerable:!0,configurable:!0,writable:!0,value:4001});class SC extends Sh{constructor(e){super(e,{code:SC.code,name:"UnauthorizedProviderError",shortMessage:"The requested method and/or account has not been authorized by the user."})}}Object.defineProperty(SC,"code",{enumerable:!0,configurable:!0,writable:!0,value:4100});class SS extends Sh{constructor(e,{method:t}={}){super(e,{code:SS.code,name:"UnsupportedProviderMethodError",shortMessage:`The Provider does not support the requested method${t?` " ${t}"`:""}.`})}}Object.defineProperty(SS,"code",{enumerable:!0,configurable:!0,writable:!0,value:4200});class SN extends Sh{constructor(e){super(e,{code:SN.code,name:"ProviderDisconnectedError",shortMessage:"The Provider is disconnected from all chains."})}}Object.defineProperty(SN,"code",{enumerable:!0,configurable:!0,writable:!0,value:4900});class SA extends Sh{constructor(e){super(e,{code:SA.code,name:"ChainDisconnectedError",shortMessage:"The Provider is not connected to the requested chain."})}}Object.defineProperty(SA,"code",{enumerable:!0,configurable:!0,writable:!0,value:4901});class SO extends Sh{constructor(e){super(e,{code:SO.code,name:"SwitchChainError",shortMessage:"An error occurred when attempting to switch chain."})}}Object.defineProperty(SO,"code",{enumerable:!0,configurable:!0,writable:!0,value:4902});class SM extends Sh{constructor(e){super(e,{code:SM.code,name:"UnsupportedNonOptionalCapabilityError",shortMessage:"This Wallet does not support a capability that was not marked as optional."})}}Object.defineProperty(SM,"code",{enumerable:!0,configurable:!0,writable:!0,value:5700});class SP extends Sh{constructor(e){super(e,{code:SP.code,name:"UnsupportedChainIdError",shortMessage:"This Wallet does not support the requested chain ID."})}}Object.defineProperty(SP,"code",{enumerable:!0,configurable:!0,writable:!0,value:5710});class Sx extends Sh{constructor(e){super(e,{code:Sx.code,name:"DuplicateIdError",shortMessage:"There is already a bundle submitted with this ID."})}}Object.defineProperty(Sx,"code",{enumerable:!0,configurable:!0,writable:!0,value:5720});class ST extends Sh{constructor(e){super(e,{code:ST.code,name:"UnknownBundleIdError",shortMessage:"This bundle id is unknown / has not been submitted"})}}Object.defineProperty(ST,"code",{enumerable:!0,configurable:!0,writable:!0,value:5730});class SD extends Sh{constructor(e){super(e,{code:SD.code,name:"BundleTooLargeError",shortMessage:"The call bundle is too large for the Wallet to process."})}}Object.defineProperty(SD,"code",{enumerable:!0,configurable:!0,writable:!0,value:5740});class SR extends Sh{constructor(e){super(e,{code:SR.code,name:"AtomicReadyWalletRejectedUpgradeError",shortMessage:"The Wallet can support atomicity after an upgrade, but the user rejected the upgrade."})}}Object.defineProperty(SR,"code",{enumerable:!0,configurable:!0,writable:!0,value:5750});class Sk extends Sh{constructor(e){super(e,{code:Sk.code,name:"AtomicityNotSupportedError",shortMessage:"The wallet does not support atomic execution but the request requires it."})}}Object.defineProperty(Sk,"code",{enumerable:!0,configurable:!0,writable:!0,value:5760});class Sj extends Sl{constructor(e){super(e,{name:"UnknownRpcError",shortMessage:"An unknown RPC error occurred."})}}class SL extends St{constructor({max:e,min:t,signed:r,size:i,value:s}){super(`Number "${s}" is not in safe ${i?`${8*i}-bit ${r?"signed":"unsigned"} `:""}integer range ${e?`(${t} to ${e})`:`(above ${t})`}`,{name:"IntegerOutOfRangeError"})}}class SU extends St{constructor({givenSize:e,maxSize:t}){super(`Size cannot exceed ${t} bytes. Given size: ${e} bytes.`,{name:"SizeOverflowError"})}}class Sz extends St{constructor({size:e,targetSize:t,type:r}){super(`${r.charAt(0).toUpperCase()}${r.slice(1).toLowerCase()} size (${e}) exceeds padding size (${t}).`,{name:"SizeExceedsPaddingSizeError"})}}function S$(e,{dir:t,size:r=32}={}){return"string"==typeof e?function(e,{dir:t,size:r=32}={}){if(null===r)return e;let i=e.replace("0x","");if(i.length>2*r)throw new Sz({size:Math.ceil(i.length/2),targetSize:r,type:"hex"});return`0x${i["right"===t?"padEnd":"padStart"](2*r,"0")}`}(e,{dir:t,size:r}):function(e,{dir:t,size:r=32}={}){if(null===r)return e;if(e.length>r)throw new Sz({size:e.length,targetSize:r,type:"bytes"});let i=new Uint8Array(r);for(let s=0;s<r;s++){let n="right"===t;i[n?s:r-s-1]=e[n?s:e.length-s-1]}return i}(e,{dir:t,size:r})}function Sq(e){return!function(e,{strict:t=!0}={}){return!!e&&"string"==typeof e&&(t?/^0x[0-9a-fA-F]*$/.test(e):e.startsWith("0x"))}(e,{strict:!1})?e.length:Math.ceil((e.length-2)/2)}function SB(e,{size:t}){if(Sq(e)>t)throw new SU({givenSize:Sq(e),maxSize:t})}let SW=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function SH(e,t={}){return"number"==typeof e||"bigint"==typeof e?function(e,t={}){let r;let{signed:i,size:s}=t,n=BigInt(e);s?r=i?(1n<<8n*BigInt(s)-1n)-1n:2n**(8n*BigInt(s))-1n:"number"==typeof e&&(r=BigInt(Number.MAX_SAFE_INTEGER));let o="bigint"==typeof r&&i?-r-1n:0;if(r&&n>r||n<o){let t="bigint"==typeof e?"n":"";throw new SL({max:r?`${r}${t}`:void 0,min:`${o}${t}`,signed:i,size:s,value:`${e}${t}`})}let a=`0x${(i&&n<0?(1n<<BigInt(8*s))+BigInt(n):n).toString(16)}`;return s?S$(a,{size:s}):a}(e,t):"string"==typeof e?SK(e,t):"boolean"==typeof e?function(e,t={}){let r=`0x${Number(e)}`;return"number"==typeof t.size?(SB(r,{size:t.size}),S$(r,{size:t.size})):r}(e,t):SF(e,t)}function SF(e,t={}){let r="";for(let t=0;t<e.length;t++)r+=SW[e[t]];let i=`0x${r}`;return"number"==typeof t.size?(SB(i,{size:t.size}),S$(i,{dir:"right",size:t.size})):i}let SV=new TextEncoder;function SK(e,t={}){return SF(SV.encode(e),t)}class SJ extends Map{constructor(e){super(),Object.defineProperty(this,"maxSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxSize=e}get(e){let t=super.get(e);return super.has(e)&&void 0!==t&&(this.delete(e),super.set(e,t)),t}set(e,t){if(super.set(e,t),this.maxSize&&this.size>this.maxSize){let e=this.keys().next().value;e&&this.delete(e)}return this}}let SY=new SJ(8192);async function SG(e){return new Promise(t=>setTimeout(t,e))}let SQ=256;function SZ({key:e,methods:t,name:r,request:i,retryCount:n=3,retryDelay:o=150,timeout:a,type:c},l){return{config:{key:e,methods:t,name:r,request:i,retryCount:n,retryDelay:o,timeout:a,type:c},request:function(e,t={}){return async(r,i={})=>{let{dedupe:s=!1,methods:n,retryDelay:o=150,retryCount:a=3,uid:c}={...t,...i},{method:l}=r;if(n?.exclude?.includes(l)||n?.include&&!n.include.includes(l))throw new Sv(Error("method not supported"),{method:l});let h=s?SK(`${c}.${C9(r)}`):void 0;return function(e,{enabled:t=!0,id:r}){if(!t||!r)return e();if(SY.get(r))return SY.get(r);let i=e().finally(()=>SY.delete(r));return SY.set(r,i),i}(()=>(function(e,{delay:t=100,retryCount:r=2,shouldRetry:i=()=>!0}={}){return new Promise((s,n)=>{let o=async({count:a=0}={})=>{let c=async({error:e})=>{let r="function"==typeof t?t({count:a,error:e}):t;r&&await SG(r),o({count:a+1})};try{let t=await e();s(t)}catch(e){if(a<r&&await i({count:a,error:e}))return c({error:e});n(e)}};o()})})(async()=>{try{return await e(r)}catch(e){switch(e.code){case Su.code:throw new Su(e);case Sd.code:throw new Sd(e);case Sp.code:throw new Sp(e,{method:r.method});case Sf.code:throw new Sf(e);case Sg.code:throw new Sg(e);case Sm.code:throw new Sm(e);case Sy.code:throw new Sy(e);case Sb.code:throw new Sb(e);case Sw.code:throw new Sw(e);case Sv.code:throw new Sv(e,{method:r.method});case SE.code:throw new SE(e);case SI.code:throw new SI(e);case S_.code:throw new S_(e);case SC.code:throw new SC(e);case SS.code:throw new SS(e);case SN.code:throw new SN(e);case SA.code:throw new SA(e);case SO.code:throw new SO(e);case SM.code:throw new SM(e);case SP.code:throw new SP(e);case Sx.code:throw new Sx(e);case ST.code:throw new ST(e);case SD.code:throw new SD(e);case SR.code:throw new SR(e);case Sk.code:throw new Sk(e);case 5e3:throw new S_(e);default:if(e instanceof St)throw e;throw new Sj(e)}}},{delay:({count:e,error:t})=>{if(t&&t instanceof Si){let e=t?.headers?.get("Retry-After");if(e?.match(/\d/))return 1e3*Number.parseInt(e,10)}return~~(1<<e)*o},retryCount:a,shouldRetry:({error:e})=>"code"in e&&"number"==typeof e.code?-1===e.code||e.code===SE.code||e.code===Sg.code:!(e instanceof Si)||!e.status||403===e.status||408===e.status||413===e.status||429===e.status||500===e.status||502===e.status||503===e.status||504===e.status}),{enabled:s,id:h})}}(i,{methods:t,retryCount:n,retryDelay:o,uid:function(e=11){if(!s||SQ+e>512){s="",SQ=0;for(let e=0;e<256;e++)s+=(256+256*Math.random()|0).toString(16).substring(1)}return s.substring(SQ,SQ+++e)}()}),value:l}}function SX(e,t={}){let{batch:r,fetchFn:i,fetchOptions:s,key:n="http",methods:o,name:a="HTTP JSON-RPC",onFetchRequest:c,onFetchResponse:l,retryDelay:h,raw:u}=t;return({chain:d,retryCount:p,timeout:f})=>{let{batchSize:g=1e3,wait:m=0}="object"==typeof r?r:{},y=t.retryCount??p,b=f??t.timeout??1e4,w=e||d?.rpcUrls.default.http[0];if(!w)throw new So;let v=function(e,t={}){let{url:r,headers:i}=function(e){try{let t=new URL(e),r=(()=>{if(t.username){let e=`${decodeURIComponent(t.username)}:${decodeURIComponent(t.password)}`;return t.username="",t.password="",{url:t.toString(),headers:{Authorization:`Basic ${btoa(e)}`}}}})();return{url:t.toString(),...r}}catch{return{url:e}}}(e);return{async request(e){let{body:s,fetchFn:n=t.fetchFn??fetch,onRequest:o=t.onRequest,onResponse:a=t.onResponse,timeout:c=t.timeout??1e4}=e,l={...t.fetchOptions??{},...e.fetchOptions??{}},{headers:h,method:u,signal:d}=l;try{let e;let t=await function(e,{errorInstance:t=Error("timed out"),timeout:r,signal:i}){return new Promise((s,n)=>{(async()=>{let o;try{let a=new AbortController;r>0&&(o=setTimeout(()=>{i?a.abort():n(t)},r)),s(await e({signal:a?.signal||null}))}catch(e){e?.name==="AbortError"&&n(t),n(e)}finally{clearTimeout(o)}})()})}(async({signal:e})=>{let t={...l,body:Array.isArray(s)?C9(s.map(e=>({jsonrpc:"2.0",id:e.id??Sc.take(),...e}))):C9({jsonrpc:"2.0",id:s.id??Sc.take(),...s}),headers:{...i,"Content-Type":"application/json",...h},method:u||"POST",signal:d||(c>0?e:null)},a=new Request(r,t),p=await o?.(a,t)??{...t,url:r};return await n(p.url??r,p)},{errorInstance:new Sn({body:s,url:r}),timeout:c,signal:!0});if(a&&await a(t),t.headers.get("Content-Type")?.startsWith("application/json"))e=await t.json();else{e=await t.text();try{e=JSON.parse(e||"{}")}catch(r){if(t.ok)throw r;e={error:e}}}if(!t.ok)throw new Si({body:s,details:C9(e.error)||t.statusText,headers:t.headers,status:t.status,url:r});return e}catch(e){if(e instanceof Si||e instanceof Sn)throw e;throw new Si({body:s,cause:e,url:r})}}}}(w,{fetchFn:i,fetchOptions:s,onRequest:c,onResponse:l,timeout:b});return SZ({key:n,methods:o,name:a,async request({method:e,params:t}){let i={method:e,params:t},{schedule:s}=function({fn:e,id:t,shouldSplitBatch:r,wait:i=0,sort:s}){let n=async()=>{let t=c();o();let r=t.map(({args:e})=>e);0!==r.length&&e(r).then(e=>{s&&Array.isArray(e)&&e.sort(s);for(let r=0;r<t.length;r++){let{resolve:i}=t[r];i?.([e[r],e])}}).catch(e=>{for(let r=0;r<t.length;r++){let{reject:i}=t[r];i?.(e)}})},o=()=>Sa.delete(t),a=()=>c().map(({args:e})=>e),c=()=>Sa.get(t)||[],l=e=>Sa.set(t,[...c(),e]);return{flush:o,async schedule(e){let t,s;let{promise:o,resolve:h,reject:u}=(t=()=>void 0,s=()=>void 0,{promise:new Promise((e,r)=>{t=e,s=r}),resolve:t,reject:s});return(r?.([...a(),e])&&n(),c().length>0)?l({args:e,resolve:h,reject:u}):(l({args:e,resolve:h,reject:u}),setTimeout(n,i)),o}}}({id:w,wait:m,shouldSplitBatch:e=>e.length>g,fn:e=>v.request({body:e}),sort:(e,t)=>e.id-t.id}),n=async e=>r?s(e):[await v.request({body:e})],[{error:o,result:a}]=await n(i);if(u)return{error:o,result:a};if(o)throw new Ss({body:i,error:o,url:w});return a},retryCount:y,retryDelay:h,timeout:b,type:"http"},{fetchOptions:s,url:w})}}let S0={ether:-9,wei:9};var S1=r(39502);function S2(e,t="wei"){return(0,S1.b)(e,S0[t])}class S3 extends St{constructor({cause:e,message:t}={}){let r=t?.replace("execution reverted: ","")?.replace("execution reverted","");super(`Execution reverted ${r?`with reason: ${r}`:"for an unknown reason"}.`,{cause:e,name:"ExecutionRevertedError"})}}Object.defineProperty(S3,"code",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(S3,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/execution reverted|gas required exceeds allowance/});class S5 extends St{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${S2(t)} gwei`:""}) cannot be higher than the maximum allowed value (2^256-1).`,{cause:e,name:"FeeCapTooHighError"})}}Object.defineProperty(S5,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas higher than 2\^256-1|fee cap higher than 2\^256-1/});class S4 extends St{constructor({cause:e,maxFeePerGas:t}={}){super(`The fee cap (\`maxFeePerGas\`${t?` = ${S2(t)}`:""} gwei) cannot be lower than the block base fee.`,{cause:e,name:"FeeCapTooLowError"})}}Object.defineProperty(S4,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max fee per gas less than block base fee|fee cap less than block base fee|transaction is outdated/});class S8 extends St{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is higher than the next one expected.`,{cause:e,name:"NonceTooHighError"})}}Object.defineProperty(S8,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too high/});class S6 extends St{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}is lower than the current nonce of the account.
Try increasing the nonce or find the latest nonce with \`getTransactionCount\`.`,{cause:e,name:"NonceTooLowError"})}}Object.defineProperty(S6,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce too low|transaction already imported|already known/});class S9 extends St{constructor({cause:e,nonce:t}={}){super(`Nonce provided for the transaction ${t?`(${t}) `:""}exceeds the maximum allowed nonce.`,{cause:e,name:"NonceMaxValueError"})}}Object.defineProperty(S9,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/nonce has max value/});class S7 extends St{constructor({cause:e}={}){super("The total cost (gas * gas fee + value) of executing this transaction exceeds the balance of the account.",{cause:e,metaMessages:["This error could arise when the account does not have enough funds to:"," - pay for the total gas fee,"," - pay for the value to send."," ","The cost of the transaction is calculated as `gas * gas fee + value`, where:"," - `gas` is the amount of gas needed for transaction to execute,"," - `gas fee` is the gas fee,"," - `value` is the amount of ether to send to the recipient."],name:"InsufficientFundsError"})}}Object.defineProperty(S7,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/insufficient funds|exceeds transaction sender account balance/});class Ne extends St{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction exceeds the limit allowed for the block.`,{cause:e,name:"IntrinsicGasTooHighError"})}}Object.defineProperty(Ne,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too high|gas limit reached/});class Nt extends St{constructor({cause:e,gas:t}={}){super(`The amount of gas ${t?`(${t}) `:""}provided for the transaction is too low.`,{cause:e,name:"IntrinsicGasTooLowError"})}}Object.defineProperty(Nt,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/intrinsic gas too low/});class Nr extends St{constructor({cause:e}){super("The transaction type is not supported for this chain.",{cause:e,name:"TransactionTypeNotSupportedError"})}}Object.defineProperty(Nr,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/transaction type not valid/});class Ni extends St{constructor({cause:e,maxPriorityFeePerGas:t,maxFeePerGas:r}={}){super(`The provided tip (\`maxPriorityFeePerGas\`${t?` = ${S2(t)} gwei`:""}) cannot be higher than the fee cap (\`maxFeePerGas\`${r?` = ${S2(r)} gwei`:""}).`,{cause:e,name:"TipAboveFeeCapError"})}}function Ns(e,t={}){let{key:r="fallback",name:i="Fallback",rank:s=!1,shouldThrow:n=Nn,retryCount:o,retryDelay:a}=t;return({chain:t,pollingInterval:c=4e3,timeout:l,...h})=>{let u=e,d=()=>{},p=SZ({key:r,name:i,async request({method:e,params:r}){let i;let s=async(o=0)=>{let a=u[o]({...h,chain:t,retryCount:0,timeout:l});try{let t=await a.request({method:e,params:r});return d({method:e,params:r,response:t,transport:a,status:"success"}),t}catch(c){if(d({error:c,method:e,params:r,transport:a,status:"error"}),n(c)||o===u.length-1||!(i??=u.slice(o+1).some(r=>{let{include:i,exclude:s}=r({chain:t}).config.methods||{};return i?i.includes(e):!s||!s.includes(e)})))throw c;return s(o+1)}};return s()},retryCount:o,retryDelay:a,type:"fallback"},{onResponse:e=>d=e,transports:u.map(e=>e({chain:t,retryCount:0}))});if(s){let e="object"==typeof s?s:{};!function({chain:e,interval:t=4e3,onTransports:r,ping:i,sampleCount:s=10,timeout:n=1e3,transports:o,weights:a={}}){let{stability:c=.7,latency:l=.3}=a,h=[],u=async()=>{let a=await Promise.all(o.map(async t=>{let r,s;let o=t({chain:e,retryCount:0,timeout:n}),a=Date.now();try{await (i?i({transport:o}):o.request({method:"net_listening"})),s=1}catch{s=0}finally{r=Date.now()}return{latency:r-a,success:s}}));h.push(a),h.length>s&&h.shift();let d=Math.max(...h.map(e=>Math.max(...e.map(({latency:e})=>e))));r(o.map((e,t)=>{let r=h.map(e=>e[t].latency),i=r.reduce((e,t)=>e+t,0)/r.length,s=h.map(e=>e[t].success),n=s.reduce((e,t)=>e+t,0)/s.length;return 0===n?[0,t]:[l*(1-i/d)+c*n,t]}).sort((e,t)=>t[0]-e[0]).map(([,e])=>o[e])),await SG(t),u()};u()}({chain:t,interval:e.interval??c,onTransports:e=>u=e,ping:e.ping,sampleCount:e.sampleCount,timeout:e.timeout,transports:u,weights:e.weights})}return p}}function Nn(e){return!!("code"in e&&"number"==typeof e.code&&(e.code===Sw.code||e.code===S_.code||S3.nodeMessage.test(e.message)||5e3===e.code))}Object.defineProperty(Ni,"nodeMessage",{enumerable:!0,configurable:!0,writable:!0,value:/max priority fee per gas higher than max fee per gas|tip higher than fee cap/});var No=r(88578);Cz.b.CONNECTOR_ID.COINBASE,Cz.b.CONNECTOR_ID.COINBASE_SDK,Cz.b.CONNECTOR_ID.SAFE,Cz.b.CONNECTOR_ID.LEDGER,Cz.b.CONNECTOR_ID.OKX,No.b.METMASK_CONNECTOR_NAME,No.b.TRUST_CONNECTOR_NAME,No.b.SOLFLARE_CONNECTOR_NAME,No.b.PHANTOM_CONNECTOR_NAME,No.b.COIN98_CONNECTOR_NAME,No.b.MAGIC_EDEN_CONNECTOR_NAME,No.b.BACKPACK_CONNECTOR_NAME,No.b.BITGET_CONNECTOR_NAME,No.b.FRONTIER_CONNECTOR_NAME,No.b.XVERSE_CONNECTOR_NAME,No.b.LEATHER_CONNECTOR_NAME;let Na={1:"ba0ba0cd-17c6-4806-ad93-f9d174f17900",42161:"3bff954d-5cb0-47a0-9a23-d20192e74600",43114:"30c46e53-e989-45fb-4549-be3bd4eb3b00",56:"93564157-2e8e-4ce7-81df-b264dbee9b00",250:"06b26297-fe0c-4733-5d6b-ffa5498aac00",10:"ab9c186a-c52f-464b-2906-ca59d760a400",137:"41d04d42-da3b-4453-8506-668cc0727900",5e3:"e86fae9b-b770-4eea-e520-150e12c81100",295:"6a97d510-cac8-4e58-c7ce-e8681b044c00",11155111:"e909ea0a-f92a-4512-c8fc-748044ea6800",84532:"a18a7ecd-e307-4360-4746-283182228e00",1301:"4eeea7ef-0014-4649-5d1d-07271a80f600",130:"2257980a-3463-48c6-cbac-a42d2a956e00",10143:"0a728e83-bacb-46db-7844-948f05434900",100:"02b53f6a-e3d4-479e-1cb4-21178987d100",9001:"f926ff41-260d-4028-635e-91913fc28e00",324:"b310f07f-4ef7-49f3-7073-2a0a39685800",314:"5a73b3dd-af74-424e-cae0-0de859ee9400",4689:"34e68754-e536-40da-c153-6ef2e7188a00",1088:"3897a66d-40b9-4833-162f-a2c90531c900",1284:"161038da-44ae-4ec7-1208-0ea569454b00",1285:"f1d73bb6-5450-4e18-38f7-fb6484264a00",7777777:"845c60df-d429-4991-e687-91ae45791600",42220:"ab781bbc-ccc6-418d-d32d-789b15da1f00",8453:"7289c336-3981-4081-c5f4-efc26ac64a00",1313161554:"3ff73439-a619-4894-9262-4470c773a100",2020:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",2021:"b8101fc0-9c19-4b6f-ec65-f6dfff106e00",80094:"e329c2c9-59b0-4a02-83e4-212ff3779900","5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp":"a1b58899-f671-4276-6a5e-56ca5bd59700","4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z":"a1b58899-f671-4276-6a5e-56ca5bd59700",EtWTRABZaYq6iMfeYKouRu166VU2xqa1:"a1b58899-f671-4276-6a5e-56ca5bd59700","000000000019d6689c085ae165831e93":"0b4838db-0161-4ffe-022d-532bf03dba00","000000000933ea01ad0ee984209779ba":"39354064-d79b-420b-065d-f980c4b78200"},Nc={[Cz.b.CONNECTOR_ID.COINBASE]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[Cz.b.CONNECTOR_ID.COINBASE_SDK]:"0c2840c3-5b04-4c44-9661-fbd4b49e1800",[Cz.b.CONNECTOR_ID.SAFE]:"461db637-8616-43ce-035a-d89b8a1d5800",[Cz.b.CONNECTOR_ID.LEDGER]:"54a1aa77-d202-4f8d-0fb2-5d2bb6db0300",[Cz.b.CONNECTOR_ID.WALLET_CONNECT]:"ef1a1fcf-7fe8-4d69-bd6d-fda1345b4400",[Cz.b.CONNECTOR_ID.INJECTED]:"07ba87ed-43aa-4adf-4540-9e6a2b9cae00"},Nl={[Cz.b.CONNECTOR_ID.INJECTED]:"Browser Wallet",[Cz.b.CONNECTOR_ID.WALLET_CONNECT]:"WalletConnect",[Cz.b.CONNECTOR_ID.COINBASE]:"Coinbase",[Cz.b.CONNECTOR_ID.COINBASE_SDK]:"Coinbase",[Cz.b.CONNECTOR_ID.LEDGER]:"Ledger",[Cz.b.CONNECTOR_ID.SAFE]:"Safe"},Nh=(Cz.b.CONNECTOR_ID.INJECTED,Cz.b.CONNECTOR_ID.WALLET_CONNECT,Cz.b.CONNECTOR_ID.EIP6963,Cz.b.CONNECTOR_ID.AUTH,["near:mainnet","solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp","eip155:1101","eip155:56","eip155:42161","eip155:7777777","eip155:59144","eip155:324","solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1","eip155:5000","solana:4sgjmw1sunhzsxgspuhpqldx6wiyjntz","eip155:80084","eip155:5003","eip155:100","eip155:8453","eip155:42220","eip155:1313161555","eip155:17000","eip155:1","eip155:300","eip155:1313161554","eip155:1329","eip155:84532","eip155:421614","eip155:11155111","eip155:8217","eip155:43114","solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z","eip155:999999999","eip155:11155420","eip155:80002","eip155:97","eip155:43113","eip155:137","eip155:10","eip155:1301","bip122:000000000019d6689c085ae165831e93","bip122:000000000933ea01ad0ee984209779ba"]),Nu={extendRpcUrlWithProjectId(e,t){let r=!1;try{r="rpc.walletconnect.org"===new URL(e).host}catch(e){r=!1}if(r){let r=new URL(e);return r.searchParams.has("projectId")||r.searchParams.set("projectId",t),r.toString()}return e},isCaipNetwork:e=>"chainNamespace"in e&&"caipNetworkId"in e,getChainNamespace(e){return this.isCaipNetwork(e)?e.chainNamespace:Cz.b.CHAIN.EVM},getCaipNetworkId(e){return this.isCaipNetwork(e)?e.caipNetworkId:`${Cz.b.CHAIN.EVM}:${e.id}`},getDefaultRpcUrl(e,t,r){let i=e.rpcUrls?.default?.http?.[0];return Nh.includes(t)?function(e,t){let r=new URL("https://rpc.walletconnect.org/v1/");return r.searchParams.set("chainId",e),r.searchParams.set("projectId",t),r.toString()}(t,r):i||""},extendCaipNetwork(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:i}){let s=this.getChainNamespace(e),n=this.getCaipNetworkId(e),o=e.rpcUrls.default.http?.[0],a=this.getDefaultRpcUrl(e,n,r),c=e?.rpcUrls?.chainDefault?.http?.[0]||o,l=i?.[n]?.map(e=>e.url)||[],h=[...l,a],u=[...l];return c&&!u.includes(c)&&u.push(c),{...e,chainNamespace:s,caipNetworkId:n,assets:{imageId:Na[e.id],imageUrl:t?.[e.id]},rpcUrls:{...e.rpcUrls,default:{http:h},chainDefault:{http:u}}}},extendCaipNetworks:(e,{customNetworkImageUrls:t,projectId:r,customRpcUrls:i})=>e.map(e=>Nu.extendCaipNetwork(e,{customNetworkImageUrls:t,customRpcUrls:i,projectId:r})),getViemTransport(e,t,r){let i=[];if(r?.forEach(e=>{i.push(SX(e.url,e.config))}),Nh.includes(e.caipNetworkId)){let r=this.getDefaultRpcUrl(e,e.caipNetworkId,t);i.push(SX(r,{fetchOptions:{headers:{"Content-Type":"text/plain"}}}))}return Ns(i)},extendWagmiTransports(e,t,r){return Nh.includes(e.caipNetworkId)?Ns([r,SX(this.getDefaultRpcUrl(e,e.caipNetworkId,t))]):r},getUnsupportedNetwork:e=>({id:e.split(":")[1],caipNetworkId:e,name:Cz.b.UNSUPPORTED_NETWORK_NAME,chainNamespace:e.split(":")[0],nativeCurrency:{name:"",decimals:0,symbol:""},rpcUrls:{default:{http:[]}}}),getCaipNetworkFromStorage(e){let t=CV.M.getActiveCaipNetworkId(),r=CB.R.getAllRequestedCaipNetworks(),i=Array.from(CB.R.state.chains?.keys()||[]),s=t?.split(":")[0],n=!!s&&i.includes(s),o=r?.find(e=>e.caipNetworkId===t);return n&&!o&&t?this.getUnsupportedNetwork(t):o||e||r?.[0]}};var Nd=r(54090);let Np={createLogger(e,t="error"){let r=(0,e$.jI)({level:t}),{logger:i}=(0,e$.Rt)({opts:r});return i.error=(...t)=>{for(let r of t)if(r instanceof Error){e(r,...t);return}e(void 0,...t)},i}},Nf={eip155:void 0,solana:void 0,polkadot:void 0,bip122:void 0},Ng=(0,CK.sj)({providers:{...Nf},providerIds:{...Nf}}),Nm={state:Ng,subscribeKey:(e,t)=>(0,CJ.VW)(Ng,e,t),subscribe:e=>(0,CK.Ld)(Ng,()=>{e(Ng)}),subscribeProviders:e=>(0,CK.Ld)(Ng.providers,()=>e(Ng.providers)),setProvider(e,t){t&&(Ng.providers[e]=(0,CK.iH)(t))},getProvider:e=>Ng.providers[e],setProviderId(e,t){t&&(Ng.providerIds[e]=t)},getProviderId(e){if(e)return Ng.providerIds[e]},reset(){Ng.providers={...Nf},Ng.providerIds={...Nf}},resetChain(e){Ng.providers[e]=void 0,Ng.providerIds[e]=void 0}};var Ny=r(59712),Nb=r(41505);let Nw={ERROR_CODE_UNRECOGNIZED_CHAIN_ID:4902,ERROR_CODE_DEFAULT:5e3,ERROR_INVALID_CHAIN_ID:32603};function Nv(e){return{formatters:void 0,fees:void 0,serializers:void 0,...e}}let NE=Nv({id:"5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",name:"Solana",network:"solana-mainnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!1,chainNamespace:"solana",caipNetworkId:"solana:5eykt4UsFv8P8NJdTREpY1vzqKqZKvdp",deprecatedCaipNetworkId:"solana:4sGjMW1sUnHzSxGspuhpqLDx6wiyjNtZ"}),NI=Nv({id:"EtWTRABZaYq6iMfeYKouRu166VU2xqa1",name:"Solana Devnet",network:"solana-devnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:EtWTRABZaYq6iMfeYKouRu166VU2xqa1",deprecatedCaipNetworkId:"solana:8E9rvCKLFQia2Y35HXjjpWzj8weVo44K"}),N_=Nv({id:"4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z",name:"Solana Testnet",network:"solana-testnet",nativeCurrency:{name:"Solana",symbol:"SOL",decimals:9},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},blockExplorers:{default:{name:"Solscan",url:"https://solscan.io"}},testnet:!0,chainNamespace:"solana",caipNetworkId:"solana:4uhcVJyU9pJkvQyS88uRDiswHXSCkY3z"});Nv({id:"000000000019d6689c085ae165831e93",caipNetworkId:"bip122:000000000019d6689c085ae165831e93",chainNamespace:"bip122",name:"Bitcoin",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}}}),Nv({id:"000000000933ea01ad0ee984209779ba",caipNetworkId:"bip122:000000000933ea01ad0ee984209779ba",chainNamespace:"bip122",name:"Bitcoin Testnet",nativeCurrency:{name:"Bitcoin",symbol:"BTC",decimals:8},rpcUrls:{default:{http:["https://rpc.walletconnect.org/v1"]}},testnet:!0});let NC={solana:["solana_signMessage","solana_signTransaction","solana_requestAccounts","solana_getAccounts","solana_signAllTransactions","solana_signAndSendTransaction"],eip155:["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_showCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"],bip122:["sendTransfer","signMessage","signPsbt","getAccountAddresses"]},NS={getMethodsByChainNamespace:e=>NC[e]||[],createDefaultNamespace(e){return{methods:this.getMethodsByChainNamespace(e),events:["accountsChanged","chainChanged"],chains:[],rpcMap:{}}},applyNamespaceOverrides(e,t){if(!t)return{...e};let r={...e},i=new Set;if(t.methods&&Object.keys(t.methods).forEach(e=>i.add(e)),t.chains&&Object.keys(t.chains).forEach(e=>i.add(e)),t.events&&Object.keys(t.events).forEach(e=>i.add(e)),t.rpcMap&&Object.keys(t.rpcMap).forEach(e=>{let[t]=e.split(":");t&&i.add(t)}),i.forEach(e=>{r[e]||(r[e]=this.createDefaultNamespace(e))}),t.methods&&Object.entries(t.methods).forEach(([e,t])=>{r[e]&&(r[e].methods=t)}),t.chains&&Object.entries(t.chains).forEach(([e,t])=>{r[e]&&(r[e].chains=t)}),t.events&&Object.entries(t.events).forEach(([e,t])=>{r[e]&&(r[e].events=t)}),t.rpcMap){let e=new Set;Object.entries(t.rpcMap).forEach(([t,i])=>{let[s,n]=t.split(":");s&&n&&r[s]&&(r[s].rpcMap||(r[s].rpcMap={}),e.has(s)||(r[s].rpcMap={},e.add(s)),r[s].rpcMap[n]=i)})}return r},createNamespaces(e,t){let r=e.reduce((e,t)=>{let{id:r,chainNamespace:i,rpcUrls:s}=t,n=s.default.http[0];e[i]||(e[i]=this.createDefaultNamespace(i));let o=`${i}:${r}`,a=e[i];switch(a.chains.push(o),o){case NE.caipNetworkId:a.chains.push(NE.deprecatedCaipNetworkId);break;case NI.caipNetworkId:a.chains.push(NI.deprecatedCaipNetworkId)}return a?.rpcMap&&n&&(a.rpcMap[r]=n),e},{});return this.applyNamespaceOverrides(r,t)},resolveReownName:async e=>{let t=await CZ.resolveName(e),r=Object.values(t?.addresses)||[];return r[0]?.address||!1},getChainsFromNamespaces:(e={})=>Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let[t,r]=e.split(":");return`${t}:${r}`})]))),isSessionEventData:e=>"object"==typeof e&&null!==e&&"id"in e&&"topic"in e&&"params"in e&&"object"==typeof e.params&&null!==e.params&&"chainId"in e.params&&"event"in e.params&&"object"==typeof e.params.event&&null!==e.params.event};class NN{constructor({provider:e,caipNetworks:t,namespace:r}){this.id=Cz.b.CONNECTOR_ID.WALLET_CONNECT,this.name=Nl[Cz.b.CONNECTOR_ID.WALLET_CONNECT],this.type="WALLET_CONNECT",this.imageId=Nc[Cz.b.CONNECTOR_ID.WALLET_CONNECT],this.caipNetworks=t,this.provider=e,this.chain=r}get chains(){return this.caipNetworks}async connectWalletConnect(){if(!await this.authenticate()){let e=gr.OptionsController.state.universalProviderConfigOverride,t=NS.createNamespaces(this.caipNetworks,e);await this.provider.connect({optionalNamespaces:t})}return{clientId:await this.provider.client.core.crypto.getClientId(),session:this.provider.session}}async disconnect(){await this.provider.disconnect()}async authenticate(){let e=this.chains.map(e=>e.caipNetworkId);return Nb.w.universalProviderAuthenticate({universalProvider:this.provider,chains:e,methods:NA})}}let NA=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_getCallsStatus","wallet_sendCalls","wallet_getCapabilities","wallet_grantPermissions","wallet_revokePermissions","wallet_getAssets"];class NO{constructor(e){this.availableConnectors=[],this.eventListeners=new Map,e&&this.construct(e)}construct(e){this.caipNetworks=e.networks,this.projectId=e.projectId,this.namespace=e.namespace,this.adapterType=e.adapterType}get connectors(){return this.availableConnectors}get networks(){return this.caipNetworks||[]}setAuthProvider(e){this.addConnector({id:Cz.b.CONNECTOR_ID.AUTH,type:"AUTH",name:Cz.b.CONNECTOR_NAMES.AUTH,provider:e,imageId:Nc[Cz.b.CONNECTOR_ID.AUTH],chain:this.namespace,chains:[]})}addConnector(...e){let t=new Set;this.availableConnectors=[...e,...this.availableConnectors].filter(e=>!t.has(e.id)&&(t.add(e.id),!0)),this.emit("connectors",this.availableConnectors)}setStatus(e,t){CH.N.setStatus(e,t)}on(e,t){this.eventListeners.has(e)||this.eventListeners.set(e,new Set),this.eventListeners.get(e)?.add(t)}off(e,t){let r=this.eventListeners.get(e);r&&r.delete(t)}removeAllEventListeners(){this.eventListeners.forEach(e=>{e.clear()})}emit(e,t){let r=this.eventListeners.get(e);r&&r.forEach(e=>e(t))}async connectWalletConnect(e){let t=this.getWalletConnectConnector();return{clientId:(await t.connectWalletConnect()).clientId}}async switchNetwork(e){let{caipNetwork:t,providerType:r}=e;if(!e.provider)return;let i="provider"in e.provider?e.provider.provider:e.provider;if("WALLET_CONNECT"===r){i.setDefaultChain(t.caipNetworkId);return}if(i&&"AUTH"===r){await i.switchNetwork(t.caipNetworkId);let e=await i.getUser({chainId:t.caipNetworkId,preferredAccountType:gr.OptionsController.state.defaultAccountTypes[t.chainNamespace]});this.emit("switchNetwork",e)}}getWalletConnectConnector(){let e=this.connectors.find(e=>e instanceof NN);if(!e)throw Error("WalletConnectConnector not found");return e}}class NM extends NO{setUniversalProvider(e){this.addConnector(new NN({provider:e,caipNetworks:this.caipNetworks||[],namespace:this.namespace}))}async connect(e){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:Number(e.chainId),provider:this.provider,address:""})}async disconnect(){try{let e=this.getWalletConnectConnector();await e.disconnect()}catch(e){console.warn("UniversalAdapter:disconnect - error",e)}}async getAccounts({namespace:e}){let t=this.provider;return Promise.resolve({accounts:(t?.session?.namespaces?.[e]?.accounts?.map(e=>{let[,,t]=e.split(":");return t}).filter((e,t,r)=>r.indexOf(e)===t)||[]).map(t=>gt.j.createAccount(e,t,"bip122"===e?"payment":"eoa"))})}async syncConnectors(){return Promise.resolve()}async getBalance(e){if(!(e.caipNetwork&&Ny.bq.BALANCE_SUPPORTED_CHAINS.includes(e.caipNetwork?.chainNamespace))||e.caipNetwork?.testnet)return{balance:"0.00",symbol:e.caipNetwork?.nativeCurrency.symbol||""};if(CH.N.state.balanceLoading&&e.chainId===CB.R.state.activeCaipNetwork?.id)return{balance:CH.N.state.balance||"0.00",symbol:CH.N.state.balanceSymbol||""};let t=(await CH.N.fetchTokenBalance()).find(t=>t.chainId===`${e.caipNetwork?.chainNamespace}:${e.chainId}`&&t.symbol===e.caipNetwork?.nativeCurrency.symbol);return{balance:t?.quantity.numeric||"0.00",symbol:t?.symbol||e.caipNetwork?.nativeCurrency.symbol||""}}async signMessage(e){let{provider:t,message:r,address:i}=e;if(!t)throw Error("UniversalAdapter:signMessage - provider is undefined");return{signature:CB.R.state.activeCaipNetwork?.chainNamespace===Cz.b.CHAIN.SOLANA?(await t.request({method:"solana_signMessage",params:{message:mM.encode(new TextEncoder().encode(r)),pubkey:i}},CB.R.state.activeCaipNetwork?.caipNetworkId)).signature:await t.request({method:"personal_sign",params:[r,i]},CB.R.state.activeCaipNetwork?.caipNetworkId)}}async estimateGas(){return Promise.resolve({gas:BigInt(0)})}async getProfile(){return Promise.resolve({profileImage:"",profileName:""})}async sendTransaction(){return Promise.resolve({hash:""})}walletGetAssets(e){return Promise.resolve({})}async writeContract(){return Promise.resolve({hash:""})}async getEnsAddress(){return Promise.resolve({address:!1})}parseUnits(){return 0n}formatUnits(){return"0"}async getCapabilities(){return Promise.resolve({})}async grantPermissions(){return Promise.resolve({})}async revokePermissions(){return Promise.resolve("0x")}async syncConnection(){return Promise.resolve({id:"WALLET_CONNECT",type:"WALLET_CONNECT",chainId:1,provider:this.provider,address:""})}async switchNetwork(e){let{caipNetwork:t}=e,r=this.getWalletConnectConnector();if(t.chainNamespace===Cz.b.CHAIN.EVM)try{await r.provider?.request({method:"wallet_switchEthereumChain",params:[{chainId:SH(t.id)}]})}catch(e){if(e.code===Nw.ERROR_CODE_UNRECOGNIZED_CHAIN_ID||e.code===Nw.ERROR_INVALID_CHAIN_ID||e.code===Nw.ERROR_CODE_DEFAULT||e?.data?.originalError?.code===Nw.ERROR_CODE_UNRECOGNIZED_CHAIN_ID)try{await r.provider?.request({method:"wallet_addEthereumChain",params:[{chainId:SH(t.id),rpcUrls:[t?.rpcUrls.chainDefault?.http],chainName:t.name,nativeCurrency:t.nativeCurrency,blockExplorerUrls:[t.blockExplorers?.default.url]}]})}catch(e){throw Error("Chain is not supported")}}r.provider.setDefaultChain(t.caipNetworkId)}getWalletConnectProvider(){let e=this.connectors.find(e=>"WALLET_CONNECT"===e.type);return e?.provider}}class NP{constructor(e){this.hasSwitchedToPreferredAccountTypeOnConnect=!1,this.chainNamespaces=[],this.reportedAlertErrors={},this.getCaipNetwork=e=>e?CB.R.getNetworkData(e)?.caipNetwork||CB.R.getRequestedCaipNetworks(e).filter(t=>t.chainNamespace===e)?.[0]:CB.R.state.activeCaipNetwork||this.defaultCaipNetwork,this.getCaipNetworkId=()=>{let e=this.getCaipNetwork();if(e)return e.id},this.getCaipNetworks=e=>CB.R.getRequestedCaipNetworks(e),this.getActiveChainNamespace=()=>CB.R.state.activeChain,this.setRequestedCaipNetworks=(e,t)=>{CB.R.setRequestedCaipNetworks(e,t)},this.getApprovedCaipNetworkIds=()=>CB.R.getAllApprovedCaipNetworkIds(),this.getCaipAddress=e=>CB.R.state.activeChain!==e&&e?CB.R.getAccountProp("caipAddress",e):CB.R.state.activeCaipAddress,this.setClientId=e=>{CW.L.setClientId(e)},this.getProvider=e=>Nm.getProvider(e),this.getProviderType=e=>Nm.getProviderId(e),this.getPreferredAccountType=()=>CH.N.state.preferredAccountType,this.setCaipAddress=(e,t)=>{CH.N.setCaipAddress(e,t)},this.setBalance=(e,t,r)=>{CH.N.setBalance(e,t,r)},this.setProfileName=(e,t)=>{CH.N.setProfileName(e,t)},this.setProfileImage=(e,t)=>{CH.N.setProfileImage(e,t)},this.setUser=(e,t)=>{CH.N.setUser(e,t),gr.OptionsController.state.enableEmbedded&&CF.I.close()},this.resetAccount=e=>{CH.N.resetAccount(e)},this.setCaipNetwork=e=>{CB.R.setActiveCaipNetwork(e)},this.setCaipNetworkOfNamespace=(e,t)=>{CB.R.setChainNetworkData(t,{caipNetwork:e})},this.setAllAccounts=(e,t)=>{CH.N.setAllAccounts(e,t),gr.OptionsController.setHasMultipleAddresses(e?.length>1)},this.setStatus=(e,t)=>{CH.N.setStatus(e,t),f7.ConnectorController.isConnected()?CV.M.setConnectionStatus("connected"):CV.M.setConnectionStatus("disconnected")},this.getAddressByChainNamespace=e=>CB.R.getAccountProp("address",e),this.setConnectors=e=>{let t=[...f7.ConnectorController.getConnectors(),...e];f7.ConnectorController.setConnectors(t)},this.fetchIdentity=e=>CW.L.fetchIdentity(e),this.getReownName=e=>CZ.getNamesForAddress(e),this.getConnectors=()=>f7.ConnectorController.getConnectors(),this.getConnectorImage=e=>CX.f.getConnectorImage(e),this.setConnectedWalletInfo=(e,t)=>{let r=Nm.getProviderId(t),i=e?{...e,type:r}:void 0;CH.N.setConnectedWalletInfo(i,t)},this.getIsConnectedState=()=>!!CB.R.state.activeCaipAddress,this.addAddressLabel=(e,t,r)=>{CH.N.addAddressLabel(e,t,r)},this.removeAddressLabel=(e,t)=>{CH.N.removeAddressLabel(e,t)},this.getAddress=e=>CB.R.state.activeChain!==e&&e?CB.R.getAccountProp("address",e):CH.N.state.address,this.setApprovedCaipNetworksData=e=>CB.R.setApprovedCaipNetworksData(e),this.resetNetwork=e=>{CB.R.resetNetwork(e)},this.addConnector=e=>{f7.ConnectorController.addConnector(e)},this.resetWcConnection=()=>{ge.ConnectionController.resetWcConnection()},this.setAddressExplorerUrl=(e,t)=>{CH.N.setAddressExplorerUrl(e,t)},this.setSmartAccountDeployed=(e,t)=>{CH.N.setSmartAccountDeployed(e,t)},this.setSmartAccountEnabledNetworks=(e,t)=>{CB.R.setSmartAccountEnabledNetworks(e,t)},this.setPreferredAccountType=(e,t)=>{CH.N.setPreferredAccountType(e,t)},this.setEIP6963Enabled=e=>{gr.OptionsController.setEIP6963Enabled(e)},this.handleUnsafeRPCRequest=()=>{this.isOpen()?this.isTransactionStackEmpty()||this.redirect("ApproveTransaction"):this.open({view:"ApproveTransaction"})},this.options=e,this.version=e.sdkVersion,this.caipNetworks=this.extendCaipNetworks(e),this.chainNamespaces=[...new Set(this.caipNetworks?.map(e=>e.chainNamespace))],this.defaultCaipNetwork=this.extendDefaultCaipNetwork(e),this.chainAdapters=this.createAdapters(e.adapters),this.initialize(e),this.sendInitializeEvent(e)}async initialize(e){this.initControllers(e),await this.initChainAdapters(),await this.injectModalUi(),await this.syncExistingConnection(),C0.I.set({initialized:!0})}sendInitializeEvent(e){let{...t}=e;delete t.adapters,C1.X.sendEvent({type:"track",event:"INITIALIZE",properties:{...t,networks:e.networks.map(e=>e.id),siweConfig:{options:e.siweConfig?.options||{}}}})}initControllers(e){this.initializeOptionsController(e),this.initializeChainController(e),this.initializeThemeController(e),this.initializeConnectionController(e),this.initializeConnectorController()}initializeThemeController(e){e.themeMode&&C2.ThemeController.setThemeMode(e.themeMode),e.themeVariables&&C2.ThemeController.setThemeVariables(e.themeVariables)}initializeChainController(e){if(!this.connectionControllerClient||!this.networkControllerClient)throw Error("ConnectionControllerClient and NetworkControllerClient must be set");CB.R.initialize(e.adapters??[],this.caipNetworks,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient});let t=this.getDefaultNetwork();t&&CB.R.setActiveCaipNetwork(t)}initializeConnectionController(e){ge.ConnectionController.setWcBasic(e.basic??!1)}initializeConnectorController(){f7.ConnectorController.initialize(this.chainNamespaces)}initializeOptionsController(e){gr.OptionsController.setDebug(!1!==e.debug),gr.OptionsController.setEnableWalletConnect(!1!==e.enableWalletConnect),gr.OptionsController.setEnableWalletGuide(!1!==e.enableWalletGuide),gr.OptionsController.setEnableWallets(!1!==e.enableWallets),gr.OptionsController.setEIP6963Enabled(!1!==e.enableEIP6963),gr.OptionsController.setEnableNetworkSwitch(!1!==e.enableNetworkSwitch),gr.OptionsController.setEnableAuthLogger(!1!==e.enableAuthLogger),gr.OptionsController.setCustomRpcUrls(e.customRpcUrls),gr.OptionsController.setSdkVersion(e.sdkVersion),gr.OptionsController.setProjectId(e.projectId),gr.OptionsController.setEnableEmbedded(e.enableEmbedded),gr.OptionsController.setAllWallets(e.allWallets),gr.OptionsController.setIncludeWalletIds(e.includeWalletIds),gr.OptionsController.setExcludeWalletIds(e.excludeWalletIds),gr.OptionsController.setFeaturedWalletIds(e.featuredWalletIds),gr.OptionsController.setTokens(e.tokens),gr.OptionsController.setTermsConditionsUrl(e.termsConditionsUrl),gr.OptionsController.setPrivacyPolicyUrl(e.privacyPolicyUrl),gr.OptionsController.setCustomWallets(e.customWallets),gr.OptionsController.setFeatures(e.features),gr.OptionsController.setAllowUnsupportedChain(e.allowUnsupportedChain),gr.OptionsController.setDefaultAccountTypes(e.defaultAccountTypes),gr.OptionsController.setUniversalProviderConfigOverride(e.universalProviderConfigOverride);let t=this.getDefaultMetaData();if(!e.metadata&&t&&(e.metadata=t),gr.OptionsController.setMetadata(e.metadata),gr.OptionsController.setDisableAppend(e.disableAppend),gr.OptionsController.setEnableEmbedded(e.enableEmbedded),gr.OptionsController.setSIWX(e.siwx),!e.projectId){C3.AlertController.open(C6.ALERT_ERRORS.PROJECT_ID_NOT_CONFIGURED,"error");return}if(e.adapters?.find(e=>e.namespace===Cz.b.CHAIN.EVM)&&e.siweConfig){if(e.siwx)throw Error("Cannot set both `siweConfig` and `siwx` options");gr.OptionsController.setSIWX(e.siweConfig.mapToSIWX())}}getDefaultMetaData(){return"undefined"!=typeof window&&"undefined"!=typeof document?{name:document.getElementsByTagName("title")?.[0]?.textContent||"",description:document.querySelector('meta[property="og:description"]')?.content||"",url:window.location.origin,icons:[document.querySelector('link[rel~="icon"]')?.href||""]}:null}setUnsupportedNetwork(e){let t=this.getActiveChainNamespace();if(t){let r=Nu.getUnsupportedNetwork(`${t}:${e}`);CB.R.setActiveCaipNetwork(r)}}getDefaultNetwork(){return Nu.getCaipNetworkFromStorage(this.defaultCaipNetwork)}extendCaipNetwork(e,t){return Nu.extendCaipNetwork(e,{customNetworkImageUrls:t.chainImages,projectId:t.projectId})}extendCaipNetworks(e){return Nu.extendCaipNetworks(e.networks,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId})}extendDefaultCaipNetwork(e){let t=e.networks.find(t=>t.id===e.defaultNetwork?.id);return t?Nu.extendCaipNetwork(t,{customNetworkImageUrls:e.chainImages,customRpcUrls:e.customRpcUrls,projectId:e.projectId}):void 0}createClients(){this.connectionControllerClient={connectWalletConnect:async()=>{let e=CB.R.state.activeChain,t=this.getAdapter(e),r=this.getCaipNetwork(e)?.id;if(!t)throw Error("Adapter not found");let i=await t.connectWalletConnect(r);this.close(),this.setClientId(i?.clientId||null),CV.M.setConnectedNamespaces([...CB.R.state.chains.keys()]),this.chainNamespaces.forEach(e=>{f7.ConnectorController.setConnectorId(No.b.CONNECTOR_TYPE_WALLET_CONNECT,e)}),await this.syncWalletConnectAccount()},connectExternal:async({id:e,info:t,type:r,provider:i,chain:s,caipNetwork:n})=>{let o=CB.R.state.activeChain,a=s||o,c=this.getAdapter(a);if(s&&s!==o&&!n){let e=this.caipNetworks?.find(e=>e.chainNamespace===s);e&&this.setCaipNetwork(e)}if(!c)throw Error("Adapter not found");let l=this.getCaipNetwork(a),h=await c.connect({id:e,info:t,type:r,provider:i,chainId:n?.id||l?.id,rpcUrl:n?.rpcUrls?.default?.http?.[0]||l?.rpcUrls?.default?.http?.[0]});if(!h)return;CV.M.addConnectedNamespace(a),this.syncProvider({...h,chainNamespace:a}),await this.syncAccount({...h,chainNamespace:a});let{accounts:u}=await c.getAccounts({namespace:a,id:e});this.setAllAccounts(u,a)},reconnectExternal:async({id:e,info:t,type:r,provider:i})=>{let s=CB.R.state.activeChain,n=this.getAdapter(s);n?.reconnect&&(await n?.reconnect({id:e,info:t,type:r,provider:i,chainId:this.getCaipNetwork()?.id}),CV.M.addConnectedNamespace(s))},disconnect:async e=>{let t=e||CB.R.state.activeChain,r=this.getAdapter(t),i=Nm.getProvider(t),s=Nm.getProviderId(t);await r?.disconnect({provider:i,providerType:s}),CV.M.removeConnectedNamespace(t),Nm.resetChain(t),this.setUser(void 0,t),this.setStatus("disconnected",t),this.hasSwitchedToPreferredAccountTypeOnConnect=!1},checkInstalled:e=>e?e.some(e=>!!window.ethereum?.[String(e)]):!!window.ethereum,signMessage:async e=>{let t=this.getAdapter(CB.R.state.activeChain),r=await t?.signMessage({message:e,address:CH.N.state.address,provider:Nm.getProvider(CB.R.state.activeChain)});return r?.signature||""},sendTransaction:async e=>{if(e.chainNamespace===Cz.b.CHAIN.EVM){let t=this.getAdapter(CB.R.state.activeChain),r=Nm.getProvider(CB.R.state.activeChain),i=await t?.sendTransaction({...e,caipNetwork:this.getCaipNetwork(),provider:r});return i?.hash||""}return""},estimateGas:async e=>{if(e.chainNamespace===Cz.b.CHAIN.EVM){let t=this.getAdapter(CB.R.state.activeChain),r=Nm.getProvider(CB.R.state.activeChain),i=this.getCaipNetwork();if(!i)throw Error("CaipNetwork is undefined");let s=await t?.estimateGas({...e,provider:r,caipNetwork:i});return s?.gas||0n}return 0n},getEnsAvatar:async()=>{let e=this.getAdapter(CB.R.state.activeChain),t=await e?.getProfile({address:CH.N.state.address,chainId:Number(this.getCaipNetwork()?.id)});return t?.profileImage||!1},getEnsAddress:async e=>{let t=this.getAdapter(CB.R.state.activeChain),r=this.getCaipNetwork();if(!r)return!1;let i=await t?.getEnsAddress({name:e,caipNetwork:r});return i?.address||!1},writeContract:async e=>{let t=this.getAdapter(CB.R.state.activeChain),r=this.getCaipNetwork(),i=this.getCaipAddress(),s=Nm.getProvider(CB.R.state.activeChain);if(!r||!i)throw Error("CaipNetwork or CaipAddress is undefined");let n=await t?.writeContract({...e,caipNetwork:r,provider:s,caipAddress:i});return n?.hash},parseUnits:(e,t)=>{let r=this.getAdapter(CB.R.state.activeChain);return r?.parseUnits({value:e,decimals:t})??0n},formatUnits:(e,t)=>{let r=this.getAdapter(CB.R.state.activeChain);return r?.formatUnits({value:e,decimals:t})??"0"},getCapabilities:async e=>{let t=this.getAdapter(CB.R.state.activeChain);return await t?.getCapabilities(e)},grantPermissions:async e=>{let t=this.getAdapter(CB.R.state.activeChain);return await t?.grantPermissions(e)},revokePermissions:async e=>{let t=this.getAdapter(CB.R.state.activeChain);return t?.revokePermissions?await t.revokePermissions(e):"0x"},walletGetAssets:async e=>{let t=this.getAdapter(CB.R.state.activeChain);return await t?.walletGetAssets(e)??{}}},this.networkControllerClient={switchCaipNetwork:async e=>await this.switchCaipNetwork(e),getApprovedCaipNetworksData:async()=>this.getApprovedCaipNetworksData()},ge.ConnectionController.setClient(this.connectionControllerClient)}getApprovedCaipNetworksData(){if(Nm.getProviderId(CB.R.state.activeChain)===No.b.CONNECTOR_TYPE_WALLET_CONNECT){let e=this.universalProvider?.session?.namespaces;return{supportsAllNetworks:this.universalProvider?.session?.peer?.metadata.name==="MetaMask Wallet",approvedCaipNetworkIds:this.getChainsFromNamespaces(e)}}return{supportsAllNetworks:!0,approvedCaipNetworkIds:[]}}async switchCaipNetwork(e){if(!e)return;let t=e.chainNamespace;if(this.getAddressByChainNamespace(e.chainNamespace)){let r=Nm.getProvider(t),i=Nm.getProviderId(t);if(e.chainNamespace===CB.R.state.activeChain){let s=this.getAdapter(t);await s?.switchNetwork({caipNetwork:e,provider:r,providerType:i})}else if(this.setCaipNetwork(e),i===No.b.CONNECTOR_TYPE_WALLET_CONNECT)this.syncWalletConnectAccount();else{let r=this.getAddressByChainNamespace(t);r&&this.syncAccount({address:r,chainId:e.id,chainNamespace:t})}}else this.setCaipNetwork(e)}getChainsFromNamespaces(e={}){return Object.values(e).flatMap(e=>Array.from(new Set([...e.chains||[],...e.accounts.map(e=>{let{chainId:t,chainNamespace:r}=C$.parseCaipAddress(e);return`${r}:${t}`})])))}createAdapters(e){return this.createClients(),this.chainNamespaces.reduce((t,r)=>{let i=e?.find(e=>e.namespace===r);return i?(t[r]=i,t[r].namespace=r,t[r].construct({namespace:r,projectId:this.options?.projectId,networks:this.caipNetworks})):t[r]=new NM({namespace:r,networks:this.caipNetworks}),t},{})}async initChainAdapter(e){this.onConnectors(e),this.listenAdapter(e),this.chainAdapters?.[e].syncConnectors(this.options,this),await this.createUniversalProviderForAdapter(e)}async initChainAdapters(){await Promise.all(this.chainNamespaces.map(async e=>{await this.initChainAdapter(e)}))}onConnectors(e){let t=this.getAdapter(e);t?.on("connectors",this.setConnectors.bind(this))}listenAdapter(e){let t=this.getAdapter(e);if(!t)return;let r=CV.M.getConnectionStatus();"connected"===r?this.setStatus("connecting",e):("disconnected"===r&&CV.M.clearAddressCache(),this.setStatus(r,e)),t.on("switchNetwork",({address:t,chainId:r})=>{let i=this.caipNetworks?.find(e=>e.id===r||e.caipNetworkId===r),s=CB.R.state.activeChain===e,n=CB.R.getAccountProp("address",e);if(i){let i=s&&t?t:n;i&&this.syncAccount({address:i,chainId:r,chainNamespace:e})}else this.setUnsupportedNetwork(r)}),t.on("disconnect",this.disconnect.bind(this,e)),t.on("pendingTransactions",()=>{let e=CH.N.state.address,t=CB.R.state.activeCaipNetwork;e&&t?.id&&this.updateNativeBalance(e,t.id,t.chainNamespace)}),t.on("accountChanged",({address:t,chainId:r})=>{let i=CB.R.state.activeChain===e;i&&r?this.syncAccount({address:t,chainId:r,chainNamespace:e}):i&&CB.R.state.activeCaipNetwork?.id?this.syncAccount({address:t,chainId:CB.R.state.activeCaipNetwork?.id,chainNamespace:e}):this.syncAccountInfo(t,r,e)})}async createUniversalProviderForAdapter(e){await this.getUniversalProvider(),this.universalProvider&&this.chainAdapters?.[e]?.setUniversalProvider?.(this.universalProvider)}async syncExistingConnection(){await Promise.allSettled(this.chainNamespaces.map(e=>this.syncNamespaceConnection(e)))}async syncNamespaceConnection(e){try{let t=f7.ConnectorController.getConnectorId(e);switch(this.setStatus("connecting",e),t){case Cz.b.CONNECTOR_ID.WALLET_CONNECT:await this.syncWalletConnectAccount();break;case Cz.b.CONNECTOR_ID.AUTH:break;default:await this.syncAdapterConnection(e)}}catch(t){console.warn("AppKit couldn't sync existing connection",t),this.setStatus("disconnected",e)}}async syncAdapterConnection(e){let t=this.getAdapter(e),r=f7.ConnectorController.getConnectorId(e),i=this.getCaipNetwork(e),s=f7.ConnectorController.getConnectors(e).find(e=>e.id===r);try{if(!t||!s)throw Error(`Adapter or connector not found for namespace ${e}`);if(!i?.id)throw Error("CaipNetwork not found");let r=await t?.syncConnection({namespace:e,id:s.id,chainId:i.id,rpcUrl:i?.rpcUrls?.default?.http?.[0]});if(r){let i=await t?.getAccounts({namespace:e,id:s.id});i&&i.accounts.length>0?this.setAllAccounts(i.accounts,e):this.setAllAccounts([gt.j.createAccount(e,r.address,"eoa")],e),this.syncProvider({...r,chainNamespace:e}),await this.syncAccount({...r,chainNamespace:e}),this.setStatus("connected",e)}else this.setStatus("disconnected",e)}catch(t){this.setStatus("disconnected",e)}}async syncWalletConnectAccount(){let e=this.chainNamespaces.map(async e=>{let t=this.getAdapter(e),r=this.universalProvider?.session?.namespaces?.[e]?.accounts||[],i=CB.R.state.activeCaipNetwork?.id,s=r.find(e=>{let{chainId:t}=C$.parseCaipAddress(e);return t===i?.toString()})||r[0];if(s){let r=C$.validateCaipAddress(s),{chainId:i,address:n}=C$.parseCaipAddress(r);if(Nm.setProviderId(e,No.b.CONNECTOR_TYPE_WALLET_CONNECT),this.caipNetworks&&CB.R.state.activeCaipNetwork&&t?.namespace!==Cz.b.CHAIN.EVM){let r=t?.getWalletConnectProvider({caipNetworks:this.caipNetworks,provider:this.universalProvider,activeCaipNetwork:CB.R.state.activeCaipNetwork});Nm.setProvider(e,r)}else Nm.setProvider(e,this.universalProvider);f7.ConnectorController.setConnectorId(Cz.b.CONNECTOR_ID.WALLET_CONNECT,e),CV.M.addConnectedNamespace(e),this.syncWalletConnectAccounts(e),await this.syncAccount({address:n,chainId:i,chainNamespace:e})}else this.setStatus("disconnected",e);await CB.R.setApprovedCaipNetworksData(e)});await Promise.all(e)}syncWalletConnectAccounts(e){let t=this.universalProvider?.session?.namespaces?.[e]?.accounts?.map(e=>{let{address:t}=C$.parseCaipAddress(e);return t}).filter((e,t,r)=>r.indexOf(e)===t);t&&this.setAllAccounts(t.map(t=>gt.j.createAccount(e,t,"bip122"===e?"payment":"eoa")),e)}syncProvider({type:e,provider:t,id:r,chainNamespace:i}){Nm.setProviderId(i,e),Nm.setProvider(i,t),f7.ConnectorController.setConnectorId(r,i)}async syncAccount(e){let t=e.chainNamespace===CB.R.state.activeChain,r=CB.R.getCaipNetworkByNamespace(e.chainNamespace,e.chainId),{address:i,chainId:s,chainNamespace:n}=e,{chainId:o}=CV.M.getActiveNetworkProps(),a=s||o,c=CB.R.state.activeCaipNetwork?.name===Cz.b.UNSUPPORTED_NETWORK_NAME,l=CB.R.getNetworkProp("supportsAllNetworks",n);if(this.setStatus("connected",n),(!c||l)&&a){let e=this.caipNetworks?.find(e=>e.id.toString()===a.toString()),s=this.caipNetworks?.find(e=>e.chainNamespace===n);if(!l&&!e&&!s){let t=this.getApprovedCaipNetworkIds()||[],r=t.find(e=>C$.parseCaipNetworkId(e)?.chainId===a.toString()),i=t.find(e=>C$.parseCaipNetworkId(e)?.chainNamespace===n);e=this.caipNetworks?.find(e=>e.caipNetworkId===r),s=this.caipNetworks?.find(e=>e.caipNetworkId===i||"deprecatedCaipNetworkId"in e&&e.deprecatedCaipNetworkId===i)}let o=e||s;o?.chainNamespace===CB.R.state.activeChain?gr.OptionsController.state.enableNetworkSwitch&&!gr.OptionsController.state.allowUnsupportedChain&&CB.R.state.activeCaipNetwork?.name===Cz.b.UNSUPPORTED_NETWORK_NAME?CB.R.showUnsupportedChainUI():this.setCaipNetwork(o):!t&&r&&this.setCaipNetworkOfNamespace(r,n),this.syncConnectedWalletInfo(n),Nd.g.isLowerCaseMatch(i,CH.N.state.address)||this.syncAccountInfo(i,o?.id,n),t?await this.syncBalance({address:i,chainId:o?.id,chainNamespace:n}):await this.syncBalance({address:i,chainId:r?.id,chainNamespace:n})}}async syncAccountInfo(e,t,r){let i=this.getCaipAddress(r),s=t||i?.split(":")[1];if(!s)return;let n=`${r}:${s}:${e}`;this.setCaipAddress(n,r),await this.syncIdentity({address:e,chainId:s,chainNamespace:r})}async syncReownName(e,t){try{let r=await this.getReownName(e);if(r[0]){let e=r[0];this.setProfileName(e.name,t)}else this.setProfileName(null,t)}catch{this.setProfileName(null,t)}}syncConnectedWalletInfo(e){let t=f7.ConnectorController.getConnectorId(e),r=Nm.getProviderId(e);if(r===No.b.CONNECTOR_TYPE_ANNOUNCED||r===No.b.CONNECTOR_TYPE_INJECTED){if(t){let r=this.getConnectors().find(e=>e.id===t);if(r){let{info:t,name:i,imageUrl:s}=r,n=s||this.getConnectorImage(r);this.setConnectedWalletInfo({name:i,icon:n,...t},e)}}}else if(r===No.b.CONNECTOR_TYPE_WALLET_CONNECT){let t=Nm.getProvider(e);t?.session&&this.setConnectedWalletInfo({...t.session.peer.metadata,name:t.session.peer.metadata.name,icon:t.session.peer.metadata.icons?.[0]},e)}else if(t){if(t===Cz.b.CONNECTOR_ID.COINBASE){let t=this.getConnectors().find(e=>e.id===Cz.b.CONNECTOR_ID.COINBASE);this.setConnectedWalletInfo({name:"Coinbase Wallet",icon:this.getConnectorImage(t)},e)}else this.setConnectedWalletInfo({name:t},e)}}async syncBalance(e){Cq.p.getNetworksByNamespace(this.caipNetworks,e.chainNamespace).find(t=>t.id.toString()===e.chainId?.toString())&&e.chainId&&await this.updateNativeBalance(e.address,e.chainId,e.chainNamespace)}async updateNativeBalance(e,t,r){let i=this.getAdapter(r);if(i){let s=await i.getBalance({address:e,chainId:t,caipNetwork:this.getCaipNetwork(r),tokens:this.options.tokens});this.setBalance(s.balance,s.symbol,r)}}async initializeUniversalAdapter(){let e=Np.createLogger((e,...t)=>{e&&this.handleAlertError(e),console.error(...t)}),t={projectId:this.options?.projectId,metadata:{name:this.options?.metadata?this.options?.metadata.name:"",description:this.options?.metadata?this.options?.metadata.description:"",url:this.options?.metadata?this.options?.metadata.url:"",icons:this.options?.metadata?this.options?.metadata.icons:[""]},logger:e};gr.OptionsController.setManualWCControl(!!this.options?.manualWCControl),this.universalProvider=this.options.universalProvider??await CU.init(t),this.listenWalletConnect()}listenWalletConnect(){this.universalProvider&&(this.universalProvider.on("display_uri",e=>{ge.ConnectionController.setUri(e)}),this.universalProvider.on("connect",ge.ConnectionController.finalizeWcConnection),this.universalProvider.on("disconnect",()=>{this.chainNamespaces.forEach(e=>{this.resetAccount(e)}),ge.ConnectionController.resetWcConnection()}),this.universalProvider.on("chainChanged",e=>{let t=this.caipNetworks?.find(t=>t.id==e),r=this.getCaipNetwork();if(!t){this.setUnsupportedNetwork(e);return}r?.id!==t?.id&&this.setCaipNetwork(t)}),this.universalProvider.on("session_event",e=>{if(NS.isSessionEventData(e)){let{name:t,data:r}=e.params.event;"accountsChanged"===t&&Array.isArray(r)&&gt.j.isCaipAddress(r[0])&&this.syncAccount(C$.parseCaipAddress(r[0]))}}))}createUniversalProvider(){return!this.universalProviderInitPromise&&gt.j.isClient()&&this.options?.projectId&&(this.universalProviderInitPromise=this.initializeUniversalAdapter()),this.universalProviderInitPromise}async getUniversalProvider(){if(!this.universalProvider)try{await this.createUniversalProvider()}catch(e){C1.X.sendEvent({type:"error",event:"INTERNAL_SDK_ERROR",properties:{errorType:"UniversalProviderInitError",errorMessage:e instanceof Error?e.message:"Unknown",uncaught:!1}}),console.error("AppKit:getUniversalProvider - Cannot create provider",e)}return this.universalProvider}handleAlertError(e){let[t,r]=Object.entries(C6.UniversalProviderErrors).find(([,{message:t}])=>e.message.includes(t))??[],{message:i,alertErrorKey:s}=r??{};if(t&&i&&!this.reportedAlertErrors[t]){let e=C6.ALERT_ERRORS[s];e&&(C3.AlertController.open(e,"error"),this.reportedAlertErrors[t]=!0)}}getAdapter(e){if(e)return this.chainAdapters?.[e]}createAdapter(e){if(!e)return;let t=e.namespace;t&&(this.createClients(),e.namespace=t,e.construct({namespace:t,projectId:this.options?.projectId,networks:this.caipNetworks}),this.chainNamespaces.includes(t)||this.chainNamespaces.push(t),this.chainAdapters&&(this.chainAdapters[t]=e))}async open(e){await this.injectModalUi(),e?.uri&&ge.ConnectionController.setUri(e.uri),await CF.I.open(e)}async close(){await this.injectModalUi(),CF.I.close()}setLoading(e,t){CF.I.setLoading(e,t)}async disconnect(e){await ge.ConnectionController.disconnect(e)}getError(){return""}getChainId(){return CB.R.state.activeCaipNetwork?.id}async switchNetwork(e){let t=this.caipNetworks?.find(t=>t.id===e.id);if(!t){C3.AlertController.open(C6.ALERT_ERRORS.SWITCH_NETWORK_NOT_FOUND,"error");return}await CB.R.switchActiveNetwork(t)}getWalletProvider(){return CB.R.state.activeChain?Nm.state.providers[CB.R.state.activeChain]:null}getWalletProviderType(){return Nm.getProviderId(CB.R.state.activeChain)}subscribeProviders(e){return Nm.subscribeProviders(e)}getThemeMode(){return C2.ThemeController.state.themeMode}getThemeVariables(){return C2.ThemeController.state.themeVariables}setThemeMode(e){C2.ThemeController.setThemeMode(e),(0,C8.Hs)(C2.ThemeController.state.themeMode)}setTermsConditionsUrl(e){gr.OptionsController.setTermsConditionsUrl(e)}setPrivacyPolicyUrl(e){gr.OptionsController.setPrivacyPolicyUrl(e)}setThemeVariables(e){C2.ThemeController.setThemeVariables(e),(0,C8.R)(C2.ThemeController.state.themeVariables)}subscribeTheme(e){return C2.ThemeController.subscribe(e)}getWalletInfo(){return CH.N.state.connectedWalletInfo}getAccount(e){let t=f7.ConnectorController.getAuthConnector(e),r=CB.R.getAccountData(e);if(r)return{allAccounts:r.allAccounts,caipAddress:r.caipAddress,address:gt.j.getPlainAddress(r.caipAddress),isConnected:!!r.caipAddress,status:r.status,embeddedWalletInfo:t?{user:r.user,authProvider:r.socialProvider||"email",accountType:r.preferredAccountType,isSmartAccountDeployed:!!r.smartAccountDeployed}:void 0}}subscribeAccount(e,t){let r=()=>{let r=this.getAccount(t);r&&e(r)};t?CB.R.subscribeChainProp("accountState",r,t):CB.R.subscribe(r),f7.ConnectorController.subscribe(r)}subscribeNetwork(e){return CB.R.subscribe(({activeCaipNetwork:t})=>{e({caipNetwork:t,chainId:t?.id,caipNetworkId:t?.caipNetworkId})})}subscribeWalletInfo(e){return CH.N.subscribeKey("connectedWalletInfo",e)}subscribeShouldUpdateToAddress(e){CH.N.subscribeKey("shouldUpdateToAddress",e)}subscribeCaipNetworkChange(e){CB.R.subscribeKey("activeCaipNetwork",e)}getState(){return C0.I.state}subscribeState(e){return C0.I.subscribe(e)}showErrorMessage(e){C5.SnackController.showError(e)}showSuccessMessage(e){C5.SnackController.showSuccess(e)}getEvent(){return{...C1.X.state}}subscribeEvents(e){return C1.X.subscribe(e)}replace(e){CG.RouterController.replace(e)}redirect(e){CG.RouterController.push(e)}popTransactionStack(e){CG.RouterController.popTransactionStack(e)}isOpen(){return CF.I.state.open}isTransactionStackEmpty(){return 0===CG.RouterController.state.transactionStack.length}isTransactionShouldReplaceView(){return CG.RouterController.state.transactionStack[CG.RouterController.state.transactionStack.length-1]?.replace}static getInstance(){return this.instance}updateFeatures(e){gr.OptionsController.setFeatures(e)}updateOptions(e){let t={...gr.OptionsController.state||{},...e};gr.OptionsController.setOptions(t)}setConnectMethodsOrder(e){gr.OptionsController.setConnectMethodsOrder(e)}setWalletFeaturesOrder(e){gr.OptionsController.setWalletFeaturesOrder(e)}setCollapseWallets(e){gr.OptionsController.setCollapseWallets(e)}setSocialsOrder(e){gr.OptionsController.setSocialsOrder(e)}getConnectMethodsOrder(){return C4.J.getConnectOrderMethod(gr.OptionsController.state.features,f7.ConnectorController.getConnectors())}removeAdapter(e){let t=this.getIsConnectedState(),r=this.getAdapter(e);if(!r||!this.chainAdapters||t)return;let i=this.caipNetworks?.filter(t=>t.chainNamespace!==e);CB.R.removeAdapter(e),f7.ConnectorController.removeAdapter(e),this.chainNamespaces=this.chainNamespaces.filter(t=>t!==e),this.caipNetworks=i,r.removeAllEventListeners(),Reflect.deleteProperty(this.chainAdapters,e)}addAdapter(e,t){let r=e.namespace;if(!this.connectionControllerClient||!this.networkControllerClient||!this.chainAdapters||!r)return;let i=this.extendCaipNetworks({...this.options,networks:t});this.caipNetworks=[...this.caipNetworks||[],...i],this.createAdapter(e),this.initChainAdapter(r),CB.R.addAdapter(e,{connectionControllerClient:this.connectionControllerClient,networkControllerClient:this.networkControllerClient},i)}addNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);let r=this.extendCaipNetwork(t,this.options);CB.R.addNetwork(r),this.caipNetworks&&!this.caipNetworks?.find(e=>e.id===r.id)&&this.caipNetworks.push(r)}removeNetwork(e,t){if(this.chainAdapters&&!this.chainAdapters[e])throw Error(`Adapter for namespace ${e} doesn't exist`);if(!this.caipNetworks?.find(e=>e.id===t))throw Error(`Network with ID ${t} not found`);if(!this.caipNetworks)return;let r=this.caipNetworks.filter(r=>r.chainNamespace===e&&r.id!==t);if(!r?.length)throw Error("Cannot remove last network for a namespace");CB.R.removeNetwork(e,t),this.caipNetworks=[...r]}}let Nx=!1;class NT extends NP{async open(e){f7.ConnectorController.isConnected()||await super.open(e)}async close(){await super.close(),this.options.manualWCControl&&ge.ConnectionController.finalizeWcConnection()}async syncIdentity(e){return Promise.resolve()}async syncBalance(e){return Promise.resolve()}async injectModalUi(){if(!Nx&&gt.j.isClient()){if(await Promise.all([r.e(3409),r.e(7406)]).then(r.bind(r,17406)),await Promise.all([r.e(3409),r.e(864)]).then(r.bind(r,80864)),!document.querySelector("w3m-modal")){let e=document.createElement("w3m-modal");gr.OptionsController.state.disableAppend||gr.OptionsController.state.enableEmbedded||document.body.insertAdjacentElement("beforeend",e)}Nx=!0}}}var ND=function(e){if(e.length>=255)throw TypeError("Alphabet too long");let t=new Uint8Array(256);for(let e=0;e<t.length;e++)t[e]=255;for(let r=0;r<e.length;r++){let i=e.charAt(r),s=i.charCodeAt(0);if(255!==t[s])throw TypeError(i+" is ambiguous");t[s]=r}let r=e.length,i=e.charAt(0),s=Math.log(r)/Math.log(256),n=Math.log(256)/Math.log(r);function o(e){if("string"!=typeof e)throw TypeError("Expected String");if(0===e.length)return new Uint8Array;let n=0,o=0,a=0;for(;e[n]===i;)o++,n++;let c=(e.length-n)*s+1>>>0,l=new Uint8Array(c);for(;n<e.length;){let i=e.charCodeAt(n);if(i>255)return;let s=t[i];if(255===s)return;let o=0;for(let e=c-1;(0!==s||o<a)&&-1!==e;e--,o++)s+=r*l[e]>>>0,l[e]=s%256>>>0,s=s/256>>>0;if(0!==s)throw Error("Non-zero carry");a=o,n++}let h=c-a;for(;h!==c&&0===l[h];)h++;let u=new Uint8Array(o+(c-h)),d=o;for(;h!==c;)u[d++]=l[h++];return u}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw TypeError("Expected Uint8Array");if(0===t.length)return"";let s=0,o=0,a=0,c=t.length;for(;a!==c&&0===t[a];)a++,s++;let l=(c-a)*n+1>>>0,h=new Uint8Array(l);for(;a!==c;){let e=t[a],i=0;for(let t=l-1;(0!==e||i<o)&&-1!==t;t--,i++)e+=256*h[t]>>>0,h[t]=e%r>>>0,e=e/r>>>0;if(0!==e)throw Error("Non-zero carry");o=i,a++}let u=l-o;for(;u!==l&&0===h[u];)u++;let d=i.repeat(s);for(;u<l;++u)d+=e.charAt(h[u]);return d},decodeUnsafe:o,decode:function(e){let t=o(e);if(t)return t;throw Error("Non-base"+r+" character")}}}("123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz");class NR extends Error{constructor(){super(),Object.setPrototypeOf(this,NR.prototype)}}class Nk extends Error{constructor(e){super(`WalletConnect Adapter - Method ${e} is not supported by the wallet`),this.name="WalletConnectFeatureNotSupportedError"}}let Nj={mainnet:`You are using a deprecated chain ID for Solana Mainnet, please use ${Q.Mainnet} instead.`,devnet:`You are using a deprecated chain ID for Solana Devnet, please use ${Q.Devnet} instead.`,wallet:"The connected wallet is using a deprecated chain ID for Solana. Please, contact them to upgrade. You can learn more at https://github.com/ChainAgnostic/namespaces/blob/main/solana/caip10.md#chain-ids"};function NL(e,t){let r=e.namespaces.solana?.accounts.map(e=>`solana:${e.split(":")[1]}`);if(t===Q.Mainnet)return r?.find(e=>e===Q.Mainnet)?Q.Mainnet:(console.warn(Nj.wallet),Q.Deprecated_Mainnet);if(t===Q.Devnet)return r?.find(e=>e===Q.Devnet)?Q.Devnet:(console.warn(Nj.wallet),Q.Deprecated_Devnet);throw Error("WalletConnect Solana Adapter: Unable to get a default chain from the session.")}class NU extends Error{constructor(){super("QR Code Modal was closed by user"),Object.setPrototypeOf(this,NU.prototype),this.name="QRCodeModalError"}}var Nz=r(82957).Buffer;class N${_UniversalProvider;_session;_modal;_projectId;_network;_ConnectQueueResolver;constructor(e){if(this.initClient(e.options),this._network=e.network,!e.options.projectId)throw Error("WalletConnect Adapter: Project ID is undefined");this._projectId=e.options.projectId}async connect(){var e;let t;if(this._UniversalProvider||await new Promise(e=>{this._ConnectQueueResolver=e}),!this._UniversalProvider)throw Error("WalletConnect Adapter - Universal Provider was undefined while calling 'connect()'");if(this._UniversalProvider.session){this._session=this._UniversalProvider.session;let e=NL(this._session,this._network);return this._network=e,this._UniversalProvider.setDefaultChain(e),{publicKey:this.publicKey}}await this.initModal();let r={optionalNamespaces:{solana:{chains:(t=[e=this._network],e===Q.Mainnet||e===Q.Deprecated_Mainnet?(t=[Q.Mainnet,Q.Deprecated_Mainnet],e===Q.Deprecated_Mainnet&&console.warn(Nj.mainnet)):(e===Q.Deprecated_Devnet||e===Q.Devnet)&&(t=[Q.Devnet,Q.Deprecated_Devnet],Q.Deprecated_Devnet&&console.warn(Nj.devnet)),t),methods:[T.signTransaction,T.signMessage],events:[]}}};this._modal?.open();let i=new AbortController,s=i.signal;this._modal?.subscribeState(e=>{e.open||i.abort(new NU)});try{let e=await Promise.race([this._UniversalProvider?.connect(r),new Promise((e,t)=>{s.addEventListener("abort",()=>{t(s.reason)})})]);if(this._modal?.close(),this._session=e,!e)throw new Y.$w;let t=NL(e,this._network);return this._network=t,this._UniversalProvider?.setDefaultChain(t),{publicKey:this.publicKey}}catch(e){throw this._modal?.close(),e}}async disconnect(){if(this._UniversalProvider?.session){if(await this.initModal(),!this._modal)throw Error("WalletConnect Adapter -Modal is undefined: unable to disconnect");await this.client.disconnect(),this._session=void 0}else throw new NR}get client(){if(this._UniversalProvider)return this._UniversalProvider;throw new NR}get session(){if(!this._session)throw new NR;return this._session}get publicKey(){if(this._UniversalProvider?.session&&this._session){let{address:e}=function(e){let[t,r,i]=e.split(":");return{namespace:t,reference:r,address:i}}(this._session?.namespaces.solana?.accounts[0]??"");return new X.nh(e)}throw new NR}async signTransaction(e){this.checkIfWalletSupportsMethod(T.signTransaction);let t=(0,Z.W)(e),r=t?{}:e,{signature:i,transaction:s}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:T.signTransaction,params:{...r,transaction:this.serialize(e)}}});return s?this.deserialize(s,t):(e.addSignature(this.publicKey,Nz.from(ND.decode(i))),e)}async signMessage(e){this.checkIfWalletSupportsMethod(T.signMessage);let{signature:t}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:T.signMessage,params:{pubkey:this.publicKey.toString(),message:ND.encode(e)}}});return ND.decode(t)}async signAndSendTransaction(e){this.checkIfWalletSupportsMethod(T.signAndSendTransaction);let{signature:t}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:T.signAndSendTransaction,params:{transaction:this.serialize(e)}}});return t}async signAllTransactions(e){try{this.checkIfWalletSupportsMethod(T.signAllTransactions);let t=e.map(e=>this.serialize(e)),{transactions:r}=await this.client.client.request({chainId:this._network,topic:this.session.topic,request:{method:T.signAllTransactions,params:{transactions:t}}});return e.map((e,t)=>(0,Z.W)(e)?this.deserialize(r[t]??"",!0):this.deserialize(r[t]??""))}catch(t){if(t instanceof Nk){let t=e.map(e=>this.signTransaction(e));return await Promise.all(t)}throw t}}async initClient(e){let t=await f9.init(e);this._UniversalProvider=t,this._ConnectQueueResolver&&this._ConnectQueueResolver(!0)}async initModal(){if(!this._modal){if(!this._UniversalProvider)throw Error("WalletConnect Adapter - cannot init modal when Universal Provider is undefined");this._modal=new NT({projectId:this._projectId,universalProvider:this._UniversalProvider,networks:[NE,NI,N_],manualWCControl:!0,basic:!0,sdkVersion:"html-core-1.7.2"})}}serialize(e){return Nz.from(e.serialize({verifySignatures:!1})).toString("base64")}deserialize(e,t=!1){return t?X.GS.deserialize(Nz.from(e,"base64")):X.YW.from(Nz.from(e,"base64"))}checkIfWalletSupportsMethod(e){if(!this.session.namespaces.solana?.methods.includes(e))throw new Nk(e)}}class Nq extends K.sz{name="WalletConnect";url="https://walletconnect.org";icon="data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE4NSIgdmlld0JveD0iMCAwIDMwMCAxODUiIHdpZHRoPSIzMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0ibTYxLjQzODU0MjkgMzYuMjU2MjYxMmM0OC45MTEyMjQxLTQ3Ljg4ODE2NjMgMTI4LjIxMTk4NzEtNDcuODg4MTY2MyAxNzcuMTIzMjA5MSAwbDUuODg2NTQ1IDUuNzYzNDE3NGMyLjQ0NTU2MSAyLjM5NDQwODEgMi40NDU1NjEgNi4yNzY1MTEyIDAgOC42NzA5MjA0bC0yMC4xMzY2OTUgMTkuNzE1NTAzYy0xLjIyMjc4MSAxLjE5NzIwNTEtMy4yMDUzIDEuMTk3MjA1MS00LjQyODA4MSAwbC04LjEwMDU4NC03LjkzMTE0NzljLTM0LjEyMTY5Mi0zMy40MDc5ODE3LTg5LjQ0Mzg4Ni0zMy40MDc5ODE3LTEyMy41NjU1Nzg4IDBsLTguNjc1MDU2MiA4LjQ5MzYwNTFjLTEuMjIyNzgxNiAxLjE5NzIwNDEtMy4yMDUzMDEgMS4xOTcyMDQxLTQuNDI4MDgwNiAwbC0yMC4xMzY2OTQ5LTE5LjcxNTUwMzFjLTIuNDQ1NTYxMi0yLjM5NDQwOTItMi40NDU1NjEyLTYuMjc2NTEyMiAwLTguNjcwOTIwNHptMjE4Ljc2Nzc5NjEgNDAuNzczNzQ0OSAxNy45MjE2OTcgMTcuNTQ2ODk3YzIuNDQ1NTQ5IDIuMzk0Mzk2OSAyLjQ0NTU2MyA2LjI3NjQ3NjkuMDAwMDMxIDguNjcwODg5OWwtODAuODEwMTcxIDc5LjEyMTEzNGMtMi40NDU1NDQgMi4zOTQ0MjYtNi40MTA1ODIgMi4zOTQ0NTMtOC44NTYxNi4wMDAwNjItLjAwMDAxLS4wMDAwMS0uMDAwMDIyLS4wMDAwMjItLjAwMDAzMi0uMDAwMDMybC01Ny4zNTQxNDMtNTYuMTU0NTcyYy0uNjExMzktLjU5ODYwMi0xLjYwMjY1LS41OTg2MDItMi4yMTQwNCAwLS4wMDAwMDQuMDAwMDA0LS4wMDAwMDcuMDAwMDA4LS4wMDAwMTEuMDAwMDExbC01Ny4zNTI5MjEyIDU2LjE1NDUzMWMtMi40NDU1MzY4IDIuMzk0NDMyLTYuNDEwNTc1NSAyLjM5NDQ3Mi04Ljg1NjE2MTIuMDAwMDg3LS4wMDAwMTQzLS4wMDAwMTQtLjAwMDAyOTYtLjAwMDAyOC0uMDAwMDQ0OS0uMDAwMDQ0bC04MC44MTI0MTk0My03OS4xMjIxODVjLTIuNDQ1NTYwMjEtMi4zOTQ0MDgtMi40NDU1NjAyMS02LjI3NjUxMTUgMC04LjY3MDkxOTdsMTcuOTIxNzI5NjMtMTcuNTQ2ODY3M2MyLjQ0NTU2MDItMi4zOTQ0MDgyIDYuNDEwNTk4OS0yLjM5NDQwODIgOC44NTYxNjAyIDBsNTcuMzU0OTc3NSA1Ni4xNTUzNTdjLjYxMTM5MDguNTk4NjAyIDEuNjAyNjQ5LjU5ODYwMiAyLjIxNDAzOTggMCAuMDAwMDA5Mi0uMDAwMDA5LjAwMDAxNzQtLjAwMDAxNy4wMDAwMjY1LS4wMDAwMjRsNTcuMzUyMTAzMS01Ni4xNTUzMzNjMi40NDU1MDUtMi4zOTQ0NjMzIDYuNDEwNTQ0LTIuMzk0NTUzMSA4Ljg1NjE2MS0uMDAwMi4wMDAwMzQuMDAwMDMzNi4wMDAwNjguMDAwMDY3My4wMDAxMDEuMDAwMTAxbDU3LjM1NDkwMiA1Ni4xNTU0MzJjLjYxMTM5LjU5ODYwMSAxLjYwMjY1LjU5ODYwMSAyLjIxNDA0IDBsNTcuMzUzOTc1LTU2LjE1NDMyNDljMi40NDU1NjEtMi4zOTQ0MDkyIDYuNDEwNTk5LTIuMzk0NDA5MiA4Ljg1NjE2IDB6IiBmaWxsPSIjM2I5OWZjIi8+PC9zdmc+";supportedTransactionVersions=new Set(["legacy",0]);_publicKey;_connecting;_wallet;_config;_readyState;_onDisconnect;constructor(e){super(),this._publicKey=null,this._connecting=!1,this._config=e,this._wallet=null,this._readyState="undefined"==typeof window?J.i1.Unsupported:J.i1.Loadable,this._onDisconnect=this.disconnect.bind(this)}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==J.i1.Loadable)throw new Y.OZ;this._connecting=!0,this._wallet=new N$({network:this._config.network===G.Q.Mainnet?x.Mainnet:x.Devnet,options:this._config.options});let{publicKey:e}=await this._wallet.connect();this._publicKey=e,this.emit("connect",e),this._wallet.client.on("session_delete",this._onDisconnect)}catch(e){if("QRCodeModalError"===e.constructor.name||e instanceof Error&&"QRCodeModalError"===e.name)throw new Y.hd;throw this._connecting=!1,e}finally{this._connecting=!1}}async disconnect(){let e=this._wallet;if(e){e.client.off("session_delete",this._onDisconnect),this._publicKey=null;try{e.client.session&&await e.disconnect()}catch(e){console.error("WalletConnectWalletAdapter: disconnect error",e),this.emit("error",new Y.UG(e?.message,e))}}this.emit("disconnect")}async signTransaction(e){try{let t=this._wallet;if(!t)throw new Y.oS;try{return await t.signTransaction(e)}catch(e){throw new Y.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signMessage(e){try{let t=this._wallet;if(!t)throw new Y.oS;try{return await t.signMessage(e)}catch(e){throw new Y.fk(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAndSendTransaction(e){try{let t=this._wallet;if(!t)throw new Y.oS;try{return await t.signAndSendTransaction(e)}catch(e){throw new Y.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}async signAllTransactions(e){try{let t=this._wallet;if(!t)throw new Y.oS;try{return await t.signAllTransactions(e)}catch(e){throw new Y.PY(e?.message,e)}}catch(e){throw this.emit("error",e),e}}}},85689:function(e,t,r){"use strict";function i(e){if(!Number.isSafeInteger(e)||e<0)throw Error("positive integer expected, got "+e)}function s(e,...t){if(!(e instanceof Uint8Array||ArrayBuffer.isView(e)&&"Uint8Array"===e.constructor.name))throw Error("Uint8Array expected");if(t.length>0&&!t.includes(e.length))throw Error("Uint8Array expected of length "+t+", got length="+e.length)}function n(e){if("function"!=typeof e||"function"!=typeof e.create)throw Error("Hash should be wrapped by utils.wrapConstructor");i(e.outputLen),i(e.blockLen)}function o(e,t=!0){if(e.destroyed)throw Error("Hash instance has been destroyed");if(t&&e.finished)throw Error("Hash#digest() has already been called")}function a(e,t){s(e);let r=t.outputLen;if(e.length<r)throw Error("digestInto() expects output buffer of length at least "+r)}r.d(t,{$h:function(){return o},eB:function(){return a},gk:function(){return s},k8:function(){return i},z3:function(){return n}})},38043:function(e,t,r){"use strict";r.d(t,{kb:function(){return d},l1:function(){return l},eV:function(){return u},GL:function(){return o},iA:function(){return c},O6:function(){return f},np:function(){return a},O0:function(){return h},Jq:function(){return n},hE:function(){return p}});let i="object"==typeof globalThis&&"crypto"in globalThis?globalThis.crypto:void 0;var s=r(85689);function n(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function o(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function a(e,t){return e<<32-t|e>>>t}let c=68===new Uint8Array(new Uint32Array([287454020]).buffer)[0];function l(e){for(let r=0;r<e.length;r++){var t;e[r]=(t=e[r])<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}}function h(e){return"string"==typeof e&&(e=function(e){if("string"!=typeof e)throw Error("utf8ToBytes expected string, got "+typeof e);return new Uint8Array(new TextEncoder().encode(e))}(e)),(0,s.gk)(e),e}function u(...e){let t=0;for(let r=0;r<e.length;r++){let i=e[r];(0,s.gk)(i),t+=i.length}let r=new Uint8Array(t);for(let t=0,i=0;t<e.length;t++){let s=e[t];r.set(s,i),i+=s.length}return r}class d{clone(){return this._cloneInto()}}function p(e){let t=t=>e().update(h(t)).digest(),r=e();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>e(),t}function f(e=32){if(i&&"function"==typeof i.getRandomValues)return i.getRandomValues(new Uint8Array(e));if(i&&"function"==typeof i.randomBytes)return i.randomBytes(e);throw Error("crypto.getRandomValues must be defined")}},81997:function(e,t,r){"use strict";r.d(t,{Jb:function(){return A},Ld:function(){return O},YP:function(){return N},_$LH:function(){return B},dy:function(){return S},sY:function(){return H}});let i=globalThis,s=e=>e,n=i.trustedTypes,o=n?n.createPolicy("lit-html",{createHTML:e=>e}):void 0,a="$lit$",c=`lit$${Math.random().toFixed(9).slice(2)}$`,l="?"+c,h=`<${l}>`,u=document,d=()=>u.createComment(""),p=e=>null===e||"object"!=typeof e&&"function"!=typeof e,f=Array.isArray,g=e=>f(e)||"function"==typeof e?.[Symbol.iterator],m="[ 	\n\f\r]",y=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,b=/-->/g,w=/>/g,v=RegExp(`>|${m}(?:([^\\s"'>=/]+)(${m}*=${m}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),E=/'/g,I=/"/g,_=/^(?:script|style|textarea|title)$/i,C=e=>(t,...r)=>({_$litType$:e,strings:t,values:r}),S=C(1),N=C(2),A=(C(3),Symbol.for("lit-noChange")),O=Symbol.for("lit-nothing"),M=new WeakMap,P=u.createTreeWalker(u,129);function x(e,t){if(!f(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==o?o.createHTML(t):t}let T=(e,t)=>{let r=e.length-1,i=[],s,n=2===t?"<svg>":3===t?"<math>":"",o=y;for(let t=0;t<r;t++){let r=e[t],l,u,d=-1,p=0;for(;p<r.length&&(o.lastIndex=p,null!==(u=o.exec(r)));)p=o.lastIndex,o===y?"!--"===u[1]?o=b:void 0!==u[1]?o=w:void 0!==u[2]?(_.test(u[2])&&(s=RegExp("</"+u[2],"g")),o=v):void 0!==u[3]&&(o=v):o===v?">"===u[0]?(o=s??y,d=-1):void 0===u[1]?d=-2:(d=o.lastIndex-u[2].length,l=u[1],o=void 0===u[3]?v:'"'===u[3]?I:E):o===I||o===E?o=v:o===b||o===w?o=y:(o=v,s=void 0);let f=o===v&&e[t+1].startsWith("/>")?" ":"";n+=o===y?r+h:d>=0?(i.push(l),r.slice(0,d)+a+r.slice(d)+c+f):r+c+(-2===d?t:f)}return[x(e,n+(e[r]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),i]};class D{constructor({strings:e,_$litType$:t},r){let i;this.parts=[];let s=0,o=0,h=e.length-1,u=this.parts,[p,f]=T(e,t);if(this.el=D.createElement(p,r),P.currentNode=this.el.content,2===t||3===t){let e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(i=P.nextNode())&&u.length<h;){if(1===i.nodeType){if(i.hasAttributes())for(let e of i.getAttributeNames())if(e.endsWith(a)){let t=f[o++],r=i.getAttribute(e).split(c),n=/([.?@])?(.*)/.exec(t);u.push({type:1,index:s,name:n[2],strings:r,ctor:"."===n[1]?U:"?"===n[1]?z:"@"===n[1]?$:L}),i.removeAttribute(e)}else e.startsWith(c)&&(u.push({type:6,index:s}),i.removeAttribute(e));if(_.test(i.tagName)){let e=i.textContent.split(c),t=e.length-1;if(t>0){i.textContent=n?n.emptyScript:"";for(let r=0;r<t;r++)i.append(e[r],d()),P.nextNode(),u.push({type:2,index:++s});i.append(e[t],d())}}}else if(8===i.nodeType){if(i.data===l)u.push({type:2,index:s});else{let e=-1;for(;-1!==(e=i.data.indexOf(c,e+1));)u.push({type:7,index:s}),e+=c.length-1}}s++}}static createElement(e,t){let r=u.createElement("template");return r.innerHTML=e,r}}function R(e,t,r=e,i){if(t===A)return t;let s=void 0!==i?r._$Co?.[i]:r._$Cl,n=p(t)?void 0:t._$litDirective$;return s?.constructor!==n&&(s?._$AO?.(!1),void 0===n?s=void 0:(s=new n(e))._$AT(e,r,i),void 0!==i?(r._$Co??=[])[i]=s:r._$Cl=s),void 0!==s&&(t=R(e,s._$AS(e,t.values),s,i)),t}class k{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){let{el:{content:t},parts:r}=this._$AD,i=(e?.creationScope??u).importNode(t,!0);P.currentNode=i;let s=P.nextNode(),n=0,o=0,a=r[0];for(;void 0!==a;){if(n===a.index){let t;2===a.type?t=new j(s,s.nextSibling,this,e):1===a.type?t=new a.ctor(s,a.name,a.strings,this,e):6===a.type&&(t=new q(s,this,e)),this._$AV.push(t),a=r[++o]}n!==a?.index&&(s=P.nextNode(),n++)}return P.currentNode=u,i}p(e){let t=0;for(let r of this._$AV)void 0!==r&&(void 0!==r.strings?(r._$AI(e,r,t),t+=r.strings.length-2):r._$AI(e[t])),t++}}class j{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,r,i){this.type=2,this._$AH=O,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=r,this.options=i,this._$Cv=i?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode,t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){p(e=R(this,e,t))?e===O||null==e||""===e?(this._$AH!==O&&this._$AR(),this._$AH=O):e!==this._$AH&&e!==A&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):g(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==O&&p(this._$AH)?this._$AA.nextSibling.data=e:this.T(u.createTextNode(e)),this._$AH=e}$(e){let{values:t,_$litType$:r}=e,i="number"==typeof r?this._$AC(e):(void 0===r.el&&(r.el=D.createElement(x(r.h,r.h[0]),this.options)),r);if(this._$AH?._$AD===i)this._$AH.p(t);else{let e=new k(i,this),r=e.u(this.options);e.p(t),this.T(r),this._$AH=e}}_$AC(e){let t=M.get(e.strings);return void 0===t&&M.set(e.strings,t=new D(e)),t}k(e){f(this._$AH)||(this._$AH=[],this._$AR());let t=this._$AH,r,i=0;for(let s of e)i===t.length?t.push(r=new j(this.O(d()),this.O(d()),this,this.options)):r=t[i],r._$AI(s),i++;i<t.length&&(this._$AR(r&&r._$AB.nextSibling,i),t.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){let t=s(e).nextSibling;s(e).remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}}class L{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,r,i,s){this.type=1,this._$AH=O,this._$AN=void 0,this.element=e,this.name=t,this._$AM=i,this.options=s,r.length>2||""!==r[0]||""!==r[1]?(this._$AH=Array(r.length-1).fill(new String),this.strings=r):this._$AH=O}_$AI(e,t=this,r,i){let s=this.strings,n=!1;if(void 0===s)(n=!p(e=R(this,e,t,0))||e!==this._$AH&&e!==A)&&(this._$AH=e);else{let i,o;let a=e;for(e=s[0],i=0;i<s.length-1;i++)(o=R(this,a[r+i],t,i))===A&&(o=this._$AH[i]),n||=!p(o)||o!==this._$AH[i],o===O?e=O:e!==O&&(e+=(o??"")+s[i+1]),this._$AH[i]=o}n&&!i&&this.j(e)}j(e){e===O?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class U extends L{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===O?void 0:e}}class z extends L{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==O)}}class $ extends L{constructor(e,t,r,i,s){super(e,t,r,i,s),this.type=5}_$AI(e,t=this){if((e=R(this,e,t,0)??O)===A)return;let r=this._$AH,i=e===O&&r!==O||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,s=e!==O&&(r===O||i);i&&this.element.removeEventListener(this.name,this,r),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}}class q{constructor(e,t,r){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=r}get _$AU(){return this._$AM._$AU}_$AI(e){R(this,e)}}let B={M:a,P:c,A:l,C:1,L:T,R:k,D:g,V:R,I:j,H:L,N:z,U:$,B:U,F:q},W=i.litHtmlPolyfillSupport;W?.(D,j),(i.litHtmlVersions??=[]).push("3.3.2");let H=(e,t,r)=>{let i=r?.renderBefore??t,s=i._$litPart$;if(void 0===s){let e=r?.renderBefore??null;i._$litPart$=s=new j(t.insertBefore(d(),e),e,void 0,r??{})}return s._$AI(e),s}},31133:function(e,t,r){"use strict";r.d(t,{oi:function(){return o},iv:function(){return i.iv},dy:function(){return s.dy},YP:function(){return s.YP},$m:function(){return i.$m}});var i=r(93511),s=r(81997);let n=globalThis;class o extends i.fl{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){let e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){let t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=(0,s.sY)(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return s.Jb}}o._$litElement$=!0,o.finalized=!0,n.litElementHydrateSupport?.({LitElement:o});let a=n.litElementPolyfillSupport;a?.({LitElement:o}),(n.litElementVersions??=[]).push("4.2.2")},33085:function(e,t,r){"use strict";r.d(t,{sj:function(){return p},iH:function(){return m},CO:function(){return g},Ld:function(){return f}}),Symbol();let i=Symbol(),s=Object.getPrototypeOf,n=new WeakMap,o=e=>e&&(n.has(e)?n.get(e):s(e)===Object.prototype||s(e)===Array.prototype),a=e=>o(e)&&e[i]||null,c=(e,t=!0)=>{n.set(e,t)},l=e=>"object"==typeof e&&null!==e,h=new WeakMap,u=new WeakSet,[d]=((e=Object.is,t=(e,t)=>new Proxy(e,t),r=e=>l(e)&&!u.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer),i=e=>{switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:throw e}},s=new WeakMap,n=(e,t,r=i)=>{let o=s.get(e);if((null==o?void 0:o[0])===t)return o[1];let a=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return c(a,!0),s.set(e,[t,a]),Reflect.ownKeys(e).forEach(t=>{if(Object.getOwnPropertyDescriptor(a,t))return;let i=Reflect.get(e,t),{enumerable:s}=Reflect.getOwnPropertyDescriptor(e,t),o={value:i,enumerable:s,configurable:!0};if(u.has(i))c(i,!1);else if(i instanceof Promise)delete o.value,o.get=()=>r(i);else if(h.has(i)){let[e,t]=h.get(i);o.value=n(e,t(),r)}Object.defineProperty(a,t,o)}),Object.preventExtensions(a)},o=new WeakMap,d=[1,1],p=i=>{if(!l(i))throw Error("object required");let s=o.get(i);if(s)return s;let c=d[0],f=new Set,g=(e,t=++d[0])=>{c!==t&&(c=t,f.forEach(r=>r(e,t)))},m=d[1],y=(e=++d[1])=>(m===e||f.size||(m=e,w.forEach(([t])=>{let r=t[1](e);r>c&&(c=r)})),c),b=e=>(t,r)=>{let i=[...t];i[1]=[e,...i[1]],g(i,r)},w=new Map,v=(e,t)=>{if(w.has(e))throw Error("prop listener already exists");if(f.size){let r=t[3](b(e));w.set(e,[t,r])}else w.set(e,[t])},E=e=>{var t;let r=w.get(e);r&&(w.delete(e),null==(t=r[1])||t.call(r))},I=e=>{f.add(e),1===f.size&&w.forEach(([e,t],r)=>{if(t)throw Error("remove already exists");let i=e[3](b(r));w.set(r,[e,i])});let t=()=>{f.delete(e),0===f.size&&w.forEach(([e,t],r)=>{t&&(t(),w.set(r,[e]))})};return t},_=Array.isArray(i)?[]:Object.create(Object.getPrototypeOf(i)),C={deleteProperty(e,t){let r=Reflect.get(e,t);E(t);let i=Reflect.deleteProperty(e,t);return i&&g(["delete",[t],r]),i},set(t,i,s,n){let c=Reflect.has(t,i),d=Reflect.get(t,i,n);if(c&&(e(d,s)||o.has(s)&&e(d,o.get(s))))return!0;E(i),l(s)&&(s=a(s)||s);let f=s;if(s instanceof Promise)s.then(e=>{s.status="fulfilled",s.value=e,g(["resolve",[i],e])}).catch(e=>{s.status="rejected",s.reason=e,g(["reject",[i],e])});else{!h.has(s)&&r(s)&&(f=p(s));let e=!u.has(f)&&h.get(f);e&&v(i,e)}return Reflect.set(t,i,f,n),g(["set",[i],s,d]),!0}},S=t(_,C);o.set(i,S);let N=[_,y,n,I];return h.set(S,N),Reflect.ownKeys(i).forEach(e=>{let t=Object.getOwnPropertyDescriptor(i,e);"value"in t&&(S[e]=i[e],delete t.value,delete t.writable),Object.defineProperty(_,e,t)}),S})=>[p,h,u,e,t,r,i,s,n,o,d])();function p(e={}){return d(e)}function f(e,t,r){let i;let s=h.get(e);s||console.warn("Please use proxy object");let n=[],o=s[3],a=!1,c=o(e=>{if(n.push(e),r){t(n.splice(0));return}i||(i=Promise.resolve().then(()=>{i=void 0,a&&t(n.splice(0))}))});return a=!0,()=>{a=!1,c()}}function g(e,t){let r=h.get(e);r||console.warn("Please use proxy object");let[i,s,n]=r;return n(i,s(),t)}function m(e){return u.add(e),e}},55543:function(e,t,r){"use strict";r.d(t,{VW:function(){return s},Yr:function(){return n}});var i=r(33085);function s(e,t,r,s){let n=e[t];return(0,i.Ld)(e,()=>{let i=e[t];Object.is(n,i)||r(n=i)},s)}function n(e){let t=(0,i.sj)({data:Array.from(e||[]),has(e){return this.data.some(t=>t[0]===e)},set(e,t){let r=this.data.find(t=>t[0]===e);return r?r[1]=t:this.data.push([e,t]),this},get(e){var t;return null==(t=this.data.find(t=>t[0]===e))?void 0:t[1]},delete(e){let t=this.data.findIndex(t=>t[0]===e);return -1!==t&&(this.data.splice(t,1),!0)},clear(){this.data.splice(0)},get size(){return this.data.length},toJSON(){return new Map(this.data)},forEach(e){this.data.forEach(t=>{e(t[1],t[0],this)})},keys(){return this.data.map(e=>e[0]).values()},values(){return this.data.map(e=>e[1]).values()},entries(){return new Map(this.data).entries()},get[Symbol.toStringTag](){return"Map"},[Symbol.iterator](){return this.entries()}});return Object.defineProperties(t,{data:{enumerable:!1},size:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(t),t}Symbol()},39502:function(e,t,r){"use strict";function i(e,t){let r=e.toString(),i=r.startsWith("-");i&&(r=r.slice(1));let[s,n]=[(r=r.padStart(t,"0")).slice(0,r.length-t),r.slice(r.length-t)];return n=n.replace(/(0+)$/,""),`${i?"-":""}${s||"0"}${n?`.${n}`:""}`}r.d(t,{b:function(){return i}})},58274:function(e){"use strict";e.exports={i8:"6.6.1"}}}]);